var u=Object.defineProperty;var p=(i,t,r)=>t in i?u(i,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[t]=r;var e=(i,t,r)=>(p(i,typeof t!="symbol"?t+"":t,r),r);import{s as c}from"./blocking-group-data.358160cd.js";import{S as g}from"./store-keys.22403613.js";import{g as l,b as d,c as S}from"./posts.59d19b48.js";import{s as o}from"./url-parsing.a8bc8aac.js";const h=()=>({property:"id",direction:"desc"}),C=()=>{const{subscribe:i,set:t,update:r}=c(g.Sort,h());return{subscribe:i,set:t,update(s){r(a=>({...a,...s}))},reset(){t(h())}}},k=C(),n=()=>({scoreValue:0,scoreComparator:">=",rating:"all"}),m=()=>{const{subscribe:i,set:t,update:r}=c(g.Filter,n());return{subscribe:i,set(s){console.log("set store",s),t({...s,scoreValue:s.scoreValue??0})},update(s){console.log("update store",s),r(a=>({...a,...s}))},reset(){t(n())}}},D=m();class f{constructor(){e(this,"pid");e(this,"tags");e(this,"supertags");e(this,"blockedContent");e(this,"sortProperty");e(this,"sortDirection");e(this,"scoreValue");e(this,"rating");e(this,"scoreComparator");e(this,"tagString");this.pid=0,this.tags=[],this.supertags=[],this.blockedContent=[],this.sortProperty="id",this.sortDirection="desc",this.scoreValue=0,this.rating="all",this.scoreComparator=">="}withPid(t){return this.pid=t,this}withTags(t){return this.tags=t,this}withSupertags(t){return this.supertags=t,this}withSortProperty(t){return this.sortProperty=t,this}withSortDirection(t){return this.sortDirection=t,this}withScoreValue(t){return this.scoreValue=t,this}withScoreComparator(t){return this.scoreComparator=t,this}withRating(t){return this.rating=t,this}withBlockedContent(t){return this.blockedContent=Object.entries(t).filter(([r,s])=>s).map(([r,s])=>r),this}async getPageAndCount(){return this.tagString=o(this.tags,this.sortProperty,this.sortDirection,this.scoreValue,this.rating,this.scoreComparator,this.blockedContent,this.supertags),Promise.all([this.getPage(),this.getCount()])}async getPage(){return this.tagString||(this.tagString=o(this.tags,this.sortProperty,this.sortDirection,this.scoreValue,this.rating,this.scoreComparator,this.blockedContent,this.supertags)),l(this.pid,this.tagString)}async getCount(){return this.tagString||(this.tagString=o(this.tags,this.sortProperty,this.sortDirection,this.scoreValue,this.rating,this.scoreComparator,this.blockedContent,this.supertags)),d(this.tagString)}getQuery(){return this.tagString||(this.tagString=o(this.tags,this.sortProperty,this.sortDirection,this.scoreValue,this.rating,this.scoreComparator,this.blockedContent,this.supertags)),S(0,this.tagString)}}export{f as S,D as f,k as s};
