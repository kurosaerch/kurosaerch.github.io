import{s as L,f as A,l as U,a as F,g as E,h as P,m as j,d as _,c as B,j as c,i as I,u as C,n as z,v as y,e as Q,y as Ze,I as De,D as $e,k as q,z as O,H as T,R as Ce,J as ue,r as fe,V as se,W as ne,O as Pe,K as Y,o as xe,M as et,Q as tt,G as he,L as st,N as nt,p as Z,P as lt,E as _e}from"./scheduler.d22bc004.js";import{h as de,u as at}from"./await_block.7529a0a6.js";import{e as le}from"./each.e59479a4.js";import{S as V,i as G,a as R,t as N,g as ie,c as oe,b as $,d as x,m as ee,e as te,r as rt,f as ge}from"./index.c60e7740.js";import{g as me}from"./comments.7340f7b2.js";import{L as it}from"./LoadingAnimation.ffe18522.js";import{f as pe}from"./format-tag.7e313273.js";import{i as ot}from"./tags.49324235.js";import{a as ce}from"./active-tags-store.c00d78fb.js";import{S as ct}from"./SimpleTag.9207d814.js";import{b as X}from"./paths.ae0c957a.js";import{c as Re,h as ut,b as Me}from"./always-loop-store.ff2f7347.js";const be=6e4,ae=s=>{if(!ft(s))throw new TypeError("Invalid createdAt passed to formatCreatedAt");const e=new Date(s).getTime()/be,l=new Date().getTime()/be-e;if(l<1)return"Just now";if(l<60)return K(l,"minute");const n=l/60;if(n<24)return K(n,"hour");const o=n/24;if(o<7)return K(o,"day");if(o<30.5)return K(o/7,"week");if(o<365.25)return K(o/30.5,"month");const a=o/365.25;return K(a,"year")},ft=s=>(typeof s=="number"||typeof s=="string")&&new Date(s).toString()!=="Invalid Date",K=(s,e)=>{const t=s.toFixed();return`${t} ${e}${t==="1"?"":"s"} ago`};function ht(s){let e,t,l=s[0].author+"",n,o,a,i=ae(s[0].createdAt)+"",r,u,d,D=s[0].content+"",m;return{c(){e=A("div"),t=A("span"),n=U(l),o=F(),a=A("span"),r=U(i),u=F(),d=A("span"),m=U(D),this.h()},l(w){e=E(w,"DIV",{class:!0});var g=P(e);t=E(g,"SPAN",{class:!0});var k=P(t);n=j(k,l),k.forEach(_),o=B(g),a=E(g,"SPAN",{class:!0});var f=P(a);r=j(f,i),f.forEach(_),u=B(g),d=E(g,"SPAN",{class:!0});var p=P(d);m=j(p,D),p.forEach(_),g.forEach(_),this.h()},h(){c(t,"class","author svelte-bys59y"),c(a,"class","created-at svelte-bys59y"),c(d,"class","content svelte-bys59y"),c(e,"class","svelte-bys59y")},m(w,g){I(w,e,g),C(e,t),C(t,n),C(e,o),C(e,a),C(a,r),C(e,u),C(e,d),C(d,m)},p(w,[g]){g&1&&l!==(l=w[0].author+"")&&z(n,l),g&1&&i!==(i=ae(w[0].createdAt)+"")&&z(r,i),g&1&&D!==(D=w[0].content+"")&&z(m,D)},i:y,o:y,d(w){w&&_(e)}}}function _t(s,e,t){let{comment:l}=e;return s.$$set=n=>{"comment"in n&&t(0,l=n.comment)},[l]}class dt extends V{constructor(e){super(),G(this,e,_t,ht,L,{comment:0})}}function ye(s,e,t){const l=s.slice();return l[2]=e[t],l}function gt(s){return{c:y,l:y,m:y,p:y,i:y,o:y,d:y}}function mt(s){let e,t,l,n;const o=[bt,pt],a=[];function i(r,u){return r[1].length>0?0:1}return e=i(s),t=a[e]=o[e](s),{c(){t.c(),l=Q()},l(r){t.l(r),l=Q()},m(r,u){a[e].m(r,u),I(r,l,u),n=!0},p(r,u){let d=e;e=i(r),e===d?a[e].p(r,u):(ie(),N(a[d],1,1,()=>{a[d]=null}),oe(),t=a[e],t?t.p(r,u):(t=a[e]=o[e](r),t.c()),R(t,1),t.m(l.parentNode,l))},i(r){n||(R(t),n=!0)},o(r){N(t),n=!1},d(r){r&&_(l),a[e].d(r)}}}function pt(s){let e,t="Comments for this post are not available. <br/>This can happen if comments have been deleted.";return{c(){e=A("p"),e.innerHTML=t,this.h()},l(l){e=E(l,"P",{class:!0,"data-svelte-h":!0}),Ze(e)!=="svelte-1f9q9vq"&&(e.innerHTML=t),this.h()},h(){c(e,"class","no-comments svelte-x6zn2h")},m(l,n){I(l,e,n)},p:y,i:y,o:y,d(l){l&&_(e)}}}function bt(s){let e,t,l=le(s[1]),n=[];for(let a=0;a<l.length;a+=1)n[a]=ve(ye(s,l,a));const o=a=>N(n[a],1,1,()=>{n[a]=null});return{c(){e=A("ul");for(let a=0;a<n.length;a+=1)n[a].c();this.h()},l(a){e=E(a,"UL",{class:!0});var i=P(e);for(let r=0;r<n.length;r+=1)n[r].l(i);i.forEach(_),this.h()},h(){c(e,"class","comments svelte-x6zn2h")},m(a,i){I(a,e,i);for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(e,null);t=!0},p(a,i){if(i&1){l=le(a[1]);let r;for(r=0;r<l.length;r+=1){const u=ye(a,l,r);n[r]?(n[r].p(u,i),R(n[r],1)):(n[r]=ve(u),n[r].c(),R(n[r],1),n[r].m(e,null))}for(ie(),r=l.length;r<n.length;r+=1)o(r);oe()}},i(a){if(!t){for(let i=0;i<l.length;i+=1)R(n[i]);t=!0}},o(a){n=n.filter(Boolean);for(let i=0;i<n.length;i+=1)N(n[i]);t=!1},d(a){a&&_(e),De(n,a)}}}function ve(s){let e,t;return e=new dt({props:{comment:s[2]}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,n){ee(e,l,n),t=!0},p(l,n){const o={};n&1&&(o.comment=l[2]),e.$set(o)},i(l){t||(R(e.$$.fragment,l),t=!0)},o(l){N(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function yt(s){let e,t;return e=new it({}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,n){ee(e,l,n),t=!0},p:y,i(l){t||(R(e.$$.fragment,l),t=!0)},o(l){N(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function vt(s){let e,t,l,n={ctx:s,current:null,token:null,hasCatch:!1,pending:yt,then:mt,catch:gt,value:1,blocks:[,,,]};return de(t=me(s[0].id),n),{c(){e=Q(),n.block.c()},l(o){e=Q(),n.block.l(o)},m(o,a){I(o,e,a),n.block.m(o,n.anchor=a),n.mount=()=>e.parentNode,n.anchor=e,l=!0},p(o,[a]){s=o,n.ctx=s,a&1&&t!==(t=me(s[0].id))&&de(t,n)||at(n,s,a)},i(o){l||(R(n.block),l=!0)},o(o){for(let a=0;a<3;a+=1){const i=n.blocks[a];N(i)}l=!1},d(o){o&&_(e),n.block.d(o),n.token=null,n=null}}}function kt(s,e,t){let{post:l}=e;return s.$$set=n=>{"post"in n&&t(0,l=n.post)},[l]}class rs extends V{constructor(e){super(),G(this,e,kt,vt,L,{post:0})}}function wt(s){let e,t=s[0].charAt(0).toUpperCase()+"",l,n;return{c(){e=A("span"),l=U(t),this.h()},l(o){e=E(o,"SPAN",{title:!0,class:!0});var a=P(e);l=j(a,t),a.forEach(_),this.h()},h(){c(e,"title",n="Rated "+s[0]+"."),c(e,"class","svelte-1nbj6kf")},m(o,a){I(o,e,a),C(e,l)},p(o,[a]){a&1&&t!==(t=o[0].charAt(0).toUpperCase()+"")&&z(l,t),a&1&&n!==(n="Rated "+o[0]+".")&&c(e,"title",n)},i:y,o:y,d(o){o&&_(e)}}}function St(s,e,t){let{value:l}=e;return s.$$set=n=>{"value"in n&&t(0,l=n.value)},[l]}class is extends V{constructor(e){super(),G(this,e,St,wt,L,{value:0})}}function At(s){let e,t=ae(s[0])+"",l;return{c(){e=A("span"),l=U(t),this.h()},l(n){e=E(n,"SPAN",{class:!0});var o=P(e);l=j(o,t),o.forEach(_),this.h()},h(){c(e,"class","svelte-1vqihm9")},m(n,o){I(n,e,o),C(e,l)},p(n,[o]){o&1&&t!==(t=ae(n[0])+"")&&z(l,t)},i:y,o:y,d(n){n&&_(e)}}}function Et(s,e,t){let{value:l}=e;return s.$$set=n=>{"value"in n&&t(0,l=n.value)},[l]}class os extends V{constructor(e){super(),G(this,e,Et,At,L,{value:0})}}function It(s){let e,t=pe(s[0])+"",l;return{c(){e=A("span"),l=U(t),this.h()},l(n){e=E(n,"SPAN",{"data-testid":!0,class:!0});var o=P(e);l=j(o,t),o.forEach(_),this.h()},h(){c(e,"data-testid","score"),c(e,"class","codicon codicon-heart svelte-te86f3")},m(n,o){I(n,e,o),C(e,l)},p(n,[o]){o&1&&t!==(t=pe(n[0])+"")&&z(l,t)},i:y,o:y,d(n){n&&_(e)}}}function Tt(s,e,t){let{value:l}=e;return s.$$set=n=>{"value"in n&&t(0,l=n.value)},[l]}class cs extends V{constructor(e){super(),G(this,e,Tt,It,L,{value:0})}}function ke(s){let e,t,l,n,o;return{c(){e=A("a"),t=A("i"),l=F(),n=U(s[1]),this.h()},l(a){e=E(a,"A",{href:!0,target:!0,class:!0});var i=P(e);t=E(i,"I",{class:!0}),P(t).forEach(_),l=B(i),n=j(i,s[1]),i.forEach(_),this.h()},h(){c(t,"class","codicon codicon-link"),c(e,"href",o=s[0].toString()),c(e,"target","_newtab"),c(e,"class","svelte-1orztco")},m(a,i){I(a,e,i),C(e,t),C(e,l),C(e,n)},p(a,i){i&2&&z(n,a[1]),i&1&&o!==(o=a[0].toString())&&c(e,"href",o)},d(a){a&&_(e)}}}function Dt(s){let e,t=s[0]&&ke(s);return{c(){t&&t.c(),e=Q()},l(l){t&&t.l(l),e=Q()},m(l,n){t&&t.m(l,n),I(l,e,n)},p(l,[n]){l[0]?t?t.p(l,n):(t=ke(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:y,o:y,d(l){l&&_(e),t&&t.d(l)}}}function Ct(s,e,t){let l,n,{source:o}=e;return s.$$set=a=>{"source"in a&&t(2,o=a.source)},s.$$.update=()=>{var a;s.$$.dirty&4&&t(0,l=ot(o)?new URL(o):null),s.$$.dirty&1&&t(1,n=(a=l==null?void 0:l.hostname)==null?void 0:a.replace(/^www./,""))},[l,n,o]}class us extends V{constructor(e){super(),G(this,e,Ct,Dt,L,{source:2})}}function Pt(s){let e,t,l;return{c(){e=A("a"),t=A("i"),l=U(" File"),this.h()},l(n){e=E(n,"A",{href:!0,target:!0,class:!0});var o=P(e);t=E(o,"I",{class:!0}),P(t).forEach(_),l=j(o," File"),o.forEach(_),this.h()},h(){c(t,"class","codicon codicon-file"),c(e,"href",s[0]),c(e,"target","_newtab"),c(e,"class","svelte-1orztco")},m(n,o){I(n,e,o),C(e,t),C(e,l)},p(n,[o]){o&1&&c(e,"href",n[0])},i:y,o:y,d(n){n&&_(e)}}}function Rt(s,e,t){let{url:l}=e;return s.$$set=n=>{"url"in n&&t(0,l=n.url)},[l]}class fs extends V{constructor(e){super(),G(this,e,Rt,Pt,L,{url:0})}}function we(s,e,t){const l=s.slice();l[4]=e[t];const n=l[1].find(function(...a){return s[3](l[4],...a)})!==void 0;return l[5]=n,l}function Se(s){let e,t;function l(){return s[2](s[5],s[4])}return e=new ct({props:{tag:s[4],active:s[5]}}),e.$on("click",l),{c(){$(e.$$.fragment)},l(n){x(e.$$.fragment,n)},m(n,o){ee(e,n,o),t=!0},p(n,o){s=n;const a={};o&1&&(a.tag=s[4]),o&3&&(a.active=s[5]),e.$set(a)},i(n){t||(R(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){te(e,n)}}}function Mt(s){let e,t,l=le(s[0]),n=[];for(let a=0;a<l.length;a+=1)n[a]=Se(we(s,l,a));const o=a=>N(n[a],1,1,()=>{n[a]=null});return{c(){e=A("ul");for(let a=0;a<n.length;a+=1)n[a].c();this.h()},l(a){e=E(a,"UL",{class:!0});var i=P(e);for(let r=0;r<n.length;r+=1)n[r].l(i);i.forEach(_),this.h()},h(){c(e,"class","tags svelte-b5q4us")},m(a,i){I(a,e,i);for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(e,null);t=!0},p(a,[i]){if(i&3){l=le(a[0]);let r;for(r=0;r<l.length;r+=1){const u=we(a,l,r);n[r]?(n[r].p(u,i),R(n[r],1)):(n[r]=Se(u),n[r].c(),R(n[r],1),n[r].m(e,null))}for(ie(),r=l.length;r<n.length;r+=1)o(r);oe()}},i(a){if(!t){for(let i=0;i<l.length;i+=1)R(n[i]);t=!0}},o(a){n=n.filter(Boolean);for(let i=0;i<n.length;i+=1)N(n[i]);t=!1},d(a){a&&_(e),De(n,a)}}}function Nt(s,e,t){let l;$e(s,ce,i=>t(1,l=i));let{tags:n}=e;const o=(i,r)=>i?ce.removeByName(r.name):ce.addOrReplace({...r,modifier:"+"}),a=(i,r)=>r.name===i.name;return s.$$set=i=>{"tags"in i&&t(0,n=i.tags)},[n,l,o,a]}class hs extends V{constructor(e){super(),G(this,e,Nt,Mt,L,{tags:0})}}const Ne=s=>s.endsWith(".gif"),Lt=(s,e,t)=>Ne(e)?{static:t,animated:e}:{static:e,animated:s},Le=s=>s.endsWith(".mp4")||s.endsWith(".webm"),_s=(s,e,t)=>Le(e)?{static:t,animated:e}:{static:e,animated:s},ds=s=>s.some(e=>e.name==="loop"),gs=s=>Ne(s)||Le(s),Vt=(s,e)=>s&&e?s/e:1,re=(s,e)=>s&&e?`${s} / ${e}`:"1 / 1",Gt="1250px",J=new IntersectionObserver(s=>{var e;for(const t of s){const l=t.isIntersecting?t.target.getAttribute("data-src")??"":"";(e=t==null?void 0:t.target)==null||e.setAttribute("src",l)}},{rootMargin:Gt}),Ve=s=>(J==null||J.observe(s),{destroy(){J==null||J.unobserve(s)}});function Ut(s){let e,t,l,n,o,a,i;return{c(){e=A("div"),t=A("img"),this.h()},l(r){e=E(r,"DIV",{class:!0});var u=P(e);t=E(u,"IMG",{class:!0,loading:!0,"data-src":!0,alt:!0,style:!0,width:!0,height:!0,tabindex:!0}),u.forEach(_),this.h()},h(){c(t,"class","post-media svelte-jjbbut"),c(t,"loading","lazy"),c(t,"data-src",s[2]),c(t,"alt",l=s[0].id.toString()),q(t,"aspect-ratio",re(s[0].width,s[0].height)),c(t,"width",n=s[0].width),c(t,"height",o=s[0].height),c(t,"tabindex","0"),c(e,"class","svelte-jjbbut"),O(e,"expandable",s[3]),O(e,"open",s[1])},m(r,u){I(r,e,u),C(e,t),a||(i=[T(t,"click",s[4]),T(t,"keydown",Re),T(t,"error",s[5],{once:!0}),Ce(Ve.call(null,t))],a=!0)},p(r,[u]){u&4&&c(t,"data-src",r[2]),u&1&&l!==(l=r[0].id.toString())&&c(t,"alt",l),u&1&&q(t,"aspect-ratio",re(r[0].width,r[0].height)),u&1&&n!==(n=r[0].width)&&c(t,"width",n),u&1&&o!==(o=r[0].height)&&c(t,"height",o),u&2&&O(e,"open",r[1])},i:y,o:y,d(r){r&&_(e),a=!1,ue(i)}}}function jt(s,e,t){let l,{post:n}=e,a=Vt(n.width,n.height)<.33,i;const r=()=>t(1,i=!i),u=d=>d.target.src=`${X}/assets/failed-to-load.svg`;return s.$$set=d=>{"post"in d&&t(0,n=d.post)},s.$$.update=()=>{s.$$.dirty&1&&t(2,l=ut?n.file_url:n.sample_url)},[n,i,l,a,r,u]}class ms extends V{constructor(e){super(),G(this,e,jt,Ut,L,{post:0})}}const Ae=s=>{if(typeof s!="number")throw new TypeError(`Attempted to call formatVideoTime with invalid value: ${s}`);const e=Math.floor(s),t=e%60,l=Math.floor(e/60);return`${Ee(l)}:${Ee(t)}`},Ee=s=>{const e=String(s),t=Math.max(0,2-e.length);return`${"0".repeat(t)}${e}`};function zt(s){let e,t;return{c(){e=A("img"),this.h()},l(l){e=E(l,"IMG",{src:!0,alt:!0,width:!0,height:!0,style:!0}),this.h()},h(){Y(e.src,t=s[3])||c(e,"src",t),c(e,"alt","Start GIF"),c(e,"width","16"),c(e,"height","32"),q(e,"margin-left","4px")},m(l,n){I(l,e,n)},p:y,d(l){l&&_(e)}}}function Ot(s){let e,t;return{c(){e=A("img"),this.h()},l(l){e=E(l,"IMG",{src:!0,alt:!0,width:!0,height:!0}),this.h()},h(){Y(e.src,t=s[4])||c(e,"src",t),c(e,"alt","Stop GIF"),c(e,"width","16"),c(e,"height","32")},m(l,n){I(l,e,n)},p:y,d(l){l&&_(e)}}}function Ft(s){let e,t;return{c(){e=A("img"),this.h()},l(l){e=E(l,"IMG",{src:!0,alt:!0,width:!0,height:!0}),this.h()},h(){Y(e.src,t=s[2])||c(e,"src",t),c(e,"alt","Loading GIF"),c(e,"width","16"),c(e,"height","32")},m(l,n){I(l,e,n)},p:y,d(l){l&&_(e)}}}function Bt(s){let e,t,l,n;function o(r,u){return r[1]?Ft:r[0]?Ot:zt}let a=o(s),i=a(s);return{c(){e=A("button"),i.c(),this.h()},l(r){e=E(r,"BUTTON",{type:!0,class:!0});var u=P(e);i.l(u),u.forEach(_),this.h()},h(){c(e,"type","button"),c(e,"class",t=fe(s[5].class)+" svelte-19k2j29")},m(r,u){I(r,e,u),i.m(e,null),l||(n=T(e,"click",s[6]),l=!0)},p(r,[u]){a===(a=o(r))&&i?i.p(r,u):(i.d(1),i=a(r),i&&(i.c(),i.m(e,null))),u&32&&t!==(t=fe(r[5].class)+" svelte-19k2j29")&&c(e,"class",t)},i:y,o:y,d(r){r&&_(e),i.d(),l=!1,n()}}}function qt(s,e,t){const l=`${X}/assets/load.svg`,n=`${X}/assets/play.svg`,o=`${X}/assets/pause.svg`;let{playing:a}=e,{loading:i}=e;function r(u){Pe.call(this,s,u)}return s.$$set=u=>{t(5,e=se(se({},e),ne(u))),"playing"in u&&t(0,a=u.playing),"loading"in u&&t(1,i=u.loading)},e=ne(e),[a,i,l,n,o,e,r]}class Ge extends V{constructor(e){super(),G(this,e,qt,Bt,L,{playing:0,loading:1})}}function Ie(s){let e,t,l,n=!0,o=!1,a,i,r,u=Ae(s[16])+"",d,D,m,w,g,k,f,p,M;function S(){cancelAnimationFrame(a),e.paused||(a=rt(S),o=!0),s[24].call(e)}return k=new Ge({props:{playing:s[5],loading:s[6],class:`center hidable ${s[13]?"hide":""}`}}),k.$on("click",s[19]),{c(){e=A("video"),i=F(),r=A("span"),d=U(u),D=F(),m=A("input"),g=F(),$(k.$$.fragment),this.h()},l(h){e=E(h,"VIDEO",{tabindex:!0,poster:!0,src:!0,preload:!0,style:!0,class:!0}),P(e).forEach(_),i=B(h),r=E(h,"SPAN",{class:!0});var v=P(r);d=j(v,u),v.forEach(_),D=B(h),m=E(h,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0,style:!0}),g=B(h),x(k.$$.fragment,h),this.h()},h(){c(e,"tabindex","0"),c(e,"poster",s[1]),e.loop=s[4],Y(e.src,t=s[0])||c(e,"src",t),c(e,"preload","metadata"),c(e,"style",l=`aspect-ratio: ${s[2]} / ${s[3]}`),c(e,"class","svelte-18n7cnr"),s[8]===void 0&&tt(()=>s[25].call(e)),c(r,"class","hidable svelte-18n7cnr"),O(r,"hide",s[10]),c(m,"type","range"),c(m,"min",0),c(m,"max",s[8]),c(m,"step",.0166666),c(m,"class","hidable svelte-18n7cnr"),c(m,"style",w=`background-image: linear-gradient(90deg, var(--accent) ${s[14]}%, var(--background-2) ${s[14]}%);}`),O(m,"hide",s[13])},m(h,v){I(h,e,v),s[22](e),I(h,i,v),I(h,r,v),C(r,d),I(h,D,v),I(h,m,v),he(m,s[7]),I(h,g,v),ee(k,h,v),f=!0,p||(M=[T(e,"play",s[23]),T(e,"pause",s[23]),T(e,"timeupdate",S),T(e,"durationchange",s[25]),T(e,"waiting",s[26]),T(e,"playing",s[27]),T(e,"pause",s[28]),T(e,"ended",s[29]),T(e,"click",s[20]),T(e,"dblclick",st(nt(s[17]))),T(m,"change",s[30]),T(m,"input",s[30])],p=!0)},p(h,v){(!f||v[0]&2)&&c(e,"poster",h[1]),(!f||v[0]&16)&&(e.loop=h[4]),(!f||v[0]&1&&!Y(e.src,t=h[0]))&&c(e,"src",t),(!f||v[0]&12&&l!==(l=`aspect-ratio: ${h[2]} / ${h[3]}`))&&c(e,"style",l),v[0]&32768&&n!==(n=h[15])&&e[n?"pause":"play"](),!o&&v[0]&128&&!isNaN(h[7])&&(e.currentTime=h[7]),o=!1,(!f||v[0]&65536)&&u!==(u=Ae(h[16])+"")&&z(d,u),(!f||v[0]&1024)&&O(r,"hide",h[10]),(!f||v[0]&256)&&c(m,"max",h[8]),(!f||v[0]&16384&&w!==(w=`background-image: linear-gradient(90deg, var(--accent) ${h[14]}%, var(--background-2) ${h[14]}%);}`))&&c(m,"style",w),v[0]&128&&he(m,h[7]),(!f||v[0]&8192)&&O(m,"hide",h[13]);const W={};v[0]&32&&(W.playing=h[5]),v[0]&64&&(W.loading=h[6]),v[0]&8192&&(W.class=`center hidable ${h[13]?"hide":""}`),k.$set(W)},i(h){f||(R(k.$$.fragment,h),f=!0)},o(h){N(k.$$.fragment,h),f=!1},d(h){h&&(_(e),_(i),_(r),_(D),_(m),_(g)),s[22](null),te(k,h),p=!1,ue(M)}}}function Wt(s){let e,t,l,n,o,a=s[9]&&Ie(s);return{c(){e=A("div"),a&&a.c(),this.h()},l(i){e=E(i,"DIV",{class:!0,style:!0});var r=P(e);a&&a.l(r),r.forEach(_),this.h()},h(){c(e,"class",t="post-media player "+s[21].class+" svelte-18n7cnr"),q(e,"aspect-ratio",s[2]+"/"+s[3])},m(i,r){I(i,e,r),a&&a.m(e,null),s[31](e),l=!0,n||(o=T(e,"keydown",s[18]),n=!0)},p(i,r){i[9]?a?(a.p(i,r),r[0]&512&&R(a,1)):(a=Ie(i),a.c(),R(a,1),a.m(e,null)):a&&(ie(),N(a,1,1,()=>{a=null}),oe()),(!l||r[0]&2097152&&t!==(t="post-media player "+i[21].class+" svelte-18n7cnr"))&&c(e,"class",t),(!l||r[0]&12)&&q(e,"aspect-ratio",i[2]+"/"+i[3])},i(i){l||(R(a),l=!0)},o(i){N(a),l=!1},d(i){i&&_(e),a&&a.d(),s[31](null),n=!1,o()}}}const Te=5;function Ht(s,e,t){let l,n,o,a,{src:i}=e,{poster:r}=e,{width:u}=e,{height:d}=e,{loop:D}=e,m,w,g=!1,k=!1,f=0,p=0,M=!1,S=!1;const h=()=>{t(7,f=Math.max(0,f-Te))},v=()=>{t(7,f=Math.min(p,f+Te))},W=b=>{b.offsetX<b.target.clientWidth/2?h():v()},Ue=b=>{Me(b)||b.key==="k"?(b.preventDefault(),t(5,g=!g)):b.key==="ArrowLeft"||b.key==="j"?h():(b.key==="ArrowRight"||b.key==="l")&&v()},H=new IntersectionObserver(b=>{for(const Ye of b)Ye.isIntersecting?t(9,M=!0):w&&(t(5,g=!1),t(6,k=!1),w.addEventListener("error",()=>{t(9,M=!1)},{once:!0}),t(12,w.src="",w))},{rootMargin:"0px"}),je=()=>{t(5,g=!g),t(6,k=!0),t(10,S=g)},ze=()=>{t(10,S=!S)};xe(()=>H==null?void 0:H.observe(m)),et(()=>H==null?void 0:H.unobserve(m));function Oe(b){Z[b?"unshift":"push"](()=>{w=b,t(12,w)})}function Fe(){n=this.paused,t(15,n),t(5,g),t(9,M)}function Be(){f=this.currentTime,t(7,f)}function qe(){p=this.duration,t(8,p)}const We=()=>t(6,k=!0),He=()=>t(6,k=!1),Ke=()=>t(6,k=!1),Je=()=>{D||(t(6,k=!1),t(5,g=!1))};function Qe(){f=lt(this.value),t(7,f)}function Xe(b){Z[b?"unshift":"push"](()=>{m=b,t(11,m)})}return s.$$set=b=>{t(21,e=se(se({},e),ne(b))),"src"in b&&t(0,i=b.src),"poster"in b&&t(1,r=b.poster),"width"in b&&t(2,u=b.width),"height"in b&&t(3,d=b.height),"loop"in b&&t(4,D=b.loop)},s.$$.update=()=>{s.$$.dirty[0]&384&&t(16,l=p-f),s.$$.dirty[0]&544&&t(5,g=M&&g),s.$$.dirty[0]&32&&t(15,n=!g),s.$$.dirty[0]&384&&t(14,o=f/p*98+1),s.$$.dirty[0]&1120&&t(13,a=g&&!k&&S)},e=ne(e),[i,r,u,d,D,g,k,f,p,M,S,m,w,a,o,n,l,W,Ue,je,ze,e,Oe,Fe,Be,qe,We,He,Ke,Je,Qe,Xe]}class ps extends V{constructor(e){super(),G(this,e,Ht,Wt,L,{src:0,poster:1,width:2,height:3,loop:4},null,[-1,-1])}}function Kt(s){let e,t,l,n,o,a,i,r,u,d,D,m;function w(f){s[13](f)}function g(f){s[14](f)}let k={class:"center"};return s[2]!==void 0&&(k.playing=s[2]),s[3]!==void 0&&(k.loading=s[3]),i=new Ge({props:k}),Z.push(()=>ge(i,"playing",w)),Z.push(()=>ge(i,"loading",g)),i.$on("click",s[15]),{c(){e=A("div"),t=A("img"),a=F(),$(i.$$.fragment),this.h()},l(f){e=E(f,"DIV",{class:!0,style:!0});var p=P(e);t=E(p,"IMG",{class:!0,loading:!0,"data-src":!0,alt:!0,width:!0,height:!0,tabindex:!0}),a=B(p),x(i.$$.fragment,p),p.forEach(_),this.h()},h(){c(t,"class","post-media media-img svelte-158nmsy"),c(t,"loading","lazy"),c(t,"data-src",s[4]),c(t,"alt",l=s[0].id.toString()),c(t,"width",n=s[0].width),c(t,"height",o=s[0].height),c(t,"tabindex","0"),c(e,"class","container svelte-158nmsy"),q(e,"aspect-ratio",re(s[0].width,s[0].height))},m(f,p){I(f,e,p),C(e,t),s[9](t),C(e,a),ee(i,e,null),d=!0,D||(m=[T(t,"click",s[8]),T(t,"keydown",s[10]),T(t,"load",s[11]),T(t,"error",s[12],{once:!0}),Ce(Ve.call(null,t))],D=!0)},p(f,[p]){(!d||p&16)&&c(t,"data-src",f[4]),(!d||p&1&&l!==(l=f[0].id.toString()))&&c(t,"alt",l),(!d||p&1&&n!==(n=f[0].width))&&c(t,"width",n),(!d||p&1&&o!==(o=f[0].height))&&c(t,"height",o);const M={};!r&&p&4&&(r=!0,M.playing=f[2],_e(()=>r=!1)),!u&&p&8&&(u=!0,M.loading=f[3],_e(()=>u=!1)),i.$set(M),(!d||p&1)&&q(e,"aspect-ratio",re(f[0].width,f[0].height))},i(f){d||(R(i.$$.fragment,f),d=!0)},o(f){N(i.$$.fragment,f),d=!1},d(f){f&&_(e),s[9](null),te(i),D=!1,ue(m)}}}function Jt(s,e,t){let l,n,o,a,{post:i}=e,r,u=!1,d=!1;function D(S){Pe.call(this,s,S)}function m(S){Z[S?"unshift":"push"](()=>{r=S,t(1,r),t(2,u),t(6,n),t(5,o),t(7,l),t(0,i)})}const w=S=>{Re(S),Me(S)&&(S.preventDefault(),t(3,d=!0),t(2,u=!u))},g=()=>t(3,d=!1),k=S=>{t(3,d=!1),S.target.src=`${X}/assets/failed-to-load.svg`};function f(S){u=S,t(2,u)}function p(S){d=S,t(3,d)}const M=()=>{t(3,d=!0),t(2,u=!u)};return s.$$set=S=>{"post"in S&&t(0,i=S.post)},s.$$.update=()=>{s.$$.dirty&1&&t(7,l=Lt(i.file_url,i.sample_url,i.preview_url)),s.$$.dirty&128&&t(6,n=l.animated),s.$$.dirty&128&&t(5,o=l.static),s.$$.dirty&100&&t(4,a=u?n:o),s.$$.dirty&102&&r&&t(1,r.src=u?n:o,r)},[i,r,u,d,a,o,n,l,D,m,w,g,k,f,p,M]}class bs extends V{constructor(e){super(),G(this,e,Jt,Kt,L,{post:0})}}export{rs as C,us as E,bs as G,ms as I,hs as P,is as R,cs as S,ps as V,os as a,fs as b,Lt as c,Vt as d,ds as e,_s as g,gs as i};
