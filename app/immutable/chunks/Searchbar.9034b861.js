import{s as te,e as y,a as N,t as W,c as E,b as w,f as d,g as T,d as z,o as m,A as q,i as P,h as k,y as C,j as G,n as M,W as se,U as ue,I as J,V as he,E as me,C as ge,l as Q,q as pe}from"./scheduler.9ddb58b7.js";import{h as R,u as de}from"./await_block.bc50228e.js";import{e as X}from"./each.e59479a4.js";import{S as le,i as oe,f as _e,c as K,b as O,m as j,t as I,a as D,d as B,g as ne,e as ae}from"./index.ea5578de.js";import{b as be}from"./paths.04592056.js";import{M as ke}from"./ModifierSelect.a9a7b68c.js";import{L as ve}from"./LoadingAnimation.9c99af81.js";import{C as Se}from"./CodiconLink.92d647d7.js";import{f as Y,b as Z}from"./format-tag.9687384a.js";import{a as ye}from"./tags.49324235.js";function Ee(n){let e,o,r,s,l,t=Y(n[0].label)+"",a,i,c,v=Z(n[0].count)+"",_,S,b,V;return{c(){e=y("li"),o=y("i"),s=N(),l=y("span"),a=W(t),i=N(),c=y("span"),_=W(v),this.h()},l(p){e=E(p,"LI",{role:!0,tabindex:!0,title:!0,class:!0});var f=w(e);o=E(f,"I",{class:!0}),w(o).forEach(d),s=T(f),l=E(f,"SPAN",{class:!0});var g=w(l);a=z(g,t),g.forEach(d),i=T(f),c=E(f,"SPAN",{class:!0});var u=w(c);_=z(u,v),u.forEach(d),f.forEach(d),this.h()},h(){m(o,"class",r=n[0].type==="supertag"?"codicon codicon-star-full":"codicon codicon-tag"),m(l,"class","tag-name svelte-1d1xyf4"),m(c,"class","tag-count"),m(e,"role","button"),m(e,"tabindex","0"),m(e,"title",S=n[0].label),m(e,"class","svelte-1d1xyf4"),q(e,"selected",n[1])},m(p,f){P(p,e,f),k(e,o),k(e,s),k(e,l),k(l,a),k(e,i),k(e,c),k(c,_),b||(V=C(e,"click",n[3]),b=!0)},p(p,[f]){f&1&&r!==(r=p[0].type==="supertag"?"codicon codicon-star-full":"codicon codicon-tag")&&m(o,"class",r),f&1&&t!==(t=Y(p[0].label)+"")&&G(a,t),f&1&&v!==(v=Z(p[0].count)+"")&&G(_,v),f&1&&S!==(S=p[0].label)&&m(e,"title",S),f&2&&q(e,"selected",p[1])},i:M,o:M,d(p){p&&d(e),b=!1,V()}}}function we(n,e,o){const r=se();let{suggestion:s}=e,{selected:l=!1}=e;const t=()=>r("click",s);return n.$$set=a=>{"suggestion"in a&&o(0,s=a.suggestion),"selected"in a&&o(1,l=a.selected)},[s,l,r,t]}class Ie extends le{constructor(e){super(),oe(this,e,we,Ee,te,{suggestion:0,selected:1})}}function $(n,e,o){const r=n.slice();return r[21]=e[o],r[23]=o,r}function Ae(n){let e,o,r,s,l=n[24].message+"",t;return{c(){e=y("div"),o=y("i"),r=N(),s=y("span"),t=W(l),this.h()},l(a){e=E(a,"DIV",{class:!0});var i=w(e);o=E(i,"I",{class:!0}),w(o).forEach(d),r=T(i),s=E(i,"SPAN",{});var c=w(s);t=z(c,l),c.forEach(d),i.forEach(d),this.h()},h(){m(o,"class",ge("codicon codicon-error")+" svelte-1fnp487"),m(e,"class","suggestion-footer svelte-1fnp487")},m(a,i){P(a,e,i),k(e,o),k(e,r),k(e,s),k(s,t)},p(a,i){i&4&&l!==(l=a[24].message+"")&&G(t,l)},i:M,o:M,d(a){a&&d(e)}}}function De(n){let e=Array.isArray(n[20]),o,r,s,l=e&&x(n);return{c(){l&&l.c(),o=N(),r=y("div"),this.h()},l(t){l&&l.l(t),o=T(t),r=E(t,"DIV",{class:!0}),w(r).forEach(d),this.h()},h(){m(r,"class","suggestion-footer svelte-1fnp487")},m(t,a){l&&l.m(t,a),P(t,o,a),P(t,r,a),s=!0},p(t,a){a&4&&(e=Array.isArray(t[20])),e?l?(l.p(t,a),a&4&&I(l,1)):(l=x(t),l.c(),I(l,1),l.m(o.parentNode,o)):l&&(ne(),D(l,1,1,()=>{l=null}),ae())},i(t){s||(I(l),s=!0)},o(t){D(l),s=!1},d(t){t&&(d(o),d(r)),l&&l.d(t)}}}function x(n){let e,o,r=X(n[20]),s=[];for(let t=0;t<r.length;t+=1)s[t]=ee($(n,r,t));const l=t=>D(s[t],1,1,()=>{s[t]=null});return{c(){for(let t=0;t<s.length;t+=1)s[t].c();e=Q()},l(t){for(let a=0;a<s.length;a+=1)s[a].l(t);e=Q()},m(t,a){for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(t,a);P(t,e,a),o=!0},p(t,a){if(a&268){r=X(t[20]);let i;for(i=0;i<r.length;i+=1){const c=$(t,r,i);s[i]?(s[i].p(c,a),I(s[i],1)):(s[i]=ee(c),s[i].c(),I(s[i],1),s[i].m(e.parentNode,e))}for(ne(),i=r.length;i<s.length;i+=1)l(i);ae()}},i(t){if(!o){for(let a=0;a<r.length;a+=1)I(s[a]);o=!0}},o(t){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)D(s[a]);o=!1},d(t){t&&d(e),pe(s,t)}}}function ee(n){let e,o;function r(){return n[16](n[21])}return e=new Ie({props:{suggestion:n[21],selected:n[23]===n[3]}}),e.$on("click",r),{c(){K(e.$$.fragment)},l(s){O(e.$$.fragment,s)},m(s,l){j(e,s,l),o=!0},p(s,l){n=s;const t={};l&4&&(t.suggestion=n[21]),l&8&&(t.selected=n[23]===n[3]),e.$set(t)},i(s){o||(I(e.$$.fragment,s),o=!0)},o(s){D(e.$$.fragment,s),o=!1},d(s){B(e,s)}}}function Ce(n){let e,o,r;return o=new ve({}),{c(){e=y("div"),K(o.$$.fragment),this.h()},l(s){e=E(s,"DIV",{class:!0});var l=w(e);O(o.$$.fragment,l),l.forEach(d),this.h()},h(){m(e,"class","suggestion-footer svelte-1fnp487")},m(s,l){P(s,e,l),j(o,e,null),r=!0},p:M,i(s){r||(I(o.$$.fragment,s),r=!0)},o(s){D(o.$$.fragment,s),r=!1},d(s){s&&d(e),B(o)}}}function Ne(n){let e,o,r,s,l,t,a,i,c,v,_,S,b;function V(g){n[14](g)}let p={};n[4]!==void 0&&(p.modifier=n[4]),o=new ke({props:p}),ue.push(()=>_e(o,"modifier",V)),a=new Se({props:{title:"More information on tags.",href:be+"/help#search",icon:"codicon codicon-question"}});let f={ctx:n,current:null,token:null,hasCatch:!0,pending:Ce,then:De,catch:Ae,value:20,error:24,blocks:[,,,]};return R(v=n[2],f),{c(){e=y("div"),K(o.$$.fragment),s=N(),l=y("input"),t=N(),K(a.$$.fragment),i=N(),c=y("ol"),f.block.c(),this.h()},l(g){e=E(g,"DIV",{class:!0});var u=w(e);O(o.$$.fragment,u),s=T(u),l=E(u,"INPUT",{type:!0,name:!0,id:!0,placeholder:!0,autocomplete:!0,"aria-label":!0,class:!0}),t=T(u),O(a.$$.fragment,u),i=T(u),c=E(u,"OL",{class:!0});var A=w(c);f.block.l(A),A.forEach(d),u.forEach(d),this.h()},h(){m(l,"type","text"),m(l,"name","searchbar"),m(l,"id","searchbar"),m(l,"placeholder",n[0]),m(l,"autocomplete","off"),m(l,"aria-label","Search for tags."),m(l,"class","svelte-1fnp487"),m(c,"class","svelte-1fnp487"),q(c,"open",n[5]&&n[6]),m(e,"class","searchbar svelte-1fnp487"),q(e,"open",n[5]&&n[6])},m(g,u){P(g,e,u),j(o,e,null),k(e,s),k(e,l),J(l,n[1]),k(e,t),j(a,e,null),k(e,i),k(e,c),f.block.m(c,f.anchor=null),f.mount=()=>c,f.anchor=null,_=!0,S||(b=[C(l,"input",n[15]),C(l,"focus",n[11]),C(l,"blur",n[10]),C(l,"keydown",n[12]),C(l,"keyup",n[7]),C(e,"blur",n[9])],S=!0)},p(g,[u]){n=g;const A={};!r&&u&16&&(r=!0,A.modifier=n[4],he(()=>r=!1)),o.$set(A),(!_||u&1)&&m(l,"placeholder",n[0]),u&2&&l.value!==n[1]&&J(l,n[1]),f.ctx=n,u&4&&v!==(v=n[2])&&R(v,f)||de(f,n,u),(!_||u&96)&&q(c,"open",n[5]&&n[6]),(!_||u&96)&&q(e,"open",n[5]&&n[6])},i(g){_||(I(o.$$.fragment,g),I(a.$$.fragment,g),I(f.block),_=!0)},o(g){D(o.$$.fragment,g),D(a.$$.fragment,g);for(let u=0;u<3;u+=1){const A=f.blocks[u];D(A)}_=!1},d(g){g&&d(e),B(o),B(a),f.block.d(),f.token=null,f=null,S=!1,me(b)}}}function Te(n,e,o){const r=se();let{placeholder:s}=e,{fetchSuggestions:l}=e,t="",a="",i,c=0,v="+",_=!1,S=!1,b=[];const V=()=>{t!==""&&t!==a&&(o(3,c=0),a=t,o(6,S=!0),o(2,i=l(t)),i.then(h=>b=h).catch(()=>b=[]))},p=h=>{r("pick",{modifier:v,...h}),o(1,t=""),o(3,c=0),o(6,S=!1)},f=()=>{o(5,_=!1)},g=h=>{(!h.relatedTarget||!h.target.parentNode.contains(h.relatedTarget))&&o(5,_=!1)},u=h=>{o(5,_=!0),h.target.scrollIntoView({block:"center",behavior:"smooth"})},A=async h=>{if(!h.ctrlKey&&h.key==="Enter"&&t!=="")if(b.length>c)p(b[c]);else{const H=t.split(";").map(U=>U.trim().replaceAll(" ","_")),fe=await Promise.all(H.map(ye));H.map(U=>{const L=fe.find(F=>(F==null?void 0:F.name)===U);return{type:(L==null?void 0:L.type)??"tag",label:U,count:(L==null?void 0:L.count)??0}}).forEach(p)}else h.code==="Escape"?h.target.blur():h.code==="ArrowUp"&&b.length>0?o(3,c=(c+b.length-1)%b.length):h.code==="ArrowDown"&&b.length>0&&o(3,c=(c+1)%b.length)};function re(h){v=h,o(4,v)}function ie(){t=this.value,o(1,t)}const ce=h=>p(h);return n.$$set=h=>{"placeholder"in h&&o(0,s=h.placeholder),"fetchSuggestions"in h&&o(13,l=h.fetchSuggestions)},[s,t,i,c,v,_,S,V,p,f,g,u,A,l,re,ie,ce]}class Fe extends le{constructor(e){super(),oe(this,e,Te,Ne,te,{placeholder:0,fetchSuggestions:13})}}export{Fe as S};
