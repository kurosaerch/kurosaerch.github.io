import{s as R,f as E,l as U,a as F,g as A,h as M,m as j,d as _,c as B,j as c,i as D,u as C,n as z,v,e as J,y as Ye,I as Te,D as Ze,z as O,H as P,R as De,J as ce,r as ue,V as te,W as se,O as Pe,K as X,k as oe,o as $e,M as xe,Q as et,G as fe,L as tt,N as st,p as Y,P as nt,E as he}from"./scheduler.dde44db2.js";import{h as _e,u as lt}from"./await_block.7e2093da.js";import{e as ne}from"./each.e59479a4.js";import{S as V,i as G,a as N,t as L,g as ae,c as re,b as Z,d as $,m as x,e as ee,r as at,f as de}from"./index.06d635fc.js";import{g as ge}from"./comments.7340f7b2.js";import{L as rt}from"./LoadingAnimation.d49ba910.js";import{f as me}from"./format-tag.7e313273.js";import{i as it}from"./tags.49324235.js";import{a as ie}from"./active-tags-store.6065be3c.js";import{S as ot}from"./SimpleTag.e684c51d.js";import{b as Q}from"./paths.d18fab71.js";import{c as Ce,h as ct,b as Me}from"./always-loop-store.a63e82dc.js";const pe=6e4,le=s=>{if(!ut(s))throw new TypeError("Invalid createdAt passed to formatCreatedAt");const e=new Date(s).getTime()/pe,l=new Date().getTime()/pe-e;if(l<1)return"Just now";if(l<60)return H(l,"minute");const n=l/60;if(n<24)return H(n,"hour");const o=n/24;if(o<7)return H(o,"day");if(o<30.5)return H(o/7,"week");if(o<365.25)return H(o/30.5,"month");const a=o/365.25;return H(a,"year")},ut=s=>(typeof s=="number"||typeof s=="string")&&new Date(s).toString()!=="Invalid Date",H=(s,e)=>{const t=s.toFixed();return`${t} ${e}${t==="1"?"":"s"} ago`};function ft(s){let e,t,l=s[0].author+"",n,o,a,i=le(s[0].createdAt)+"",r,u,f,S=s[0].content+"",g;return{c(){e=E("div"),t=E("span"),n=U(l),o=F(),a=E("span"),r=U(i),u=F(),f=E("span"),g=U(S),this.h()},l(w){e=A(w,"DIV",{class:!0});var m=M(e);t=A(m,"SPAN",{class:!0});var I=M(t);n=j(I,l),I.forEach(_),o=B(m),a=A(m,"SPAN",{class:!0});var p=M(a);r=j(p,i),p.forEach(_),u=B(m),f=A(m,"SPAN",{class:!0});var d=M(f);g=j(d,S),d.forEach(_),m.forEach(_),this.h()},h(){c(t,"class","author svelte-bys59y"),c(a,"class","created-at svelte-bys59y"),c(f,"class","content svelte-bys59y"),c(e,"class","svelte-bys59y")},m(w,m){D(w,e,m),C(e,t),C(t,n),C(e,o),C(e,a),C(a,r),C(e,u),C(e,f),C(f,g)},p(w,[m]){m&1&&l!==(l=w[0].author+"")&&z(n,l),m&1&&i!==(i=le(w[0].createdAt)+"")&&z(r,i),m&1&&S!==(S=w[0].content+"")&&z(g,S)},i:v,o:v,d(w){w&&_(e)}}}function ht(s,e,t){let{comment:l}=e;return s.$$set=n=>{"comment"in n&&t(0,l=n.comment)},[l]}class _t extends V{constructor(e){super(),G(this,e,ht,ft,R,{comment:0})}}function be(s,e,t){const l=s.slice();return l[2]=e[t],l}function dt(s){return{c:v,l:v,m:v,p:v,i:v,o:v,d:v}}function gt(s){let e,t,l,n;const o=[pt,mt],a=[];function i(r,u){return r[1].length>0?0:1}return e=i(s),t=a[e]=o[e](s),{c(){t.c(),l=J()},l(r){t.l(r),l=J()},m(r,u){a[e].m(r,u),D(r,l,u),n=!0},p(r,u){let f=e;e=i(r),e===f?a[e].p(r,u):(ae(),L(a[f],1,1,()=>{a[f]=null}),re(),t=a[e],t?t.p(r,u):(t=a[e]=o[e](r),t.c()),N(t,1),t.m(l.parentNode,l))},i(r){n||(N(t),n=!0)},o(r){L(t),n=!1},d(r){r&&_(l),a[e].d(r)}}}function mt(s){let e,t="Comments for this post are not available. <br/>This can happen if comments have been deleted.";return{c(){e=E("p"),e.innerHTML=t,this.h()},l(l){e=A(l,"P",{class:!0,"data-svelte-h":!0}),Ye(e)!=="svelte-1f9q9vq"&&(e.innerHTML=t),this.h()},h(){c(e,"class","no-comments svelte-x6zn2h")},m(l,n){D(l,e,n)},p:v,i:v,o:v,d(l){l&&_(e)}}}function pt(s){let e,t,l=ne(s[1]),n=[];for(let a=0;a<l.length;a+=1)n[a]=ye(be(s,l,a));const o=a=>L(n[a],1,1,()=>{n[a]=null});return{c(){e=E("ul");for(let a=0;a<n.length;a+=1)n[a].c();this.h()},l(a){e=A(a,"UL",{class:!0});var i=M(e);for(let r=0;r<n.length;r+=1)n[r].l(i);i.forEach(_),this.h()},h(){c(e,"class","comments svelte-x6zn2h")},m(a,i){D(a,e,i);for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(e,null);t=!0},p(a,i){if(i&1){l=ne(a[1]);let r;for(r=0;r<l.length;r+=1){const u=be(a,l,r);n[r]?(n[r].p(u,i),N(n[r],1)):(n[r]=ye(u),n[r].c(),N(n[r],1),n[r].m(e,null))}for(ae(),r=l.length;r<n.length;r+=1)o(r);re()}},i(a){if(!t){for(let i=0;i<l.length;i+=1)N(n[i]);t=!0}},o(a){n=n.filter(Boolean);for(let i=0;i<n.length;i+=1)L(n[i]);t=!1},d(a){a&&_(e),Te(n,a)}}}function ye(s){let e,t;return e=new _t({props:{comment:s[2]}}),{c(){Z(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,n){x(e,l,n),t=!0},p(l,n){const o={};n&1&&(o.comment=l[2]),e.$set(o)},i(l){t||(N(e.$$.fragment,l),t=!0)},o(l){L(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function bt(s){let e,t;return e=new rt({}),{c(){Z(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,n){x(e,l,n),t=!0},p:v,i(l){t||(N(e.$$.fragment,l),t=!0)},o(l){L(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function yt(s){let e,t,l,n={ctx:s,current:null,token:null,hasCatch:!1,pending:bt,then:gt,catch:dt,value:1,blocks:[,,,]};return _e(t=ge(s[0].id),n),{c(){e=J(),n.block.c()},l(o){e=J(),n.block.l(o)},m(o,a){D(o,e,a),n.block.m(o,n.anchor=a),n.mount=()=>e.parentNode,n.anchor=e,l=!0},p(o,[a]){s=o,n.ctx=s,a&1&&t!==(t=ge(s[0].id))&&_e(t,n)||lt(n,s,a)},i(o){l||(N(n.block),l=!0)},o(o){for(let a=0;a<3;a+=1){const i=n.blocks[a];L(i)}l=!1},d(o){o&&_(e),n.block.d(o),n.token=null,n=null}}}function vt(s,e,t){let{post:l}=e;return s.$$set=n=>{"post"in n&&t(0,l=n.post)},[l]}class ls extends V{constructor(e){super(),G(this,e,vt,yt,R,{post:0})}}function kt(s){let e,t=s[0].charAt(0).toUpperCase()+"",l,n;return{c(){e=E("span"),l=U(t),this.h()},l(o){e=A(o,"SPAN",{title:!0,class:!0});var a=M(e);l=j(a,t),a.forEach(_),this.h()},h(){c(e,"title",n="Rated "+s[0]+"."),c(e,"class","svelte-1nbj6kf")},m(o,a){D(o,e,a),C(e,l)},p(o,[a]){a&1&&t!==(t=o[0].charAt(0).toUpperCase()+"")&&z(l,t),a&1&&n!==(n="Rated "+o[0]+".")&&c(e,"title",n)},i:v,o:v,d(o){o&&_(e)}}}function wt(s,e,t){let{value:l}=e;return s.$$set=n=>{"value"in n&&t(0,l=n.value)},[l]}class as extends V{constructor(e){super(),G(this,e,wt,kt,R,{value:0})}}function St(s){let e,t=le(s[0])+"",l;return{c(){e=E("span"),l=U(t),this.h()},l(n){e=A(n,"SPAN",{class:!0});var o=M(e);l=j(o,t),o.forEach(_),this.h()},h(){c(e,"class","svelte-1vqihm9")},m(n,o){D(n,e,o),C(e,l)},p(n,[o]){o&1&&t!==(t=le(n[0])+"")&&z(l,t)},i:v,o:v,d(n){n&&_(e)}}}function Et(s,e,t){let{value:l}=e;return s.$$set=n=>{"value"in n&&t(0,l=n.value)},[l]}class rs extends V{constructor(e){super(),G(this,e,Et,St,R,{value:0})}}function At(s){let e,t=me(s[0])+"",l;return{c(){e=E("span"),l=U(t),this.h()},l(n){e=A(n,"SPAN",{"data-testid":!0,class:!0});var o=M(e);l=j(o,t),o.forEach(_),this.h()},h(){c(e,"data-testid","score"),c(e,"class","codicon codicon-heart svelte-te86f3")},m(n,o){D(n,e,o),C(e,l)},p(n,[o]){o&1&&t!==(t=me(n[0])+"")&&z(l,t)},i:v,o:v,d(n){n&&_(e)}}}function It(s,e,t){let{value:l}=e;return s.$$set=n=>{"value"in n&&t(0,l=n.value)},[l]}class is extends V{constructor(e){super(),G(this,e,It,At,R,{value:0})}}function ve(s){let e,t,l,n,o;return{c(){e=E("a"),t=E("i"),l=F(),n=U(s[1]),this.h()},l(a){e=A(a,"A",{href:!0,target:!0,class:!0});var i=M(e);t=A(i,"I",{class:!0}),M(t).forEach(_),l=B(i),n=j(i,s[1]),i.forEach(_),this.h()},h(){c(t,"class","codicon codicon-link"),c(e,"href",o=s[0].toString()),c(e,"target","_newtab"),c(e,"class","svelte-1orztco")},m(a,i){D(a,e,i),C(e,t),C(e,l),C(e,n)},p(a,i){i&2&&z(n,a[1]),i&1&&o!==(o=a[0].toString())&&c(e,"href",o)},d(a){a&&_(e)}}}function Tt(s){let e,t=s[0]&&ve(s);return{c(){t&&t.c(),e=J()},l(l){t&&t.l(l),e=J()},m(l,n){t&&t.m(l,n),D(l,e,n)},p(l,[n]){l[0]?t?t.p(l,n):(t=ve(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:v,o:v,d(l){l&&_(e),t&&t.d(l)}}}function Dt(s,e,t){let l,n,{source:o}=e;return s.$$set=a=>{"source"in a&&t(2,o=a.source)},s.$$.update=()=>{var a;s.$$.dirty&4&&t(0,l=it(o)?new URL(o):null),s.$$.dirty&1&&t(1,n=(a=l==null?void 0:l.hostname)==null?void 0:a.replace(/^www./,""))},[l,n,o]}class os extends V{constructor(e){super(),G(this,e,Dt,Tt,R,{source:2})}}function Pt(s){let e,t,l;return{c(){e=E("a"),t=E("i"),l=U(" File"),this.h()},l(n){e=A(n,"A",{href:!0,target:!0,class:!0});var o=M(e);t=A(o,"I",{class:!0}),M(t).forEach(_),l=j(o," File"),o.forEach(_),this.h()},h(){c(t,"class","codicon codicon-file"),c(e,"href",s[0]),c(e,"target","_newtab"),c(e,"class","svelte-1orztco")},m(n,o){D(n,e,o),C(e,t),C(e,l)},p(n,[o]){o&1&&c(e,"href",n[0])},i:v,o:v,d(n){n&&_(e)}}}function Ct(s,e,t){let{url:l}=e;return s.$$set=n=>{"url"in n&&t(0,l=n.url)},[l]}class cs extends V{constructor(e){super(),G(this,e,Ct,Pt,R,{url:0})}}function ke(s,e,t){const l=s.slice();l[4]=e[t];const n=l[1].find(function(...a){return s[3](l[4],...a)})!==void 0;return l[5]=n,l}function we(s){let e,t;function l(){return s[2](s[5],s[4])}return e=new ot({props:{tag:s[4],active:s[5]}}),e.$on("click",l),{c(){Z(e.$$.fragment)},l(n){$(e.$$.fragment,n)},m(n,o){x(e,n,o),t=!0},p(n,o){s=n;const a={};o&1&&(a.tag=s[4]),o&3&&(a.active=s[5]),e.$set(a)},i(n){t||(N(e.$$.fragment,n),t=!0)},o(n){L(e.$$.fragment,n),t=!1},d(n){ee(e,n)}}}function Mt(s){let e,t,l=ne(s[0]),n=[];for(let a=0;a<l.length;a+=1)n[a]=we(ke(s,l,a));const o=a=>L(n[a],1,1,()=>{n[a]=null});return{c(){e=E("ul");for(let a=0;a<n.length;a+=1)n[a].c();this.h()},l(a){e=A(a,"UL",{class:!0});var i=M(e);for(let r=0;r<n.length;r+=1)n[r].l(i);i.forEach(_),this.h()},h(){c(e,"class","tags svelte-b5q4us")},m(a,i){D(a,e,i);for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(e,null);t=!0},p(a,[i]){if(i&3){l=ne(a[0]);let r;for(r=0;r<l.length;r+=1){const u=ke(a,l,r);n[r]?(n[r].p(u,i),N(n[r],1)):(n[r]=we(u),n[r].c(),N(n[r],1),n[r].m(e,null))}for(ae(),r=l.length;r<n.length;r+=1)o(r);re()}},i(a){if(!t){for(let i=0;i<l.length;i+=1)N(n[i]);t=!0}},o(a){n=n.filter(Boolean);for(let i=0;i<n.length;i+=1)L(n[i]);t=!1},d(a){a&&_(e),Te(n,a)}}}function Nt(s,e,t){let l;Ze(s,ie,i=>t(1,l=i));let{tags:n}=e;const o=(i,r)=>i?ie.removeByName(r.name):ie.addOrReplace({...r,modifier:"+"}),a=(i,r)=>r.name===i.name;return s.$$set=i=>{"tags"in i&&t(0,n=i.tags)},[n,l,o,a]}class us extends V{constructor(e){super(),G(this,e,Nt,Mt,R,{tags:0})}}const Ne=s=>s.endsWith(".gif"),Lt=(s,e,t)=>Ne(e)?{static:t,animated:e}:{static:e,animated:s},Le=s=>s.endsWith(".mp4")||s.endsWith(".webm"),fs=(s,e,t)=>Le(e)?{static:t,animated:e}:{static:e,animated:s},hs=s=>s.some(e=>e.name==="loop"),_s=s=>Ne(s)||Le(s),Rt="1250px",K=new IntersectionObserver(s=>{var e;for(const t of s){const l=t.isIntersecting?t.target.getAttribute("data-src")??"":"";(e=t==null?void 0:t.target)==null||e.setAttribute("src",l)}},{rootMargin:Rt}),Re=s=>(K==null||K.observe(s),{destroy(){K==null||K.unobserve(s)}});function Vt(s){let e,t,l,n,o,a,i,r;return{c(){e=E("div"),t=E("img"),this.h()},l(u){e=A(u,"DIV",{class:!0});var f=M(e);t=A(f,"IMG",{class:!0,loading:!0,"data-src":!0,alt:!0,style:!0,width:!0,height:!0,tabindex:!0}),f.forEach(_),this.h()},h(){c(t,"class","post-media svelte-jjbbut"),c(t,"loading","lazy"),c(t,"data-src",s[2]),c(t,"alt",l=s[0].id.toString()),c(t,"style",n=`aspect-ratio: ${s[0].width} / ${s[0].height}`),c(t,"width",o=s[0].width),c(t,"height",a=s[0].height),c(t,"tabindex","0"),c(e,"class","svelte-jjbbut"),O(e,"expandable",s[3]),O(e,"open",s[1])},m(u,f){D(u,e,f),C(e,t),i||(r=[P(t,"click",s[4]),P(t,"keydown",Ce),P(t,"error",s[5],{once:!0}),De(Re.call(null,t))],i=!0)},p(u,[f]){f&4&&c(t,"data-src",u[2]),f&1&&l!==(l=u[0].id.toString())&&c(t,"alt",l),f&1&&n!==(n=`aspect-ratio: ${u[0].width} / ${u[0].height}`)&&c(t,"style",n),f&1&&o!==(o=u[0].width)&&c(t,"width",o),f&1&&a!==(a=u[0].height)&&c(t,"height",a),f&2&&O(e,"open",u[1])},i:v,o:v,d(u){u&&_(e),i=!1,ce(r)}}}function Gt(s,e,t){let l,{post:n}=e;const a=n.width/n.height<.33;let i;const r=()=>t(1,i=!i),u=f=>f.target.src=`${Q}/assets/failed-to-load.svg`;return s.$$set=f=>{"post"in f&&t(0,n=f.post)},s.$$.update=()=>{s.$$.dirty&1&&t(2,l=ct?n.file_url:n.sample_url)},[n,i,l,a,r,u]}class ds extends V{constructor(e){super(),G(this,e,Gt,Vt,R,{post:0})}}const Se=s=>{if(typeof s!="number")throw new TypeError(`Attempted to call formatVideoTime with invalid value: ${s}`);const e=Math.floor(s),t=e%60,l=Math.floor(e/60);return`${Ee(l)}:${Ee(t)}`},Ee=s=>{const e=String(s),t=Math.max(0,2-e.length);return`${"0".repeat(t)}${e}`};function Ut(s){let e,t;return{c(){e=E("img"),this.h()},l(l){e=A(l,"IMG",{src:!0,alt:!0,width:!0,height:!0,style:!0}),this.h()},h(){X(e.src,t=s[3])||c(e,"src",t),c(e,"alt","Start GIF"),c(e,"width","16"),c(e,"height","32"),oe(e,"margin-left","4px")},m(l,n){D(l,e,n)},p:v,d(l){l&&_(e)}}}function jt(s){let e,t;return{c(){e=E("img"),this.h()},l(l){e=A(l,"IMG",{src:!0,alt:!0,width:!0,height:!0}),this.h()},h(){X(e.src,t=s[4])||c(e,"src",t),c(e,"alt","Stop GIF"),c(e,"width","16"),c(e,"height","32")},m(l,n){D(l,e,n)},p:v,d(l){l&&_(e)}}}function zt(s){let e,t;return{c(){e=E("img"),this.h()},l(l){e=A(l,"IMG",{src:!0,alt:!0,width:!0,height:!0}),this.h()},h(){X(e.src,t=s[2])||c(e,"src",t),c(e,"alt","Loading GIF"),c(e,"width","16"),c(e,"height","32")},m(l,n){D(l,e,n)},p:v,d(l){l&&_(e)}}}function Ot(s){let e,t,l,n;function o(r,u){return r[1]?zt:r[0]?jt:Ut}let a=o(s),i=a(s);return{c(){e=E("button"),i.c(),this.h()},l(r){e=A(r,"BUTTON",{type:!0,class:!0});var u=M(e);i.l(u),u.forEach(_),this.h()},h(){c(e,"type","button"),c(e,"class",t=ue(s[5].class)+" svelte-19k2j29")},m(r,u){D(r,e,u),i.m(e,null),l||(n=P(e,"click",s[6]),l=!0)},p(r,[u]){a===(a=o(r))&&i?i.p(r,u):(i.d(1),i=a(r),i&&(i.c(),i.m(e,null))),u&32&&t!==(t=ue(r[5].class)+" svelte-19k2j29")&&c(e,"class",t)},i:v,o:v,d(r){r&&_(e),i.d(),l=!1,n()}}}function Ft(s,e,t){const l=`${Q}/assets/load.svg`,n=`${Q}/assets/play.svg`,o=`${Q}/assets/pause.svg`;let{playing:a}=e,{loading:i}=e;function r(u){Pe.call(this,s,u)}return s.$$set=u=>{t(5,e=te(te({},e),se(u))),"playing"in u&&t(0,a=u.playing),"loading"in u&&t(1,i=u.loading)},e=se(e),[a,i,l,n,o,e,r]}class Ve extends V{constructor(e){super(),G(this,e,Ft,Ot,R,{playing:0,loading:1})}}function Ae(s){let e,t,l,n=!0,o=!1,a,i,r,u=Se(s[16])+"",f,S,g,w,m,I,p,d,T;function b(){cancelAnimationFrame(a),e.paused||(a=at(b),o=!0),s[24].call(e)}return I=new Ve({props:{playing:s[5],loading:s[6],class:`center hidable ${s[13]?"hide":""}`}}),I.$on("click",s[19]),{c(){e=E("video"),i=F(),r=E("span"),f=U(u),S=F(),g=E("input"),m=F(),Z(I.$$.fragment),this.h()},l(h){e=A(h,"VIDEO",{tabindex:!0,poster:!0,src:!0,preload:!0,style:!0,class:!0}),M(e).forEach(_),i=B(h),r=A(h,"SPAN",{class:!0});var k=M(r);f=j(k,u),k.forEach(_),S=B(h),g=A(h,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0,style:!0}),m=B(h),$(I.$$.fragment,h),this.h()},h(){c(e,"tabindex","0"),c(e,"poster",s[1]),e.loop=s[4],X(e.src,t=s[0])||c(e,"src",t),c(e,"preload","metadata"),c(e,"style",l=`aspect-ratio: ${s[2]} / ${s[3]}`),c(e,"class","svelte-18n7cnr"),s[8]===void 0&&et(()=>s[25].call(e)),c(r,"class","hidable svelte-18n7cnr"),O(r,"hide",s[10]),c(g,"type","range"),c(g,"min",0),c(g,"max",s[8]),c(g,"step",.0166666),c(g,"class","hidable svelte-18n7cnr"),c(g,"style",w=`background-image: linear-gradient(90deg, var(--accent) ${s[14]}%, var(--background-2) ${s[14]}%);}`),O(g,"hide",s[13])},m(h,k){D(h,e,k),s[22](e),D(h,i,k),D(h,r,k),C(r,f),D(h,S,k),D(h,g,k),fe(g,s[7]),D(h,m,k),x(I,h,k),p=!0,d||(T=[P(e,"play",s[23]),P(e,"pause",s[23]),P(e,"timeupdate",b),P(e,"durationchange",s[25]),P(e,"waiting",s[26]),P(e,"playing",s[27]),P(e,"pause",s[28]),P(e,"ended",s[29]),P(e,"click",s[20]),P(e,"dblclick",tt(st(s[17]))),P(g,"change",s[30]),P(g,"input",s[30])],d=!0)},p(h,k){(!p||k[0]&2)&&c(e,"poster",h[1]),(!p||k[0]&16)&&(e.loop=h[4]),(!p||k[0]&1&&!X(e.src,t=h[0]))&&c(e,"src",t),(!p||k[0]&12&&l!==(l=`aspect-ratio: ${h[2]} / ${h[3]}`))&&c(e,"style",l),k[0]&32768&&n!==(n=h[15])&&e[n?"pause":"play"](),!o&&k[0]&128&&!isNaN(h[7])&&(e.currentTime=h[7]),o=!1,(!p||k[0]&65536)&&u!==(u=Se(h[16])+"")&&z(f,u),(!p||k[0]&1024)&&O(r,"hide",h[10]),(!p||k[0]&256)&&c(g,"max",h[8]),(!p||k[0]&16384&&w!==(w=`background-image: linear-gradient(90deg, var(--accent) ${h[14]}%, var(--background-2) ${h[14]}%);}`))&&c(g,"style",w),k[0]&128&&fe(g,h[7]),(!p||k[0]&8192)&&O(g,"hide",h[13]);const q={};k[0]&32&&(q.playing=h[5]),k[0]&64&&(q.loading=h[6]),k[0]&8192&&(q.class=`center hidable ${h[13]?"hide":""}`),I.$set(q)},i(h){p||(N(I.$$.fragment,h),p=!0)},o(h){L(I.$$.fragment,h),p=!1},d(h){h&&(_(e),_(i),_(r),_(S),_(g),_(m)),s[22](null),ee(I,h),d=!1,ce(T)}}}function Bt(s){let e,t,l,n,o,a=s[9]&&Ae(s);return{c(){e=E("div"),a&&a.c(),this.h()},l(i){e=A(i,"DIV",{class:!0,style:!0});var r=M(e);a&&a.l(r),r.forEach(_),this.h()},h(){c(e,"class",t="post-media player "+s[21].class+" svelte-18n7cnr"),oe(e,"aspect-ratio",s[2]+"/"+s[3])},m(i,r){D(i,e,r),a&&a.m(e,null),s[31](e),l=!0,n||(o=P(e,"keydown",s[18]),n=!0)},p(i,r){i[9]?a?(a.p(i,r),r[0]&512&&N(a,1)):(a=Ae(i),a.c(),N(a,1),a.m(e,null)):a&&(ae(),L(a,1,1,()=>{a=null}),re()),(!l||r[0]&2097152&&t!==(t="post-media player "+i[21].class+" svelte-18n7cnr"))&&c(e,"class",t),(!l||r[0]&12)&&oe(e,"aspect-ratio",i[2]+"/"+i[3])},i(i){l||(N(a),l=!0)},o(i){L(a),l=!1},d(i){i&&_(e),a&&a.d(),s[31](null),n=!1,o()}}}const Ie=5;function qt(s,e,t){let l,n,o,a,{src:i}=e,{poster:r}=e,{width:u}=e,{height:f}=e,{loop:S}=e,g,w,m=!1,I=!1,p=0,d=0,T=!1,b=!1;const h=()=>{t(7,p=Math.max(0,p-Ie))},k=()=>{t(7,p=Math.min(d,p+Ie))},q=y=>{y.offsetX<y.target.clientWidth/2?h():k()},Ge=y=>{Me(y)||y.key==="k"?(y.preventDefault(),t(5,m=!m)):y.key==="ArrowLeft"||y.key==="j"?h():(y.key==="ArrowRight"||y.key==="l")&&k()},W=new IntersectionObserver(y=>{for(const Xe of y)Xe.isIntersecting?t(9,T=!0):w&&(t(5,m=!1),t(6,I=!1),w.addEventListener("error",()=>{t(9,T=!1)},{once:!0}),t(12,w.src="",w))},{rootMargin:"0px"}),Ue=()=>{t(5,m=!m),t(6,I=!0),t(10,b=m)},je=()=>{t(10,b=!b)};$e(()=>W==null?void 0:W.observe(g)),xe(()=>W==null?void 0:W.unobserve(g));function ze(y){Y[y?"unshift":"push"](()=>{w=y,t(12,w)})}function Oe(){n=this.paused,t(15,n),t(5,m),t(9,T)}function Fe(){p=this.currentTime,t(7,p)}function Be(){d=this.duration,t(8,d)}const qe=()=>t(6,I=!0),We=()=>t(6,I=!1),He=()=>t(6,I=!1),Ke=()=>{S||(t(6,I=!1),t(5,m=!1))};function Je(){p=nt(this.value),t(7,p)}function Qe(y){Y[y?"unshift":"push"](()=>{g=y,t(11,g)})}return s.$$set=y=>{t(21,e=te(te({},e),se(y))),"src"in y&&t(0,i=y.src),"poster"in y&&t(1,r=y.poster),"width"in y&&t(2,u=y.width),"height"in y&&t(3,f=y.height),"loop"in y&&t(4,S=y.loop)},s.$$.update=()=>{s.$$.dirty[0]&384&&t(16,l=d-p),s.$$.dirty[0]&544&&t(5,m=T&&m),s.$$.dirty[0]&32&&t(15,n=!m),s.$$.dirty[0]&384&&t(14,o=p/d*98+1),s.$$.dirty[0]&1120&&t(13,a=m&&!I&&b)},e=se(e),[i,r,u,f,S,m,I,p,d,T,b,g,w,a,o,n,l,q,Ge,Ue,je,e,ze,Oe,Fe,Be,qe,We,He,Ke,Je,Qe]}class gs extends V{constructor(e){super(),G(this,e,qt,Bt,R,{src:0,poster:1,width:2,height:3,loop:4},null,[-1,-1])}}function Wt(s){let e,t,l,n,o,a,i,r,u,f,S,g,w;function m(d){s[13](d)}function I(d){s[14](d)}let p={class:"center"};return s[2]!==void 0&&(p.playing=s[2]),s[3]!==void 0&&(p.loading=s[3]),i=new Ve({props:p}),Y.push(()=>de(i,"playing",m)),Y.push(()=>de(i,"loading",I)),i.$on("click",s[15]),{c(){e=E("div"),t=E("img"),a=F(),Z(i.$$.fragment),this.h()},l(d){e=A(d,"DIV",{class:!0,style:!0});var T=M(e);t=A(T,"IMG",{class:!0,loading:!0,"data-src":!0,alt:!0,width:!0,height:!0,tabindex:!0}),a=B(T),$(i.$$.fragment,T),T.forEach(_),this.h()},h(){c(t,"class","post-media media-img svelte-158nmsy"),c(t,"loading","lazy"),c(t,"data-src",s[4]),c(t,"alt",l=s[0].id.toString()),c(t,"width",n=s[0].width),c(t,"height",o=s[0].height),c(t,"tabindex","0"),c(e,"class","container svelte-158nmsy"),c(e,"style",f=`aspect-ratio: ${s[0].width} / ${s[0].height}`)},m(d,T){D(d,e,T),C(e,t),s[9](t),C(e,a),x(i,e,null),S=!0,g||(w=[P(t,"click",s[8]),P(t,"keydown",s[10]),P(t,"load",s[11]),P(t,"error",s[12],{once:!0}),De(Re.call(null,t))],g=!0)},p(d,[T]){(!S||T&16)&&c(t,"data-src",d[4]),(!S||T&1&&l!==(l=d[0].id.toString()))&&c(t,"alt",l),(!S||T&1&&n!==(n=d[0].width))&&c(t,"width",n),(!S||T&1&&o!==(o=d[0].height))&&c(t,"height",o);const b={};!r&&T&4&&(r=!0,b.playing=d[2],he(()=>r=!1)),!u&&T&8&&(u=!0,b.loading=d[3],he(()=>u=!1)),i.$set(b),(!S||T&1&&f!==(f=`aspect-ratio: ${d[0].width} / ${d[0].height}`))&&c(e,"style",f)},i(d){S||(N(i.$$.fragment,d),S=!0)},o(d){L(i.$$.fragment,d),S=!1},d(d){d&&_(e),s[9](null),ee(i),g=!1,ce(w)}}}function Ht(s,e,t){let l,n,o,a,{post:i}=e,r,u=!1,f=!1;function S(b){Pe.call(this,s,b)}function g(b){Y[b?"unshift":"push"](()=>{r=b,t(1,r),t(2,u),t(6,n),t(5,o),t(7,l),t(0,i)})}const w=b=>{Ce(b),Me(b)&&(b.preventDefault(),t(3,f=!0),t(2,u=!u))},m=()=>t(3,f=!1),I=b=>{t(3,f=!1),b.target.src=`${Q}/assets/failed-to-load.svg`};function p(b){u=b,t(2,u)}function d(b){f=b,t(3,f)}const T=()=>{t(3,f=!0),t(2,u=!u)};return s.$$set=b=>{"post"in b&&t(0,i=b.post)},s.$$.update=()=>{s.$$.dirty&1&&t(7,l=Lt(i.file_url,i.sample_url,i.preview_url)),s.$$.dirty&128&&t(6,n=l.animated),s.$$.dirty&128&&t(5,o=l.static),s.$$.dirty&100&&t(4,a=u?n:o),s.$$.dirty&102&&r&&t(1,r.src=u?n:o,r)},[i,r,u,f,a,o,n,l,S,g,w,m,I,p,d,T]}class ms extends V{constructor(e){super(),G(this,e,Ht,Wt,R,{post:0})}}export{ls as C,os as E,ms as G,ds as I,us as P,as as R,is as S,gs as V,rs as a,cs as b,Lt as c,hs as d,fs as g,_s as i};
