import{v,s as M,f as E,l as q,a as z,g as I,h as C,m as U,d,c as B,j as c,i as T,u as D,n as F,e as Q,x as xe,G as Ce,y as et,k as j,B as O,J as P,T as Re,O as ie,L as oe,r as he,U as se,V as le,F as Y,o as tt,P as st,S as lt,I as _e,N as nt,Q as at,p as Z,R as rt,K as de}from"./scheduler.41e0bfa2.js";import{h as ge,u as it}from"./await_block.421e30a4.js";import{e as ne}from"./each.e59479a4.js";import{S as V,i as G,a as R,t as L,g as ce,c as ue,b as $,d as x,m as ee,e as te,f as me}from"./index.e3f19884.js";import{g as pe}from"./comments.7340f7b2.js";import{L as ot}from"./LoadingAnimation.99c029b8.js";import{f as be}from"./format-tag.7e313273.js";import{i as ct}from"./tags.49324235.js";import{a as fe}from"./active-tags-store.8f583d8c.js";import{S as ut}from"./SimpleTag.b389e3b7.js";import{b as X}from"./paths.d62ffb0b.js";import{h as ve,c as Ne,b as Le}from"./always-loop-store.06ca5387.js";const ft=typeof window<"u";let ht=ft?s=>requestAnimationFrame(s):v;const ye=6e4,ae=s=>{if(!_t(s))throw new TypeError("Invalid createdAt passed to formatCreatedAt");const e=new Date(s).getTime()/ye,n=new Date().getTime()/ye-e;if(n<1)return"Just now";if(n<60)return H(n,"minute");const l=n/60;if(l<24)return H(l,"hour");const o=l/24;if(o<7)return H(o,"day");if(o<30.5)return H(o/7,"week");if(o<365.25)return H(o/30.5,"month");const a=o/365.25;return H(a,"year")},_t=s=>(typeof s=="number"||typeof s=="string")&&new Date(s).toString()!=="Invalid Date",H=(s,e)=>{const t=s.toFixed();return`${t} ${e}${t==="1"?"":"s"} ago`};function dt(s){let e,t,n=s[0].author+"",l,o,a,i=ae(s[0].createdAt)+"",r,u,f,b=s[0].content+"",p;return{c(){e=E("div"),t=E("span"),l=q(n),o=z(),a=E("span"),r=q(i),u=z(),f=E("span"),p=q(b),this.h()},l(S){e=I(S,"DIV",{class:!0});var m=C(e);t=I(m,"SPAN",{class:!0});var w=C(t);l=U(w,n),w.forEach(d),o=B(m),a=I(m,"SPAN",{class:!0});var h=C(a);r=U(h,i),h.forEach(d),u=B(m),f=I(m,"SPAN",{class:!0});var y=C(f);p=U(y,b),y.forEach(d),m.forEach(d),this.h()},h(){c(t,"class","author svelte-bys59y"),c(a,"class","created-at svelte-bys59y"),c(f,"class","content svelte-bys59y"),c(e,"class","svelte-bys59y")},m(S,m){T(S,e,m),D(e,t),D(t,l),D(e,o),D(e,a),D(a,r),D(e,u),D(e,f),D(f,p)},p(S,[m]){m&1&&n!==(n=S[0].author+"")&&F(l,n),m&1&&i!==(i=ae(S[0].createdAt)+"")&&F(r,i),m&1&&b!==(b=S[0].content+"")&&F(p,b)},i:v,o:v,d(S){S&&d(e)}}}function gt(s,e,t){let{comment:n}=e;return s.$$set=l=>{"comment"in l&&t(0,n=l.comment)},[n]}class mt extends V{constructor(e){super(),G(this,e,gt,dt,M,{comment:0})}}function ke(s,e,t){const n=s.slice();return n[2]=e[t],n}function pt(s){return{c:v,l:v,m:v,p:v,i:v,o:v,d:v}}function bt(s){let e,t,n,l;const o=[yt,vt],a=[];function i(r,u){return r[1].length>0?0:1}return e=i(s),t=a[e]=o[e](s),{c(){t.c(),n=Q()},l(r){t.l(r),n=Q()},m(r,u){a[e].m(r,u),T(r,n,u),l=!0},p(r,u){let f=e;e=i(r),e===f?a[e].p(r,u):(ce(),L(a[f],1,1,()=>{a[f]=null}),ue(),t=a[e],t?t.p(r,u):(t=a[e]=o[e](r),t.c()),R(t,1),t.m(n.parentNode,n))},i(r){l||(R(t),l=!0)},o(r){L(t),l=!1},d(r){r&&d(n),a[e].d(r)}}}function vt(s){let e,t="Comments for this post are not available. <br/>This can happen if comments have been deleted.";return{c(){e=E("p"),e.innerHTML=t,this.h()},l(n){e=I(n,"P",{class:!0,"data-svelte-h":!0}),xe(e)!=="svelte-1f9q9vq"&&(e.innerHTML=t),this.h()},h(){c(e,"class","no-comments svelte-x6zn2h")},m(n,l){T(n,e,l)},p:v,i:v,o:v,d(n){n&&d(e)}}}function yt(s){let e,t,n=ne(s[1]),l=[];for(let a=0;a<n.length;a+=1)l[a]=we(ke(s,n,a));const o=a=>L(l[a],1,1,()=>{l[a]=null});return{c(){e=E("ul");for(let a=0;a<l.length;a+=1)l[a].c();this.h()},l(a){e=I(a,"UL",{class:!0});var i=C(e);for(let r=0;r<l.length;r+=1)l[r].l(i);i.forEach(d),this.h()},h(){c(e,"class","comments svelte-x6zn2h")},m(a,i){T(a,e,i);for(let r=0;r<l.length;r+=1)l[r]&&l[r].m(e,null);t=!0},p(a,i){if(i&1){n=ne(a[1]);let r;for(r=0;r<n.length;r+=1){const u=ke(a,n,r);l[r]?(l[r].p(u,i),R(l[r],1)):(l[r]=we(u),l[r].c(),R(l[r],1),l[r].m(e,null))}for(ce(),r=n.length;r<l.length;r+=1)o(r);ue()}},i(a){if(!t){for(let i=0;i<n.length;i+=1)R(l[i]);t=!0}},o(a){l=l.filter(Boolean);for(let i=0;i<l.length;i+=1)L(l[i]);t=!1},d(a){a&&d(e),Ce(l,a)}}}function we(s){let e,t;return e=new mt({props:{comment:s[2]}}),{c(){$(e.$$.fragment)},l(n){x(e.$$.fragment,n)},m(n,l){ee(e,n,l),t=!0},p(n,l){const o={};l&1&&(o.comment=n[2]),e.$set(o)},i(n){t||(R(e.$$.fragment,n),t=!0)},o(n){L(e.$$.fragment,n),t=!1},d(n){te(e,n)}}}function kt(s){let e,t;return e=new ot({}),{c(){$(e.$$.fragment)},l(n){x(e.$$.fragment,n)},m(n,l){ee(e,n,l),t=!0},p:v,i(n){t||(R(e.$$.fragment,n),t=!0)},o(n){L(e.$$.fragment,n),t=!1},d(n){te(e,n)}}}function wt(s){let e,t,n,l={ctx:s,current:null,token:null,hasCatch:!1,pending:kt,then:bt,catch:pt,value:1,blocks:[,,,]};return ge(t=pe(s[0].id),l),{c(){e=Q(),l.block.c()},l(o){e=Q(),l.block.l(o)},m(o,a){T(o,e,a),l.block.m(o,l.anchor=a),l.mount=()=>e.parentNode,l.anchor=e,n=!0},p(o,[a]){s=o,l.ctx=s,a&1&&t!==(t=pe(s[0].id))&&ge(t,l)||it(l,s,a)},i(o){n||(R(l.block),n=!0)},o(o){for(let a=0;a<3;a+=1){const i=l.blocks[a];L(i)}n=!1},d(o){o&&d(e),l.block.d(o),l.token=null,l=null}}}function St(s,e,t){let{post:n}=e;return s.$$set=l=>{"post"in l&&t(0,n=l.post)},[n]}class os extends V{constructor(e){super(),G(this,e,St,wt,M,{post:0})}}function At(s){let e,t=s[0].charAt(0).toUpperCase()+"",n,l;return{c(){e=E("span"),n=q(t),this.h()},l(o){e=I(o,"SPAN",{title:!0,class:!0});var a=C(e);n=U(a,t),a.forEach(d),this.h()},h(){c(e,"title",l="Rated "+s[0]+"."),c(e,"class","svelte-1nbj6kf")},m(o,a){T(o,e,a),D(e,n)},p(o,[a]){a&1&&t!==(t=o[0].charAt(0).toUpperCase()+"")&&F(n,t),a&1&&l!==(l="Rated "+o[0]+".")&&c(e,"title",l)},i:v,o:v,d(o){o&&d(e)}}}function Et(s,e,t){let{value:n}=e;return s.$$set=l=>{"value"in l&&t(0,n=l.value)},[n]}class cs extends V{constructor(e){super(),G(this,e,Et,At,M,{value:0})}}function It(s){let e,t=ae(s[0])+"",n;return{c(){e=E("span"),n=q(t),this.h()},l(l){e=I(l,"SPAN",{class:!0});var o=C(e);n=U(o,t),o.forEach(d),this.h()},h(){c(e,"class","svelte-1vqihm9")},m(l,o){T(l,e,o),D(e,n)},p(l,[o]){o&1&&t!==(t=ae(l[0])+"")&&F(n,t)},i:v,o:v,d(l){l&&d(e)}}}function Tt(s,e,t){let{value:n}=e;return s.$$set=l=>{"value"in l&&t(0,n=l.value)},[n]}class us extends V{constructor(e){super(),G(this,e,Tt,It,M,{value:0})}}function Pt(s){let e,t=be(s[0])+"",n;return{c(){e=E("span"),n=q(t),this.h()},l(l){e=I(l,"SPAN",{"data-testid":!0,class:!0});var o=C(e);n=U(o,t),o.forEach(d),this.h()},h(){c(e,"data-testid","score"),c(e,"class","codicon codicon-heart svelte-te86f3")},m(l,o){T(l,e,o),D(e,n)},p(l,[o]){o&1&&t!==(t=be(l[0])+"")&&F(n,t)},i:v,o:v,d(l){l&&d(e)}}}function Dt(s,e,t){let{value:n}=e;return s.$$set=l=>{"value"in l&&t(0,n=l.value)},[n]}class fs extends V{constructor(e){super(),G(this,e,Dt,Pt,M,{value:0})}}function Se(s){let e,t,n,l,o;return{c(){e=E("a"),t=E("i"),n=z(),l=q(s[1]),this.h()},l(a){e=I(a,"A",{href:!0,target:!0,class:!0});var i=C(e);t=I(i,"I",{class:!0}),C(t).forEach(d),n=B(i),l=U(i,s[1]),i.forEach(d),this.h()},h(){c(t,"class","codicon codicon-link"),c(e,"href",o=s[0].toString()),c(e,"target","_newtab"),c(e,"class","svelte-1orztco")},m(a,i){T(a,e,i),D(e,t),D(e,n),D(e,l)},p(a,i){i&2&&F(l,a[1]),i&1&&o!==(o=a[0].toString())&&c(e,"href",o)},d(a){a&&d(e)}}}function Ct(s){let e,t=s[0]&&Se(s);return{c(){t&&t.c(),e=Q()},l(n){t&&t.l(n),e=Q()},m(n,l){t&&t.m(n,l),T(n,e,l)},p(n,[l]){n[0]?t?t.p(n,l):(t=Se(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:v,o:v,d(n){n&&d(e),t&&t.d(n)}}}function Rt(s,e,t){let n,l,{source:o}=e;return s.$$set=a=>{"source"in a&&t(2,o=a.source)},s.$$.update=()=>{var a;s.$$.dirty&4&&t(0,n=ct(o)?new URL(o):null),s.$$.dirty&1&&t(1,l=(a=n==null?void 0:n.hostname)==null?void 0:a.replace(/^www./,""))},[n,l,o]}class hs extends V{constructor(e){super(),G(this,e,Rt,Ct,M,{source:2})}}function Nt(s){let e,t,n;return{c(){e=E("a"),t=E("i"),n=q(" File"),this.h()},l(l){e=I(l,"A",{href:!0,target:!0,class:!0});var o=C(e);t=I(o,"I",{class:!0}),C(t).forEach(d),n=U(o," File"),o.forEach(d),this.h()},h(){c(t,"class","codicon codicon-file"),c(e,"href",s[0]),c(e,"target","_newtab"),c(e,"class","svelte-1orztco")},m(l,o){T(l,e,o),D(e,t),D(e,n)},p(l,[o]){o&1&&c(e,"href",l[0])},i:v,o:v,d(l){l&&d(e)}}}function Lt(s,e,t){let{url:n}=e;return s.$$set=l=>{"url"in l&&t(0,n=l.url)},[n]}class _s extends V{constructor(e){super(),G(this,e,Lt,Nt,M,{url:0})}}function Ae(s,e,t){const n=s.slice();n[4]=e[t];const l=n[1].find(function(...a){return s[3](n[4],...a)})!==void 0;return n[5]=l,n}function Ee(s){let e,t;function n(){return s[2](s[5],s[4])}return e=new ut({props:{tag:s[4],active:s[5]}}),e.$on("click",n),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,o){ee(e,l,o),t=!0},p(l,o){s=l;const a={};o&1&&(a.tag=s[4]),o&3&&(a.active=s[5]),e.$set(a)},i(l){t||(R(e.$$.fragment,l),t=!0)},o(l){L(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function Mt(s){let e,t,n=ne(s[0]),l=[];for(let a=0;a<n.length;a+=1)l[a]=Ee(Ae(s,n,a));const o=a=>L(l[a],1,1,()=>{l[a]=null});return{c(){e=E("ul");for(let a=0;a<l.length;a+=1)l[a].c();this.h()},l(a){e=I(a,"UL",{class:!0});var i=C(e);for(let r=0;r<l.length;r+=1)l[r].l(i);i.forEach(d),this.h()},h(){c(e,"class","tags svelte-b5q4us")},m(a,i){T(a,e,i);for(let r=0;r<l.length;r+=1)l[r]&&l[r].m(e,null);t=!0},p(a,[i]){if(i&3){n=ne(a[0]);let r;for(r=0;r<n.length;r+=1){const u=Ae(a,n,r);l[r]?(l[r].p(u,i),R(l[r],1)):(l[r]=Ee(u),l[r].c(),R(l[r],1),l[r].m(e,null))}for(ce(),r=n.length;r<l.length;r+=1)o(r);ue()}},i(a){if(!t){for(let i=0;i<n.length;i+=1)R(l[i]);t=!0}},o(a){l=l.filter(Boolean);for(let i=0;i<l.length;i+=1)L(l[i]);t=!1},d(a){a&&d(e),Ce(l,a)}}}function Vt(s,e,t){let n;et(s,fe,i=>t(1,n=i));let{tags:l}=e;const o=(i,r)=>i?fe.removeByName(r.name):fe.addOrReplace({...r,modifier:"+"}),a=(i,r)=>r.name===i.name;return s.$$set=i=>{"tags"in i&&t(0,l=i.tags)},[l,n,o,a]}class ds extends V{constructor(e){super(),G(this,e,Vt,Mt,M,{tags:0})}}const Me=s=>s.endsWith(".gif"),Gt=(s,e,t)=>Me(e)?{static:t,animated:e}:{static:e,animated:s},Ve=s=>s.endsWith(".mp4")||s.endsWith(".webm"),gs=(s,e,t)=>Ve(e)?{static:t,animated:e}:{static:e,animated:s},ms=s=>s.some(e=>e.name==="loop"),ps=s=>Me(s)||Ve(s),Ie=s=>{if(typeof s!="number")throw new TypeError(`Attempted to call formatVideoTime with invalid value: ${s}`);const e=Math.floor(s),t=e%60,n=Math.floor(e/60);return`${Te(n)}:${Te(t)}`},Te=s=>{const e=String(s),t=Math.max(0,2-e.length);return`${"0".repeat(t)}${e}`},qt=(s,e)=>s&&e?s/e:1,re=(s,e)=>s&&e?`${s} / ${e}`:"1 / 1",Ut="1250px",J=new IntersectionObserver(s=>{var e;for(const t of s)if(t.isIntersecting){const n=t.target.getAttribute("data-src-lowres")??"",l=t.target.getAttribute("data-src-hires")??"";if(t.target.getAttribute("src")===l||((e=t==null?void 0:t.target)==null||e.setAttribute("src",n),l===""))return;const o=new Image;o.src=l,o.onload=()=>{t.target.setAttribute("src",o.src)}}},{rootMargin:Ut}),Ge=s=>(J==null||J.observe(s),{destroy(){J==null||J.unobserve(s)}});function Ft(s){let e,t,n,l,o,a,i,r,u;return{c(){e=E("div"),t=E("img"),this.h()},l(f){e=I(f,"DIV",{class:!0});var b=C(e);t=I(b,"IMG",{class:!0,loading:!0,"data-src-lowres":!0,"data-src-hires":!0,alt:!0,style:!0,width:!0,height:!0,tabindex:!0}),b.forEach(d),this.h()},h(){c(t,"class","post-media svelte-1gcqb6"),c(t,"loading","lazy"),c(t,"data-src-lowres",n=s[0].preview_url),c(t,"data-src-hires",l=ve?s[0].file_url:s[0].sample_url),c(t,"alt",o=s[0].id.toString()),j(t,"aspect-ratio",re(s[0].width,s[0].height)),c(t,"width",a=s[0].width),c(t,"height",i=s[0].height),c(t,"tabindex","0"),c(e,"class","svelte-1gcqb6"),O(e,"expandable",s[2]),O(e,"open",s[1])},m(f,b){T(f,e,b),D(e,t),r||(u=[P(t,"click",s[4]),P(t,"keydown",Ne),P(t,"error",s[5],{once:!0}),Re(Ge.call(null,t)),P(e,"click",s[3])],r=!0)},p(f,[b]){b&1&&n!==(n=f[0].preview_url)&&c(t,"data-src-lowres",n),b&1&&l!==(l=ve?f[0].file_url:f[0].sample_url)&&c(t,"data-src-hires",l),b&1&&o!==(o=f[0].id.toString())&&c(t,"alt",o),b&1&&j(t,"aspect-ratio",re(f[0].width,f[0].height)),b&1&&a!==(a=f[0].width)&&c(t,"width",a),b&1&&i!==(i=f[0].height)&&c(t,"height",i),b&2&&O(e,"open",f[1])},i:v,o:v,d(f){f&&d(e),r=!1,ie(u)}}}function Ot(s,e,t){let{post:n}=e,o=qt(n.width,n.height)<.33,a;function i(f){oe.call(this,s,f)}const r=()=>t(1,a=!a),u=f=>f.target.src=`${X}/assets/failed-to-load.svg`;return s.$$set=f=>{"post"in f&&t(0,n=f.post)},[n,a,o,i,r,u]}let bs=class extends V{constructor(e){super(),G(this,e,Ot,Ft,M,{post:0})}};function zt(s){let e,t;return{c(){e=E("img"),this.h()},l(n){e=I(n,"IMG",{src:!0,alt:!0,width:!0,height:!0,style:!0}),this.h()},h(){Y(e.src,t=s[3])||c(e,"src",t),c(e,"alt","Start GIF"),c(e,"width","16"),c(e,"height","32"),j(e,"margin-left","4px")},m(n,l){T(n,e,l)},p:v,d(n){n&&d(e)}}}function Bt(s){let e,t;return{c(){e=E("img"),this.h()},l(n){e=I(n,"IMG",{src:!0,alt:!0,width:!0,height:!0}),this.h()},h(){Y(e.src,t=s[4])||c(e,"src",t),c(e,"alt","Stop GIF"),c(e,"width","16"),c(e,"height","32")},m(n,l){T(n,e,l)},p:v,d(n){n&&d(e)}}}function jt(s){let e,t;return{c(){e=E("img"),this.h()},l(n){e=I(n,"IMG",{src:!0,alt:!0,width:!0,height:!0}),this.h()},h(){Y(e.src,t=s[2])||c(e,"src",t),c(e,"alt","Loading GIF"),c(e,"width","16"),c(e,"height","32")},m(n,l){T(n,e,l)},p:v,d(n){n&&d(e)}}}function Kt(s){let e,t,n,l;function o(r,u){return r[1]?jt:r[0]?Bt:zt}let a=o(s),i=a(s);return{c(){e=E("button"),i.c(),this.h()},l(r){e=I(r,"BUTTON",{type:!0,class:!0});var u=C(e);i.l(u),u.forEach(d),this.h()},h(){c(e,"type","button"),c(e,"class",t=he(s[5].class)+" svelte-19k2j29")},m(r,u){T(r,e,u),i.m(e,null),n||(l=P(e,"click",s[6]),n=!0)},p(r,[u]){a===(a=o(r))&&i?i.p(r,u):(i.d(1),i=a(r),i&&(i.c(),i.m(e,null))),u&32&&t!==(t=he(r[5].class)+" svelte-19k2j29")&&c(e,"class",t)},i:v,o:v,d(r){r&&d(e),i.d(),n=!1,l()}}}function Wt(s,e,t){const n=`${X}/assets/load.svg`,l=`${X}/assets/play.svg`,o=`${X}/assets/pause.svg`;let{playing:a}=e,{loading:i}=e;function r(u){oe.call(this,s,u)}return s.$$set=u=>{t(5,e=se(se({},e),le(u))),"playing"in u&&t(0,a=u.playing),"loading"in u&&t(1,i=u.loading)},e=le(e),[a,i,n,l,o,e,r]}class qe extends V{constructor(e){super(),G(this,e,Wt,Kt,M,{playing:0,loading:1})}}function Pe(s){let e,t,n,l=!0,o=!1,a,i,r,u=Ie(s[16])+"",f,b,p,S,m,w,h,y,N;function A(){cancelAnimationFrame(a),e.paused||(a=ht(A),o=!0),s[25].call(e)}return w=new qe({props:{playing:s[5],loading:s[6],class:`center hidable ${s[13]?"hide":""}`}}),w.$on("click",s[19]),{c(){e=E("video"),i=z(),r=E("span"),f=q(u),b=z(),p=E("input"),m=z(),$(w.$$.fragment),this.h()},l(_){e=I(_,"VIDEO",{tabindex:!0,poster:!0,src:!0,preload:!0,style:!0,class:!0}),C(e).forEach(d),i=B(_),r=I(_,"SPAN",{class:!0});var k=C(r);f=U(k,u),k.forEach(d),b=B(_),p=I(_,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0,style:!0}),m=B(_),x(w.$$.fragment,_),this.h()},h(){c(e,"tabindex","0"),c(e,"poster",s[1]),e.loop=s[4],Y(e.src,t=s[0])||c(e,"src",t),c(e,"preload","metadata"),c(e,"style",n=`aspect-ratio: ${s[2]} / ${s[3]}`),c(e,"class","svelte-5v7blo"),s[8]===void 0&&lt(()=>s[26].call(e)),c(r,"class","hidable svelte-5v7blo"),O(r,"hide",s[10]),c(p,"type","range"),c(p,"min",0),c(p,"max",s[8]),c(p,"step",.0166666),c(p,"class","hidable svelte-5v7blo"),c(p,"style",S=`background-image: linear-gradient(90deg, var(--accent) ${s[14]}%, var(--background-2) ${s[14]}%);}`),O(p,"hide",s[13])},m(_,k){T(_,e,k),s[23](e),T(_,i,k),T(_,r,k),D(r,f),T(_,b,k),T(_,p,k),_e(p,s[7]),T(_,m,k),ee(w,_,k),h=!0,y||(N=[P(e,"play",s[24]),P(e,"pause",s[24]),P(e,"timeupdate",A),P(e,"durationchange",s[26]),P(e,"waiting",s[27]),P(e,"playing",s[28]),P(e,"pause",s[29]),P(e,"ended",s[30]),P(e,"click",s[20]),P(e,"dblclick",nt(at(s[17]))),P(p,"change",s[31]),P(p,"input",s[31])],y=!0)},p(_,k){(!h||k[0]&2)&&c(e,"poster",_[1]),(!h||k[0]&16)&&(e.loop=_[4]),(!h||k[0]&1&&!Y(e.src,t=_[0]))&&c(e,"src",t),(!h||k[0]&12&&n!==(n=`aspect-ratio: ${_[2]} / ${_[3]}`))&&c(e,"style",n),k[0]&32768&&l!==(l=_[15])&&e[l?"pause":"play"](),!o&&k[0]&128&&!isNaN(_[7])&&(e.currentTime=_[7]),o=!1,(!h||k[0]&65536)&&u!==(u=Ie(_[16])+"")&&F(f,u),(!h||k[0]&1024)&&O(r,"hide",_[10]),(!h||k[0]&256)&&c(p,"max",_[8]),(!h||k[0]&16384&&S!==(S=`background-image: linear-gradient(90deg, var(--accent) ${_[14]}%, var(--background-2) ${_[14]}%);}`))&&c(p,"style",S),k[0]&128&&_e(p,_[7]),(!h||k[0]&8192)&&O(p,"hide",_[13]);const K={};k[0]&32&&(K.playing=_[5]),k[0]&64&&(K.loading=_[6]),k[0]&8192&&(K.class=`center hidable ${_[13]?"hide":""}`),w.$set(K)},i(_){h||(R(w.$$.fragment,_),h=!0)},o(_){L(w.$$.fragment,_),h=!1},d(_){_&&(d(e),d(i),d(r),d(b),d(p),d(m)),s[23](null),te(w,_),y=!1,ie(N)}}}function Ht(s){let e,t,n,l,o,a=s[9]&&Pe(s);return{c(){e=E("div"),a&&a.c(),this.h()},l(i){e=I(i,"DIV",{class:!0,style:!0});var r=C(e);a&&a.l(r),r.forEach(d),this.h()},h(){c(e,"class",t="post-media player "+s[21].class+" svelte-5v7blo"),j(e,"aspect-ratio",s[2]+"/"+s[3])},m(i,r){T(i,e,r),a&&a.m(e,null),s[32](e),n=!0,l||(o=[P(e,"keydown",s[18]),P(e,"click",s[22])],l=!0)},p(i,r){i[9]?a?(a.p(i,r),r[0]&512&&R(a,1)):(a=Pe(i),a.c(),R(a,1),a.m(e,null)):a&&(ce(),L(a,1,1,()=>{a=null}),ue()),(!n||r[0]&2097152&&t!==(t="post-media player "+i[21].class+" svelte-5v7blo"))&&c(e,"class",t),(!n||r[0]&12)&&j(e,"aspect-ratio",i[2]+"/"+i[3])},i(i){n||(R(a),n=!0)},o(i){L(a),n=!1},d(i){i&&d(e),a&&a.d(),s[32](null),l=!1,ie(o)}}}const De=5;function Jt(s,e,t){let n,l,o,a,{src:i}=e,{poster:r}=e,{width:u}=e,{height:f}=e,{loop:b}=e,p,S,m=!1,w=!1,h=0,y=0,N=!1,A=!1;const _=()=>{t(7,h=Math.max(0,h-De))},k=()=>{t(7,h=Math.min(y,h+De))},K=g=>{g.offsetX<g.target.clientWidth/2?_():k()},Ue=g=>{Le(g)||g.key==="k"?(g.preventDefault(),g.stopPropagation(),t(5,m=!m)):g.key==="ArrowLeft"||g.key==="j"?(g.preventDefault(),g.stopPropagation(),_()):(g.key==="ArrowRight"||g.key==="l")&&(g.preventDefault(),g.stopPropagation(),k())},W=new IntersectionObserver(g=>{for(const $e of g)$e.isIntersecting?t(9,N=!0):S&&(t(5,m=!1),t(6,w=!1),S.addEventListener("error",()=>{t(9,N=!1)},{once:!0}),t(12,S.src="",S))},{rootMargin:"0px"}),Fe=()=>{t(5,m=!m),t(6,w=!0),t(10,A=m)},Oe=()=>{t(10,A=!A)};tt(()=>W==null?void 0:W.observe(p)),st(()=>W==null?void 0:W.unobserve(p));function ze(g){oe.call(this,s,g)}function Be(g){Z[g?"unshift":"push"](()=>{S=g,t(12,S)})}function je(){l=this.paused,t(15,l),t(5,m),t(9,N)}function Ke(){h=this.currentTime,t(7,h)}function We(){y=this.duration,t(8,y)}const He=()=>t(6,w=!0),Je=()=>t(6,w=!1),Qe=()=>t(6,w=!1),Xe=()=>{b||(t(6,w=!1),t(5,m=!1))};function Ye(){h=rt(this.value),t(7,h)}function Ze(g){Z[g?"unshift":"push"](()=>{p=g,t(11,p)})}return s.$$set=g=>{t(21,e=se(se({},e),le(g))),"src"in g&&t(0,i=g.src),"poster"in g&&t(1,r=g.poster),"width"in g&&t(2,u=g.width),"height"in g&&t(3,f=g.height),"loop"in g&&t(4,b=g.loop)},s.$$.update=()=>{s.$$.dirty[0]&384&&t(16,n=y-h),s.$$.dirty[0]&544&&t(5,m=N&&m),s.$$.dirty[0]&32&&t(15,l=!m),s.$$.dirty[0]&384&&t(14,o=h/y*98+1),s.$$.dirty[0]&1120&&t(13,a=m&&!w&&A)},e=le(e),[i,r,u,f,b,m,w,h,y,N,A,p,S,a,o,l,n,K,Ue,Fe,Oe,e,ze,Be,je,Ke,We,He,Je,Qe,Xe,Ye,Ze]}class ys extends V{constructor(e){super(),G(this,e,Jt,Ht,M,{src:0,poster:1,width:2,height:3,loop:4},null,[-1,-1])}}function Qt(s){let e,t,n,l,o,a,i,r,u,f,b,p;function S(h){s[13](h)}function m(h){s[14](h)}let w={class:"center"};return s[2]!==void 0&&(w.playing=s[2]),s[3]!==void 0&&(w.loading=s[3]),i=new qe({props:w}),Z.push(()=>me(i,"playing",S)),Z.push(()=>me(i,"loading",m)),i.$on("click",s[15]),{c(){e=E("div"),t=E("img"),a=z(),$(i.$$.fragment),this.h()},l(h){e=I(h,"DIV",{class:!0,style:!0});var y=C(e);t=I(y,"IMG",{class:!0,loading:!0,"data-src-lowres":!0,alt:!0,width:!0,height:!0,tabindex:!0}),a=B(y),x(i.$$.fragment,y),y.forEach(d),this.h()},h(){c(t,"class","post-media media-img svelte-ghjvqf"),c(t,"loading","lazy"),c(t,"data-src-lowres",s[4]),c(t,"alt",n=s[0].id.toString()),c(t,"width",l=s[0].width),c(t,"height",o=s[0].height),c(t,"tabindex","0"),c(e,"class","container svelte-ghjvqf"),j(e,"aspect-ratio",re(s[0].width,s[0].height))},m(h,y){T(h,e,y),D(e,t),s[9](t),D(e,a),ee(i,e,null),f=!0,b||(p=[P(t,"click",s[8]),P(t,"keydown",s[10]),P(t,"load",s[11]),P(t,"error",s[12],{once:!0}),Re(Ge.call(null,t))],b=!0)},p(h,[y]){(!f||y&16)&&c(t,"data-src-lowres",h[4]),(!f||y&1&&n!==(n=h[0].id.toString()))&&c(t,"alt",n),(!f||y&1&&l!==(l=h[0].width))&&c(t,"width",l),(!f||y&1&&o!==(o=h[0].height))&&c(t,"height",o);const N={};!r&&y&4&&(r=!0,N.playing=h[2],de(()=>r=!1)),!u&&y&8&&(u=!0,N.loading=h[3],de(()=>u=!1)),i.$set(N),(!f||y&1)&&j(e,"aspect-ratio",re(h[0].width,h[0].height))},i(h){f||(R(i.$$.fragment,h),f=!0)},o(h){L(i.$$.fragment,h),f=!1},d(h){h&&d(e),s[9](null),te(i),b=!1,ie(p)}}}function Xt(s,e,t){let n,l,o,a,{post:i}=e,r,u=!1,f=!1;function b(A){oe.call(this,s,A)}function p(A){Z[A?"unshift":"push"](()=>{r=A,t(1,r),t(2,u),t(6,l),t(5,o),t(7,n),t(0,i)})}const S=A=>{Ne(A),Le(A)&&(A.preventDefault(),t(3,f=!0),t(2,u=!u))},m=()=>t(3,f=!1),w=A=>{t(3,f=!1),A.target.src=`${X}/assets/failed-to-load.svg`};function h(A){u=A,t(2,u)}function y(A){f=A,t(3,f)}const N=()=>{t(3,f=!0),t(2,u=!u)};return s.$$set=A=>{"post"in A&&t(0,i=A.post)},s.$$.update=()=>{s.$$.dirty&1&&t(7,n=Gt(i.file_url,i.sample_url,i.preview_url)),s.$$.dirty&128&&t(6,l=n.animated),s.$$.dirty&128&&t(5,o=n.static),s.$$.dirty&100&&t(4,a=u?l:o),s.$$.dirty&102&&r&&t(1,r.src=u?l:o,r)},[i,r,u,f,a,o,l,n,b,p,S,m,w,h,y,N]}class ks extends V{constructor(e){super(),G(this,e,Xt,Qt,M,{post:0})}}export{os as C,hs as E,ks as G,bs as I,ds as P,cs as R,fs as S,ys as V,us as a,_s as b,Gt as c,qt as d,ms as e,Ie as f,gs as g,ps as i,ht as r};
