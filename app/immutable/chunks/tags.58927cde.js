const s=e=>e.replaceAll("&#034;",'"').replaceAll("&#038;","&").replaceAll("&#039;","'").replaceAll("&eacute;","Ã©"),o=e=>{try{return new URL(e),!0}catch{return!1}},l=(e,t)=>{if(!o(e))throw new TypeError("Invalid URL passed to fetchAbortPrevious");if(!i(t))throw new TypeError("Invalid AbortController passed to fetchAbortPrevious");return t&&t.abort(),t=new AbortController,fetch(e,{signal:t.signal})},i=e=>e===null||e instanceof AbortController;let c=null;const h=async e=>{const t=new URL("https://api.rule34.xxx/autocomplete.php");t.searchParams.append("q",e.replaceAll(" ","_"));const a=await l(t.toString(),c);if(a.ok){const r=await a.json();if(Array.isArray(r)){if(r.length===0)throw new Error("No tags found");return r.map(p)}else throw r.message?new Error(r.message):new Error("Invalid tag suggestions received")}else throw new Error("Failed to get tag suggestions")},f=async e=>{const t=new URL("https://api.rule34.xxx/index.php?page=dapi&s=tag&q=index&limit=1");t.searchParams.append("name",e);const r=await(await fetch(t.toString())).text(),n=new DOMParser().parseFromString(r,"text/xml").getElementsByTagName("tag")[0];return g(n.attributes)},p=e=>({label:s(e.value),count:u(e.label),type:"tag"}),u=e=>Number(e.substring(e.lastIndexOf("(")+1,e.length-1)),g=e=>{const t=e.getNamedItem("name"),a=e.getNamedItem("count"),r=e.getNamedItem("type");if(t===null||a===null||r===null)throw new Error(`Failed to parse tag details, attribute was null. ${t}, ${a}, ${r}`);return{name:s(t.value),count:Number(a.value),type:m(r.value)}},m=e=>["general","artist","general","copyright","character","metadata"][Number(e)];export{f as a,l as f,h as g,o as i,s as r};
