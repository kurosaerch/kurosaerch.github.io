import{v as b,s as M,f as E,l as q,a as z,g as I,h as C,m as U,d as _,c as B,j as c,i as T,u as D,n as F,e as Q,x as xe,G as De,y as $e,k as j,B as O,J as P,T as Ce,O as ie,L as oe,r as he,U as se,V as le,F as Y,o as et,P as tt,S as st,I as _e,N as lt,Q as nt,p as Z,R as at,K as de}from"./scheduler.41e0bfa2.js";import{h as ge,u as rt}from"./await_block.421e30a4.js";import{e as ne}from"./each.e59479a4.js";import{S as V,i as G,a as R,t as L,g as ce,c as ue,b as x,d as $,m as ee,e as te,f as me}from"./index.e3f19884.js";import{g as pe}from"./comments.7340f7b2.js";import{L as it}from"./LoadingAnimation.99c029b8.js";import{f as be}from"./format-tag.7e313273.js";import{i as ot}from"./tags.49324235.js";import{a as fe}from"./active-tags-store.8f583d8c.js";import{S as ct}from"./SimpleTag.b389e3b7.js";import{b as X}from"./paths.cd6e5a4b.js";import{c as Re,h as ut,b as Ne}from"./always-loop-store.06ca5387.js";const ft=typeof window<"u";let ht=ft?s=>requestAnimationFrame(s):b;const ye=6e4,ae=s=>{if(!_t(s))throw new TypeError("Invalid createdAt passed to formatCreatedAt");const e=new Date(s).getTime()/ye,n=new Date().getTime()/ye-e;if(n<1)return"Just now";if(n<60)return H(n,"minute");const l=n/60;if(l<24)return H(l,"hour");const o=l/24;if(o<7)return H(o,"day");if(o<30.5)return H(o/7,"week");if(o<365.25)return H(o/30.5,"month");const a=o/365.25;return H(a,"year")},_t=s=>(typeof s=="number"||typeof s=="string")&&new Date(s).toString()!=="Invalid Date",H=(s,e)=>{const t=s.toFixed();return`${t} ${e}${t==="1"?"":"s"} ago`};function dt(s){let e,t,n=s[0].author+"",l,o,a,i=ae(s[0].createdAt)+"",r,u,d,k=s[0].content+"",p;return{c(){e=E("div"),t=E("span"),l=q(n),o=z(),a=E("span"),r=q(i),u=z(),d=E("span"),p=q(k),this.h()},l(S){e=I(S,"DIV",{class:!0});var m=C(e);t=I(m,"SPAN",{class:!0});var w=C(t);l=U(w,n),w.forEach(_),o=B(m),a=I(m,"SPAN",{class:!0});var f=C(a);r=U(f,i),f.forEach(_),u=B(m),d=I(m,"SPAN",{class:!0});var y=C(d);p=U(y,k),y.forEach(_),m.forEach(_),this.h()},h(){c(t,"class","author svelte-bys59y"),c(a,"class","created-at svelte-bys59y"),c(d,"class","content svelte-bys59y"),c(e,"class","svelte-bys59y")},m(S,m){T(S,e,m),D(e,t),D(t,l),D(e,o),D(e,a),D(a,r),D(e,u),D(e,d),D(d,p)},p(S,[m]){m&1&&n!==(n=S[0].author+"")&&F(l,n),m&1&&i!==(i=ae(S[0].createdAt)+"")&&F(r,i),m&1&&k!==(k=S[0].content+"")&&F(p,k)},i:b,o:b,d(S){S&&_(e)}}}function gt(s,e,t){let{comment:n}=e;return s.$$set=l=>{"comment"in l&&t(0,n=l.comment)},[n]}class mt extends V{constructor(e){super(),G(this,e,gt,dt,M,{comment:0})}}function ve(s,e,t){const n=s.slice();return n[2]=e[t],n}function pt(s){return{c:b,l:b,m:b,p:b,i:b,o:b,d:b}}function bt(s){let e,t,n,l;const o=[vt,yt],a=[];function i(r,u){return r[1].length>0?0:1}return e=i(s),t=a[e]=o[e](s),{c(){t.c(),n=Q()},l(r){t.l(r),n=Q()},m(r,u){a[e].m(r,u),T(r,n,u),l=!0},p(r,u){let d=e;e=i(r),e===d?a[e].p(r,u):(ce(),L(a[d],1,1,()=>{a[d]=null}),ue(),t=a[e],t?t.p(r,u):(t=a[e]=o[e](r),t.c()),R(t,1),t.m(n.parentNode,n))},i(r){l||(R(t),l=!0)},o(r){L(t),l=!1},d(r){r&&_(n),a[e].d(r)}}}function yt(s){let e,t="Comments for this post are not available. <br/>This can happen if comments have been deleted.";return{c(){e=E("p"),e.innerHTML=t,this.h()},l(n){e=I(n,"P",{class:!0,"data-svelte-h":!0}),xe(e)!=="svelte-1f9q9vq"&&(e.innerHTML=t),this.h()},h(){c(e,"class","no-comments svelte-x6zn2h")},m(n,l){T(n,e,l)},p:b,i:b,o:b,d(n){n&&_(e)}}}function vt(s){let e,t,n=ne(s[1]),l=[];for(let a=0;a<n.length;a+=1)l[a]=ke(ve(s,n,a));const o=a=>L(l[a],1,1,()=>{l[a]=null});return{c(){e=E("ul");for(let a=0;a<l.length;a+=1)l[a].c();this.h()},l(a){e=I(a,"UL",{class:!0});var i=C(e);for(let r=0;r<l.length;r+=1)l[r].l(i);i.forEach(_),this.h()},h(){c(e,"class","comments svelte-x6zn2h")},m(a,i){T(a,e,i);for(let r=0;r<l.length;r+=1)l[r]&&l[r].m(e,null);t=!0},p(a,i){if(i&1){n=ne(a[1]);let r;for(r=0;r<n.length;r+=1){const u=ve(a,n,r);l[r]?(l[r].p(u,i),R(l[r],1)):(l[r]=ke(u),l[r].c(),R(l[r],1),l[r].m(e,null))}for(ce(),r=n.length;r<l.length;r+=1)o(r);ue()}},i(a){if(!t){for(let i=0;i<n.length;i+=1)R(l[i]);t=!0}},o(a){l=l.filter(Boolean);for(let i=0;i<l.length;i+=1)L(l[i]);t=!1},d(a){a&&_(e),De(l,a)}}}function ke(s){let e,t;return e=new mt({props:{comment:s[2]}}),{c(){x(e.$$.fragment)},l(n){$(e.$$.fragment,n)},m(n,l){ee(e,n,l),t=!0},p(n,l){const o={};l&1&&(o.comment=n[2]),e.$set(o)},i(n){t||(R(e.$$.fragment,n),t=!0)},o(n){L(e.$$.fragment,n),t=!1},d(n){te(e,n)}}}function kt(s){let e,t;return e=new it({}),{c(){x(e.$$.fragment)},l(n){$(e.$$.fragment,n)},m(n,l){ee(e,n,l),t=!0},p:b,i(n){t||(R(e.$$.fragment,n),t=!0)},o(n){L(e.$$.fragment,n),t=!1},d(n){te(e,n)}}}function wt(s){let e,t,n,l={ctx:s,current:null,token:null,hasCatch:!1,pending:kt,then:bt,catch:pt,value:1,blocks:[,,,]};return ge(t=pe(s[0].id),l),{c(){e=Q(),l.block.c()},l(o){e=Q(),l.block.l(o)},m(o,a){T(o,e,a),l.block.m(o,l.anchor=a),l.mount=()=>e.parentNode,l.anchor=e,n=!0},p(o,[a]){s=o,l.ctx=s,a&1&&t!==(t=pe(s[0].id))&&ge(t,l)||rt(l,s,a)},i(o){n||(R(l.block),n=!0)},o(o){for(let a=0;a<3;a+=1){const i=l.blocks[a];L(i)}n=!1},d(o){o&&_(e),l.block.d(o),l.token=null,l=null}}}function St(s,e,t){let{post:n}=e;return s.$$set=l=>{"post"in l&&t(0,n=l.post)},[n]}class os extends V{constructor(e){super(),G(this,e,St,wt,M,{post:0})}}function At(s){let e,t=s[0].charAt(0).toUpperCase()+"",n,l;return{c(){e=E("span"),n=q(t),this.h()},l(o){e=I(o,"SPAN",{title:!0,class:!0});var a=C(e);n=U(a,t),a.forEach(_),this.h()},h(){c(e,"title",l="Rated "+s[0]+"."),c(e,"class","svelte-1nbj6kf")},m(o,a){T(o,e,a),D(e,n)},p(o,[a]){a&1&&t!==(t=o[0].charAt(0).toUpperCase()+"")&&F(n,t),a&1&&l!==(l="Rated "+o[0]+".")&&c(e,"title",l)},i:b,o:b,d(o){o&&_(e)}}}function Et(s,e,t){let{value:n}=e;return s.$$set=l=>{"value"in l&&t(0,n=l.value)},[n]}class cs extends V{constructor(e){super(),G(this,e,Et,At,M,{value:0})}}function It(s){let e,t=ae(s[0])+"",n;return{c(){e=E("span"),n=q(t),this.h()},l(l){e=I(l,"SPAN",{class:!0});var o=C(e);n=U(o,t),o.forEach(_),this.h()},h(){c(e,"class","svelte-1vqihm9")},m(l,o){T(l,e,o),D(e,n)},p(l,[o]){o&1&&t!==(t=ae(l[0])+"")&&F(n,t)},i:b,o:b,d(l){l&&_(e)}}}function Tt(s,e,t){let{value:n}=e;return s.$$set=l=>{"value"in l&&t(0,n=l.value)},[n]}class us extends V{constructor(e){super(),G(this,e,Tt,It,M,{value:0})}}function Pt(s){let e,t=be(s[0])+"",n;return{c(){e=E("span"),n=q(t),this.h()},l(l){e=I(l,"SPAN",{"data-testid":!0,class:!0});var o=C(e);n=U(o,t),o.forEach(_),this.h()},h(){c(e,"data-testid","score"),c(e,"class","codicon codicon-heart svelte-te86f3")},m(l,o){T(l,e,o),D(e,n)},p(l,[o]){o&1&&t!==(t=be(l[0])+"")&&F(n,t)},i:b,o:b,d(l){l&&_(e)}}}function Dt(s,e,t){let{value:n}=e;return s.$$set=l=>{"value"in l&&t(0,n=l.value)},[n]}class fs extends V{constructor(e){super(),G(this,e,Dt,Pt,M,{value:0})}}function we(s){let e,t,n,l,o;return{c(){e=E("a"),t=E("i"),n=z(),l=q(s[1]),this.h()},l(a){e=I(a,"A",{href:!0,target:!0,class:!0});var i=C(e);t=I(i,"I",{class:!0}),C(t).forEach(_),n=B(i),l=U(i,s[1]),i.forEach(_),this.h()},h(){c(t,"class","codicon codicon-link"),c(e,"href",o=s[0].toString()),c(e,"target","_newtab"),c(e,"class","svelte-1orztco")},m(a,i){T(a,e,i),D(e,t),D(e,n),D(e,l)},p(a,i){i&2&&F(l,a[1]),i&1&&o!==(o=a[0].toString())&&c(e,"href",o)},d(a){a&&_(e)}}}function Ct(s){let e,t=s[0]&&we(s);return{c(){t&&t.c(),e=Q()},l(n){t&&t.l(n),e=Q()},m(n,l){t&&t.m(n,l),T(n,e,l)},p(n,[l]){n[0]?t?t.p(n,l):(t=we(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:b,o:b,d(n){n&&_(e),t&&t.d(n)}}}function Rt(s,e,t){let n,l,{source:o}=e;return s.$$set=a=>{"source"in a&&t(2,o=a.source)},s.$$.update=()=>{var a;s.$$.dirty&4&&t(0,n=ot(o)?new URL(o):null),s.$$.dirty&1&&t(1,l=(a=n==null?void 0:n.hostname)==null?void 0:a.replace(/^www./,""))},[n,l,o]}class hs extends V{constructor(e){super(),G(this,e,Rt,Ct,M,{source:2})}}function Nt(s){let e,t,n;return{c(){e=E("a"),t=E("i"),n=q(" File"),this.h()},l(l){e=I(l,"A",{href:!0,target:!0,class:!0});var o=C(e);t=I(o,"I",{class:!0}),C(t).forEach(_),n=U(o," File"),o.forEach(_),this.h()},h(){c(t,"class","codicon codicon-file"),c(e,"href",s[0]),c(e,"target","_newtab"),c(e,"class","svelte-1orztco")},m(l,o){T(l,e,o),D(e,t),D(e,n)},p(l,[o]){o&1&&c(e,"href",l[0])},i:b,o:b,d(l){l&&_(e)}}}function Lt(s,e,t){let{url:n}=e;return s.$$set=l=>{"url"in l&&t(0,n=l.url)},[n]}class _s extends V{constructor(e){super(),G(this,e,Lt,Nt,M,{url:0})}}function Se(s,e,t){const n=s.slice();n[4]=e[t];const l=n[1].find(function(...a){return s[3](n[4],...a)})!==void 0;return n[5]=l,n}function Ae(s){let e,t;function n(){return s[2](s[5],s[4])}return e=new ct({props:{tag:s[4],active:s[5]}}),e.$on("click",n),{c(){x(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,o){ee(e,l,o),t=!0},p(l,o){s=l;const a={};o&1&&(a.tag=s[4]),o&3&&(a.active=s[5]),e.$set(a)},i(l){t||(R(e.$$.fragment,l),t=!0)},o(l){L(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function Mt(s){let e,t,n=ne(s[0]),l=[];for(let a=0;a<n.length;a+=1)l[a]=Ae(Se(s,n,a));const o=a=>L(l[a],1,1,()=>{l[a]=null});return{c(){e=E("ul");for(let a=0;a<l.length;a+=1)l[a].c();this.h()},l(a){e=I(a,"UL",{class:!0});var i=C(e);for(let r=0;r<l.length;r+=1)l[r].l(i);i.forEach(_),this.h()},h(){c(e,"class","tags svelte-b5q4us")},m(a,i){T(a,e,i);for(let r=0;r<l.length;r+=1)l[r]&&l[r].m(e,null);t=!0},p(a,[i]){if(i&3){n=ne(a[0]);let r;for(r=0;r<n.length;r+=1){const u=Se(a,n,r);l[r]?(l[r].p(u,i),R(l[r],1)):(l[r]=Ae(u),l[r].c(),R(l[r],1),l[r].m(e,null))}for(ce(),r=n.length;r<l.length;r+=1)o(r);ue()}},i(a){if(!t){for(let i=0;i<n.length;i+=1)R(l[i]);t=!0}},o(a){l=l.filter(Boolean);for(let i=0;i<l.length;i+=1)L(l[i]);t=!1},d(a){a&&_(e),De(l,a)}}}function Vt(s,e,t){let n;$e(s,fe,i=>t(1,n=i));let{tags:l}=e;const o=(i,r)=>i?fe.removeByName(r.name):fe.addOrReplace({...r,modifier:"+"}),a=(i,r)=>r.name===i.name;return s.$$set=i=>{"tags"in i&&t(0,l=i.tags)},[l,n,o,a]}class ds extends V{constructor(e){super(),G(this,e,Vt,Mt,M,{tags:0})}}const Le=s=>s.endsWith(".gif"),Gt=(s,e,t)=>Le(e)?{static:t,animated:e}:{static:e,animated:s},Me=s=>s.endsWith(".mp4")||s.endsWith(".webm"),gs=(s,e,t)=>Me(e)?{static:t,animated:e}:{static:e,animated:s},ms=s=>s.some(e=>e.name==="loop"),ps=s=>Le(s)||Me(s),Ee=s=>{if(typeof s!="number")throw new TypeError(`Attempted to call formatVideoTime with invalid value: ${s}`);const e=Math.floor(s),t=e%60,n=Math.floor(e/60);return`${Ie(n)}:${Ie(t)}`},Ie=s=>{const e=String(s),t=Math.max(0,2-e.length);return`${"0".repeat(t)}${e}`},qt=(s,e)=>s&&e?s/e:1,re=(s,e)=>s&&e?`${s} / ${e}`:"1 / 1",Ut="1250px",J=new IntersectionObserver(s=>{var e;for(const t of s){const n=t.isIntersecting?t.target.getAttribute("data-src")??"":"";(e=t==null?void 0:t.target)==null||e.setAttribute("src",n)}},{rootMargin:Ut}),Ve=s=>(J==null||J.observe(s),{destroy(){J==null||J.unobserve(s)}});function Ft(s){let e,t,n,l,o,a,i;return{c(){e=E("div"),t=E("img"),this.h()},l(r){e=I(r,"DIV",{class:!0});var u=C(e);t=I(u,"IMG",{class:!0,loading:!0,"data-src":!0,alt:!0,style:!0,width:!0,height:!0,tabindex:!0}),u.forEach(_),this.h()},h(){c(t,"class","post-media svelte-1gcqb6"),c(t,"loading","lazy"),c(t,"data-src",s[2]),c(t,"alt",n=s[0].id.toString()),j(t,"aspect-ratio",re(s[0].width,s[0].height)),c(t,"width",l=s[0].width),c(t,"height",o=s[0].height),c(t,"tabindex","0"),c(e,"class","svelte-1gcqb6"),O(e,"expandable",s[3]),O(e,"open",s[1])},m(r,u){T(r,e,u),D(e,t),a||(i=[P(t,"click",s[5]),P(t,"keydown",Re),P(t,"error",s[6],{once:!0}),Ce(Ve.call(null,t)),P(e,"click",s[4])],a=!0)},p(r,[u]){u&4&&c(t,"data-src",r[2]),u&1&&n!==(n=r[0].id.toString())&&c(t,"alt",n),u&1&&j(t,"aspect-ratio",re(r[0].width,r[0].height)),u&1&&l!==(l=r[0].width)&&c(t,"width",l),u&1&&o!==(o=r[0].height)&&c(t,"height",o),u&2&&O(e,"open",r[1])},i:b,o:b,d(r){r&&_(e),a=!1,ie(i)}}}function Ot(s,e,t){let n,{post:l}=e,a=qt(l.width,l.height)<.33,i;function r(k){oe.call(this,s,k)}const u=()=>t(1,i=!i),d=k=>k.target.src=`${X}/assets/failed-to-load.svg`;return s.$$set=k=>{"post"in k&&t(0,l=k.post)},s.$$.update=()=>{s.$$.dirty&1&&t(2,n=ut?l.file_url:l.sample_url)},[l,i,n,a,r,u,d]}class bs extends V{constructor(e){super(),G(this,e,Ot,Ft,M,{post:0})}}function zt(s){let e,t;return{c(){e=E("img"),this.h()},l(n){e=I(n,"IMG",{src:!0,alt:!0,width:!0,height:!0,style:!0}),this.h()},h(){Y(e.src,t=s[3])||c(e,"src",t),c(e,"alt","Start GIF"),c(e,"width","16"),c(e,"height","32"),j(e,"margin-left","4px")},m(n,l){T(n,e,l)},p:b,d(n){n&&_(e)}}}function Bt(s){let e,t;return{c(){e=E("img"),this.h()},l(n){e=I(n,"IMG",{src:!0,alt:!0,width:!0,height:!0}),this.h()},h(){Y(e.src,t=s[4])||c(e,"src",t),c(e,"alt","Stop GIF"),c(e,"width","16"),c(e,"height","32")},m(n,l){T(n,e,l)},p:b,d(n){n&&_(e)}}}function jt(s){let e,t;return{c(){e=E("img"),this.h()},l(n){e=I(n,"IMG",{src:!0,alt:!0,width:!0,height:!0}),this.h()},h(){Y(e.src,t=s[2])||c(e,"src",t),c(e,"alt","Loading GIF"),c(e,"width","16"),c(e,"height","32")},m(n,l){T(n,e,l)},p:b,d(n){n&&_(e)}}}function Kt(s){let e,t,n,l;function o(r,u){return r[1]?jt:r[0]?Bt:zt}let a=o(s),i=a(s);return{c(){e=E("button"),i.c(),this.h()},l(r){e=I(r,"BUTTON",{type:!0,class:!0});var u=C(e);i.l(u),u.forEach(_),this.h()},h(){c(e,"type","button"),c(e,"class",t=he(s[5].class)+" svelte-19k2j29")},m(r,u){T(r,e,u),i.m(e,null),n||(l=P(e,"click",s[6]),n=!0)},p(r,[u]){a===(a=o(r))&&i?i.p(r,u):(i.d(1),i=a(r),i&&(i.c(),i.m(e,null))),u&32&&t!==(t=he(r[5].class)+" svelte-19k2j29")&&c(e,"class",t)},i:b,o:b,d(r){r&&_(e),i.d(),n=!1,l()}}}function Wt(s,e,t){const n=`${X}/assets/load.svg`,l=`${X}/assets/play.svg`,o=`${X}/assets/pause.svg`;let{playing:a}=e,{loading:i}=e;function r(u){oe.call(this,s,u)}return s.$$set=u=>{t(5,e=se(se({},e),le(u))),"playing"in u&&t(0,a=u.playing),"loading"in u&&t(1,i=u.loading)},e=le(e),[a,i,n,l,o,e,r]}class Ge extends V{constructor(e){super(),G(this,e,Wt,Kt,M,{playing:0,loading:1})}}function Te(s){let e,t,n,l=!0,o=!1,a,i,r,u=Ee(s[16])+"",d,k,p,S,m,w,f,y,N;function A(){cancelAnimationFrame(a),e.paused||(a=ht(A),o=!0),s[25].call(e)}return w=new Ge({props:{playing:s[5],loading:s[6],class:`center hidable ${s[13]?"hide":""}`}}),w.$on("click",s[19]),{c(){e=E("video"),i=z(),r=E("span"),d=q(u),k=z(),p=E("input"),m=z(),x(w.$$.fragment),this.h()},l(h){e=I(h,"VIDEO",{tabindex:!0,poster:!0,src:!0,preload:!0,style:!0,class:!0}),C(e).forEach(_),i=B(h),r=I(h,"SPAN",{class:!0});var v=C(r);d=U(v,u),v.forEach(_),k=B(h),p=I(h,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0,style:!0}),m=B(h),$(w.$$.fragment,h),this.h()},h(){c(e,"tabindex","0"),c(e,"poster",s[1]),e.loop=s[4],Y(e.src,t=s[0])||c(e,"src",t),c(e,"preload","metadata"),c(e,"style",n=`aspect-ratio: ${s[2]} / ${s[3]}`),c(e,"class","svelte-5v7blo"),s[8]===void 0&&st(()=>s[26].call(e)),c(r,"class","hidable svelte-5v7blo"),O(r,"hide",s[10]),c(p,"type","range"),c(p,"min",0),c(p,"max",s[8]),c(p,"step",.0166666),c(p,"class","hidable svelte-5v7blo"),c(p,"style",S=`background-image: linear-gradient(90deg, var(--accent) ${s[14]}%, var(--background-2) ${s[14]}%);}`),O(p,"hide",s[13])},m(h,v){T(h,e,v),s[23](e),T(h,i,v),T(h,r,v),D(r,d),T(h,k,v),T(h,p,v),_e(p,s[7]),T(h,m,v),ee(w,h,v),f=!0,y||(N=[P(e,"play",s[24]),P(e,"pause",s[24]),P(e,"timeupdate",A),P(e,"durationchange",s[26]),P(e,"waiting",s[27]),P(e,"playing",s[28]),P(e,"pause",s[29]),P(e,"ended",s[30]),P(e,"click",s[20]),P(e,"dblclick",lt(nt(s[17]))),P(p,"change",s[31]),P(p,"input",s[31])],y=!0)},p(h,v){(!f||v[0]&2)&&c(e,"poster",h[1]),(!f||v[0]&16)&&(e.loop=h[4]),(!f||v[0]&1&&!Y(e.src,t=h[0]))&&c(e,"src",t),(!f||v[0]&12&&n!==(n=`aspect-ratio: ${h[2]} / ${h[3]}`))&&c(e,"style",n),v[0]&32768&&l!==(l=h[15])&&e[l?"pause":"play"](),!o&&v[0]&128&&!isNaN(h[7])&&(e.currentTime=h[7]),o=!1,(!f||v[0]&65536)&&u!==(u=Ee(h[16])+"")&&F(d,u),(!f||v[0]&1024)&&O(r,"hide",h[10]),(!f||v[0]&256)&&c(p,"max",h[8]),(!f||v[0]&16384&&S!==(S=`background-image: linear-gradient(90deg, var(--accent) ${h[14]}%, var(--background-2) ${h[14]}%);}`))&&c(p,"style",S),v[0]&128&&_e(p,h[7]),(!f||v[0]&8192)&&O(p,"hide",h[13]);const K={};v[0]&32&&(K.playing=h[5]),v[0]&64&&(K.loading=h[6]),v[0]&8192&&(K.class=`center hidable ${h[13]?"hide":""}`),w.$set(K)},i(h){f||(R(w.$$.fragment,h),f=!0)},o(h){L(w.$$.fragment,h),f=!1},d(h){h&&(_(e),_(i),_(r),_(k),_(p),_(m)),s[23](null),te(w,h),y=!1,ie(N)}}}function Ht(s){let e,t,n,l,o,a=s[9]&&Te(s);return{c(){e=E("div"),a&&a.c(),this.h()},l(i){e=I(i,"DIV",{class:!0,style:!0});var r=C(e);a&&a.l(r),r.forEach(_),this.h()},h(){c(e,"class",t="post-media player "+s[21].class+" svelte-5v7blo"),j(e,"aspect-ratio",s[2]+"/"+s[3])},m(i,r){T(i,e,r),a&&a.m(e,null),s[32](e),n=!0,l||(o=[P(e,"keydown",s[18]),P(e,"click",s[22])],l=!0)},p(i,r){i[9]?a?(a.p(i,r),r[0]&512&&R(a,1)):(a=Te(i),a.c(),R(a,1),a.m(e,null)):a&&(ce(),L(a,1,1,()=>{a=null}),ue()),(!n||r[0]&2097152&&t!==(t="post-media player "+i[21].class+" svelte-5v7blo"))&&c(e,"class",t),(!n||r[0]&12)&&j(e,"aspect-ratio",i[2]+"/"+i[3])},i(i){n||(R(a),n=!0)},o(i){L(a),n=!1},d(i){i&&_(e),a&&a.d(),s[32](null),l=!1,ie(o)}}}const Pe=5;function Jt(s,e,t){let n,l,o,a,{src:i}=e,{poster:r}=e,{width:u}=e,{height:d}=e,{loop:k}=e,p,S,m=!1,w=!1,f=0,y=0,N=!1,A=!1;const h=()=>{t(7,f=Math.max(0,f-Pe))},v=()=>{t(7,f=Math.min(y,f+Pe))},K=g=>{g.offsetX<g.target.clientWidth/2?h():v()},qe=g=>{Ne(g)||g.key==="k"?(g.preventDefault(),g.stopPropagation(),t(5,m=!m)):g.key==="ArrowLeft"||g.key==="j"?(g.preventDefault(),g.stopPropagation(),h()):(g.key==="ArrowRight"||g.key==="l")&&(g.preventDefault(),g.stopPropagation(),v())},W=new IntersectionObserver(g=>{for(const Ze of g)Ze.isIntersecting?t(9,N=!0):S&&(t(5,m=!1),t(6,w=!1),S.addEventListener("error",()=>{t(9,N=!1)},{once:!0}),t(12,S.src="",S))},{rootMargin:"0px"}),Ue=()=>{t(5,m=!m),t(6,w=!0),t(10,A=m)},Fe=()=>{t(10,A=!A)};et(()=>W==null?void 0:W.observe(p)),tt(()=>W==null?void 0:W.unobserve(p));function Oe(g){oe.call(this,s,g)}function ze(g){Z[g?"unshift":"push"](()=>{S=g,t(12,S)})}function Be(){l=this.paused,t(15,l),t(5,m),t(9,N)}function je(){f=this.currentTime,t(7,f)}function Ke(){y=this.duration,t(8,y)}const We=()=>t(6,w=!0),He=()=>t(6,w=!1),Je=()=>t(6,w=!1),Qe=()=>{k||(t(6,w=!1),t(5,m=!1))};function Xe(){f=at(this.value),t(7,f)}function Ye(g){Z[g?"unshift":"push"](()=>{p=g,t(11,p)})}return s.$$set=g=>{t(21,e=se(se({},e),le(g))),"src"in g&&t(0,i=g.src),"poster"in g&&t(1,r=g.poster),"width"in g&&t(2,u=g.width),"height"in g&&t(3,d=g.height),"loop"in g&&t(4,k=g.loop)},s.$$.update=()=>{s.$$.dirty[0]&384&&t(16,n=y-f),s.$$.dirty[0]&544&&t(5,m=N&&m),s.$$.dirty[0]&32&&t(15,l=!m),s.$$.dirty[0]&384&&t(14,o=f/y*98+1),s.$$.dirty[0]&1120&&t(13,a=m&&!w&&A)},e=le(e),[i,r,u,d,k,m,w,f,y,N,A,p,S,a,o,l,n,K,qe,Ue,Fe,e,Oe,ze,Be,je,Ke,We,He,Je,Qe,Xe,Ye]}class ys extends V{constructor(e){super(),G(this,e,Jt,Ht,M,{src:0,poster:1,width:2,height:3,loop:4},null,[-1,-1])}}function Qt(s){let e,t,n,l,o,a,i,r,u,d,k,p;function S(f){s[13](f)}function m(f){s[14](f)}let w={class:"center"};return s[2]!==void 0&&(w.playing=s[2]),s[3]!==void 0&&(w.loading=s[3]),i=new Ge({props:w}),Z.push(()=>me(i,"playing",S)),Z.push(()=>me(i,"loading",m)),i.$on("click",s[15]),{c(){e=E("div"),t=E("img"),a=z(),x(i.$$.fragment),this.h()},l(f){e=I(f,"DIV",{class:!0,style:!0});var y=C(e);t=I(y,"IMG",{class:!0,loading:!0,"data-src":!0,alt:!0,width:!0,height:!0,tabindex:!0}),a=B(y),$(i.$$.fragment,y),y.forEach(_),this.h()},h(){c(t,"class","post-media media-img svelte-ghjvqf"),c(t,"loading","lazy"),c(t,"data-src",s[4]),c(t,"alt",n=s[0].id.toString()),c(t,"width",l=s[0].width),c(t,"height",o=s[0].height),c(t,"tabindex","0"),c(e,"class","container svelte-ghjvqf"),j(e,"aspect-ratio",re(s[0].width,s[0].height))},m(f,y){T(f,e,y),D(e,t),s[9](t),D(e,a),ee(i,e,null),d=!0,k||(p=[P(t,"click",s[8]),P(t,"keydown",s[10]),P(t,"load",s[11]),P(t,"error",s[12],{once:!0}),Ce(Ve.call(null,t))],k=!0)},p(f,[y]){(!d||y&16)&&c(t,"data-src",f[4]),(!d||y&1&&n!==(n=f[0].id.toString()))&&c(t,"alt",n),(!d||y&1&&l!==(l=f[0].width))&&c(t,"width",l),(!d||y&1&&o!==(o=f[0].height))&&c(t,"height",o);const N={};!r&&y&4&&(r=!0,N.playing=f[2],de(()=>r=!1)),!u&&y&8&&(u=!0,N.loading=f[3],de(()=>u=!1)),i.$set(N),(!d||y&1)&&j(e,"aspect-ratio",re(f[0].width,f[0].height))},i(f){d||(R(i.$$.fragment,f),d=!0)},o(f){L(i.$$.fragment,f),d=!1},d(f){f&&_(e),s[9](null),te(i),k=!1,ie(p)}}}function Xt(s,e,t){let n,l,o,a,{post:i}=e,r,u=!1,d=!1;function k(A){oe.call(this,s,A)}function p(A){Z[A?"unshift":"push"](()=>{r=A,t(1,r),t(2,u),t(6,l),t(5,o),t(7,n),t(0,i)})}const S=A=>{Re(A),Ne(A)&&(A.preventDefault(),t(3,d=!0),t(2,u=!u))},m=()=>t(3,d=!1),w=A=>{t(3,d=!1),A.target.src=`${X}/assets/failed-to-load.svg`};function f(A){u=A,t(2,u)}function y(A){d=A,t(3,d)}const N=()=>{t(3,d=!0),t(2,u=!u)};return s.$$set=A=>{"post"in A&&t(0,i=A.post)},s.$$.update=()=>{s.$$.dirty&1&&t(7,n=Gt(i.file_url,i.sample_url,i.preview_url)),s.$$.dirty&128&&t(6,l=n.animated),s.$$.dirty&128&&t(5,o=n.static),s.$$.dirty&100&&t(4,a=u?l:o),s.$$.dirty&102&&r&&t(1,r.src=u?l:o,r)},[i,r,u,d,a,o,l,n,k,p,S,m,w,f,y,N]}class vs extends V{constructor(e){super(),G(this,e,Xt,Qt,M,{post:0})}}export{os as C,hs as E,vs as G,bs as I,ds as P,cs as R,fs as S,ys as V,us as a,_s as b,Gt as c,qt as d,ms as e,Ee as f,gs as g,ps as i,ht as r};
