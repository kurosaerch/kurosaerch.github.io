import{s as V,f as E,l as F,a as O,g as A,h as P,m as U,d as _,c as B,j as c,i as N,u as M,n as j,v as w,e as J,y as Ze,I as Te,D as Ye,z,H as D,R as Ne,J as ce,r as ue,V as te,W as se,O as De,K as Q,k as oe,o as xe,M as $e,Q as et,G as fe,L as tt,N as st,p as X,P as nt,E as he}from"./scheduler.a5f94e90.js";import{h as _e,u as lt}from"./await_block.d62949c0.js";import{e as ne}from"./each.e59479a4.js";import{S as R,i as G,a as C,t as L,g as ae,c as re,b as Z,d as Y,m as x,e as $,r as at,f as de}from"./index.364b58a4.js";import{L as rt}from"./LoadingAnimation.72f13765.js";import{f as me}from"./format-tag.7e313273.js";import{i as it}from"./tags.49324235.js";import{a as ie}from"./active-tags-store.b83fefc6.js";import{S as ot}from"./SimpleTag.58ec3e24.js";import{b as ee}from"./paths.0cd4367f.js";import{c as Me,h as ct,b as Pe}from"./always-loop-store.7fb651a6.js";const ut="https://api.rule34.xxx/index.php?page=dapi&s=comment&q=index&json=1",ge=async(s=void 0)=>{if(typeof s!="number"&&s!==void 0)throw new TypeError("Invalid postId");const e=new URL(ut);s!==void 0&&e.searchParams.append("post_id",String(s));const t=await fetch(e);if(!t.ok)throw new Error("Failed to get tag suggestions");const l=await t.text(),o=new DOMParser().parseFromString(l,"text/xml"),a=[];for(const i of o.getElementsByTagName("comment"))a.push(ft(i.attributes));return a},ft=s=>{const e=s.getNamedItem("creator"),t=s.getNamedItem("created_at"),l=s.getNamedItem("body");if(e==null||t==null||l==null)throw new Error(`Failed to parse comment, attribute was null. ${e}, ${t}, ${l}`);return{author:e.value,createdAt:t.value,content:l.value}},pe=6e4,le=s=>{if(!ht(s))throw new TypeError("Invalid createdAt passed to formatCreatedAt");const e=new Date(s).getTime()/pe,l=new Date().getTime()/pe-e;if(l<1)return"Just now";if(l<60)return H(l,"minute");const n=l/60;if(n<24)return H(n,"hour");const o=n/24;if(o<7)return H(o,"day");if(o<30.5)return H(o/7,"week");if(o<365.25)return H(o/30.5,"month");const a=o/365.25;return H(a,"year")},ht=s=>(typeof s=="number"||typeof s=="string")&&new Date(s).toString()!=="Invalid Date",H=(s,e)=>{const t=s.toFixed();return`${t} ${e}${t==="1"?"":"s"} ago`};function _t(s){let e,t,l=s[0].author+"",n,o,a,i=le(s[0].createdAt)+"",r,u,f,S=s[0].content+"",m;return{c(){e=E("div"),t=E("span"),n=F(l),o=O(),a=E("span"),r=F(i),u=O(),f=E("span"),m=F(S),this.h()},l(k){e=A(k,"DIV",{class:!0});var g=P(e);t=A(g,"SPAN",{class:!0});var I=P(t);n=U(I,l),I.forEach(_),o=B(g),a=A(g,"SPAN",{class:!0});var p=P(a);r=U(p,i),p.forEach(_),u=B(g),f=A(g,"SPAN",{class:!0});var d=P(f);m=U(d,S),d.forEach(_),g.forEach(_),this.h()},h(){c(t,"class","author svelte-bys59y"),c(a,"class","created-at svelte-bys59y"),c(f,"class","content svelte-bys59y"),c(e,"class","svelte-bys59y")},m(k,g){N(k,e,g),M(e,t),M(t,n),M(e,o),M(e,a),M(a,r),M(e,u),M(e,f),M(f,m)},p(k,[g]){g&1&&l!==(l=k[0].author+"")&&j(n,l),g&1&&i!==(i=le(k[0].createdAt)+"")&&j(r,i),g&1&&S!==(S=k[0].content+"")&&j(m,S)},i:w,o:w,d(k){k&&_(e)}}}function dt(s,e,t){let{comment:l}=e;return s.$$set=n=>{"comment"in n&&t(0,l=n.comment)},[l]}class mt extends R{constructor(e){super(),G(this,e,dt,_t,V,{comment:0})}}function be(s,e,t){const l=s.slice();return l[2]=e[t],l}function gt(s){return{c:w,l:w,m:w,p:w,i:w,o:w,d:w}}function pt(s){let e,t,l,n;const o=[yt,bt],a=[];function i(r,u){return r[1].length>0?0:1}return e=i(s),t=a[e]=o[e](s),{c(){t.c(),l=J()},l(r){t.l(r),l=J()},m(r,u){a[e].m(r,u),N(r,l,u),n=!0},p(r,u){let f=e;e=i(r),e===f?a[e].p(r,u):(ae(),L(a[f],1,1,()=>{a[f]=null}),re(),t=a[e],t?t.p(r,u):(t=a[e]=o[e](r),t.c()),C(t,1),t.m(l.parentNode,l))},i(r){n||(C(t),n=!0)},o(r){L(t),n=!1},d(r){r&&_(l),a[e].d(r)}}}function bt(s){let e,t="Comments for this post are not available. <br/>This can happen if comments have been deleted.";return{c(){e=E("p"),e.innerHTML=t,this.h()},l(l){e=A(l,"P",{class:!0,"data-svelte-h":!0}),Ze(e)!=="svelte-1f9q9vq"&&(e.innerHTML=t),this.h()},h(){c(e,"class","no-comments svelte-x6zn2h")},m(l,n){N(l,e,n)},p:w,i:w,o:w,d(l){l&&_(e)}}}function yt(s){let e,t,l=ne(s[1]),n=[];for(let a=0;a<l.length;a+=1)n[a]=ye(be(s,l,a));const o=a=>L(n[a],1,1,()=>{n[a]=null});return{c(){e=E("ul");for(let a=0;a<n.length;a+=1)n[a].c();this.h()},l(a){e=A(a,"UL",{class:!0});var i=P(e);for(let r=0;r<n.length;r+=1)n[r].l(i);i.forEach(_),this.h()},h(){c(e,"class","comments svelte-x6zn2h")},m(a,i){N(a,e,i);for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(e,null);t=!0},p(a,i){if(i&1){l=ne(a[1]);let r;for(r=0;r<l.length;r+=1){const u=be(a,l,r);n[r]?(n[r].p(u,i),C(n[r],1)):(n[r]=ye(u),n[r].c(),C(n[r],1),n[r].m(e,null))}for(ae(),r=l.length;r<n.length;r+=1)o(r);re()}},i(a){if(!t){for(let i=0;i<l.length;i+=1)C(n[i]);t=!0}},o(a){n=n.filter(Boolean);for(let i=0;i<n.length;i+=1)L(n[i]);t=!1},d(a){a&&_(e),Te(n,a)}}}function ye(s){let e,t;return e=new mt({props:{comment:s[2]}}),{c(){Z(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,n){x(e,l,n),t=!0},p(l,n){const o={};n&1&&(o.comment=l[2]),e.$set(o)},i(l){t||(C(e.$$.fragment,l),t=!0)},o(l){L(e.$$.fragment,l),t=!1},d(l){$(e,l)}}}function vt(s){let e,t;return e=new rt({}),{c(){Z(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,n){x(e,l,n),t=!0},p:w,i(l){t||(C(e.$$.fragment,l),t=!0)},o(l){L(e.$$.fragment,l),t=!1},d(l){$(e,l)}}}function kt(s){let e,t,l,n={ctx:s,current:null,token:null,hasCatch:!1,pending:vt,then:pt,catch:gt,value:1,blocks:[,,,]};return _e(t=ge(s[0].id),n),{c(){e=J(),n.block.c()},l(o){e=J(),n.block.l(o)},m(o,a){N(o,e,a),n.block.m(o,n.anchor=a),n.mount=()=>e.parentNode,n.anchor=e,l=!0},p(o,[a]){s=o,n.ctx=s,a&1&&t!==(t=ge(s[0].id))&&_e(t,n)||lt(n,s,a)},i(o){l||(C(n.block),l=!0)},o(o){for(let a=0;a<3;a+=1){const i=n.blocks[a];L(i)}l=!1},d(o){o&&_(e),n.block.d(o),n.token=null,n=null}}}function wt(s,e,t){let{post:l}=e;return s.$$set=n=>{"post"in n&&t(0,l=n.post)},[l]}class as extends R{constructor(e){super(),G(this,e,wt,kt,V,{post:0})}}function St(s){let e,t=s[0].charAt(0).toUpperCase()+"",l,n;return{c(){e=E("span"),l=F(t),this.h()},l(o){e=A(o,"SPAN",{title:!0,class:!0});var a=P(e);l=U(a,t),a.forEach(_),this.h()},h(){c(e,"title",n="Rated "+s[0]+"."),c(e,"class","svelte-1nbj6kf")},m(o,a){N(o,e,a),M(e,l)},p(o,[a]){a&1&&t!==(t=o[0].charAt(0).toUpperCase()+"")&&j(l,t),a&1&&n!==(n="Rated "+o[0]+".")&&c(e,"title",n)},i:w,o:w,d(o){o&&_(e)}}}function Et(s,e,t){let{value:l}=e;return s.$$set=n=>{"value"in n&&t(0,l=n.value)},[l]}class rs extends R{constructor(e){super(),G(this,e,Et,St,V,{value:0})}}function At(s){let e,t=le(s[0])+"",l;return{c(){e=E("span"),l=F(t),this.h()},l(n){e=A(n,"SPAN",{class:!0});var o=P(e);l=U(o,t),o.forEach(_),this.h()},h(){c(e,"class","svelte-1vqihm9")},m(n,o){N(n,e,o),M(e,l)},p(n,[o]){o&1&&t!==(t=le(n[0])+"")&&j(l,t)},i:w,o:w,d(n){n&&_(e)}}}function It(s,e,t){let{value:l}=e;return s.$$set=n=>{"value"in n&&t(0,l=n.value)},[l]}class is extends R{constructor(e){super(),G(this,e,It,At,V,{value:0})}}function Tt(s){let e,t=me(s[0])+"",l;return{c(){e=E("span"),l=F(t),this.h()},l(n){e=A(n,"SPAN",{"data-testid":!0,class:!0});var o=P(e);l=U(o,t),o.forEach(_),this.h()},h(){c(e,"data-testid","score"),c(e,"class","codicon codicon-heart svelte-te86f3")},m(n,o){N(n,e,o),M(e,l)},p(n,[o]){o&1&&t!==(t=me(n[0])+"")&&j(l,t)},i:w,o:w,d(n){n&&_(e)}}}function Nt(s,e,t){let{value:l}=e;return s.$$set=n=>{"value"in n&&t(0,l=n.value)},[l]}class os extends R{constructor(e){super(),G(this,e,Nt,Tt,V,{value:0})}}function ve(s){let e,t,l,n,o;return{c(){e=E("a"),t=E("i"),l=O(),n=F(s[1]),this.h()},l(a){e=A(a,"A",{href:!0,target:!0,class:!0});var i=P(e);t=A(i,"I",{class:!0}),P(t).forEach(_),l=B(i),n=U(i,s[1]),i.forEach(_),this.h()},h(){c(t,"class","codicon codicon-link"),c(e,"href",o=s[0].toString()),c(e,"target","_newtab"),c(e,"class","svelte-1orztco")},m(a,i){N(a,e,i),M(e,t),M(e,l),M(e,n)},p(a,i){i&2&&j(n,a[1]),i&1&&o!==(o=a[0].toString())&&c(e,"href",o)},d(a){a&&_(e)}}}function Dt(s){let e,t=s[0]&&ve(s);return{c(){t&&t.c(),e=J()},l(l){t&&t.l(l),e=J()},m(l,n){t&&t.m(l,n),N(l,e,n)},p(l,[n]){l[0]?t?t.p(l,n):(t=ve(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:w,o:w,d(l){l&&_(e),t&&t.d(l)}}}function Mt(s,e,t){let l,n,{source:o}=e;return s.$$set=a=>{"source"in a&&t(2,o=a.source)},s.$$.update=()=>{var a;s.$$.dirty&4&&t(0,l=it(o)?new URL(o):null),s.$$.dirty&1&&t(1,n=(a=l==null?void 0:l.hostname)==null?void 0:a.replace(/^www./,""))},[l,n,o]}class cs extends R{constructor(e){super(),G(this,e,Mt,Dt,V,{source:2})}}function Pt(s){let e,t,l;return{c(){e=E("a"),t=E("i"),l=F(" File"),this.h()},l(n){e=A(n,"A",{href:!0,target:!0,class:!0});var o=P(e);t=A(o,"I",{class:!0}),P(t).forEach(_),l=U(o," File"),o.forEach(_),this.h()},h(){c(t,"class","codicon codicon-file"),c(e,"href",s[0]),c(e,"target","_newtab"),c(e,"class","svelte-1orztco")},m(n,o){N(n,e,o),M(e,t),M(e,l)},p(n,[o]){o&1&&c(e,"href",n[0])},i:w,o:w,d(n){n&&_(e)}}}function Ct(s,e,t){let{url:l}=e;return s.$$set=n=>{"url"in n&&t(0,l=n.url)},[l]}class us extends R{constructor(e){super(),G(this,e,Ct,Pt,V,{url:0})}}function ke(s,e,t){const l=s.slice();l[4]=e[t];const n=l[1].find(function(...a){return s[3](l[4],...a)})!==void 0;return l[5]=n,l}function we(s){let e,t;function l(){return s[2](s[5],s[4])}return e=new ot({props:{tag:s[4],active:s[5]}}),e.$on("click",l),{c(){Z(e.$$.fragment)},l(n){Y(e.$$.fragment,n)},m(n,o){x(e,n,o),t=!0},p(n,o){s=n;const a={};o&1&&(a.tag=s[4]),o&3&&(a.active=s[5]),e.$set(a)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){L(e.$$.fragment,n),t=!1},d(n){$(e,n)}}}function Lt(s){let e,t,l=ne(s[0]),n=[];for(let a=0;a<l.length;a+=1)n[a]=we(ke(s,l,a));const o=a=>L(n[a],1,1,()=>{n[a]=null});return{c(){e=E("ul");for(let a=0;a<n.length;a+=1)n[a].c();this.h()},l(a){e=A(a,"UL",{class:!0});var i=P(e);for(let r=0;r<n.length;r+=1)n[r].l(i);i.forEach(_),this.h()},h(){c(e,"class","tags svelte-b5q4us")},m(a,i){N(a,e,i);for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(e,null);t=!0},p(a,[i]){if(i&3){l=ne(a[0]);let r;for(r=0;r<l.length;r+=1){const u=ke(a,l,r);n[r]?(n[r].p(u,i),C(n[r],1)):(n[r]=we(u),n[r].c(),C(n[r],1),n[r].m(e,null))}for(ae(),r=l.length;r<n.length;r+=1)o(r);re()}},i(a){if(!t){for(let i=0;i<l.length;i+=1)C(n[i]);t=!0}},o(a){n=n.filter(Boolean);for(let i=0;i<n.length;i+=1)L(n[i]);t=!1},d(a){a&&_(e),Te(n,a)}}}function Vt(s,e,t){let l;Ye(s,ie,i=>t(1,l=i));let{tags:n}=e;const o=(i,r)=>i?ie.removeByName(r.name):ie.addOrReplace({...r,modifier:"+"}),a=(i,r)=>r.name===i.name;return s.$$set=i=>{"tags"in i&&t(0,n=i.tags)},[n,l,o,a]}class fs extends R{constructor(e){super(),G(this,e,Vt,Lt,V,{tags:0})}}const Ce=s=>s.endsWith(".gif"),Rt=(s,e,t)=>Ce(e)?{static:t,animated:e}:{static:e,animated:s},Le=s=>s.endsWith(".mp4")||s.endsWith(".webm"),hs=(s,e,t)=>Le(e)?{static:t,animated:e}:{static:e,animated:s},_s=s=>s.some(e=>e.name==="loop"),ds=s=>Ce(s)||Le(s),Gt="1250px",K=new IntersectionObserver(s=>{var e;for(const t of s){const l=t.isIntersecting?t.target.getAttribute("data-src")??"":"";(e=t==null?void 0:t.target)==null||e.setAttribute("src",l)}},{rootMargin:Gt}),Ve=s=>(K==null||K.observe(s),{destroy(){K==null||K.unobserve(s)}});function Ft(s){let e,t,l,n,o,a,i,r;return{c(){e=E("div"),t=E("img"),this.h()},l(u){e=A(u,"DIV",{class:!0});var f=P(e);t=A(f,"IMG",{class:!0,loading:!0,"data-src":!0,alt:!0,style:!0,width:!0,height:!0,tabindex:!0}),f.forEach(_),this.h()},h(){c(t,"class","post-media svelte-jjbbut"),c(t,"loading","lazy"),c(t,"data-src",s[2]),c(t,"alt",l=s[0].id.toString()),c(t,"style",n=`aspect-ratio: ${s[0].width} / ${s[0].height}`),c(t,"width",o=s[0].width),c(t,"height",a=s[0].height),c(t,"tabindex","0"),c(e,"class","svelte-jjbbut"),z(e,"expandable",s[3]),z(e,"open",s[1])},m(u,f){N(u,e,f),M(e,t),i||(r=[D(t,"click",s[4]),D(t,"keydown",Me),D(t,"error",s[5],{once:!0}),Ne(Ve.call(null,t))],i=!0)},p(u,[f]){f&4&&c(t,"data-src",u[2]),f&1&&l!==(l=u[0].id.toString())&&c(t,"alt",l),f&1&&n!==(n=`aspect-ratio: ${u[0].width} / ${u[0].height}`)&&c(t,"style",n),f&1&&o!==(o=u[0].width)&&c(t,"width",o),f&1&&a!==(a=u[0].height)&&c(t,"height",a),f&2&&z(e,"open",u[1])},i:w,o:w,d(u){u&&_(e),i=!1,ce(r)}}}function Ut(s,e,t){let l,{post:n}=e;const a=n.width/n.height<.33;let i;const r=()=>t(1,i=!i),u=f=>f.target.src=`${ee}/assets/failed-to-load.svg`;return s.$$set=f=>{"post"in f&&t(0,n=f.post)},s.$$.update=()=>{s.$$.dirty&1&&t(2,l=ct?n.file_url:n.sample_url)},[n,i,l,a,r,u]}class ms extends R{constructor(e){super(),G(this,e,Ut,Ft,V,{post:0})}}const Se=s=>{if(typeof s!="number")throw new TypeError(`Attempted to call formatVideoTime with invalid value: ${s}`);const e=Math.floor(s),t=e%60,l=Math.floor(e/60);return`${Ee(l)}:${Ee(t)}`},Ee=s=>{const e=String(s),t=Math.max(0,2-e.length);return`${"0".repeat(t)}${e}`};function jt(s){let e,t;return{c(){e=E("img"),this.h()},l(l){e=A(l,"IMG",{src:!0,alt:!0,width:!0,height:!0,style:!0}),this.h()},h(){Q(e.src,t=ee+"/assets/play.svg")||c(e,"src",t),c(e,"alt","Start GIF"),c(e,"width","16"),c(e,"height","32"),oe(e,"margin-left","4px")},m(l,n){N(l,e,n)},d(l){l&&_(e)}}}function zt(s){let e,t;return{c(){e=E("img"),this.h()},l(l){e=A(l,"IMG",{src:!0,alt:!0,width:!0,height:!0}),this.h()},h(){Q(e.src,t=ee+"/assets/pause.svg")||c(e,"src",t),c(e,"alt","Stop GIF"),c(e,"width","16"),c(e,"height","32")},m(l,n){N(l,e,n)},d(l){l&&_(e)}}}function Ot(s){let e,t;return{c(){e=E("img"),this.h()},l(l){e=A(l,"IMG",{src:!0,alt:!0,width:!0,height:!0}),this.h()},h(){Q(e.src,t=ee+"/assets/load.svg")||c(e,"src",t),c(e,"alt","Loading GIF"),c(e,"width","16"),c(e,"height","32")},m(l,n){N(l,e,n)},d(l){l&&_(e)}}}function Bt(s){let e,t,l,n;function o(r,u){return r[1]?Ot:r[0]?zt:jt}let a=o(s),i=a(s);return{c(){e=E("button"),i.c(),this.h()},l(r){e=A(r,"BUTTON",{type:!0,class:!0});var u=P(e);i.l(u),u.forEach(_),this.h()},h(){c(e,"type","button"),c(e,"class",t=ue(s[2].class)+" svelte-106eyjk")},m(r,u){N(r,e,u),i.m(e,null),l||(n=D(e,"click",s[3]),l=!0)},p(r,[u]){a!==(a=o(r))&&(i.d(1),i=a(r),i&&(i.c(),i.m(e,null))),u&4&&t!==(t=ue(r[2].class)+" svelte-106eyjk")&&c(e,"class",t)},i:w,o:w,d(r){r&&_(e),i.d(),l=!1,n()}}}function qt(s,e,t){let{playing:l}=e,{loading:n}=e;function o(a){De.call(this,s,a)}return s.$$set=a=>{t(2,e=te(te({},e),se(a))),"playing"in a&&t(0,l=a.playing),"loading"in a&&t(1,n=a.loading)},e=se(e),[l,n,e,o]}class Re extends R{constructor(e){super(),G(this,e,qt,Bt,V,{playing:0,loading:1})}}function Ae(s){let e,t,l,n=!0,o=!1,a,i,r,u=Se(s[16])+"",f,S,m,k,g,I,p,d,T;function b(){cancelAnimationFrame(a),e.paused||(a=at(b),o=!0),s[24].call(e)}return I=new Re({props:{playing:s[5],loading:s[6],class:`center hidable ${s[13]?"hide":""}`}}),I.$on("click",s[19]),{c(){e=E("video"),i=O(),r=E("span"),f=F(u),S=O(),m=E("input"),g=O(),Z(I.$$.fragment),this.h()},l(h){e=A(h,"VIDEO",{tabindex:!0,poster:!0,src:!0,preload:!0,style:!0,class:!0}),P(e).forEach(_),i=B(h),r=A(h,"SPAN",{class:!0});var v=P(r);f=U(v,u),v.forEach(_),S=B(h),m=A(h,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0,style:!0}),g=B(h),Y(I.$$.fragment,h),this.h()},h(){c(e,"tabindex","0"),c(e,"poster",s[1]),e.loop=s[4],Q(e.src,t=s[0])||c(e,"src",t),c(e,"preload","metadata"),c(e,"style",l=`aspect-ratio: ${s[2]} / ${s[3]}`),c(e,"class","svelte-18n7cnr"),s[8]===void 0&&et(()=>s[25].call(e)),c(r,"class","hidable svelte-18n7cnr"),z(r,"hide",s[10]),c(m,"type","range"),c(m,"min",0),c(m,"max",s[8]),c(m,"step",.0166666),c(m,"class","hidable svelte-18n7cnr"),c(m,"style",k=`background-image: linear-gradient(90deg, var(--accent) ${s[14]}%, var(--background-2) ${s[14]}%);}`),z(m,"hide",s[13])},m(h,v){N(h,e,v),s[22](e),N(h,i,v),N(h,r,v),M(r,f),N(h,S,v),N(h,m,v),fe(m,s[7]),N(h,g,v),x(I,h,v),p=!0,d||(T=[D(e,"play",s[23]),D(e,"pause",s[23]),D(e,"timeupdate",b),D(e,"durationchange",s[25]),D(e,"waiting",s[26]),D(e,"playing",s[27]),D(e,"pause",s[28]),D(e,"ended",s[29]),D(e,"click",s[20]),D(e,"dblclick",tt(st(s[17]))),D(m,"change",s[30]),D(m,"input",s[30])],d=!0)},p(h,v){(!p||v[0]&2)&&c(e,"poster",h[1]),(!p||v[0]&16)&&(e.loop=h[4]),(!p||v[0]&1&&!Q(e.src,t=h[0]))&&c(e,"src",t),(!p||v[0]&12&&l!==(l=`aspect-ratio: ${h[2]} / ${h[3]}`))&&c(e,"style",l),v[0]&32768&&n!==(n=h[15])&&e[n?"pause":"play"](),!o&&v[0]&128&&!isNaN(h[7])&&(e.currentTime=h[7]),o=!1,(!p||v[0]&65536)&&u!==(u=Se(h[16])+"")&&j(f,u),(!p||v[0]&1024)&&z(r,"hide",h[10]),(!p||v[0]&256)&&c(m,"max",h[8]),(!p||v[0]&16384&&k!==(k=`background-image: linear-gradient(90deg, var(--accent) ${h[14]}%, var(--background-2) ${h[14]}%);}`))&&c(m,"style",k),v[0]&128&&fe(m,h[7]),(!p||v[0]&8192)&&z(m,"hide",h[13]);const q={};v[0]&32&&(q.playing=h[5]),v[0]&64&&(q.loading=h[6]),v[0]&8192&&(q.class=`center hidable ${h[13]?"hide":""}`),I.$set(q)},i(h){p||(C(I.$$.fragment,h),p=!0)},o(h){L(I.$$.fragment,h),p=!1},d(h){h&&(_(e),_(i),_(r),_(S),_(m),_(g)),s[22](null),$(I,h),d=!1,ce(T)}}}function Wt(s){let e,t,l,n,o,a=s[9]&&Ae(s);return{c(){e=E("div"),a&&a.c(),this.h()},l(i){e=A(i,"DIV",{class:!0,style:!0});var r=P(e);a&&a.l(r),r.forEach(_),this.h()},h(){c(e,"class",t="post-media player "+s[21].class+" svelte-18n7cnr"),oe(e,"aspect-ratio",s[2]+"/"+s[3])},m(i,r){N(i,e,r),a&&a.m(e,null),s[31](e),l=!0,n||(o=D(e,"keydown",s[18]),n=!0)},p(i,r){i[9]?a?(a.p(i,r),r[0]&512&&C(a,1)):(a=Ae(i),a.c(),C(a,1),a.m(e,null)):a&&(ae(),L(a,1,1,()=>{a=null}),re()),(!l||r[0]&2097152&&t!==(t="post-media player "+i[21].class+" svelte-18n7cnr"))&&c(e,"class",t),(!l||r[0]&12)&&oe(e,"aspect-ratio",i[2]+"/"+i[3])},i(i){l||(C(a),l=!0)},o(i){L(a),l=!1},d(i){i&&_(e),a&&a.d(),s[31](null),n=!1,o()}}}const Ie=5;function Ht(s,e,t){let l,n,o,a,{src:i}=e,{poster:r}=e,{width:u}=e,{height:f}=e,{loop:S}=e,m,k,g=!1,I=!1,p=0,d=0,T=!1,b=!1;const h=()=>{t(7,p=Math.max(0,p-Ie))},v=()=>{t(7,p=Math.min(d,p+Ie))},q=y=>{y.offsetX<y.target.clientWidth/2?h():v()},Ge=y=>{Pe(y)||y.key==="k"?(y.preventDefault(),t(5,g=!g)):y.key==="ArrowLeft"||y.key==="j"?h():(y.key==="ArrowRight"||y.key==="l")&&v()},W=new IntersectionObserver(y=>{for(const Xe of y)Xe.isIntersecting?t(9,T=!0):k&&(t(5,g=!1),t(6,I=!1),k.addEventListener("error",()=>{t(9,T=!1)},{once:!0}),t(12,k.src="",k))},{rootMargin:"0px"}),Fe=()=>{t(5,g=!g),t(6,I=!0),t(10,b=g)},Ue=()=>{t(10,b=!b)};xe(()=>W==null?void 0:W.observe(m)),$e(()=>W==null?void 0:W.unobserve(m));function je(y){X[y?"unshift":"push"](()=>{k=y,t(12,k)})}function ze(){n=this.paused,t(15,n),t(5,g),t(9,T)}function Oe(){p=this.currentTime,t(7,p)}function Be(){d=this.duration,t(8,d)}const qe=()=>t(6,I=!0),We=()=>t(6,I=!1),He=()=>t(6,I=!1),Ke=()=>{S||(t(6,I=!1),t(5,g=!1))};function Je(){p=nt(this.value),t(7,p)}function Qe(y){X[y?"unshift":"push"](()=>{m=y,t(11,m)})}return s.$$set=y=>{t(21,e=te(te({},e),se(y))),"src"in y&&t(0,i=y.src),"poster"in y&&t(1,r=y.poster),"width"in y&&t(2,u=y.width),"height"in y&&t(3,f=y.height),"loop"in y&&t(4,S=y.loop)},s.$$.update=()=>{s.$$.dirty[0]&384&&t(16,l=d-p),s.$$.dirty[0]&544&&t(5,g=T&&g),s.$$.dirty[0]&32&&t(15,n=!g),s.$$.dirty[0]&384&&t(14,o=p/d*98+1),s.$$.dirty[0]&1120&&t(13,a=g&&!I&&b)},e=se(e),[i,r,u,f,S,g,I,p,d,T,b,m,k,a,o,n,l,q,Ge,Fe,Ue,e,je,ze,Oe,Be,qe,We,He,Ke,Je,Qe]}class gs extends R{constructor(e){super(),G(this,e,Ht,Wt,V,{src:0,poster:1,width:2,height:3,loop:4},null,[-1,-1])}}function Kt(s){let e,t,l,n,o,a,i,r,u,f,S,m,k;function g(d){s[13](d)}function I(d){s[14](d)}let p={class:"center"};return s[2]!==void 0&&(p.playing=s[2]),s[3]!==void 0&&(p.loading=s[3]),i=new Re({props:p}),X.push(()=>de(i,"playing",g)),X.push(()=>de(i,"loading",I)),i.$on("click",s[15]),{c(){e=E("div"),t=E("img"),a=O(),Z(i.$$.fragment),this.h()},l(d){e=A(d,"DIV",{class:!0,style:!0});var T=P(e);t=A(T,"IMG",{class:!0,loading:!0,"data-src":!0,alt:!0,width:!0,height:!0,tabindex:!0}),a=B(T),Y(i.$$.fragment,T),T.forEach(_),this.h()},h(){c(t,"class","post-media media-img svelte-158nmsy"),c(t,"loading","lazy"),c(t,"data-src",s[4]),c(t,"alt",l=s[0].id.toString()),c(t,"width",n=s[0].width),c(t,"height",o=s[0].height),c(t,"tabindex","0"),c(e,"class","container svelte-158nmsy"),c(e,"style",f=`aspect-ratio: ${s[0].width} / ${s[0].height}`)},m(d,T){N(d,e,T),M(e,t),s[9](t),M(e,a),x(i,e,null),S=!0,m||(k=[D(t,"click",s[8]),D(t,"keydown",s[10]),D(t,"load",s[11]),D(t,"error",s[12],{once:!0}),Ne(Ve.call(null,t))],m=!0)},p(d,[T]){(!S||T&16)&&c(t,"data-src",d[4]),(!S||T&1&&l!==(l=d[0].id.toString()))&&c(t,"alt",l),(!S||T&1&&n!==(n=d[0].width))&&c(t,"width",n),(!S||T&1&&o!==(o=d[0].height))&&c(t,"height",o);const b={};!r&&T&4&&(r=!0,b.playing=d[2],he(()=>r=!1)),!u&&T&8&&(u=!0,b.loading=d[3],he(()=>u=!1)),i.$set(b),(!S||T&1&&f!==(f=`aspect-ratio: ${d[0].width} / ${d[0].height}`))&&c(e,"style",f)},i(d){S||(C(i.$$.fragment,d),S=!0)},o(d){L(i.$$.fragment,d),S=!1},d(d){d&&_(e),s[9](null),$(i),m=!1,ce(k)}}}function Jt(s,e,t){let l,n,o,a,{post:i}=e,r,u=!1,f=!1;function S(b){De.call(this,s,b)}function m(b){X[b?"unshift":"push"](()=>{r=b,t(1,r),t(2,u),t(6,n),t(5,o),t(7,l),t(0,i)})}const k=b=>{Me(b),Pe(b)&&(b.preventDefault(),t(3,f=!0),t(2,u=!u))},g=()=>t(3,f=!1),I=b=>{t(3,f=!1),b.target.src=`${ee}/assets/failed-to-load.svg`};function p(b){u=b,t(2,u)}function d(b){f=b,t(3,f)}const T=()=>{t(3,f=!0),t(2,u=!u)};return s.$$set=b=>{"post"in b&&t(0,i=b.post)},s.$$.update=()=>{s.$$.dirty&1&&t(7,l=Rt(i.file_url,i.sample_url,i.preview_url)),s.$$.dirty&128&&t(6,n=l.animated),s.$$.dirty&128&&t(5,o=l.static),s.$$.dirty&100&&t(4,a=u?n:o),s.$$.dirty&102&&r&&t(1,r.src=u?n:o,r)},[i,r,u,f,a,o,n,l,S,m,k,g,I,p,d,T]}class ps extends R{constructor(e){super(),G(this,e,Jt,Kt,V,{post:0})}}export{as as C,cs as E,ps as G,ms as I,fs as P,rs as R,os as S,gs as V,is as a,us as b,Rt as c,_s as d,hs as g,ds as i};
