import{s as fe,D as Ve,f as S,a as N,g as I,h as A,y as ae,c as T,d as g,j as m,r as zt,i as O,u as _,E as He,F as Ie,G as Qe,H as ct,l as ce,m as ue,v as Q,I as ke,w as nn,J as sn,z as ln,A as rn,B as on,o as rt,K as ot,p as Oe,n as Me,e as we,k as Le,C as me,L as et,M as nt,N as at,O as an,P as Gt,Q as ft}from"../chunks/scheduler.32f194ce.js";import{S as pe,i as _e,b as V,d as R,m as F,a as v,t as b,e as M,g as oe,c as ie,f as tt,h as cn}from"../chunks/index.aa0a4971.js";import{e as De}from"../chunks/each.e59479a4.js";import{D as Ut,r as qt}from"../chunks/result-columns-store.456395b2.js";import{T as We}from"../chunks/TextButton.bf64be78.js";import{D as un}from"../chunks/DetailedTag.42657508.js";import{K as fn,A as pn}from"../chunks/ActiveTagList.a34015b3.js";import{b as Ht}from"../chunks/paths.94c687ba.js";import{f as st}from"../chunks/format-tag.7e313273.js";import{r as Ke,a as ut}from"../chunks/active-supertags-store.191bceb4.js";import{I as Kt,R as _n}from"../chunks/ModifierSelect.b17e978c.js";import{h as pt,u as dn}from"../chunks/await_block.af8be678.js";import{L as Wt}from"../chunks/LoadingAnimation.1752780f.js";import{R as mn,S as gn,a as hn,K as $n,E as Qt,b as vn,g as _t,P as bn,C as kn,c as wn,d as Yt,i as yn,e as Zt,D as Cn,G as En,V as Sn,f as dt,I as In}from"../chunks/Details.9e2ec106.js";import{a as Dn}from"../chunks/always-loop-store.79351e6e.js";import{f as Fe,s as Be,S as Pn}from"../chunks/search-builder.8e7a2c78.js";import{S as mt}from"../chunks/Select.86ea1f7f.js";import{R as Nn}from"../chunks/RotatingTextSelect.068e75cb.js";import{S as Tn}from"../chunks/Searchbar.f617b69a.js";import{S as On}from"../chunks/ScrollUpButton.7d16a589.js";import{g as An,a as Vn}from"../chunks/tags.49324235.js";import{l as Rn}from"../chunks/analytics.b280da65.js";import{n as Fn,s as gt}from"../chunks/supertags-store.5b66bb0f.js";import{a as it}from"../chunks/active-tags-store.b6c3d1de.js";import{b as Mn}from"../chunks/blocked-content-store.4020ee6a.js";import{c as Jt}from"../chunks/cookies-accepted-store.156ac03f.js";function ht(l,e,n){const t=l.slice();return t[9]=e[n],t}function $t(l){let e,n;return e=new un({props:{tag:l[9]}}),{c(){V(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p(t,s){const o={};s&4&&(o.tag=t[9]),e.$set(o)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function Ln(l){let e;return{c(){e=ce("Create supertag")},l(n){e=ue(n,"Create supertag")},m(n,t){O(n,e,t)},d(n){n&&g(e)}}}function Bn(l){let e,n,t="Create Supertag",s,o,r,a,i,u="Name",c,f,d,E,C,k="Description",$,p,h,w,y,D="Tags",B,K,Z,ee,se,le,P,X,q=De(l[2]),L=[];for(let j=0;j<q.length;j+=1)L[j]=$t(ht(l,q,j));const ne=j=>b(L[j],1,1,()=>{L[j]=null});return se=new We({props:{title:l[3]?"Click to create supertag":"Enter a valid name to continue",disabled:!l[3],$$slots:{default:[Ln]},$$scope:{ctx:l}}}),se.$on("click",l[8]),{c(){e=S("section"),n=S("h3"),n.textContent=t,s=N(),o=S("button"),r=N(),a=S("div"),i=S("label"),i.textContent=u,c=N(),f=S("input"),d=N(),E=S("div"),C=S("label"),C.textContent=k,$=N(),p=S("input"),h=N(),w=S("div"),y=S("span"),y.textContent=D,B=N(),K=S("ol");for(let j=0;j<L.length;j+=1)L[j].c();Z=N(),ee=S("div"),V(se.$$.fragment),this.h()},l(j){e=I(j,"SECTION",{class:!0});var z=A(e);n=I(z,"H3",{"data-svelte-h":!0}),ae(n)!=="svelte-ho1cwx"&&(n.textContent=t),s=T(z),o=I(z,"BUTTON",{class:!0}),A(o).forEach(g),r=T(z),a=I(z,"DIV",{class:!0});var x=A(a);i=I(x,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),ae(i)!=="svelte-10k8a68"&&(i.textContent=u),c=T(x),f=I(x,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),x.forEach(g),d=T(z),E=I(z,"DIV",{class:!0});var W=A(E);C=I(W,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),ae(C)!=="svelte-14n9kp6"&&(C.textContent=k),$=T(W),p=I(W,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),W.forEach(g),h=T(z),w=I(z,"DIV",{class:!0});var ge=A(w);y=I(ge,"SPAN",{class:!0,"data-svelte-h":!0}),ae(y)!=="svelte-7hjyox"&&(y.textContent=D),B=T(ge),K=I(ge,"OL",{class:!0});var he=A(K);for(let Ee=0;Ee<L.length;Ee+=1)L[Ee].l(he);he.forEach(g),ge.forEach(g),Z=T(z),ee=I(z,"DIV",{class:!0});var Ae=A(ee);R(se.$$.fragment,Ae),Ae.forEach(g),z.forEach(g),this.h()},h(){m(o,"class",zt("codicon codicon-close")+" svelte-1x6vc81"),m(i,"for","supertag-name"),m(i,"class","svelte-1x6vc81"),m(f,"type","text"),m(f,"placeholder","Descriptive name"),m(f,"id","supertag-name"),m(f,"class","svelte-1x6vc81"),m(a,"class","svelte-1x6vc81"),m(C,"for","supertag-description"),m(C,"class","svelte-1x6vc81"),m(p,"type","text"),m(p,"placeholder","Short description"),m(p,"id","supertag-description"),m(p,"class","svelte-1x6vc81"),m(E,"class","svelte-1x6vc81"),m(y,"class","svelte-1x6vc81"),m(K,"class","svelte-1x6vc81"),m(w,"class","svelte-1x6vc81"),m(ee,"class","last svelte-1x6vc81"),m(e,"class","svelte-1x6vc81")},m(j,z){O(j,e,z),_(e,n),_(e,s),_(e,o),_(e,r),_(e,a),_(a,i),_(a,c),_(a,f),He(f,l[0]),_(e,d),_(e,E),_(E,C),_(E,$),_(E,p),He(p,l[1]),_(e,h),_(e,w),_(w,y),_(w,B),_(w,K);for(let x=0;x<L.length;x+=1)L[x]&&L[x].m(K,null);_(e,Z),_(e,ee),F(se,ee,null),le=!0,P||(X=[Ie(o,"click",l[5]),Ie(f,"input",l[6]),Ie(p,"input",l[7])],P=!0)},p(j,z){if(z&1&&f.value!==j[0]&&He(f,j[0]),z&2&&p.value!==j[1]&&He(p,j[1]),z&4){q=De(j[2]);let W;for(W=0;W<q.length;W+=1){const ge=ht(j,q,W);L[W]?(L[W].p(ge,z),v(L[W],1)):(L[W]=$t(ge),L[W].c(),v(L[W],1),L[W].m(K,null))}for(oe(),W=q.length;W<L.length;W+=1)ne(W);ie()}const x={};z&8&&(x.title=j[3]?"Click to create supertag":"Enter a valid name to continue"),z&8&&(x.disabled=!j[3]),z&4096&&(x.$$scope={dirty:z,ctx:j}),se.$set(x)},i(j){if(!le){for(let z=0;z<q.length;z+=1)v(L[z]);v(se.$$.fragment,j),le=!0}},o(j){L=L.filter(Boolean);for(let z=0;z<L.length;z+=1)b(L[z]);b(se.$$.fragment,j),le=!1},d(j){j&&g(e),Qe(L,j),M(se),P=!1,ct(X)}}}function jn(l){let e,n;return e=new Ut({props:{$$slots:{default:[Bn]},$$scope:{ctx:l}}}),e.$on("close",l[5]),{c(){V(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p(t,[s]){const o={};s&4111&&(o.$$scope={dirty:s,ctx:t}),e.$set(o)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function zn(l,e,n){let t,{name:s=""}=e,{description:o=""}=e,{tags:r}=e;const a=Ve(),i=()=>a("close");function u(){s=this.value,n(0,s)}function c(){o=this.value,n(1,o)}const f=()=>{a("submit",{name:s,description:o,tags:r.map(({modifier:d,name:E})=>({modifier:d,name:E}))}),i()};return l.$$set=d=>{"name"in d&&n(0,s=d.name),"description"in d&&n(1,o=d.description),"tags"in d&&n(2,r=d.tags)},l.$$.update=()=>{l.$$.dirty&5&&n(3,t=typeof s=="string"&&s!==""&&r.length>1)},[s,o,r,t,a,i,u,c,f]}class Gn extends pe{constructor(e){super(),_e(this,e,zn,jn,fe,{name:0,description:1,tags:2})}}function Un(l){let e,n,t,s,o,r,a,i,u,c;return{c(){e=S("div"),n=S("div"),t=S("i"),s=N(),o=S("div"),r=S("h3"),a=ce(l[0]),i=N(),u=S("span"),c=ce(l[2]),this.h()},l(f){e=I(f,"DIV",{class:!0});var d=A(e);n=I(d,"DIV",{class:!0});var E=A(n);t=I(E,"I",{class:!0}),A(t).forEach(g),E.forEach(g),s=T(d),o=I(d,"DIV",{});var C=A(o);r=I(C,"H3",{class:!0});var k=A(r);a=ue(k,l[0]),k.forEach(g),i=T(C),u=I(C,"SPAN",{});var $=A(u);c=ue($,l[2]),$.forEach(g),C.forEach(g),d.forEach(g),this.h()},h(){m(t,"class",zt(l[1])+" svelte-1yohziu"),m(n,"class","icon svelte-1yohziu"),m(r,"class","svelte-1yohziu"),m(e,"class","error svelte-1yohziu")},m(f,d){O(f,e,d),_(e,n),_(n,t),_(e,s),_(e,o),_(o,r),_(r,a),_(o,i),_(o,u),_(u,c)},p:Q,i:Q,o:Q,d(f){f&&g(e)}}}function qn(l,e,n){let{error:t}=e,s=t.message==="Failed to fetch"?"Connection Error":"Application Error",o=t.message==="Failed to fetch"?"codicon codicon-debug-disconnect":"codicon codicon-error",r=t.message==="Failed to fetch"?"Failed to connect to the server. Make sure you have a stable internet connection.":t.message;return l.$$set=a=>{"error"in a&&n(3,t=a.error)},[s,o,r,t]}class Hn extends pe{constructor(e){super(),_e(this,e,qn,Un,fe,{error:3})}}function Kn(l){let e,n,t,s,o="You have seen everything there is to see...";return{c(){e=S("img"),t=N(),s=S("p"),s.textContent=o,this.h()},l(r){e=I(r,"IMG",{src:!0,alt:!0,class:!0}),t=T(r),s=I(r,"P",{"data-svelte-h":!0}),ae(s)!=="svelte-1i75mtf"&&(s.textContent=o),this.h()},h(){ke(e.src,n=Ht+"/assets/shironeko-x.png")||m(e,"src",n),m(e,"alt","No more results to load"),m(e,"class","svelte-1pkma0d")},m(r,a){O(r,e,a),O(r,t,a),O(r,s,a)},p:Q,i:Q,o:Q,d(r){r&&(g(e),g(t),g(s))}}}class Wn extends pe{constructor(e){super(),_e(this,e,null,Kn,fe,{})}}const lt=l=>`post_${l}`;function Qn(l){let e,n,t,s;const o=l[3].default,r=nn(o,l,l[2],null);return{c(){e=S("div"),r&&r.c(),this.h()},l(a){e=I(a,"DIV",{role:!0,tabindex:!0,class:!0});var i=A(e);r&&r.l(i),i.forEach(g),this.h()},h(){m(e,"role","none"),m(e,"tabindex","-1"),m(e,"class","svelte-6sy8qz")},m(a,i){O(a,e,i),r&&r.m(e,null),l[4](e),n=!0,t||(s=[Ie(e,"click",sn(Yn)),Ie(e,"keydown",l[1])],t=!0)},p(a,[i]){r&&r.p&&(!n||i&4)&&ln(r,o,a,a[2],n?on(o,a[2],i,null):rn(a[2]),null)},i(a){n||(v(r,a),n=!0)},o(a){b(r,a),n=!1},d(a){a&&g(e),r&&r.d(a),l[4](null),t=!1,ct(s)}}}const Yn=()=>{};function Zn(l,e,n){let{$$slots:t={},$$scope:s}=e;const o=Ve(),r=()=>o("close"),a=f=>{f.key==="Escape"&&r()},i=()=>{document.fullscreenElement||r()};let u;rt(async()=>{u.focus(),document.addEventListener("fullscreenchange",i);try{await u.requestFullscreen()}catch{}}),ot(async()=>{document.removeEventListener("fullscreenchange",i);try{await document.exitFullscreen()}catch{}});function c(f){Oe[f?"unshift":"push"](()=>{u=f,n(0,u)})}return l.$$set=f=>{"$$scope"in f&&n(2,s=f.$$scope)},[u,a,s,t,c]}class Jn extends pe{constructor(e){super(),_e(this,e,Zn,Qn,fe,{})}}function Xn(l){let e,n;return{c(){e=S("div"),this.h()},l(t){e=I(t,"DIV",{style:!0}),A(e).forEach(g),this.h()},h(){m(e,"style",n=l[0]?`position:absolute;top:${l[0]};`:void 0)},m(t,s){O(t,e,s),l[3](e)},p(t,[s]){s&1&&n!==(n=t[0]?`position:absolute;top:${t[0]};`:void 0)&&m(e,"style",n)},i:Q,o:Q,d(t){t&&g(e),l[3](null)}}}function xn(l,e,n){let{rootMargin:t}=e,{absoluteTop:s}=e;console.log("creating intersection observer: ",t);const o=Ve(),r=new IntersectionObserver(u=>{u[0].isIntersecting&&o("intersection")},{rootMargin:t});let a;function i(u){Oe[u?"unshift":"push"](()=>{a=u,n(1,a)})}return l.$$set=u=>{"rootMargin"in u&&n(2,t=u.rootMargin),"absoluteTop"in u&&n(0,s=u.absoluteTop)},l.$$.update=()=>{l.$$.dirty&2&&(r.disconnect(),a&&r.observe(a))},[s,a,t,i]}class Xt extends pe{constructor(e){super(),_e(this,e,xn,Xn,fe,{rootMargin:2,absoluteTop:0})}}function vt(l,e,n){const t=l.slice();return t[3]=e[n],t}function bt(l,e,n){const t=l.slice();return t[6]=e[n][0],t[7]=e[n][1],t}function kt(l){let e,n="•",t,s,o;return s=new Qt({props:{source:l[0].source}}),{c(){e=S("span"),e.textContent=n,t=N(),V(s.$$.fragment)},l(r){e=I(r,"SPAN",{"data-svelte-h":!0}),ae(e)!=="svelte-7hh8jk"&&(e.textContent=n),t=T(r),R(s.$$.fragment,r)},m(r,a){O(r,e,a),O(r,t,a),F(s,r,a),o=!0},p(r,a){const i={};a&1&&(i.source=r[0].source),s.$set(i)},i(r){o||(v(s.$$.fragment,r),o=!0)},o(r){b(s.$$.fragment,r),o=!1},d(r){r&&(g(e),g(t)),M(s,r)}}}function wt(l){let e,n=l[6]+"",t,s,o,r;return o=new bn({props:{tags:l[7]}}),{c(){e=S("h3"),t=ce(n),s=N(),V(o.$$.fragment),this.h()},l(a){e=I(a,"H3",{class:!0});var i=A(e);t=ue(i,n),i.forEach(g),s=T(a),R(o.$$.fragment,a),this.h()},h(){m(e,"class","svelte-1kekodt")},m(a,i){O(a,e,i),_(e,t),O(a,s,i),F(o,a,i),r=!0},p(a,i){(!r||i&2)&&n!==(n=a[6]+"")&&Me(t,n);const u={};i&2&&(u.tags=a[7]),o.$set(u)},i(a){r||(v(o.$$.fragment,a),r=!0)},o(a){b(o.$$.fragment,a),r=!1},d(a){a&&(g(e),g(s)),M(o,a)}}}function es(l){return{c:Q,l:Q,m:Q,p:Q,i:Q,o:Q,d:Q}}function ts(l){let e,n,t,s;const o=[ss,ns],r=[];function a(i,u){return i[2].length>0?0:1}return e=a(l),n=r[e]=o[e](l),{c(){n.c(),t=we()},l(i){n.l(i),t=we()},m(i,u){r[e].m(i,u),O(i,t,u),s=!0},p(i,u){let c=e;e=a(i),e===c?r[e].p(i,u):(oe(),b(r[c],1,1,()=>{r[c]=null}),ie(),n=r[e],n?n.p(i,u):(n=r[e]=o[e](i),n.c()),v(n,1),n.m(t.parentNode,t))},i(i){s||(v(n),s=!0)},o(i){b(n),s=!1},d(i){i&&g(t),r[e].d(i)}}}function ns(l){let e,n="Comments for this post are not available";return{c(){e=S("span"),e.textContent=n,this.h()},l(t){e=I(t,"SPAN",{class:!0,"data-svelte-h":!0}),ae(e)!=="svelte-4t2lxe"&&(e.textContent=n),this.h()},h(){m(e,"class","no-comments svelte-1kekodt")},m(t,s){O(t,e,s)},p:Q,i:Q,o:Q,d(t){t&&g(e)}}}function ss(l){let e,n,t=De(l[2]),s=[];for(let r=0;r<t.length;r+=1)s[r]=yt(vt(l,t,r));const o=r=>b(s[r],1,1,()=>{s[r]=null});return{c(){e=S("ul");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){e=I(r,"UL",{class:!0});var a=A(e);for(let i=0;i<s.length;i+=1)s[i].l(a);a.forEach(g),this.h()},h(){m(e,"class","comments svelte-1kekodt")},m(r,a){O(r,e,a);for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(e,null);n=!0},p(r,a){if(a&1){t=De(r[2]);let i;for(i=0;i<t.length;i+=1){const u=vt(r,t,i);s[i]?(s[i].p(u,a),v(s[i],1)):(s[i]=yt(u),s[i].c(),v(s[i],1),s[i].m(e,null))}for(oe(),i=t.length;i<s.length;i+=1)o(i);ie()}},i(r){if(!n){for(let a=0;a<t.length;a+=1)v(s[a]);n=!0}},o(r){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)b(s[a]);n=!1},d(r){r&&g(e),Qe(s,r)}}}function yt(l){let e,n;return e=new kn({props:{comment:l[3]}}),{c(){V(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p(t,s){const o={};s&1&&(o.comment=t[3]),e.$set(o)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function ls(l){let e,n;return e=new Wt({}),{c(){V(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p:Q,i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function rs(l){let e,n,t,s,o,r,a,i,u=l[0].id+"",c,f,d,E,C,k,$="•",p,h,w=l[0].type.toUpperCase()+"",y,D,B,K="•",Z,ee,se,le,P="•",X,q,L,ne,j,z,x,W="•",ge,he,Ae,Ee,Ye="•",Ze,Pe,Je,je,Re,ze,G,Y,Te="Comments",Ne,Se,$e;E=new mn({props:{value:l[0].rating}}),ee=new gn({props:{value:l[0].score}}),q=new hn({props:{value:l[0].change}}),j=new $n({props:{url:"/post?id="+l[0].id+"&src="+encodeURIComponent(l[0].file_url)}}),he=new Qt({props:{source:"https://rule34.xxx/index.php?page=post&s=view&id="+l[0].id}}),Pe=new vn({props:{url:l[0].file_url}});let J=l[0].source&&kt(l),ye=De(Object.entries(l[1])),te=[];for(let H=0;H<ye.length;H+=1)te[H]=wt(bt(l,ye,H));const tn=H=>b(te[H],1,1,()=>{te[H]=null});let ve={ctx:l,current:null,token:null,hasCatch:!1,pending:ls,then:ts,catch:es,value:2,blocks:[,,,]};return pt(Se=_t(l[0].id),ve),{c(){e=S("div"),n=S("img"),s=N(),o=S("h1"),r=ce("Post "),a=S("b"),i=ce("#"),c=ce(u),f=N(),d=S("div"),V(E.$$.fragment),C=N(),k=S("span"),k.textContent=$,p=N(),h=S("span"),y=ce(w),D=N(),B=S("span"),B.textContent=K,Z=N(),V(ee.$$.fragment),se=N(),le=S("span"),le.textContent=P,X=N(),V(q.$$.fragment),L=N(),ne=S("div"),V(j.$$.fragment),z=N(),x=S("span"),x.textContent=W,ge=N(),V(he.$$.fragment),Ae=N(),Ee=S("span"),Ee.textContent=Ye,Ze=N(),V(Pe.$$.fragment),Je=N(),J&&J.c(),je=N(),Re=S("div");for(let H=0;H<te.length;H+=1)te[H].c();ze=N(),G=S("div"),Y=S("h3"),Y.textContent=Te,Ne=N(),ve.block.c(),this.h()},l(H){e=I(H,"DIV",{class:!0});var U=A(e);n=I(U,"IMG",{class:!0,src:!0,alt:!0}),s=T(U),o=I(U,"H1",{class:!0});var Ce=A(o);r=ue(Ce,"Post "),a=I(Ce,"B",{});var Ge=A(a);i=ue(Ge,"#"),c=ue(Ge,u),Ge.forEach(g),Ce.forEach(g),f=T(U),d=I(U,"DIV",{class:!0});var de=A(d);R(E.$$.fragment,de),C=T(de),k=I(de,"SPAN",{"data-svelte-h":!0}),ae(k)!=="svelte-7hh8jk"&&(k.textContent=$),p=T(de),h=I(de,"SPAN",{});var Xe=A(h);y=ue(Xe,w),Xe.forEach(g),D=T(de),B=I(de,"SPAN",{"data-svelte-h":!0}),ae(B)!=="svelte-7hh8jk"&&(B.textContent=K),Z=T(de),R(ee.$$.fragment,de),se=T(de),le=I(de,"SPAN",{"data-svelte-h":!0}),ae(le)!=="svelte-7hh8jk"&&(le.textContent=P),X=T(de),R(q.$$.fragment,de),de.forEach(g),L=T(U),ne=I(U,"DIV",{class:!0});var be=A(ne);R(j.$$.fragment,be),z=T(be),x=I(be,"SPAN",{"data-svelte-h":!0}),ae(x)!=="svelte-7hh8jk"&&(x.textContent=W),ge=T(be),R(he.$$.fragment,be),Ae=T(be),Ee=I(be,"SPAN",{"data-svelte-h":!0}),ae(Ee)!=="svelte-7hh8jk"&&(Ee.textContent=Ye),Ze=T(be),R(Pe.$$.fragment,be),Je=T(be),J&&J.l(be),be.forEach(g),je=T(U),Re=I(U,"DIV",{});var xe=A(Re);for(let Ue=0;Ue<te.length;Ue+=1)te[Ue].l(xe);xe.forEach(g),ze=T(U),G=I(U,"DIV",{});var re=A(G);Y=I(re,"H3",{class:!0,"data-svelte-h":!0}),ae(Y)!=="svelte-kc6sae"&&(Y.textContent=Te),Ne=T(re),ve.block.l(re),re.forEach(g),U.forEach(g),this.h()},h(){m(n,"class","preview svelte-1kekodt"),ke(n.src,t=l[0].sample_url)||m(n,"src",t),m(n,"alt","preview"),m(o,"class","svelte-1kekodt"),m(d,"class","flex-row svelte-1kekodt"),m(ne,"class","flex-row svelte-1kekodt"),m(Y,"class","svelte-1kekodt"),m(e,"class","details svelte-1kekodt")},m(H,U){O(H,e,U),_(e,n),_(e,s),_(e,o),_(o,r),_(o,a),_(a,i),_(a,c),_(e,f),_(e,d),F(E,d,null),_(d,C),_(d,k),_(d,p),_(d,h),_(h,y),_(d,D),_(d,B),_(d,Z),F(ee,d,null),_(d,se),_(d,le),_(d,X),F(q,d,null),_(e,L),_(e,ne),F(j,ne,null),_(ne,z),_(ne,x),_(ne,ge),F(he,ne,null),_(ne,Ae),_(ne,Ee),_(ne,Ze),F(Pe,ne,null),_(ne,Je),J&&J.m(ne,null),_(e,je),_(e,Re);for(let Ce=0;Ce<te.length;Ce+=1)te[Ce]&&te[Ce].m(Re,null);_(e,ze),_(e,G),_(G,Y),_(G,Ne),ve.block.m(G,ve.anchor=null),ve.mount=()=>G,ve.anchor=null,$e=!0},p(H,[U]){l=H,(!$e||U&1&&!ke(n.src,t=l[0].sample_url))&&m(n,"src",t),(!$e||U&1)&&u!==(u=l[0].id+"")&&Me(c,u);const Ce={};U&1&&(Ce.value=l[0].rating),E.$set(Ce),(!$e||U&1)&&w!==(w=l[0].type.toUpperCase()+"")&&Me(y,w);const Ge={};U&1&&(Ge.value=l[0].score),ee.$set(Ge);const de={};U&1&&(de.value=l[0].change),q.$set(de);const Xe={};U&1&&(Xe.url="/post?id="+l[0].id+"&src="+encodeURIComponent(l[0].file_url)),j.$set(Xe);const be={};U&1&&(be.source="https://rule34.xxx/index.php?page=post&s=view&id="+l[0].id),he.$set(be);const xe={};if(U&1&&(xe.url=l[0].file_url),Pe.$set(xe),l[0].source?J?(J.p(l,U),U&1&&v(J,1)):(J=kt(l),J.c(),v(J,1),J.m(ne,null)):J&&(oe(),b(J,1,1,()=>{J=null}),ie()),U&2){ye=De(Object.entries(l[1]));let re;for(re=0;re<ye.length;re+=1){const Ue=bt(l,ye,re);te[re]?(te[re].p(Ue,U),v(te[re],1)):(te[re]=wt(Ue),te[re].c(),v(te[re],1),te[re].m(Re,null))}for(oe(),re=ye.length;re<te.length;re+=1)tn(re);ie()}ve.ctx=l,U&1&&Se!==(Se=_t(l[0].id))&&pt(Se,ve)||dn(ve,l,U)},i(H){if(!$e){v(E.$$.fragment,H),v(ee.$$.fragment,H),v(q.$$.fragment,H),v(j.$$.fragment,H),v(he.$$.fragment,H),v(Pe.$$.fragment,H),v(J);for(let U=0;U<ye.length;U+=1)v(te[U]);v(ve.block),$e=!0}},o(H){b(E.$$.fragment,H),b(ee.$$.fragment,H),b(q.$$.fragment,H),b(j.$$.fragment,H),b(he.$$.fragment,H),b(Pe.$$.fragment,H),b(J),te=te.filter(Boolean);for(let U=0;U<te.length;U+=1)b(te[U]);for(let U=0;U<3;U+=1){const Ce=ve.blocks[U];b(Ce)}$e=!1},d(H){H&&g(e),M(E),M(ee),M(q),M(j),M(he),M(Pe),J&&J.d(),Qe(te,H),ve.block.d(),ve.token=null,ve=null}}}function os(l,e,n){let t,{post:s}=e;return l.$$set=o=>{"post"in o&&n(0,s=o.post)},l.$$.update=()=>{l.$$.dirty&1&&n(1,t=s.tags.reduce((o,r)=>(o[r.type]===void 0&&(o[r.type]=[]),o[r.type].push(r),o),{}))},[s,t]}class is extends pe{constructor(e){super(),_e(this,e,os,rs,fe,{post:0})}}const qe=new IntersectionObserver(l=>{for(const e of l)if(e.target){const n=e.target;e.isIntersecting&&n.autoplay&&n.paused&&n.play(),!e.isIntersecting&&!n.paused&&n.pause()}},{rootMargin:"-1px",threshold:.001});function as(l){const e=l.slice(),n=wn(e[0].file_url,e[0].sample_url,e[0].preview_url);return e[4]=n,e}function cs(l){const e=l.slice(),n=Yt(e[0].file_url,e[0].sample_url,e[0].preview_url);return e[4]=n,e}function Ct(l){let e,n,t,s;return{c(){e=S("img"),this.h()},l(o){e=I(o,"IMG",{src:!0,alt:!0,title:!0,class:!0}),this.h()},h(){ke(e.src,n=l[4].animated)||m(e,"src",n),m(e,"alt",t="[GIF] post #"+l[0].id),m(e,"title",s="[GIF] post #"+l[0].id),m(e,"class","svelte-1cjgn2p")},m(o,r){O(o,e,r)},p(o,r){r&1&&!ke(e.src,n=o[4].animated)&&m(e,"src",n),r&1&&t!==(t="[GIF] post #"+o[0].id)&&m(e,"alt",t),r&1&&s!==(s="[GIF] post #"+o[0].id)&&m(e,"title",s)},d(o){o&&g(e)}}}function Et(l){let e,n,t,s;return{c(){e=S("video"),this.h()},l(o){e=I(o,"VIDEO",{src:!0,poster:!0,title:!0,preload:!0,class:!0}),A(e).forEach(g),this.h()},h(){ke(e.src,n=l[4].animated)||m(e,"src",n),m(e,"poster",t=l[4].static),e.loop=!0,m(e,"title",s="[VIDEO] post #"+l[0].id),e.controls=!0,m(e,"preload","metadata"),e.autoplay=!0,m(e,"class","svelte-1cjgn2p")},m(o,r){O(o,e,r),l[2](e)},p(o,r){r&1&&!ke(e.src,n=o[4].animated)&&m(e,"src",n),r&1&&t!==(t=o[4].static)&&m(e,"poster",t),r&1&&s!==(s="[VIDEO] post #"+o[0].id)&&m(e,"title",s)},d(o){o&&g(e),l[2](null)}}}function us(l){let e,n,t,s;return{c(){e=S("img"),this.h()},l(o){e=I(o,"IMG",{src:!0,alt:!0,title:!0,class:!0}),this.h()},h(){ke(e.src,n=l[0].sample_url)||m(e,"src",n),m(e,"alt",t="[IMAGE] post #"+l[0].id),m(e,"title",s="[IMAGE] post #"+l[0].id),m(e,"class","svelte-1cjgn2p")},m(o,r){O(o,e,r)},p(o,r){r&1&&!ke(e.src,n=o[0].sample_url)&&m(e,"src",n),r&1&&t!==(t="[IMAGE] post #"+o[0].id)&&m(e,"alt",t),r&1&&s!==(s="[IMAGE] post #"+o[0].id)&&m(e,"title",s)},d(o){o&&g(e)}}}function fs(l){let e;function n(r,a){return r[0].type==="image"?us:r[0].type==="video"?Et:Ct}function t(r,a){return a===Et?cs(r):a===Ct?as(r):r}let s=n(l),o=s(t(l,s));return{c(){o.c(),e=we()},l(r){o.l(r),e=we()},m(r,a){o.m(r,a),O(r,e,a)},p(r,[a]){s===(s=n(r))&&o?o.p(t(r,s),a):(o.d(1),o=s(t(r,s)),o&&(o.c(),o.m(e.parentNode,e)))},i:Q,o:Q,d(r){r&&g(e),o.d(r)}}}function ps(l,e,n){let{post:t}=e,s;const o=a=>{t.type==="video"&&s&&(a.key==="ArrowLeft"&&(a.preventDefault(),a.stopPropagation(),n(1,s.currentTime=Math.max(0,s.currentTime-5),s)),a.key==="ArrowRight"&&(a.preventDefault(),a.stopPropagation(),n(1,s.currentTime=Math.min(s.duration,s.currentTime+5),s)))};rt(()=>{s&&(qe==null||qe.observe(s)),document.addEventListener("keydown",o)}),ot(()=>{s&&(qe==null||qe.unobserve(s)),document.removeEventListener("keydown",o)});function r(a){Oe[a?"unshift":"push"](()=>{s=a,n(1,s)})}return l.$$set=a=>{"post"in a&&n(0,t=a.post)},[t,s,r]}class _s extends pe{constructor(e){super(),_e(this,e,ps,fs,fe,{post:0})}}function ds(l){let e,n,t;return{c(){e=S("img"),this.h()},l(s){e=I(s,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){ke(e.src,n=l[2])||m(e,"src",n),m(e,"alt",t="post #"+l[0].id),m(e,"class","svelte-itxz72"),Le(e,"top",l[1])},m(s,o){O(s,e,o)},p(s,[o]){o&4&&!ke(e.src,n=s[2])&&m(e,"src",n),o&1&&t!==(t="post #"+s[0].id)&&m(e,"alt",t),o&2&&Le(e,"top",s[1])},i:Q,o:Q,d(s){s&&g(e)}}}function ms(l,e,n){let t,{post:s}=e,{offset:o}=e;return l.$$set=r=>{"post"in r&&n(0,s=r.post),"offset"in r&&n(1,o=r.offset)},l.$$.update=()=>{l.$$.dirty&1&&n(2,t=yn(s.sample_url)?s.preview_url:s.sample_url)},[s,o,t]}class xt extends pe{constructor(e){super(),_e(this,e,ms,ds,fe,{post:0,offset:1})}}function St(l,e,n){const t=l.slice();return t[17]=e[n],t[19]=n,t}function It(l){let e,n;return e=new xt({props:{post:l[3],offset:l[6]}}),{c(){V(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p(t,s){const o={};s&8&&(o.post=t[3]),s&64&&(o.offset=t[6]),e.$set(o)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function Dt(l){let e,n;return e=new xt({props:{post:l[4],offset:l[7]}}),{c(){V(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p(t,s){const o={};s&16&&(o.post=t[4]),s&128&&(o.offset=t[7]),e.$set(o)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function Pt(l){let e,n=`${l[19]*100}vh`;return{c(){e=S("div"),this.h()},l(t){e=I(t,"DIV",{class:!0}),A(e).forEach(g),this.h()},h(){m(e,"class","pseudo snap-item svelte-3khu3"),Le(e,"top",n)},m(t,s){O(t,e,s)},p:Q,d(t){t&&g(e)}}}function gs(l){let e,n,t,s,o,r,a,i,u,c,f,d,E,C=l[3]&&It(l);s=new _s({props:{post:l[2]}}),r=new is({props:{post:l[2]}});let k=l[4]&&Dt(l),$=De({length:l[8].posts.length}),p=[];for(let h=0;h<$.length;h+=1)p[h]=Pt(St(l,$,h));return c=new Xt({props:{absoluteTop:l[8].posts.length*100+"vh",rootMargin:window.innerHeight*3+"px"}}),c.$on("intersection",l[13]),{c(){e=S("div"),C&&C.c(),n=N(),t=S("div"),V(s.$$.fragment),o=N(),V(r.$$.fragment),a=N(),k&&k.c(),i=N();for(let h=0;h<p.length;h+=1)p[h].c();u=N(),V(c.$$.fragment),this.h()},l(h){e=I(h,"DIV",{class:!0});var w=A(e);C&&C.l(w),n=T(w),t=I(w,"DIV",{class:!0});var y=A(t);R(s.$$.fragment,y),o=T(y),R(r.$$.fragment,y),y.forEach(g),a=T(w),k&&k.l(w),i=T(w);for(let D=0;D<p.length;D+=1)p[D].l(w);u=T(w),R(c.$$.fragment,w),w.forEach(g),this.h()},h(){m(t,"class","screen snap-container horizontal current svelte-3khu3"),Le(t,"top",l[5]),m(e,"class","root screen snap-container svelte-3khu3")},m(h,w){O(h,e,w),C&&C.m(e,null),_(e,n),_(e,t),F(s,t,null),_(t,o),F(r,t,null),l[12](t),_(e,a),k&&k.m(e,null),_(e,i);for(let y=0;y<p.length;y+=1)p[y]&&p[y].m(e,null);_(e,u),F(c,e,null),l[14](e),f=!0,d||(E=Ie(e,"scroll",l[10]),d=!0)},p(h,[w]){h[3]?C?(C.p(h,w),w&8&&v(C,1)):(C=It(h),C.c(),v(C,1),C.m(e,n)):C&&(oe(),b(C,1,1,()=>{C=null}),ie());const y={};w&4&&(y.post=h[2]),s.$set(y);const D={};if(w&4&&(D.post=h[2]),r.$set(D),w&32&&Le(t,"top",h[5]),h[4]?k?(k.p(h,w),w&16&&v(k,1)):(k=Dt(h),k.c(),v(k,1),k.m(e,i)):k&&(oe(),b(k,1,1,()=>{k=null}),ie()),w&256){$=De({length:h[8].posts.length});let K;for(K=0;K<$.length;K+=1){const Z=St(h,$,K);p[K]?p[K].p(Z,w):(p[K]=Pt(Z),p[K].c(),p[K].m(e,u))}for(;K<p.length;K+=1)p[K].d(1);p.length=$.length}const B={};w&256&&(B.absoluteTop=h[8].posts.length*100+"vh"),c.$set(B)},i(h){f||(v(C),v(s.$$.fragment,h),v(r.$$.fragment,h),v(k),v(c.$$.fragment,h),f=!0)},o(h){b(C),b(s.$$.fragment,h),b(r.$$.fragment,h),b(k),b(c.$$.fragment,h),f=!1},d(h){h&&g(e),C&&C.d(),M(s),M(r),l[12](null),k&&k.d(),Qe(p,h),M(c),l[14](null),d=!1,E()}}}function hs(l,e,n){let t;me(l,Ke,y=>n(8,t=y));let{index:s}=e,o,r,a=t.posts[s],i=s>0?t.posts[s-1]:void 0,u=s<t.posts.length-1?t.posts[s+1]:void 0,c=`${s*100}vh`,f=`${(s-1)*100}vh`,d=`${(s+1)*100}vh`;const E=Ve(),C=()=>{r&&(r.scrollIntoView(),n(1,r.scrollLeft=0,r))},k=y=>{const D=y.target,B=D.getBoundingClientRect().height,K=D.scrollTop/B,Z=Math.round(K);Z!=s&&requestAnimationFrame(()=>{n(11,s=Z),n(2,a=t.posts[s]),n(3,i=s>0?t.posts[s-1]:void 0),n(4,u=s<t.posts.length-1?t.posts[s+1]:void 0),n(5,c=`${s*100}vh`),n(6,f=`${(s-1)*100}vh`),n(7,d=`${(s+1)*100}vh`),r&&n(1,r.scrollLeft=0,r)})},$=y=>{y.key==="d"&&(y.preventDefault(),y.stopPropagation(),r.scrollLeft===0?r.scrollBy({left:o.clientWidth,top:0,behavior:"smooth"}):r.scrollBy({left:-o.clientWidth,top:0,behavior:"smooth"})),y.key==="ArrowUp"&&(y.preventDefault(),y.stopPropagation(),o.scrollTo({left:0,top:o.clientHeight*(s-1),behavior:"smooth"})),y.key==="ArrowDown"&&(y.preventDefault(),y.stopPropagation(),o.scrollTo({left:0,top:o.clientHeight*(s+1),behavior:"smooth"}))};rt(()=>{document.addEventListener("keydown",$),C()}),ot(()=>{document.removeEventListener("keydown",$)});function p(y){Oe[y?"unshift":"push"](()=>{r=y,n(1,r)})}const h=()=>{console.log("endreached"),E("endreached")};function w(y){Oe[y?"unshift":"push"](()=>{o=y,n(0,o)})}return l.$$set=y=>{"index"in y&&n(11,s=y.index)},window.innerHeight&&console.log(window.innerHeight*2,"height"),[o,r,a,i,u,c,f,d,t,E,k,s,p,h,w]}class $s extends pe{constructor(e){super(),_e(this,e,hs,gs,fe,{index:11})}}function vs(l){let e;return{c(){e=S("i"),this.h()},l(n){e=I(n,"I",{class:!0}),A(e).forEach(g),this.h()},h(){m(e,"class","codicon codicon-close")},m(n,t){O(n,e,t)},p:Q,d(n){n&&g(e)}}}function bs(l){let e,n,t,s,o;function r(i){l[2](i)}let a={};return l[0]!==void 0&&(a.index=l[0]),e=new $s({props:a}),Oe.push(()=>tt(e,"index",r)),e.$on("endreached",l[3]),s=new Kt({props:{class:"button-close",$$slots:{default:[vs]},$$scope:{ctx:l}}}),s.$on("click",l[1]),{c(){V(e.$$.fragment),t=N(),V(s.$$.fragment)},l(i){R(e.$$.fragment,i),t=T(i),R(s.$$.fragment,i)},m(i,u){F(e,i,u),O(i,t,u),F(s,i,u),o=!0},p(i,u){const c={};!n&&u&1&&(n=!0,c.index=i[0],et(()=>n=!1)),e.$set(c);const f={};u&128&&(f.$$scope={dirty:u,ctx:i}),s.$set(f)},i(i){o||(v(e.$$.fragment,i),v(s.$$.fragment,i),o=!0)},o(i){b(e.$$.fragment,i),b(s.$$.fragment,i),o=!1},d(i){i&&g(t),M(e,i),M(s,i)}}}function ks(l){let e,n;return e=new Jn({props:{$$slots:{default:[bs]},$$scope:{ctx:l}}}),e.$on("close",l[1]),{c(){V(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p(t,[s]){const o={};s&129&&(o.$$scope={dirty:s,ctx:t}),e.$set(o)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function ws(l,e,n){let{index:t}=e;const s=Ve(),o=()=>{s("close",t)},r=c=>{c.key==="f"&&(c.preventDefault(),c.stopPropagation(),o())},a=()=>{var c,f;(((c=history.state)==null?void 0:c.fullscreen)===void 0||((f=history.state)==null?void 0:f.fullscreen)===!1)&&o()};rt(()=>{window.addEventListener("popstate",a),document.addEventListener("keydown",r)}),ot(()=>{window.removeEventListener("popstate",a),document.removeEventListener("keydown",r)});function i(c){t=c,n(0,t)}function u(c){nt.call(this,l,c)}return l.$$set=c=>{"index"in c&&n(0,t=c.index)},[t,o,i,u]}class ys extends pe{constructor(e){super(),_e(this,e,ws,ks,fe,{index:0})}}function Nt(l){let e,n=l[0].type==="video"?"▶":"GIF",t;return{c(){e=S("span"),t=ce(n),this.h()},l(s){e=I(s,"SPAN",{class:!0});var o=A(e);t=ue(o,n),o.forEach(g),this.h()},h(){m(e,"class","type svelte-1213alg")},m(s,o){O(s,e,o),_(e,t)},p(s,o){o&1&&n!==(n=s[0].type==="video"?"▶":"GIF")&&Me(t,n)},d(s){s&&g(e)}}}function Cs(l){let e,n,t,s,o,r=st(l[0].score)+"",a,i,u,c,f,d=l[0].type!=="image"&&Nt(l);return{c(){e=S("div"),n=S("img"),s=N(),o=S("span"),a=ce(r),i=N(),d&&d.c(),this.h()},l(E){e=I(E,"DIV",{id:!0,class:!0,style:!0});var C=A(e);n=I(C,"IMG",{src:!0,alt:!0,class:!0,tabindex:!0,loading:!0}),s=T(C),o=I(C,"SPAN",{class:!0});var k=A(o);a=ue(k,r),k.forEach(g),i=T(C),d&&d.l(C),C.forEach(g),this.h()},h(){ke(n.src,t=l[1])||m(n,"src",t),m(n,"alt","post"),m(n,"class","post-media svelte-1213alg"),m(n,"tabindex","-1"),m(n,"loading","lazy"),m(o,"class","score svelte-1213alg"),m(e,"id",u=lt(l[0].id)),m(e,"class","post svelte-1213alg"),Le(e,"grid-row","span "+l[2]),at(e,"open",open)},m(E,C){O(E,e,C),_(e,n),_(e,s),_(e,o),_(o,a),_(e,i),d&&d.m(e,null),c||(f=[Ie(e,"click",l[3]),Ie(e,"keydown",l[4])],c=!0)},p(E,[C]){C&2&&!ke(n.src,t=E[1])&&m(n,"src",t),C&1&&r!==(r=st(E[0].score)+"")&&Me(a,r),E[0].type!=="image"?d?d.p(E,C):(d=Nt(E),d.c(),d.m(e,null)):d&&(d.d(1),d=null),C&1&&u!==(u=lt(E[0].id))&&m(e,"id",u),C&0&&at(e,"open",open)},i:Q,o:Q,d(E){E&&g(e),d&&d.d(),c=!1,ct(f)}}}let Tt=3;function Es(l,e,n){let t,{post:s}=e,o=Math.min(Math.round(s.height/s.width)*Tt,Tt*3);const r=u=>u.endsWith(".jpg")||u.endsWith(".jpeg")||u.endsWith(".png")||u.endsWith(".webp");function a(u){nt.call(this,l,u)}const i=u=>{var c;(Zt(u)||u.key==="f")&&((c=u.target)==null||c.click())};return l.$$set=u=>{"post"in u&&n(0,s=u.post)},l.$$.update=()=>{l.$$.dirty&1&&n(1,t=r(s.sample_url)?s.sample_url:s.preview_url)},[s,t,o,a,i]}class Ss extends pe{constructor(e){super(),_e(this,e,Es,Cs,fe,{post:0})}}function Is(l){const e=l.slice(),n=Yt(e[1].file_url,e[1].sample_url,e[1].preview_url);return e[7]=n,e}function Ds(l){let e,n;return e=new En({props:{post:l[1]}}),e.$on("click",l[4]),{c(){V(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p(t,s){const o={};s&2&&(o.post=t[1]),e.$set(o)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function Ps(l){let e,n;return e=new Sn({props:{src:l[7].animated,poster:l[7].static,width:l[1].width,height:l[1].height,loop:l[2]||dt(l[1].tags)}}),e.$on("click",l[4]),{c(){V(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p(t,s){const o={};s&2&&(o.src=t[7].animated),s&2&&(o.poster=t[7].static),s&2&&(o.width=t[1].width),s&2&&(o.height=t[1].height),s&6&&(o.loop=t[2]||dt(t[1].tags)),e.$set(o)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function Ns(l){let e,n;return e=new In({props:{post:l[1],open:l[0]}}),e.$on("click",l[4]),{c(){V(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p(t,s){const o={};s&2&&(o.post=t[1]),s&1&&(o.open=t[0]),e.$set(o)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function Ts(l){let e;return{c(){e=S("i"),this.h()},l(n){e=I(n,"I",{class:!0}),A(e).forEach(g),this.h()},h(){m(e,"class","codicon codicon-screen-full")},m(n,t){O(n,e,t)},p:Q,d(n){n&&g(e)}}}function Ot(l){let e,n;return e=new Cn({props:{post:l[1]}}),{c(){V(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p(t,s){const o={};s&2&&(o.post=t[1]),e.$set(o)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function Os(l){let e,n,t,s,o,r,a,i,u,c;const f=[Ns,Ps,Ds],d=[];function E($,p){return $[1].type==="image"?0:$[1].type==="video"?1:2}function C($,p){return p===1?Is($):$}n=E(l),t=d[n]=f[n](C(l,n)),o=new Kt({props:{class:"button-fullscreen","aria-label":"Enter Fullscreen mode",$$slots:{default:[Ts]},$$scope:{ctx:l}}}),o.$on("click",l[5]);let k=l[0]&&Ot(l);return{c(){e=S("div"),t.c(),s=N(),V(o.$$.fragment),r=N(),k&&k.c(),this.h()},l($){e=I($,"DIV",{id:!0,class:!0});var p=A(e);t.l(p),s=T(p),R(o.$$.fragment,p),r=T(p),k&&k.l(p),p.forEach(g),this.h()},h(){m(e,"id",a=lt(l[1].id)),m(e,"class","post svelte-pwgq1f"),at(e,"open",l[0])},m($,p){O($,e,p),d[n].m(e,null),_(e,s),F(o,e,null),_(e,r),k&&k.m(e,null),i=!0,u||(c=Ie(e,"keydown",l[6]),u=!0)},p($,[p]){let h=n;n=E($),n===h?d[n].p(C($,n),p):(oe(),b(d[h],1,1,()=>{d[h]=null}),ie(),t=d[n],t?t.p(C($,n),p):(t=d[n]=f[n](C($,n)),t.c()),v(t,1),t.m(e,s));const w={};p&256&&(w.$$scope={dirty:p,ctx:$}),o.$set(w),$[0]?k?(k.p($,p),p&1&&v(k,1)):(k=Ot($),k.c(),v(k,1),k.m(e,null)):k&&(oe(),b(k,1,1,()=>{k=null}),ie()),(!i||p&2&&a!==(a=lt($[1].id)))&&m(e,"id",a),(!i||p&1)&&at(e,"open",$[0])},i($){i||(v(t),v(o.$$.fragment,$),v(k),i=!0)},o($){b(t),b(o.$$.fragment,$),b(k),i=!1},d($){$&&g(e),d[n].d(),M(o),k&&k.d(),u=!1,c()}}}function As(l,e,n){let t;me(l,Dn,c=>n(2,t=c));const s=Ve(),o=()=>n(0,a=!a);let{post:r}=e,{open:a=!1}=e;const i=()=>s("fullscreen"),u=c=>{c.key==="f"&&s("fullscreen")};return l.$$set=c=>{"post"in c&&n(1,r=c.post),"open"in c&&n(0,a=c.open)},[a,r,t,s,o,i,u]}class Vs extends pe{constructor(e){super(),_e(this,e,As,Os,fe,{post:1,open:0})}}function Rs(l){let e;return{c(){e=ce("Done")},l(n){e=ue(n,"Done")},m(n,t){O(n,e,t)},d(n){n&&g(e)}}}function Fs(l){let e;return{c(){e=ce("Reset")},l(n){e=ue(n,"Reset")},m(n,t){O(n,e,t)},d(n){n&&g(e)}}}function Ms(l){let e,n,t="Sorting and Filtering",s,o,r,a="Sorting",i,u,c,f,d,E,C,k,$,p,h="Filtering by Score",w,y,D,B,K,Z,ee,se,le,P="Filtering by Rating",X,q,L,ne,j,z,x,W,ge,he,Ae;function Ee(G){l[6](G)}let Ye={options:js};l[2].direction!==void 0&&(Ye.value=l[2].direction),c=new _n({props:Ye}),Oe.push(()=>tt(c,"value",Ee));function Ze(G){l[7](G)}let Pe={options:Bs};l[2].property!==void 0&&(Pe.value=l[2].property),E=new mt({props:Pe}),Oe.push(()=>tt(E,"value",Ze));function Je(G){l[8](G)}let je={options:zs};l[1].scoreComparator!==void 0&&(je.value=l[1].scoreComparator),D=new Nn({props:je}),Oe.push(()=>tt(D,"value",Je));function Re(G){l[10](G)}let ze={options:en};return l[1].rating!==void 0&&(ze.value=l[1].rating),L=new mt({props:ze}),Oe.push(()=>tt(L,"value",Re)),z=new We({props:{title:"Return to searching.",$$slots:{default:[Rs]},$$scope:{ctx:l}}}),z.$on("click",l[11]),W=new We({props:{title:"Reset sort and filter.",type:"secondary",$$slots:{default:[Fs]},$$scope:{ctx:l}}}),W.$on("click",l[5]),{c(){e=S("div"),n=S("h3"),n.textContent=t,s=N(),o=S("div"),r=S("b"),r.textContent=a,i=N(),u=S("div"),V(c.$$.fragment),d=N(),V(E.$$.fragment),k=N(),$=S("div"),p=S("b"),p.textContent=h,w=N(),y=S("div"),V(D.$$.fragment),K=N(),Z=S("input"),ee=N(),se=S("div"),le=S("b"),le.textContent=P,X=N(),q=S("div"),V(L.$$.fragment),j=N(),V(z.$$.fragment),x=N(),V(W.$$.fragment),this.h()},l(G){e=I(G,"DIV",{class:!0});var Y=A(e);n=I(Y,"H3",{"data-svelte-h":!0}),ae(n)!=="svelte-15zouq3"&&(n.textContent=t),s=T(Y),o=I(Y,"DIV",{});var Te=A(o);r=I(Te,"B",{class:!0,"data-svelte-h":!0}),ae(r)!=="svelte-ekzpgg"&&(r.textContent=a),i=T(Te),u=I(Te,"DIV",{class:!0});var Ne=A(u);R(c.$$.fragment,Ne),d=T(Ne),R(E.$$.fragment,Ne),Ne.forEach(g),Te.forEach(g),k=T(Y),$=I(Y,"DIV",{});var Se=A($);p=I(Se,"B",{class:!0,"data-svelte-h":!0}),ae(p)!=="svelte-1flca3"&&(p.textContent=h),w=T(Se),y=I(Se,"DIV",{class:!0});var $e=A(y);R(D.$$.fragment,$e),K=T($e),Z=I($e,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),$e.forEach(g),Se.forEach(g),ee=T(Y),se=I(Y,"DIV",{});var J=A(se);le=I(J,"B",{class:!0,"data-svelte-h":!0}),ae(le)!=="svelte-1evbw58"&&(le.textContent=P),X=T(J),q=I(J,"DIV",{class:!0});var ye=A(q);R(L.$$.fragment,ye),ye.forEach(g),J.forEach(g),j=T(Y),R(z.$$.fragment,Y),x=T(Y),R(W.$$.fragment,Y),Y.forEach(g),this.h()},h(){m(r,"class","svelte-kdg2ou"),m(u,"class","row svelte-kdg2ou"),m(p,"class","svelte-kdg2ou"),m(Z,"type","number"),m(Z,"min",0),m(Z,"max",1e5),m(Z,"step",1),m(Z,"class","svelte-kdg2ou"),m(y,"class","row svelte-kdg2ou"),m(le,"class","svelte-kdg2ou"),m(q,"class","row svelte-kdg2ou"),m(e,"class","container svelte-kdg2ou")},m(G,Y){O(G,e,Y),_(e,n),_(e,s),_(e,o),_(o,r),_(o,i),_(o,u),F(c,u,null),_(u,d),F(E,u,null),_(e,k),_(e,$),_($,p),_($,w),_($,y),F(D,y,null),_(y,K),_(y,Z),He(Z,l[0]),_(e,ee),_(e,se),_(se,le),_(se,X),_(se,q),F(L,q,null),_(e,j),F(z,e,null),_(e,x),F(W,e,null),ge=!0,he||(Ae=[Ie(Z,"input",l[9]),Ie(Z,"keyup",l[4])],he=!0)},p(G,Y){const Te={};!f&&Y&4&&(f=!0,Te.value=G[2].direction,et(()=>f=!1)),c.$set(Te);const Ne={};!C&&Y&4&&(C=!0,Ne.value=G[2].property,et(()=>C=!1)),E.$set(Ne);const Se={};!B&&Y&2&&(B=!0,Se.value=G[1].scoreComparator,et(()=>B=!1)),D.$set(Se),Y&1&&Gt(Z.value)!==G[0]&&He(Z,G[0]);const $e={};!ne&&Y&2&&(ne=!0,$e.value=G[1].rating,et(()=>ne=!1)),L.$set($e);const J={};Y&8192&&(J.$$scope={dirty:Y,ctx:G}),z.$set(J);const ye={};Y&8192&&(ye.$$scope={dirty:Y,ctx:G}),W.$set(ye)},i(G){ge||(v(c.$$.fragment,G),v(E.$$.fragment,G),v(D.$$.fragment,G),v(L.$$.fragment,G),v(z.$$.fragment,G),v(W.$$.fragment,G),ge=!0)},o(G){b(c.$$.fragment,G),b(E.$$.fragment,G),b(D.$$.fragment,G),b(L.$$.fragment,G),b(z.$$.fragment,G),b(W.$$.fragment,G),ge=!1},d(G){G&&g(e),M(c),M(E),M(D),M(L),M(z),M(W),he=!1,ct(Ae)}}}function Ls(l){let e,n;return e=new Ut({props:{$$slots:{default:[Ms]},$$scope:{ctx:l}}}),e.$on("close",l[12]),{c(){V(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p(t,[s]){const o={};s&8199&&(o.$$scope={dirty:s,ctx:t}),e.$set(o)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}const en=Object.freeze({all:"All",safe:"Safe",questionable:"Questionable",explicit:"Explicit"}),Bs=Object.freeze({id:"Uploaded",score:"Score",updated:"Updated",random:"Random"}),js=Object.freeze({desc:"codicon codicon-arrow-down",asc:"codicon codicon-arrow-up"}),zs=Object.freeze({">=":"≥","<=":"≤"});function Gs(l,e,n){let t,s;me(l,Fe,$=>n(1,t=$)),me(l,Be,$=>n(2,s=$));let o;const r=Ve(),a=$=>{var p;return Zt($)&&((p=$.target)==null?void 0:p.blur())},i=()=>{Be.reset(),Fe.reset(),n(0,o=t.scoreValue)};function u($){l.$$.not_equal(s.direction,$)&&(s.direction=$,Be.set(s))}function c($){l.$$.not_equal(s.property,$)&&(s.property=$,Be.set(s))}function f($){l.$$.not_equal(t.scoreComparator,$)&&(t.scoreComparator=$,Fe.set(t))}function d(){o=Gt(this.value),n(0,o),n(1,t)}function E($){l.$$.not_equal(t.rating,$)&&(t.rating=$,Fe.set(t))}const C=()=>r("close");function k($){nt.call(this,l,$)}return l.$$.update=()=>{if(l.$$.dirty&3){o===void 0&&n(0,o=t.scoreValue);let $=Number(o);isNaN($)||an(Fe,t.scoreValue=$,t)}},[o,t,s,r,a,i,u,c,f,d,E,C,k]}class Us extends pe{constructor(e){super(),_e(this,e,Gs,Ls,fe,{})}}function At(l){let e,n;return e=new Us({}),e.$on("close",l[4]),{c(){V(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p:Q,i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function qs(l){let e,n,t,s,o,r,a,i,u,c,f,d,E,C,k,$=l[0]&&At(l);return{c(){e=S("button"),n=S("i"),t=N(),s=S("span"),o=ce(l[2]),r=N(),a=S("i"),i=N(),u=S("span"),c=ce(l[1]),f=N(),$&&$.c(),d=we(),this.h()},l(p){e=I(p,"BUTTON",{class:!0});var h=A(e);n=I(h,"I",{class:!0}),A(n).forEach(g),t=T(h),s=I(h,"SPAN",{});var w=A(s);o=ue(w,l[2]),w.forEach(g),r=T(h),a=I(h,"I",{class:!0}),A(a).forEach(g),i=T(h),u=I(h,"SPAN",{});var y=A(u);c=ue(y,l[1]),y.forEach(g),h.forEach(g),f=T(p),$&&$.l(p),d=we(),this.h()},h(){m(n,"class","codicon codicon-filter svelte-a4zz3f"),m(a,"class","codicon codicon-arrow-swap svelte-a4zz3f"),m(e,"class","svelte-a4zz3f")},m(p,h){O(p,e,h),_(e,n),_(e,t),_(e,s),_(s,o),_(e,r),_(e,a),_(e,i),_(e,u),_(u,c),O(p,f,h),$&&$.m(p,h),O(p,d,h),E=!0,C||(k=Ie(e,"click",l[3]),C=!0)},p(p,[h]){(!E||h&4)&&Me(o,p[2]),(!E||h&2)&&Me(c,p[1]),p[0]?$?($.p(p,h),h&1&&v($,1)):($=At(p),$.c(),v($,1),$.m(d.parentNode,d)):$&&(oe(),b($,1,1,()=>{$=null}),ie())},i(p){E||(v($),E=!0)},o(p){b($),E=!1},d(p){p&&(g(e),g(f),g(d)),$&&$.d(p),C=!1,k()}}}const Hs=Object.freeze({id:{asc:"Oldest",desc:"Newest"},score:{asc:"Worst",desc:"Best"},updated:{asc:"Inactive",desc:"Active"},random:{asc:"Random",desc:"Random"}}),Ks=(l,e,n)=>{let t=l==="all"?void 0:en[l],s=e===0&&n===">="?void 0:`Score${n}${st(e)}`;return[t,s].filter(o=>o!==void 0).join(",")||"All"};function Ws(l,e,n){let t,s,o,r;me(l,Be,f=>n(5,o=f)),me(l,Fe,f=>n(6,r=f));let a=!1;const i=Ve(),u=()=>n(0,a=!0),c=()=>{n(0,a=!1),i("sortfilterupdate")};return l.$$.update=()=>{l.$$.dirty&64&&n(2,t=Ks(r.rating,r.scoreValue,r.scoreComparator)),l.$$.dirty&32&&n(1,s=Hs[o.property][o.direction])},[a,s,t,u,c,o,r]}class Qs extends pe{constructor(e){super(),_e(this,e,Ws,qs,fe,{})}}function Vt(l,e,n){const t=l.slice();return t[8]=e[n],t[10]=n,t}function Rt(l,e,n){const t=l.slice();return t[8]=e[n],t[10]=n,t}function Ys(l){let e,n,t=De(l[1].posts),s=[];for(let r=0;r<t.length;r+=1)s[r]=Ft(Vt(l,t,r));const o=r=>b(s[r],1,1,()=>{s[r]=null});return{c(){e=S("section");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){e=I(r,"SECTION",{class:!0,style:!0});var a=A(e);for(let i=0;i<s.length;i+=1)s[i].l(a);a.forEach(g),this.h()},h(){m(e,"class","multi-column svelte-wypqh"),Le(e,"grid-template-columns","repeat("+l[2]+", 1fr)")},m(r,a){O(r,e,a);for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(e,null);n=!0},p(r,a){if(a&3){t=De(r[1].posts);let i;for(i=0;i<t.length;i+=1){const u=Vt(r,t,i);s[i]?(s[i].p(u,a),v(s[i],1)):(s[i]=Ft(u),s[i].c(),v(s[i],1),s[i].m(e,null))}for(oe(),i=t.length;i<s.length;i+=1)o(i);ie()}(!n||a&4)&&Le(e,"grid-template-columns","repeat("+r[2]+", 1fr)")},i(r){if(!n){for(let a=0;a<t.length;a+=1)v(s[a]);n=!0}},o(r){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)b(s[a]);n=!1},d(r){r&&g(e),Qe(s,r)}}}function Zs(l){let e,n,t=De(l[1].posts),s=[];for(let r=0;r<t.length;r+=1)s[r]=Mt(Rt(l,t,r));const o=r=>b(s[r],1,1,()=>{s[r]=null});return{c(){e=S("section");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){e=I(r,"SECTION",{class:!0});var a=A(e);for(let i=0;i<s.length;i+=1)s[i].l(a);a.forEach(g),this.h()},h(){m(e,"class","single-column svelte-wypqh")},m(r,a){O(r,e,a);for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(e,null);n=!0},p(r,a){if(a&3){t=De(r[1].posts);let i;for(i=0;i<t.length;i+=1){const u=Rt(r,t,i);s[i]?(s[i].p(u,a),v(s[i],1)):(s[i]=Mt(u),s[i].c(),v(s[i],1),s[i].m(e,null))}for(oe(),i=t.length;i<s.length;i+=1)o(i);ie()}},i(r){if(!n){for(let a=0;a<t.length;a+=1)v(s[a]);n=!0}},o(r){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)b(s[a]);n=!1},d(r){r&&g(e),Qe(s,r)}}}function Ft(l){let e,n;function t(){return l[6](l[10])}return e=new Ss({props:{post:l[8]}}),e.$on("click",t),{c(){V(e.$$.fragment)},l(s){R(e.$$.fragment,s)},m(s,o){F(e,s,o),n=!0},p(s,o){l=s;const r={};o&2&&(r.post=l[8]),e.$set(r)},i(s){n||(v(e.$$.fragment,s),n=!0)},o(s){b(e.$$.fragment,s),n=!1},d(s){M(e,s)}}}function Mt(l){let e,n;function t(){return l[5](l[10])}return e=new Vs({props:{post:l[8]}}),e.$on("fullscreen",t),{c(){V(e.$$.fragment)},l(s){R(e.$$.fragment,s)},m(s,o){F(e,s,o),n=!0},p(s,o){l=s;const r={};o&2&&(r.post=l[8]),e.$set(r)},i(s){n||(v(e.$$.fragment,s),n=!0)},o(s){b(e.$$.fragment,s),n=!1},d(s){M(e,s)}}}function Lt(l){let e,n;return e=new ys({props:{index:l[0]}}),e.$on("close",l[3]),e.$on("endreached",l[7]),{c(){V(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p(t,s){const o={};s&1&&(o.index=t[0]),e.$set(o)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function Js(l){let e,n,t=st(l[1].postCount)+"",s,o,r,a,i,u,c,f,d,E;a=new Qs({}),a.$on("sortfilterupdate",l[4]);const C=[Zs,Ys],k=[];function $(h,w){return h[2]==="1"?0:1}u=$(l),c=k[u]=C[u](l);let p=l[0]!==void 0&&Lt(l);return{c(){e=S("div"),n=S("span"),s=ce(t),o=ce(" posts"),r=N(),V(a.$$.fragment),i=N(),c.c(),f=N(),p&&p.c(),d=we(),this.h()},l(h){e=I(h,"DIV",{class:!0});var w=A(e);n=I(w,"SPAN",{});var y=A(n);s=ue(y,t),o=ue(y," posts"),y.forEach(g),r=T(w),R(a.$$.fragment,w),w.forEach(g),i=T(h),c.l(h),f=T(h),p&&p.l(h),d=we(),this.h()},h(){m(e,"class","svelte-wypqh")},m(h,w){O(h,e,w),_(e,n),_(n,s),_(n,o),_(e,r),F(a,e,null),O(h,i,w),k[u].m(h,w),O(h,f,w),p&&p.m(h,w),O(h,d,w),E=!0},p(h,[w]){(!E||w&2)&&t!==(t=st(h[1].postCount)+"")&&Me(s,t);let y=u;u=$(h),u===y?k[u].p(h,w):(oe(),b(k[y],1,1,()=>{k[y]=null}),ie(),c=k[u],c?c.p(h,w):(c=k[u]=C[u](h),c.c()),v(c,1),c.m(f.parentNode,f)),h[0]!==void 0?p?(p.p(h,w),w&1&&v(p,1)):(p=Lt(h),p.c(),v(p,1),p.m(d.parentNode,d)):p&&(oe(),b(p,1,1,()=>{p=null}),ie())},i(h){E||(v(a.$$.fragment,h),v(c),v(p),E=!0)},o(h){b(a.$$.fragment,h),b(c),b(p),E=!1},d(h){h&&(g(e),g(i),g(f),g(d)),M(a),k[u].d(h),p&&p.d(h)}}}function Xs(l,e,n){let t,s;me(l,Ke,f=>n(1,t=f)),me(l,qt,f=>n(2,s=f));let o;const r=f=>{var C;const d=t.posts[f.detail],E=lt(d.id);(C=document.getElementById(E))==null||C.scrollIntoView(),n(0,o=void 0)};function a(f){nt.call(this,l,f)}const i=f=>{n(0,o=f)},u=f=>{n(0,o=f)};function c(f){nt.call(this,l,f)}return l.$$.update=()=>{var f;l.$$.dirty&1&&(o!==void 0?history.pushState({...history.state,fullscreen:!0},""):(f=history.state)!=null&&f.fullscreen&&history.back())},[o,t,s,r,a,i,u,c]}class xs extends pe{constructor(e){super(),_e(this,e,Xs,Js,fe,{})}}function el(l){let e;return{c(){e=ce("Reset Filter")},l(n){e=ue(n,"Reset Filter")},m(n,t){O(n,e,t)},d(n){n&&g(e)}}}function tl(l){let e,n,t,s,o="We couldn't find any posts matching your tags. Sorry...",r,a,i;return a=new We({props:{title:"In case your filter caused all posts to vanish. Reset it.",$$slots:{default:[el]},$$scope:{ctx:l}}}),a.$on("click",l[1]),{c(){e=S("img"),t=N(),s=S("p"),s.textContent=o,r=N(),V(a.$$.fragment),this.h()},l(u){e=I(u,"IMG",{src:!0,alt:!0,class:!0}),t=T(u),s=I(u,"P",{"data-svelte-h":!0}),ae(s)!=="svelte-1utxj3w"&&(s.textContent=o),r=T(u),R(a.$$.fragment,u),this.h()},h(){ke(e.src,n=Ht+"/assets/shironeko-confused.png")||m(e,"src",n),m(e,"alt","Nothing here..."),m(e,"class","svelte-1bb5e7g")},m(u,c){O(u,e,c),O(u,t,c),O(u,s,c),O(u,r,c),F(a,u,c),i=!0},p(u,[c]){const f={};c&4&&(f.$$scope={dirty:c,ctx:u}),a.$set(f)},i(u){i||(v(a.$$.fragment,u),i=!0)},o(u){b(a.$$.fragment,u),i=!1},d(u){u&&(g(e),g(t),g(s),g(r)),M(a,u)}}}function nl(l){const e=Ve();return[e,()=>{Be.reset(),Fe.reset(),e("sortfilterupdate")}]}class sl extends pe{constructor(e){super(),_e(this,e,nl,tl,fe,{})}}function ll(l){const e=l-1;return e*e*e+1}function rl(l,{delay:e=0,duration:n=400,easing:t=ll,x:s=0,y:o=0,opacity:r=0}={}){const a=getComputedStyle(l),i=+a.opacity,u=a.transform==="none"?"":a.transform,c=i*(1-r),[f,d]=ft(s),[E,C]=ft(o);return{delay:e,duration:n,easing:t,css:(k,$)=>`
			transform: ${u} translate(${(1-k)*f}${d}, ${(1-k)*E}${C});
			opacity: ${i-c*$}`}}function ol(l){let e;return{c(){e=ce("Ok")},l(n){e=ue(n,"Ok")},m(n,t){O(n,e,t)},d(n){n&&g(e)}}}function il(l){let e,n,t="This site uses cookies",s,o,r,a;return o=new We({props:{title:"Accept cookies",$$slots:{default:[ol]},$$scope:{ctx:l}}}),o.$on("click",l[0]),{c(){e=S("div"),n=S("span"),n.textContent=t,s=N(),V(o.$$.fragment),this.h()},l(i){e=I(i,"DIV",{class:!0});var u=A(e);n=I(u,"SPAN",{"data-svelte-h":!0}),ae(n)!=="svelte-17tpe0c"&&(n.textContent=t),s=T(u),R(o.$$.fragment,u),u.forEach(g),this.h()},h(){m(e,"class","svelte-20j44m")},m(i,u){O(i,e,u),_(e,n),_(e,s),F(o,e,null),a=!0},p(i,[u]){const c={};u&2&&(c.$$scope={dirty:u,ctx:i}),o.$set(c)},i(i){a||(v(o.$$.fragment,i),r&&r.end(1),a=!0)},o(i){b(o.$$.fragment,i),i&&(r=cn(e,rl,{y:200,duration:200})),a=!1},d(i){i&&g(e),M(o),i&&r&&r.end()}}}function al(l){return[()=>Jt.set(!0)]}class cl extends pe{constructor(e){super(),_e(this,e,al,il,fe,{})}}function ul(l){let e;return{c(){e=ce("Search")},l(n){e=ue(n,"Search")},m(n,t){O(n,e,t)},i:Q,o:Q,d(n){n&&g(e)}}}function fl(l){let e,n;return e=new Wt({}),{c(){V(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function pl(l){let e,n,t,s;const o=[fl,ul],r=[];function a(i,u){return i[0]?0:1}return e=a(l),n=r[e]=o[e](l),{c(){n.c(),t=we()},l(i){n.l(i),t=we()},m(i,u){r[e].m(i,u),O(i,t,u),s=!0},p(i,u){let c=e;e=a(i),e!==c&&(oe(),b(r[c],1,1,()=>{r[c]=null}),ie(),n=r[e],n||(n=r[e]=o[e](i),n.c()),v(n,1),n.m(t.parentNode,t))},i(i){s||(v(n),s=!0)},o(i){b(n),s=!1},d(i){i&&g(t),r[e].d(i)}}}function _l(l){let e,n,t,s,o,r;const a=[gl,ml],i=[];function u(c,f){return c[3].postCount===0?0:1}return n=u(l),t=i[n]=a[n](l),o=new On({}),{c(){e=S("section"),t.c(),s=N(),V(o.$$.fragment),this.h()},l(c){e=I(c,"SECTION",{class:!0});var f=A(e);t.l(f),f.forEach(g),s=T(c),R(o.$$.fragment,c),this.h()},h(){m(e,"class","svelte-1muglpt")},m(c,f){O(c,e,f),i[n].m(e,null),O(c,s,f),F(o,c,f),r=!0},p(c,f){let d=n;n=u(c),n===d?i[n].p(c,f):(oe(),b(i[d],1,1,()=>{i[d]=null}),ie(),t=i[n],t?t.p(c,f):(t=i[n]=a[n](c),t.c()),v(t,1),t.m(e,null))},i(c){r||(v(t),v(o.$$.fragment,c),r=!0)},o(c){b(t),b(o.$$.fragment,c),r=!1},d(c){c&&(g(e),g(s)),i[n].d(),M(o,c)}}}function dl(l){let e,n;return e=new Hn({props:{error:l[1]}}),{c(){V(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p(t,s){const o={};s&2&&(o.error=t[1]),e.$set(o)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function ml(l){let e,n,t,s,o,r;e=new xs({}),e.$on("sortfilterupdate",l[10]),e.$on("endreached",l[11]);const a=[$l,hl],i=[];function u(c,f){return c[3].posts.length===c[3].postCount?0:1}return t=u(l),s=i[t]=a[t](l),{c(){V(e.$$.fragment),n=N(),s.c(),o=we()},l(c){R(e.$$.fragment,c),n=T(c),s.l(c),o=we()},m(c,f){F(e,c,f),O(c,n,f),i[t].m(c,f),O(c,o,f),r=!0},p(c,f){let d=t;t=u(c),t===d?i[t].p(c,f):(oe(),b(i[d],1,1,()=>{i[d]=null}),ie(),s=i[t],s?s.p(c,f):(s=i[t]=a[t](c),s.c()),v(s,1),s.m(o.parentNode,o))},i(c){r||(v(e.$$.fragment,c),v(s),r=!0)},o(c){b(e.$$.fragment,c),b(s),r=!1},d(c){c&&(g(n),g(o)),M(e,c),i[t].d(c)}}}function gl(l){let e,n;return e=new sl({}),e.$on("sortfilterupdate",l[10]),{c(){V(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p:Q,i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function hl(l){let e,n;return e=new Xt({props:{absoluteTop:void 0,rootMargin:1e3/Number(l[7])+"px"}}),e.$on("intersection",l[11]),{c(){V(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p(t,s){const o={};s&128&&(o.rootMargin=1e3/Number(t[7])+"px"),e.$set(o)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function $l(l){let e,n;return e=new Wn({}),{c(){V(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p:Q,i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function Bt(l){let e,n;return e=new Gn({props:{tags:l[5]}}),e.$on("close",l[16]),e.$on("submit",l[17]),{c(){V(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p(t,s){const o={};s&32&&(o.tags=t[5]),e.$set(o)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function jt(l){let e,n;return e=new cl({}),{c(){V(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function vl(l){let e,n,t,s,o,r,a,i,u,c,f,d,E,C,k;n=new fn({}),s=new Tn({props:{placeholder:"Search for tags",fetchSuggestions:l[9]}}),s.$on("pick",l[12]),r=new We({props:{title:"Search with the tags above",$$slots:{default:[pl]},$$scope:{ctx:l}}}),r.$on("click",l[10]),i=new pn({props:{tags:[...l[5],...l[4]]}}),i.$on("click",l[13]),i.$on("contextmenu",l[14]),i.$on("createSupertag",l[15]);const $=[dl,_l],p=[];function h(D,B){return D[1]?0:D[3].requested?1:-1}~(c=h(l))&&(f=p[c]=$[c](l));let w=l[2]&&Bt(l),y=!l[8]&&jt();return{c(){e=S("section"),V(n.$$.fragment),t=N(),V(s.$$.fragment),o=N(),V(r.$$.fragment),a=N(),V(i.$$.fragment),u=N(),f&&f.c(),d=N(),w&&w.c(),E=N(),y&&y.c(),C=we(),this.h()},l(D){e=I(D,"SECTION",{id:!0,class:!0});var B=A(e);R(n.$$.fragment,B),t=T(B),R(s.$$.fragment,B),o=T(B),R(r.$$.fragment,B),a=T(B),R(i.$$.fragment,B),B.forEach(g),u=T(D),f&&f.l(D),d=T(D),w&&w.l(D),E=T(D),y&&y.l(D),C=we(),this.h()},h(){m(e,"id","search"),m(e,"class","svelte-1muglpt")},m(D,B){O(D,e,B),F(n,e,null),_(e,t),F(s,e,null),_(e,o),F(r,e,null),_(e,a),F(i,e,null),O(D,u,B),~c&&p[c].m(D,B),O(D,d,B),w&&w.m(D,B),O(D,E,B),y&&y.m(D,B),O(D,C,B),k=!0},p(D,[B]){const K={};B&33554433&&(K.$$scope={dirty:B,ctx:D}),r.$set(K);const Z={};B&48&&(Z.tags=[...D[5],...D[4]]),i.$set(Z);let ee=c;c=h(D),c===ee?~c&&p[c].p(D,B):(f&&(oe(),b(p[ee],1,1,()=>{p[ee]=null}),ie()),~c?(f=p[c],f?f.p(D,B):(f=p[c]=$[c](D),f.c()),v(f,1),f.m(d.parentNode,d)):f=null),D[2]?w?(w.p(D,B),B&4&&v(w,1)):(w=Bt(D),w.c(),v(w,1),w.m(E.parentNode,E)):w&&(oe(),b(w,1,1,()=>{w=null}),ie()),D[8]?y&&(oe(),b(y,1,1,()=>{y=null}),ie()):y?B&256&&v(y,1):(y=jt(),y.c(),v(y,1),y.m(C.parentNode,C))},i(D){k||(v(n.$$.fragment,D),v(s.$$.fragment,D),v(r.$$.fragment,D),v(i.$$.fragment,D),v(f),v(w),v(y),k=!0)},o(D){b(n.$$.fragment,D),b(s.$$.fragment,D),b(r.$$.fragment,D),b(i.$$.fragment,D),b(f),b(w),b(y),k=!1},d(D){D&&(g(e),g(u),g(d),g(E),g(C)),M(n),M(s),M(r),M(i),~c&&p[c].d(D),w&&w.d(D),y&&y.d(D)}}}function bl(l,e,n){let t,s,o,r,a,i,u,c,f;me(l,Ke,P=>n(3,t=P)),me(l,ut,P=>n(4,s=P)),me(l,Fe,P=>n(19,o=P)),me(l,Be,P=>n(20,r=P)),me(l,Mn,P=>n(21,a=P)),me(l,it,P=>n(5,i=P)),me(l,gt,P=>n(6,u=P)),me(l,qt,P=>n(7,c=P)),me(l,Jt,P=>n(8,f=P));let d=!1,E,C=!1,k=0;const $=async P=>{const X=await An(P);return[...u.items.filter(({name:L})=>L.toLowerCase().includes(P.toLowerCase())).map(L=>({label:L.name,count:L.tags.length,type:"supertag"})),...X]},p=()=>new Pn().withPid(t.pageCount).withTags(i).withBlockedContent(a).withSortProperty(r.property).withSortDirection(r.direction).withScoreValue(o.scoreValue).withScoreComparator(o.scoreComparator).withRating(o.rating).withSupertags(s),h=async P=>{if(!d){n(1,E=void 0),n(0,d=!0);try{const X=t.pageCount;await P(),Rn(X).catch(()=>{})}catch(X){n(1,E=X),console.warn(X)}finally{n(0,d=!1)}}},w=async()=>{Ke.reset(),k=0,h(async()=>{const[P,X]=await p().getPageAndCount();Ke.addPage(P,X)})},y=async()=>{h(async()=>{const P=await p().getPage();Ke.addPage(P)})},D=P=>{var X,q;if((P.key==="/"||P.key==="s")&&(!document.activeElement||document.activeElement===document.body)&&((X=document.getElementById("searchbar"))==null||X.focus(),P.preventDefault(),P.stopPropagation()),P.ctrlKey&&P.key==="Enter"&&(P.preventDefault(),P.stopPropagation(),w()),P.ctrlKey&&P.key==="m"&&((q=document.getElementById("select-modifier"))==null||q.click()),P.ctrlKey&&P.key==="ArrowDown"){const L=document.getElementsByClassName("post-media");L[k].focus(),k=Math.min(k+1,Math.max(0,L.length-1))}P.ctrlKey&&P.key==="ArrowUp"&&(document.getElementsByClassName("post-media")[k].focus(),k=Math.max(k-1,0))};return rt(async()=>{document.addEventListener("keydown",D)}),ot(()=>{document.removeEventListener("keydown",D)}),[d,E,C,t,s,i,u,c,f,$,w,y,async P=>{const X=P.detail;if(X.type==="supertag"){const q=u.items.find(L=>L.name===X.label);if(!q){console.warn("Supertag not present.");return}ut.addOrReplace(q)}else{const q=await Vn(P.detail.label);it.addOrReplace({name:P.detail.label,modifier:P.detail.modifier,count:P.detail.count,type:(q==null?void 0:q.type)??"tag"})}},P=>"description"in P.detail?ut.removeByName(P.detail.name):it.removeByName(P.detail.name),P=>{"description"in P.detail||(P.detail.modifier=Fn(P.detail.modifier),it.addOrReplace(P.detail))},()=>n(2,C=!0),()=>n(2,C=!1),P=>gt.add(P.detail)]}class Wl extends pe{constructor(e){super(),_e(this,e,bl,vl,fe,{})}}export{Wl as component};
