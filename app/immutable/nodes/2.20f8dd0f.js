import{s as le,f as C,a as N,g as I,c as O,y as ce,D as pe,j as $,i as P,d as h,E as me,l as x,m as ee,e as _e,h as T,u as b,F as ie,n as Oe,C as fe,G as vt,p as be,H as we,I as Re,J as it,K as Fe,L as ye,v as U,k as qe,M as ze,w as bt,N as kt,z as wt,A as yt,B as Et,o as je,O as Ve,P as Ge,r as ct}from"../chunks/scheduler.88299003.js";import{S as re,i as oe,b as R,d as B,m as A,a as E,t as S,e as F,g as te,c as se,f as Be}from"../chunks/index.15b414ac.js";import{s as ue,r as Ne,K as St,A as Ct,a as Me,S as It}from"../chunks/search-builder.1bb73e3b.js";import{S as Dt,n as Pt,s as Ye}from"../chunks/supertags-store.996bacfc.js";import{T as Te}from"../chunks/TextButton.2f318c50.js";import{g as Nt,a as Ot}from"../chunks/tags.58927cde.js";import{a as Pe}from"../chunks/active-tags-store.ee1f6602.js";import{b as ut}from"../chunks/paths.c706fab4.js";import{e as Ee}from"../chunks/each.e59479a4.js";import{D as ft,r as Tt}from"../chunks/Dialog.f8853b6f.js";import{i as pt,D as _t,g as Lt,G as mt,V as Rt,I as Bt}from"../chunks/Details.c61e6748.js";import{f as Le}from"../chunks/format-tag.d6c065e3.js";import{R as At,I as Ae}from"../chunks/ModifierSelect.623aacd6.js";import{S as Ze}from"../chunks/Select.22805bc7.js";import{R as Ft}from"../chunks/RotatingTextSelect.7e32facf.js";import{b as jt}from"../chunks/blocked-content-store.805c4a3d.js";import{D as Vt}from"../chunks/DetailedTag.28ff9b0d.js";import{S as Mt}from"../chunks/ScrollUpButton.cfa21b3f.js";import{l as qt}from"../chunks/analytics.12ea4383.js";function zt(l){let e;return{c(){e=x("Reset Filter")},l(s){e=ee(s,"Reset Filter")},m(s,t){P(s,e,t)},d(s){s&&h(e)}}}function Gt(l){let e,s,t,n,r="We couldn't find any posts matching your tags. Sorry...",o,a,i;return a=new Te({props:{title:"In case your filter caused all posts to vanish. Reset it.",$$slots:{default:[zt]},$$scope:{ctx:l}}}),a.$on("click",l[1]),{c(){e=C("img"),t=N(),n=C("p"),n.textContent=r,o=N(),R(a.$$.fragment),this.h()},l(f){e=I(f,"IMG",{src:!0,alt:!0,class:!0}),t=O(f),n=I(f,"P",{"data-svelte-h":!0}),ce(n)!=="svelte-1utxj3w"&&(n.textContent=r),o=O(f),B(a.$$.fragment,f),this.h()},h(){pe(e.src,s=ut+"/assets/shironeko-confused.png")||$(e,"src",s),$(e,"alt","Nothing here..."),$(e,"class","svelte-1bb5e7g")},m(f,u){P(f,e,u),P(f,t,u),P(f,n,u),P(f,o,u),A(a,f,u),i=!0},p(f,[u]){const p={};u&4&&(p.$$scope={dirty:u,ctx:f}),a.$set(p)},i(f){i||(E(a.$$.fragment,f),i=!0)},o(f){S(a.$$.fragment,f),i=!1},d(f){f&&(h(e),h(t),h(n),h(o)),F(a,f)}}}function Ut(l){const e=me();return[e,()=>{ue.reset(),e("sortfilterupdate")}]}class Kt extends re{constructor(e){super(),oe(this,e,Ut,Gt,le,{})}}function Je(l){let e,s;return e=new ft({props:{$$slots:{default:[Yt]},$$scope:{ctx:l}}}),e.$on("close",l[6]),{c(){R(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,n){A(e,t,n),s=!0},p(t,n){const r={};n&32771&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){s||(E(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){F(e,t)}}}function Ht(l){let e;return{c(){e=x("Done")},l(s){e=ee(s,"Done")},m(s,t){P(s,e,t)},d(s){s&&h(e)}}}function Wt(l){let e;return{c(){e=x("Reset")},l(s){e=ee(s,"Reset")},m(s,t){P(s,e,t)},d(s){s&&h(e)}}}function Yt(l){let e,s,t="Sorting and Filtering",n,r,o,a="Sorting",i,f,u,p,m,g,d,v,w,y,c="Filtering by Score",_,D,H,Q,W,K,ae,k,z,J="Filtering by Rating",Z,X,M,Se,j,L,Y,q,ne,ke,Ce;function Ie(V){l[8](V)}let Ue={options:Qt};l[1].sortDirection!==void 0&&(Ue.value=l[1].sortDirection),u=new At({props:Ue}),be.push(()=>Be(u,"value",Ie));function gt(V){l[9](V)}let Ke={options:Jt};l[1].sortProperty!==void 0&&(Ke.value=l[1].sortProperty),g=new Ze({props:Ke}),be.push(()=>Be(g,"value",gt));function ht(V){l[10](V)}let He={options:Xt};l[1].scoreComparator!==void 0&&(He.value=l[1].scoreComparator),H=new Ft({props:He}),be.push(()=>Be(H,"value",ht));function $t(V){l[13](V)}let We={options:dt};return l[1].rating!==void 0&&(We.value=l[1].rating),M=new Ze({props:We}),be.push(()=>Be(M,"value",$t)),L=new Te({props:{title:"Return to searching.",$$slots:{default:[Ht]},$$scope:{ctx:l}}}),L.$on("click",l[6]),q=new Te({props:{title:"Reset sort and filter.",type:"secondary",$$slots:{default:[Wt]},$$scope:{ctx:l}}}),q.$on("click",l[7]),{c(){e=C("div"),s=C("h3"),s.textContent=t,n=N(),r=C("label"),o=C("b"),o.textContent=a,i=N(),f=C("div"),R(u.$$.fragment),m=N(),R(g.$$.fragment),v=N(),w=C("label"),y=C("b"),y.textContent=c,_=N(),D=C("div"),R(H.$$.fragment),W=N(),K=C("input"),ae=N(),k=C("label"),z=C("b"),z.textContent=J,Z=N(),X=C("div"),R(M.$$.fragment),j=N(),R(L.$$.fragment),Y=N(),R(q.$$.fragment),this.h()},l(V){e=I(V,"DIV",{class:!0});var G=T(e);s=I(G,"H3",{"data-svelte-h":!0}),ce(s)!=="svelte-15zouq3"&&(s.textContent=t),n=O(G),r=I(G,"LABEL",{class:!0});var de=T(r);o=I(de,"B",{"data-svelte-h":!0}),ce(o)!=="svelte-ekzpgg"&&(o.textContent=a),i=O(de),f=I(de,"DIV",{class:!0});var ge=T(f);B(u.$$.fragment,ge),m=O(ge),B(g.$$.fragment,ge),ge.forEach(h),de.forEach(h),v=O(G),w=I(G,"LABEL",{class:!0});var he=T(w);y=I(he,"B",{"data-svelte-h":!0}),ce(y)!=="svelte-1flca3"&&(y.textContent=c),_=O(he),D=I(he,"DIV",{class:!0});var $e=T(D);B(H.$$.fragment,$e),W=O($e),K=I($e,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),$e.forEach(h),he.forEach(h),ae=O(G),k=I(G,"LABEL",{class:!0});var ve=T(k);z=I(ve,"B",{"data-svelte-h":!0}),ce(z)!=="svelte-1evbw58"&&(z.textContent=J),Z=O(ve),X=I(ve,"DIV",{class:!0});var De=T(X);B(M.$$.fragment,De),De.forEach(h),ve.forEach(h),j=O(G),B(L.$$.fragment,G),Y=O(G),B(q.$$.fragment,G),G.forEach(h),this.h()},h(){$(f,"class","row svelte-1omoy36"),$(r,"class","svelte-1omoy36"),$(K,"type","number"),$(K,"min",0),$(K,"max",1e5),$(K,"step",1),$(K,"class","svelte-1omoy36"),$(D,"class","row svelte-1omoy36"),$(w,"class","svelte-1omoy36"),$(X,"class","row svelte-1omoy36"),$(k,"class","svelte-1omoy36"),$(e,"class","container svelte-1omoy36")},m(V,G){P(V,e,G),b(e,s),b(e,n),b(e,r),b(r,o),b(r,i),b(r,f),A(u,f,null),b(f,m),A(g,f,null),b(e,v),b(e,w),b(w,y),b(w,_),b(w,D),A(H,D,null),b(D,W),b(D,K),we(K,l[0]),b(e,ae),b(e,k),b(k,z),b(k,Z),b(k,X),A(M,X,null),b(e,j),A(L,e,null),b(e,Y),A(q,e,null),ne=!0,ke||(Ce=[ie(K,"input",l[11]),ie(K,"keyup",l[12])],ke=!0)},p(V,G){const de={};!p&&G&2&&(p=!0,de.value=V[1].sortDirection,Re(()=>p=!1)),u.$set(de);const ge={};!d&&G&2&&(d=!0,ge.value=V[1].sortProperty,Re(()=>d=!1)),g.$set(ge);const he={};!Q&&G&2&&(Q=!0,he.value=V[1].scoreComparator,Re(()=>Q=!1)),H.$set(he),G&1&&it(K.value)!==V[0]&&we(K,V[0]);const $e={};!Se&&G&2&&(Se=!0,$e.value=V[1].rating,Re(()=>Se=!1)),M.$set($e);const ve={};G&32768&&(ve.$$scope={dirty:G,ctx:V}),L.$set(ve);const De={};G&32768&&(De.$$scope={dirty:G,ctx:V}),q.$set(De)},i(V){ne||(E(u.$$.fragment,V),E(g.$$.fragment,V),E(H.$$.fragment,V),E(M.$$.fragment,V),E(L.$$.fragment,V),E(q.$$.fragment,V),ne=!0)},o(V){S(u.$$.fragment,V),S(g.$$.fragment,V),S(H.$$.fragment,V),S(M.$$.fragment,V),S(L.$$.fragment,V),S(q.$$.fragment,V),ne=!1},d(V){V&&h(e),F(u),F(g),F(H),F(M),F(L),F(q),ke=!1,Fe(Ce)}}}function Zt(l){let e,s,t,n,r,o,a,i,f,u,p,m,g,d,v,w=l[2]&&Je(l);return{c(){e=C("button"),s=C("i"),t=N(),n=C("span"),r=x(l[4]),o=N(),a=C("i"),i=N(),f=C("span"),u=x(l[3]),p=N(),w&&w.c(),m=_e(),this.h()},l(y){e=I(y,"BUTTON",{class:!0});var c=T(e);s=I(c,"I",{class:!0}),T(s).forEach(h),t=O(c),n=I(c,"SPAN",{});var _=T(n);r=ee(_,l[4]),_.forEach(h),o=O(c),a=I(c,"I",{class:!0}),T(a).forEach(h),i=O(c),f=I(c,"SPAN",{});var D=T(f);u=ee(D,l[3]),D.forEach(h),c.forEach(h),p=O(y),w&&w.l(y),m=_e(),this.h()},h(){$(s,"class","codicon codicon-filter svelte-1omoy36"),$(a,"class","codicon codicon-arrow-swap svelte-1omoy36"),$(e,"class","svelte-1omoy36")},m(y,c){P(y,e,c),b(e,s),b(e,t),b(e,n),b(n,r),b(e,o),b(e,a),b(e,i),b(e,f),b(f,u),P(y,p,c),w&&w.m(y,c),P(y,m,c),g=!0,d||(v=ie(e,"click",l[5]),d=!0)},p(y,[c]){(!g||c&16)&&Oe(r,y[4]),(!g||c&8)&&Oe(u,y[3]),y[2]?w?(w.p(y,c),c&4&&E(w,1)):(w=Je(y),w.c(),E(w,1),w.m(m.parentNode,m)):w&&(te(),S(w,1,1,()=>{w=null}),se())},i(y){g||(E(w),g=!0)},o(y){S(w),g=!1},d(y){y&&(h(e),h(p),h(m)),w&&w.d(y),d=!1,v()}}}const Jt=Object.freeze({id:"Uploaded",score:"Score",updated:"Updated"}),Qt=Object.freeze({desc:"codicon codicon-arrow-down",asc:"codicon codicon-arrow-up"}),Xt=Object.freeze({">=":"≥","<=":"≤"}),dt=Object.freeze({all:"All",safe:"Safe",questionable:"Questionable",explicit:"Explicit"}),xt=Object.freeze({id:{asc:"Oldest",desc:"Newest"},score:{asc:"Worst",desc:"Best"},updated:{asc:"Inactive",desc:"Active"}}),es=(l,e,s)=>{let t=l==="all"?void 0:dt[l],n=e===0&&s===">="?void 0:`Score${s}${Le(e)}`;return[t,n].filter(r=>r!==void 0).join(",")||"All"};function ts(l,e,s){let t,n,r;fe(l,ue,c=>s(1,r=c));const o=me();let a=!1;const i=()=>s(2,a=!0),f=()=>{s(2,a=!1),o("sortfilterupdate")},u=()=>{ue.reset(),s(0,p=r.scoreValue)};let p;function m(c){l.$$.not_equal(r.sortDirection,c)&&(r.sortDirection=c,ue.set(r))}function g(c){l.$$.not_equal(r.sortProperty,c)&&(r.sortProperty=c,ue.set(r))}function d(c){l.$$.not_equal(r.scoreComparator,c)&&(r.scoreComparator=c,ue.set(r))}function v(){p=it(this.value),s(0,p),s(1,r)}const w=c=>pt(c)&&c.target.blur();function y(c){l.$$.not_equal(r.rating,c)&&(r.rating=c,ue.set(r))}return l.$$.update=()=>{if(l.$$.dirty&3){p===void 0&&s(0,p=r.scoreValue);let c=Number(p);isNaN(c)||vt(ue,r.scoreValue=c,r)}l.$$.dirty&2&&s(4,t=es(r.rating,r.scoreValue,r.scoreComparator)),l.$$.dirty&2&&s(3,n=xt[r.sortProperty][r.sortDirection])},[p,r,a,n,t,i,f,u,m,g,d,v,w,y]}class ss extends re{constructor(e){super(),oe(this,e,ts,Zt,le,{})}}function ns(l){const e=l.slice(),s=Lt(e[1].file_url,e[1].sample_url,e[1].preview_url);return e[5]=s,e}function ls(l){let e,s;return e=new mt({props:{post:l[1]}}),e.$on("click",l[3]),{c(){R(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,n){A(e,t,n),s=!0},p(t,n){const r={};n&2&&(r.post=t[1]),e.$set(r)},i(t){s||(E(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){F(e,t)}}}function rs(l){let e,s,t;return s=new Rt({props:{src:l[5].animated,poster:l[5].static,width:l[1].width,height:l[1].height,loop:l[1].tags.some(Xe)}}),s.$on("click",l[3]),{c(){e=x(`#
		
		`),R(s.$$.fragment)},l(n){e=ee(n,`#
		
		`),B(s.$$.fragment,n)},m(n,r){P(n,e,r),A(s,n,r),t=!0},p(n,r){const o={};r&2&&(o.src=n[5].animated),r&2&&(o.poster=n[5].static),r&2&&(o.width=n[1].width),r&2&&(o.height=n[1].height),r&2&&(o.loop=n[1].tags.some(Xe)),s.$set(o)},i(n){t||(E(s.$$.fragment,n),t=!0)},o(n){S(s.$$.fragment,n),t=!1},d(n){n&&h(e),F(s,n)}}}function os(l){let e,s;return e=new Bt({props:{post:l[1],open:l[0]}}),e.$on("click",l[3]),{c(){R(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,n){A(e,t,n),s=!0},p(t,n){const r={};n&2&&(r.post=t[1]),n&1&&(r.open=t[0]),e.$set(r)},i(t){s||(E(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){F(e,t)}}}function as(l){let e;return{c(){e=C("i"),this.h()},l(s){e=I(s,"I",{class:!0}),T(e).forEach(h),this.h()},h(){$(e,"class","codicon codicon-screen-full")},m(s,t){P(s,e,t)},p:U,d(s){s&&h(e)}}}function Qe(l){let e,s;return e=new _t({props:{post:l[1]}}),{c(){R(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,n){A(e,t,n),s=!0},p(t,n){const r={};n&2&&(r.post=t[1]),e.$set(r)},i(t){s||(E(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){F(e,t)}}}function is(l){let e,s,t,n,r,o,a,i;const f=[os,rs,ls],u=[];function p(d,v){return d[1].type==="image"?0:d[1].type==="video"?1:2}function m(d,v){return v===1?ns(d):d}s=p(l),t=u[s]=f[s](m(l,s)),r=new Ae({props:{class:"button-fullscreen","aria-label":"Enter Fullscreen mode",$$slots:{default:[as]},$$scope:{ctx:l}}}),r.$on("click",l[4]);let g=l[0]&&Qe(l);return{c(){e=C("div"),t.c(),n=N(),R(r.$$.fragment),o=N(),g&&g.c(),this.h()},l(d){e=I(d,"DIV",{id:!0,class:!0});var v=T(e);t.l(v),n=O(v),B(r.$$.fragment,v),o=O(v),g&&g.l(v),v.forEach(h),this.h()},h(){$(e,"id",a="post_"+l[1].id),$(e,"class","post svelte-pwgq1f"),ye(e,"open",l[0])},m(d,v){P(d,e,v),u[s].m(e,null),b(e,n),A(r,e,null),b(e,o),g&&g.m(e,null),i=!0},p(d,[v]){let w=s;s=p(d),s===w?u[s].p(m(d,s),v):(te(),S(u[w],1,1,()=>{u[w]=null}),se(),t=u[s],t?t.p(m(d,s),v):(t=u[s]=f[s](m(d,s)),t.c()),E(t,1),t.m(e,n));const y={};v&64&&(y.$$scope={dirty:v,ctx:d}),r.$set(y),d[0]?g?(g.p(d,v),v&1&&E(g,1)):(g=Qe(d),g.c(),E(g,1),g.m(e,null)):g&&(te(),S(g,1,1,()=>{g=null}),se()),(!i||v&2&&a!==(a="post_"+d[1].id))&&$(e,"id",a),(!i||v&1)&&ye(e,"open",d[0])},i(d){i||(E(t),E(r.$$.fragment,d),E(g),i=!0)},o(d){S(t),S(r.$$.fragment,d),S(g),i=!1},d(d){d&&h(e),u[s].d(),F(r),g&&g.d()}}}const Xe=l=>l.name==="loop";function cs(l,e,s){const t=me(),n=()=>s(0,o=!o);let{post:r}=e,{open:o=!1}=e;const a=()=>t("fullscreen");return l.$$set=i=>{"post"in i&&s(1,r=i.post),"open"in i&&s(0,o=i.open)},[o,r,t,n,a]}class us extends re{constructor(e){super(),oe(this,e,cs,is,le,{post:1,open:0})}}function xe(l){let e,s=l[0].type==="video"?"▶":"GIF",t;return{c(){e=C("span"),t=x(s),this.h()},l(n){e=I(n,"SPAN",{class:!0});var r=T(e);t=ee(r,s),r.forEach(h),this.h()},h(){$(e,"class","type svelte-14imjnt")},m(n,r){P(n,e,r),b(e,t)},p(n,r){r&1&&s!==(s=n[0].type==="video"?"▶":"GIF")&&Oe(t,s)},d(n){n&&h(e)}}}function fs(l){let e,s,t,n,r,o,a=Le(l[0].score)+"",i,f,u,p,m=l[0].type!=="image"&&xe(l);return{c(){e=C("div"),s=C("img"),r=N(),o=C("span"),i=x(a),f=N(),m&&m.c(),this.h()},l(g){e=I(g,"DIV",{class:!0,style:!0});var d=T(e);s=I(d,"IMG",{src:!0,alt:!0,class:!0,tabindex:!0,loading:!0,id:!0}),r=O(d),o=I(d,"SPAN",{class:!0});var v=T(o);i=ee(v,a),v.forEach(h),f=O(d),m&&m.l(d),d.forEach(h),this.h()},h(){pe(s.src,t=l[1])||$(s,"src",t),$(s,"alt","post"),$(s,"class","post-media svelte-14imjnt"),$(s,"tabindex","-1"),$(s,"loading","lazy"),$(s,"id",n="post_"+l[0].id),$(o,"class","score svelte-14imjnt"),$(e,"class","post svelte-14imjnt"),qe(e,"grid-row","span "+l[2]),ye(e,"open",open)},m(g,d){P(g,e,d),b(e,s),b(e,r),b(e,o),b(o,i),b(e,f),m&&m.m(e,null),u||(p=[ie(e,"click",l[3]),ie(e,"keydown",l[4])],u=!0)},p(g,[d]){d&2&&!pe(s.src,t=g[1])&&$(s,"src",t),d&1&&n!==(n="post_"+g[0].id)&&$(s,"id",n),d&1&&a!==(a=Le(g[0].score)+"")&&Oe(i,a),g[0].type!=="image"?m?m.p(g,d):(m=xe(g),m.c(),m.m(e,null)):m&&(m.d(1),m=null),d&0&&ye(e,"open",open)},i:U,o:U,d(g){g&&h(e),m&&m.d(),u=!1,Fe(p)}}}function ps(l,e,s){let t,{post:n}=e,r=Math.min(Math.round(n.height/n.width*5),15);const o=f=>f.endsWith(".jpg")||f.endsWith(".jpeg")||f.endsWith(".png")||f.endsWith(".webp");function a(f){ze.call(this,l,f)}const i=f=>{pt(f)&&f.target.click()};return l.$$set=f=>{"post"in f&&s(0,n=f.post)},l.$$.update=()=>{l.$$.dirty&1&&s(1,t=o(n.sample_url)?n.sample_url:n.preview_url)},[n,t,r,a,i]}class _s extends re{constructor(e){super(),oe(this,e,ps,fs,le,{post:0})}}function ms(l){let e,s,t,n;const r=l[3].default,o=bt(r,l,l[2],null);return{c(){e=C("div"),o&&o.c(),this.h()},l(a){e=I(a,"DIV",{role:!0,tabindex:!0,class:!0});var i=T(e);o&&o.l(i),i.forEach(h),this.h()},h(){$(e,"role","none"),$(e,"tabindex","-1"),$(e,"class","dialog fullscreen svelte-1j44awz")},m(a,i){P(a,e,i),o&&o.m(e,null),l[5](e),s=!0,t||(n=[ie(e,"keydown",l[4]),ie(e,"click",kt(ds))],t=!0)},p(a,[i]){o&&o.p&&(!s||i&4)&&wt(o,r,a,a[2],s?Et(r,a[2],i,null):yt(a[2]),null)},i(a){s||(E(o,a),s=!0)},o(a){S(o,a),s=!1},d(a){a&&h(e),o&&o.d(a),l[5](null),t=!1,Fe(n)}}}const ds=()=>{};function gs(l,e,s){let{$$slots:t={},$$scope:n}=e;const r=me(),o=()=>r("close"),a=m=>{m.key==="Escape"&&o()};let i=()=>{document.fullscreenElement||o()},f;je(async()=>{f.focus(),document.addEventListener("keydown",a),document.addEventListener("fullscreenchange",i);try{await f.requestFullscreen()}catch{}}),Ve(async()=>{document.removeEventListener("keydown",a),document.removeEventListener("fullscreenchange",i);try{await document.exitFullscreen()}catch{}});const u=m=>{m.code==="Escape"&&o()};function p(m){be[m?"unshift":"push"](()=>{f=m,s(0,f)})}return l.$$set=m=>{"$$scope"in m&&s(2,n=m.$$scope)},[f,o,n,t,u,p]}class hs extends re{constructor(e){super(),oe(this,e,gs,ms,le,{})}}function $s(l){let e,s;return e=new mt({props:{post:l[0]}}),{c(){R(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,n){A(e,t,n),s=!0},p(t,n){const r={};n&1&&(r.post=t[0]),e.$set(r)},i(t){s||(E(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){F(e,t)}}}function vs(l){let e,s;return{c(){e=C("video"),this.h()},l(t){e=I(t,"VIDEO",{class:!0,src:!0}),T(e).forEach(h),this.h()},h(){$(e,"class","post-media svelte-12glt11"),pe(e.src,s=l[0].file_url)||$(e,"src",s),e.controls=!0},m(t,n){P(t,e,n),l[5](e)},p(t,n){n&1&&!pe(e.src,s=t[0].file_url)&&$(e,"src",s)},i:U,o:U,d(t){t&&h(e),l[5](null)}}}function bs(l){let e,s,t,n,r;return{c(){e=C("img"),this.h()},l(o){e=I(o,"IMG",{class:!0,src:!0,alt:!0}),this.h()},h(){$(e,"class","post-media svelte-12glt11"),pe(e.src,s=l[0].file_url)||$(e,"src",s),$(e,"alt",t="Image of Post "+l[0].id),ye(e,"zoomed",l[1])},m(o,a){P(o,e,a),n||(r=ie(e,"click",l[4]),n=!0)},p(o,a){a&1&&!pe(e.src,s=o[0].file_url)&&$(e,"src",s),a&1&&t!==(t="Image of Post "+o[0].id)&&$(e,"alt",t),a&2&&ye(e,"zoomed",o[1])},i:U,o:U,d(o){o&&h(e),n=!1,r()}}}function ks(l){let e;return{c(){e=C("i"),this.h()},l(s){e=I(s,"I",{class:!0}),T(e).forEach(h),this.h()},h(){$(e,"class","codicon codicon-close")},m(s,t){P(s,e,t)},p:U,d(s){s&&h(e)}}}function ws(l){let e;return{c(){e=C("i"),this.h()},l(s){e=I(s,"I",{class:!0}),T(e).forEach(h),this.h()},h(){$(e,"class","codicon codicon-chevron-left")},m(s,t){P(s,e,t)},p:U,d(s){s&&h(e)}}}function ys(l){let e;return{c(){e=C("i"),this.h()},l(s){e=I(s,"I",{class:!0}),T(e).forEach(h),this.h()},h(){$(e,"class","codicon codicon-chevron-right")},m(s,t){P(s,e,t)},p:U,d(s){s&&h(e)}}}function Es(l){let e,s,t,n,r,o,a,i,f,u,p,m,g,d;const v=[bs,vs,$s],w=[];function y(c,_){return c[0].type==="image"?0:c[0].type==="video"?1:2}return s=y(l),t=w[s]=v[s](l),a=new _t({props:{post:l[0]}}),f=new Ae({props:{class:"button-close",$$slots:{default:[ks]},$$scope:{ctx:l}}}),f.$on("click",l[6]),p=new Ae({props:{class:"button-previous",$$slots:{default:[ws]},$$scope:{ctx:l}}}),p.$on("click",l[7]),g=new Ae({props:{class:"button-next",$$slots:{default:[ys]},$$scope:{ctx:l}}}),g.$on("click",l[8]),{c(){e=C("div"),t.c(),n=N(),r=C("i"),o=N(),R(a.$$.fragment),i=N(),R(f.$$.fragment),u=N(),R(p.$$.fragment),m=N(),R(g.$$.fragment),this.h()},l(c){e=I(c,"DIV",{class:!0});var _=T(e);t.l(_),n=O(_),r=I(_,"I",{class:!0}),T(r).forEach(h),_.forEach(h),o=O(c),B(a.$$.fragment,c),i=O(c),B(f.$$.fragment,c),u=O(c),B(p.$$.fragment,c),m=O(c),B(g.$$.fragment,c),this.h()},h(){$(r,"class","codicon codicon-chevron-down svelte-12glt11"),$(e,"class","svelte-12glt11")},m(c,_){P(c,e,_),w[s].m(e,null),b(e,n),b(e,r),P(c,o,_),A(a,c,_),P(c,i,_),A(f,c,_),P(c,u,_),A(p,c,_),P(c,m,_),A(g,c,_),d=!0},p(c,_){let D=s;s=y(c),s===D?w[s].p(c,_):(te(),S(w[D],1,1,()=>{w[D]=null}),se(),t=w[s],t?t.p(c,_):(t=w[s]=v[s](c),t.c()),E(t,1),t.m(e,n));const H={};_&1&&(H.post=c[0]),a.$set(H);const Q={};_&2048&&(Q.$$scope={dirty:_,ctx:c}),f.$set(Q);const W={};_&2048&&(W.$$scope={dirty:_,ctx:c}),p.$set(W);const K={};_&2048&&(K.$$scope={dirty:_,ctx:c}),g.$set(K)},i(c){d||(E(t),E(a.$$.fragment,c),E(f.$$.fragment,c),E(p.$$.fragment,c),E(g.$$.fragment,c),d=!0)},o(c){S(t),S(a.$$.fragment,c),S(f.$$.fragment,c),S(p.$$.fragment,c),S(g.$$.fragment,c),d=!1},d(c){c&&(h(e),h(o),h(i),h(u),h(m)),w[s].d(),F(a,c),F(f,c),F(p,c),F(g,c)}}}function Ss(l){let e,s;return e=new hs({props:{$$slots:{default:[Es]},$$scope:{ctx:l}}}),e.$on("close",l[9]),{c(){R(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,n){A(e,t,n),s=!0},p(t,[n]){const r={};n&2055&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){s||(E(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){F(e,t)}}}function Cs(l,e,s){const t=me(),n=d=>{if(d.key==="ArrowLeft"&&(d.preventDefault(),d.stopPropagation(),t("previous")),d.key==="ArrowRight"&&(d.preventDefault(),d.stopPropagation(),t("next")),d.key===" "){d.preventDefault(),d.stopPropagation(),console.log("play"),a&&(a.paused?a.play():a.pause());const v=document.querySelector(".fullscreen.circle");v&&v.click()}};let{post:r}=e,o=r.width/r.height<.33,a;je(()=>{document.addEventListener("keydown",n)}),Ve(()=>document.removeEventListener("keydown",n));const i=()=>s(1,o=!o);function f(d){be[d?"unshift":"push"](()=>{a=d,s(2,a)})}const u=()=>t("close"),p=()=>t("previous"),m=()=>t("next");function g(d){ze.call(this,l,d)}return l.$$set=d=>{"post"in d&&s(0,r=d.post)},[r,o,a,t,i,f,u,p,m,g]}class Is extends re{constructor(e){super(),oe(this,e,Cs,Ss,le,{post:0})}}function et(l,e,s){const t=l.slice();return t[12]=e[s],t[14]=s,t}function tt(l,e,s){const t=l.slice();return t[12]=e[s],t[14]=s,t}function Ds(l){let e,s,t=Ee(l[2].posts),n=[];for(let o=0;o<t.length;o+=1)n[o]=st(et(l,t,o));const r=o=>S(n[o],1,1,()=>{n[o]=null});return{c(){e=C("section");for(let o=0;o<n.length;o+=1)n[o].c();this.h()},l(o){e=I(o,"SECTION",{class:!0,style:!0});var a=T(e);for(let i=0;i<n.length;i+=1)n[i].l(a);a.forEach(h),this.h()},h(){$(e,"class","multi svelte-q6spg0"),qe(e,"grid-template-columns","repeat("+l[3]+", 1fr)")},m(o,a){P(o,e,a);for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(e,null);s=!0},p(o,a){if(a&5){t=Ee(o[2].posts);let i;for(i=0;i<t.length;i+=1){const f=et(o,t,i);n[i]?(n[i].p(f,a),E(n[i],1)):(n[i]=st(f),n[i].c(),E(n[i],1),n[i].m(e,null))}for(te(),i=t.length;i<n.length;i+=1)r(i);se()}(!s||a&8)&&qe(e,"grid-template-columns","repeat("+o[3]+", 1fr)")},i(o){if(!s){for(let a=0;a<t.length;a+=1)E(n[a]);s=!0}},o(o){n=n.filter(Boolean);for(let a=0;a<n.length;a+=1)S(n[a]);s=!1},d(o){o&&h(e),Ge(n,o)}}}function Ps(l){let e,s,t=Ee(l[2].posts),n=[];for(let o=0;o<t.length;o+=1)n[o]=nt(tt(l,t,o));const r=o=>S(n[o],1,1,()=>{n[o]=null});return{c(){e=C("section");for(let o=0;o<n.length;o+=1)n[o].c();this.h()},l(o){e=I(o,"SECTION",{class:!0});var a=T(e);for(let i=0;i<n.length;i+=1)n[i].l(a);a.forEach(h),this.h()},h(){$(e,"class","single svelte-q6spg0")},m(o,a){P(o,e,a);for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(e,null);s=!0},p(o,a){if(a&5){t=Ee(o[2].posts);let i;for(i=0;i<t.length;i+=1){const f=tt(o,t,i);n[i]?(n[i].p(f,a),E(n[i],1)):(n[i]=nt(f),n[i].c(),E(n[i],1),n[i].m(e,null))}for(te(),i=t.length;i<n.length;i+=1)r(i);se()}},i(o){if(!s){for(let a=0;a<t.length;a+=1)E(n[a]);s=!0}},o(o){n=n.filter(Boolean);for(let a=0;a<n.length;a+=1)S(n[a]);s=!1},d(o){o&&h(e),Ge(n,o)}}}function st(l){let e,s;function t(){return l[7](l[12],l[14])}return e=new _s({props:{post:l[12]}}),e.$on("click",t),{c(){R(e.$$.fragment)},l(n){B(e.$$.fragment,n)},m(n,r){A(e,n,r),s=!0},p(n,r){l=n;const o={};r&4&&(o.post=l[12]),e.$set(o)},i(n){s||(E(e.$$.fragment,n),s=!0)},o(n){S(e.$$.fragment,n),s=!1},d(n){F(e,n)}}}function nt(l){let e,s;function t(){return l[6](l[12],l[14])}return e=new us({props:{post:l[12]}}),e.$on("fullscreen",t),{c(){R(e.$$.fragment)},l(n){B(e.$$.fragment,n)},m(n,r){A(e,n,r),s=!0},p(n,r){l=n;const o={};r&4&&(o.post=l[12]),e.$set(o)},i(n){s||(E(e.$$.fragment,n),s=!0)},o(n){S(e.$$.fragment,n),s=!1},d(n){F(e,n)}}}function lt(l){let e,s;return e=new Is({props:{post:l[0].post}}),e.$on("close",l[8]),e.$on("previous",l[9]),e.$on("next",l[10]),{c(){R(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,n){A(e,t,n),s=!0},p(t,n){const r={};n&1&&(r.post=t[0].post),e.$set(r)},i(t){s||(E(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){F(e,t)}}}function Ns(l){let e,s,t=Le(l[2].postCount)+"",n,r,o,a,i,f,u,p,m,g;a=new ss({}),a.$on("sortfilterupdate",l[5]);const d=[Ps,Ds],v=[];function w(c,_){return c[3]==="1"?0:1}f=w(l),u=v[f]=d[f](l);let y=l[1]&&l[0]!==void 0&&lt(l);return{c(){e=C("div"),s=C("span"),n=x(t),r=x(" posts"),o=N(),R(a.$$.fragment),i=N(),u.c(),p=N(),y&&y.c(),m=_e(),this.h()},l(c){e=I(c,"DIV",{class:!0});var _=T(e);s=I(_,"SPAN",{});var D=T(s);n=ee(D,t),r=ee(D," posts"),D.forEach(h),o=O(_),B(a.$$.fragment,_),_.forEach(h),i=O(c),u.l(c),p=O(c),y&&y.l(c),m=_e(),this.h()},h(){$(e,"class","svelte-q6spg0")},m(c,_){P(c,e,_),b(e,s),b(s,n),b(s,r),b(e,o),A(a,e,null),P(c,i,_),v[f].m(c,_),P(c,p,_),y&&y.m(c,_),P(c,m,_),g=!0},p(c,[_]){(!g||_&4)&&t!==(t=Le(c[2].postCount)+"")&&Oe(n,t);let D=f;f=w(c),f===D?v[f].p(c,_):(te(),S(v[D],1,1,()=>{v[D]=null}),se(),u=v[f],u?u.p(c,_):(u=v[f]=d[f](c),u.c()),E(u,1),u.m(p.parentNode,p)),c[1]&&c[0]!==void 0?y?(y.p(c,_),_&3&&E(y,1)):(y=lt(c),y.c(),E(y,1),y.m(m.parentNode,m)):y&&(te(),S(y,1,1,()=>{y=null}),se())},i(c){g||(E(a.$$.fragment,c),E(u),E(y),g=!0)},o(c){S(a.$$.fragment,c),S(u),S(y),g=!1},d(c){c&&(h(e),h(i),h(p),h(m)),F(a),v[f].d(c),y&&y.d(c)}}}function Os(l,e,s){let t,n;fe(l,Ne,v=>s(2,t=v)),fe(l,Tt,v=>s(3,n=v));const r=me(),o=()=>{s(1,i=location.hash.length>2)};let a,i=location.hash.length>2;je(()=>{window.addEventListener("hashchange",o)}),Ve(()=>{window.removeEventListener("hashchange",o)});function f(v){ze.call(this,l,v)}return[a,i,t,n,r,f,(v,w)=>{s(0,a={post:v,index:w}),location.hash="fullscreen"},(v,w)=>{s(0,a={post:v,index:w}),location.hash="fullscreen"},()=>{var v,w;(v=a==null?void 0:a.post)!=null&&v.id&&((w=document.getElementById(`post_${a.post.id}`))==null||w.focus()),s(0,a=void 0),history.back()},()=>{let v=Math.max(a.index-1,0);s(0,a={index:v,post:t.posts[v]})},()=>{let v=Math.min(a.index+1,t.posts.length);s(0,a={index:v,post:t.posts[v]}),v>t.posts.length-3&&t.posts.length!==t.postCount&&r("endreached")}]}class Ts extends re{constructor(e){super(),oe(this,e,Os,Ns,le,{})}}function Ls(l){let e;return{c(){e=C("div")},l(s){e=I(s,"DIV",{}),T(e).forEach(h)},m(s,t){P(s,e,t),l[2](e)},p:U,i:U,o:U,d(s){s&&h(e),l[2](null)}}}function Rs(l,e,s){let{rootMargin:t}=e;const n=me(),r=new IntersectionObserver(i=>{i[0].isIntersecting&&n("intersection")},{rootMargin:t});let o;function a(i){be[i?"unshift":"push"](()=>{o=i,s(0,o)})}return l.$$set=i=>{"rootMargin"in i&&s(1,t=i.rootMargin)},l.$$.update=()=>{l.$$.dirty&1&&(r.disconnect(),o&&r.observe(o))},[o,t,a]}class Bs extends re{constructor(e){super(),oe(this,e,Rs,Ls,le,{rootMargin:1})}}function As(l){let e,s,t,n,r="You have seen everything there is to see...";return{c(){e=C("img"),t=N(),n=C("p"),n.textContent=r,this.h()},l(o){e=I(o,"IMG",{src:!0,alt:!0,class:!0}),t=O(o),n=I(o,"P",{"data-svelte-h":!0}),ce(n)!=="svelte-1i75mtf"&&(n.textContent=r),this.h()},h(){pe(e.src,s=ut+"/assets/shironeko-x.png")||$(e,"src",s),$(e,"alt","No more results to load"),$(e,"class","svelte-1pkma0d")},m(o,a){P(o,e,a),P(o,t,a),P(o,n,a)},p:U,i:U,o:U,d(o){o&&(h(e),h(t),h(n))}}}class Fs extends re{constructor(e){super(),oe(this,e,null,As,le,{})}}function rt(l,e,s){const t=l.slice();return t[9]=e[s],t}function ot(l){let e,s;return e=new Vt({props:{tag:l[9]}}),{c(){R(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,n){A(e,t,n),s=!0},p(t,n){const r={};n&4&&(r.tag=t[9]),e.$set(r)},i(t){s||(E(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){F(e,t)}}}function js(l){let e;return{c(){e=x("Create supertag")},l(s){e=ee(s,"Create supertag")},m(s,t){P(s,e,t)},d(s){s&&h(e)}}}function Vs(l){let e,s,t="Create Supertag",n,r,o,a,i,f="Name",u,p,m,g,d,v="Description",w,y,c,_,D,H="Tags",Q,W,K,ae,k,z,J,Z,X=Ee(l[2]),M=[];for(let j=0;j<X.length;j+=1)M[j]=ot(rt(l,X,j));const Se=j=>S(M[j],1,1,()=>{M[j]=null});return k=new Te({props:{title:l[3]?"Click to create supertag":"Enter a valid name to continue",disabled:!l[3],$$slots:{default:[js]},$$scope:{ctx:l}}}),k.$on("click",l[8]),{c(){e=C("section"),s=C("h3"),s.textContent=t,n=N(),r=C("button"),o=N(),a=C("div"),i=C("label"),i.textContent=f,u=N(),p=C("input"),m=N(),g=C("div"),d=C("label"),d.textContent=v,w=N(),y=C("input"),c=N(),_=C("div"),D=C("span"),D.textContent=H,Q=N(),W=C("ol");for(let j=0;j<M.length;j+=1)M[j].c();K=N(),ae=C("div"),R(k.$$.fragment),this.h()},l(j){e=I(j,"SECTION",{class:!0});var L=T(e);s=I(L,"H3",{"data-svelte-h":!0}),ce(s)!=="svelte-ho1cwx"&&(s.textContent=t),n=O(L),r=I(L,"BUTTON",{class:!0}),T(r).forEach(h),o=O(L),a=I(L,"DIV",{class:!0});var Y=T(a);i=I(Y,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),ce(i)!=="svelte-10k8a68"&&(i.textContent=f),u=O(Y),p=I(Y,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),Y.forEach(h),m=O(L),g=I(L,"DIV",{class:!0});var q=T(g);d=I(q,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),ce(d)!=="svelte-14n9kp6"&&(d.textContent=v),w=O(q),y=I(q,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),q.forEach(h),c=O(L),_=I(L,"DIV",{class:!0});var ne=T(_);D=I(ne,"SPAN",{class:!0,"data-svelte-h":!0}),ce(D)!=="svelte-7hjyox"&&(D.textContent=H),Q=O(ne),W=I(ne,"OL",{class:!0});var ke=T(W);for(let Ie=0;Ie<M.length;Ie+=1)M[Ie].l(ke);ke.forEach(h),ne.forEach(h),K=O(L),ae=I(L,"DIV",{class:!0});var Ce=T(ae);B(k.$$.fragment,Ce),Ce.forEach(h),L.forEach(h),this.h()},h(){$(r,"class",ct("codicon codicon-close")+" svelte-xkjm86"),$(i,"for","supertag-name"),$(i,"class","svelte-xkjm86"),$(p,"type","text"),$(p,"placeholder","Descriptive name"),$(p,"id","supertag-name"),$(p,"class","svelte-xkjm86"),$(a,"class","svelte-xkjm86"),$(d,"for","supertag-description"),$(d,"class","svelte-xkjm86"),$(y,"type","text"),$(y,"placeholder","Short description"),$(y,"id","supertag-description"),$(y,"class","svelte-xkjm86"),$(g,"class","svelte-xkjm86"),$(D,"class","svelte-xkjm86"),$(W,"class","svelte-xkjm86"),$(_,"class","svelte-xkjm86"),$(ae,"class","last svelte-xkjm86"),$(e,"class","svelte-xkjm86")},m(j,L){P(j,e,L),b(e,s),b(e,n),b(e,r),b(e,o),b(e,a),b(a,i),b(a,u),b(a,p),we(p,l[0]),b(e,m),b(e,g),b(g,d),b(g,w),b(g,y),we(y,l[1]),b(e,c),b(e,_),b(_,D),b(_,Q),b(_,W);for(let Y=0;Y<M.length;Y+=1)M[Y]&&M[Y].m(W,null);b(e,K),b(e,ae),A(k,ae,null),z=!0,J||(Z=[ie(r,"click",l[5]),ie(p,"input",l[6]),ie(y,"input",l[7])],J=!0)},p(j,L){if(L&1&&p.value!==j[0]&&we(p,j[0]),L&2&&y.value!==j[1]&&we(y,j[1]),L&4){X=Ee(j[2]);let q;for(q=0;q<X.length;q+=1){const ne=rt(j,X,q);M[q]?(M[q].p(ne,L),E(M[q],1)):(M[q]=ot(ne),M[q].c(),E(M[q],1),M[q].m(W,null))}for(te(),q=X.length;q<M.length;q+=1)Se(q);se()}const Y={};L&8&&(Y.title=j[3]?"Click to create supertag":"Enter a valid name to continue"),L&8&&(Y.disabled=!j[3]),L&4096&&(Y.$$scope={dirty:L,ctx:j}),k.$set(Y)},i(j){if(!z){for(let L=0;L<X.length;L+=1)E(M[L]);E(k.$$.fragment,j),z=!0}},o(j){M=M.filter(Boolean);for(let L=0;L<M.length;L+=1)S(M[L]);S(k.$$.fragment,j),z=!1},d(j){j&&h(e),Ge(M,j),F(k),J=!1,Fe(Z)}}}function Ms(l){let e,s;return e=new ft({props:{$$slots:{default:[Vs]},$$scope:{ctx:l}}}),e.$on("close",l[5]),{c(){R(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,n){A(e,t,n),s=!0},p(t,[n]){const r={};n&4111&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){s||(E(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){F(e,t)}}}function qs(l,e,s){let t,{name:n=""}=e,{description:r=""}=e,{tags:o}=e;const a=me(),i=()=>a("close");function f(){n=this.value,s(0,n)}function u(){r=this.value,s(1,r)}const p=()=>{a("submit",{name:n,description:r,tags:o.map(({modifier:m,name:g})=>({modifier:m,name:g}))}),i()};return l.$$set=m=>{"name"in m&&s(0,n=m.name),"description"in m&&s(1,r=m.description),"tags"in m&&s(2,o=m.tags)},l.$$.update=()=>{l.$$.dirty&5&&s(3,t=typeof n=="string"&&n!==""&&o.length>1)},[n,r,o,t,a,i,f,u,p]}class zs extends re{constructor(e){super(),oe(this,e,qs,Ms,le,{name:0,description:1,tags:2})}}function Gs(l){let e,s,t,n,r,o,a,i,f,u;return{c(){e=C("div"),s=C("div"),t=C("i"),n=N(),r=C("div"),o=C("h3"),a=x(l[0]),i=N(),f=C("span"),u=x(l[2]),this.h()},l(p){e=I(p,"DIV",{class:!0});var m=T(e);s=I(m,"DIV",{class:!0});var g=T(s);t=I(g,"I",{class:!0}),T(t).forEach(h),g.forEach(h),n=O(m),r=I(m,"DIV",{});var d=T(r);o=I(d,"H3",{class:!0});var v=T(o);a=ee(v,l[0]),v.forEach(h),i=O(d),f=I(d,"SPAN",{});var w=T(f);u=ee(w,l[2]),w.forEach(h),d.forEach(h),m.forEach(h),this.h()},h(){$(t,"class",ct(l[1])+" svelte-1tvgln1"),$(s,"class","icon svelte-1tvgln1"),$(o,"class","svelte-1tvgln1"),$(e,"class","error svelte-1tvgln1")},m(p,m){P(p,e,m),b(e,s),b(s,t),b(e,n),b(e,r),b(r,o),b(o,a),b(r,i),b(r,f),b(f,u)},p:U,i:U,o:U,d(p){p&&h(e)}}}function Us(l,e,s){let{error:t}=e,n=t.message==="Failed to fetch"?"Connection Error":"Application Error",r=t.message==="Failed to fetch"?"codicon codicon-debug-disconnect":"codicon codicon-error",o=t.message==="Failed to fetch"?"Failed to connect to the server. Make sure you have a stable internet connection.":t.message;return l.$$set=a=>{"error"in a&&s(3,t=a.error)},[n,r,o,t]}class Ks extends re{constructor(e){super(),oe(this,e,Us,Gs,le,{error:3})}}function Hs(l){let e;return{c(){e=x("Search")},l(s){e=ee(s,"Search")},m(s,t){P(s,e,t)},d(s){s&&h(e)}}}function Ws(l){let e,s,t,n,r,o;const a=[Js,Zs],i=[];function f(u,p){return u[2].postCount===0?0:1}return s=f(l),t=i[s]=a[s](l),r=new Mt({}),{c(){e=C("section"),t.c(),n=N(),R(r.$$.fragment),this.h()},l(u){e=I(u,"SECTION",{class:!0});var p=T(e);t.l(p),p.forEach(h),n=O(u),B(r.$$.fragment,u),this.h()},h(){$(e,"class","svelte-rk0y4a")},m(u,p){P(u,e,p),i[s].m(e,null),P(u,n,p),A(r,u,p),o=!0},p(u,p){let m=s;s=f(u),s===m?i[s].p(u,p):(te(),S(i[m],1,1,()=>{i[m]=null}),se(),t=i[s],t?t.p(u,p):(t=i[s]=a[s](u),t.c()),E(t,1),t.m(e,null))},i(u){o||(E(t),E(r.$$.fragment,u),o=!0)},o(u){S(t),S(r.$$.fragment,u),o=!1},d(u){u&&(h(e),h(n)),i[s].d(),F(r,u)}}}function Ys(l){let e,s;return e=new Ks({props:{error:l[0]}}),{c(){R(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,n){A(e,t,n),s=!0},p(t,n){const r={};n&1&&(r.error=t[0]),e.$set(r)},i(t){s||(E(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){F(e,t)}}}function Zs(l){let e,s,t,n,r,o;e=new Ts({}),e.$on("sortfilterupdate",l[7]),e.$on("endreached",l[8]);const a=[Xs,Qs],i=[];function f(u,p){return u[2].posts.length===u[2].postCount?0:1}return t=f(l),n=i[t]=a[t](l),{c(){R(e.$$.fragment),s=N(),n.c(),r=_e()},l(u){B(e.$$.fragment,u),s=O(u),n.l(u),r=_e()},m(u,p){A(e,u,p),P(u,s,p),i[t].m(u,p),P(u,r,p),o=!0},p(u,p){let m=t;t=f(u),t===m?i[t].p(u,p):(te(),S(i[m],1,1,()=>{i[m]=null}),se(),n=i[t],n?n.p(u,p):(n=i[t]=a[t](u),n.c()),E(n,1),n.m(r.parentNode,r))},i(u){o||(E(e.$$.fragment,u),E(n),o=!0)},o(u){S(e.$$.fragment,u),S(n),o=!1},d(u){u&&(h(s),h(r)),F(e,u),i[t].d(u)}}}function Js(l){let e,s;return e=new Kt({}),e.$on("sortfilterupdate",l[7]),{c(){R(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,n){A(e,t,n),s=!0},p:U,i(t){s||(E(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){F(e,t)}}}function Qs(l){let e,s;return e=new Bs({props:{rootMargin:"1000px"}}),e.$on("intersection",l[8]),{c(){R(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,n){A(e,t,n),s=!0},p:U,i(t){s||(E(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){F(e,t)}}}function Xs(l){let e,s;return e=new Fs({}),{c(){R(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,n){A(e,t,n),s=!0},p:U,i(t){s||(E(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){F(e,t)}}}function at(l){let e,s;return e=new zs({props:{tags:l[4]}}),e.$on("close",l[13]),e.$on("submit",l[14]),{c(){R(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,n){A(e,t,n),s=!0},p(t,n){const r={};n&16&&(r.tags=t[4]),e.$set(r)},i(t){s||(E(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){F(e,t)}}}function xs(l){let e,s,t,n,r,o,a,i,f,u,p,m,g,d;s=new St({}),n=new Dt({props:{placeholder:"Search for tags",fetchSuggestions:l[6]}}),n.$on("pick",l[9]),o=new Te({props:{title:"Search with the tags above",$$slots:{default:[Hs]},$$scope:{ctx:l}}}),o.$on("click",l[7]),i=new Ct({props:{tags:[...l[4],...l[3]]}}),i.$on("click",l[10]),i.$on("contextmenu",l[11]),i.$on("createSupertag",l[12]);const v=[Ys,Ws],w=[];function y(_,D){return _[0]?0:_[2].requested?1:-1}~(u=y(l))&&(p=w[u]=v[u](l));let c=l[1]&&at(l);return{c(){e=C("section"),R(s.$$.fragment),t=N(),R(n.$$.fragment),r=N(),R(o.$$.fragment),a=N(),R(i.$$.fragment),f=N(),p&&p.c(),m=N(),c&&c.c(),g=_e(),this.h()},l(_){e=I(_,"SECTION",{id:!0,class:!0});var D=T(e);B(s.$$.fragment,D),t=O(D),B(n.$$.fragment,D),r=O(D),B(o.$$.fragment,D),a=O(D),B(i.$$.fragment,D),D.forEach(h),f=O(_),p&&p.l(_),m=O(_),c&&c.l(_),g=_e(),this.h()},h(){$(e,"id","search"),$(e,"class","svelte-rk0y4a")},m(_,D){P(_,e,D),A(s,e,null),b(e,t),A(n,e,null),b(e,r),A(o,e,null),b(e,a),A(i,e,null),P(_,f,D),~u&&w[u].m(_,D),P(_,m,D),c&&c.m(_,D),P(_,g,D),d=!0},p(_,[D]){const H={};D&8388608&&(H.$$scope={dirty:D,ctx:_}),o.$set(H);const Q={};D&24&&(Q.tags=[..._[4],..._[3]]),i.$set(Q);let W=u;u=y(_),u===W?~u&&w[u].p(_,D):(p&&(te(),S(w[W],1,1,()=>{w[W]=null}),se()),~u?(p=w[u],p?p.p(_,D):(p=w[u]=v[u](_),p.c()),E(p,1),p.m(m.parentNode,m)):p=null),_[1]?c?(c.p(_,D),D&2&&E(c,1)):(c=at(_),c.c(),E(c,1),c.m(g.parentNode,g)):c&&(te(),S(c,1,1,()=>{c=null}),se())},i(_){d||(E(s.$$.fragment,_),E(n.$$.fragment,_),E(o.$$.fragment,_),E(i.$$.fragment,_),E(p),E(c),d=!0)},o(_){S(s.$$.fragment,_),S(n.$$.fragment,_),S(o.$$.fragment,_),S(i.$$.fragment,_),S(p),S(c),d=!1},d(_){_&&(h(e),h(f),h(m),h(g)),F(s),F(n),F(o),F(i),~u&&w[u].d(_),c&&c.d(_)}}}const en=()=>{const l=new URL(location.href);if(!l.searchParams.has("tags"))return;const s=(l.searchParams.get("tags")??"").split(";");if(!(!Array.isArray(s)||s.length===0))return s};function tn(l,e,s){let t,n,r,o,a,i;fe(l,Ne,k=>s(2,t=k)),fe(l,Me,k=>s(3,n=k)),fe(l,ue,k=>s(17,r=k)),fe(l,jt,k=>s(18,o=k)),fe(l,Pe,k=>s(4,a=k)),fe(l,Ye,k=>s(5,i=k));let f=!1,u,p=!1,m=0;const g=async k=>{const z=await Nt(k);return[...i.items.filter(({name:Z})=>Z.toLowerCase().includes(k.toLowerCase())).map(Z=>({label:Z.name,count:Z.tags.length,type:"supertag"})),...z]},d=en();d&&d.forEach(k=>{a.some(z=>z.name===k)||Pe.addByName(k)});const v=()=>new It().withPid(t.pageCount).withTags(a).withBlockedContent(o).withSortProperty(r.sortProperty).withSortDirection(r.sortDirection).withScoreValue(r.scoreValue).withScoreComparator(r.scoreComparator).withRating(r.rating).withSupertags(n),w=async k=>{if(!f){s(0,u=void 0),f=!0;try{const z=t.pageCount;await k(),qt(z).catch(()=>{})}catch(z){s(0,u=z),console.warn(z)}finally{f=!1}}},y=async()=>{Ne.reset(),m=0,w(async()=>{const[k,z]=await v().getPageAndCount();console.log(k,z),Ne.addPage(k,z)})},c=async()=>{w(async()=>{const k=await v().getPage();Ne.addPage(k)})},_=k=>{var z,J;if((k.key==="/"||k.key==="s")&&(!document.activeElement||document.activeElement===document.body)&&((z=document.getElementById("searchbar"))==null||z.focus(),k.preventDefault(),k.stopPropagation()),k.ctrlKey&&k.key==="Enter"&&(k.preventDefault(),k.stopPropagation(),y()),k.ctrlKey&&k.key==="m"&&((J=document.getElementById("select-modifier"))==null||J.click()),k.ctrlKey&&k.key==="ArrowDown"){const Z=document.getElementsByClassName("post-media");Z[m].focus(),m=Math.min(m+1,Math.max(0,Z.length-1))}k.ctrlKey&&k.key==="ArrowUp"&&(document.getElementsByClassName("post-media")[m].focus(),m=Math.max(m-1,0))};return je(()=>{document.addEventListener("keydown",_)}),Ve(()=>{document.removeEventListener("keydown",_)}),[u,p,t,n,a,i,g,y,c,async k=>{const z=k.detail;if(z.type==="supertag"){const J=i.items.find(Z=>Z.name===z.label);if(!J){console.log("Supertag not present.");return}Me.addOrReplace(J)}else{const J=await Ot(k.detail.label);Pe.addOrReplace({name:k.detail.label,modifier:k.detail.modifier,count:k.detail.count,type:J.type})}},k=>"description"in k.detail?Me.removeByName(k.detail.name):Pe.removeByName(k.detail.name),k=>{"description"in k.detail||(k.detail.modifier=Pt(k.detail.modifier),Pe.addOrReplace(k.detail))},()=>s(1,p=!0),()=>s(1,p=!1),k=>Ye.add(k.detail)]}class wn extends re{constructor(e){super(),oe(this,e,tn,xs,le,{})}}export{wn as component};
