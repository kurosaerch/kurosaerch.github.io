import{s as ne,f as E,a as P,g as C,c as N,y as ce,D as _e,j as d,i as O,d as _,E as Se,l as X,m as x,e as ue,h as R,u as v,F as ie,n as Oe,C as pe,G as $t,p as be,H as ke,I as Be,J as ot,K as je,L as we,k as Ve,v as U,M as Fe,w as vt,N as bt,z as kt,A as wt,B as yt,o as Me,O as at,P as ze,r as it}from"../chunks/scheduler.88299003.js";import{S as le,i as re,b as L,d as V,m as F,a as b,t as y,e as M,g as ee,c as te,f as Ae}from"../chunks/index.15b414ac.js";import{s as fe,r as Ne,K as St,A as Et,a as Le,S as Ct}from"../chunks/search-builder.1bb73e3b.js";import{S as It,n as Dt,s as He}from"../chunks/supertags-store.b1acc28d.js";import{T as Te}from"../chunks/TextButton.2f318c50.js";import{g as Pt,a as Nt}from"../chunks/tags.58927cde.js";import{a as Pe}from"../chunks/active-tags-store.ee1f6602.js";import{b as ct}from"../chunks/paths.600dabf7.js";import{e as ye}from"../chunks/each.e59479a4.js";import{D as ut,r as Ot}from"../chunks/Dialog.f8853b6f.js";import{i as ft,D as pt,G as _t,V as Tt,I as Rt}from"../chunks/Details.49e215b8.js";import{f as Re}from"../chunks/format-tag.d6c065e3.js";import{R as Bt,I as At}from"../chunks/ModifierSelect.623aacd6.js";import{S as We}from"../chunks/Select.22805bc7.js";import{R as jt}from"../chunks/RotatingTextSelect.7e32facf.js";import{b as Lt}from"../chunks/blocked-content-store.805c4a3d.js";import{D as Vt}from"../chunks/DetailedTag.28ff9b0d.js";import{S as Ft}from"../chunks/ScrollUpButton.cfa21b3f.js";import{l as Mt}from"../chunks/analytics.12ea4383.js";function zt(n){let e;return{c(){e=X("Reset Filter")},l(s){e=x(s,"Reset Filter")},m(s,t){O(s,e,t)},d(s){s&&_(e)}}}function qt(n){let e,s,t,l,r="We couldn't find any posts matching your tags. Sorry...",o,f,i;return f=new Te({props:{title:"In case your filter caused all posts to vanish. Reset it.",$$slots:{default:[zt]},$$scope:{ctx:n}}}),f.$on("click",n[1]),{c(){e=E("img"),t=P(),l=E("p"),l.textContent=r,o=P(),L(f.$$.fragment),this.h()},l(c){e=C(c,"IMG",{src:!0,alt:!0,class:!0}),t=N(c),l=C(c,"P",{"data-svelte-h":!0}),ce(l)!=="svelte-1utxj3w"&&(l.textContent=r),o=N(c),V(f.$$.fragment,c),this.h()},h(){_e(e.src,s=ct+"/assets/shironeko-confused.png")||d(e,"src",s),d(e,"alt","Nothing here..."),d(e,"class","svelte-1bb5e7g")},m(c,a){O(c,e,a),O(c,t,a),O(c,l,a),O(c,o,a),F(f,c,a),i=!0},p(c,[a]){const u={};a&4&&(u.$$scope={dirty:a,ctx:c}),f.$set(u)},i(c){i||(b(f.$$.fragment,c),i=!0)},o(c){y(f.$$.fragment,c),i=!1},d(c){c&&(_(e),_(t),_(l),_(o)),M(f,c)}}}function Gt(n){const e=Se();return[e,()=>{fe.reset(),e("sortfilterupdate")}]}class Ut extends le{constructor(e){super(),re(this,e,Gt,qt,ne,{})}}function Ye(n){let e,s;return e=new ut({props:{$$slots:{default:[Wt]},$$scope:{ctx:n}}}),e.$on("close",n[6]),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,l){F(e,t,l),s=!0},p(t,l){const r={};l&32771&&(r.$$scope={dirty:l,ctx:t}),e.$set(r)},i(t){s||(b(e.$$.fragment,t),s=!0)},o(t){y(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function Kt(n){let e;return{c(){e=X("Done")},l(s){e=x(s,"Done")},m(s,t){O(s,e,t)},d(s){s&&_(e)}}}function Ht(n){let e;return{c(){e=X("Reset")},l(s){e=x(s,"Reset")},m(s,t){O(s,e,t)},d(s){s&&_(e)}}}function Wt(n){let e,s,t="Sorting and Filtering",l,r,o,f="Sorting",i,c,a,u,p,k,m,D,h,w,g="Filtering by Score",S,I,Y,oe,Z,K,ae,$,q,J="Filtering by Rating",W,Q,j,Ee,B,T,H,z,se,ve,Ce;function Ie(A){n[8](A)}let qe={options:Jt};n[1].sortDirection!==void 0&&(qe.value=n[1].sortDirection),a=new Bt({props:qe}),be.push(()=>Ae(a,"value",Ie));function gt(A){n[9](A)}let Ge={options:Zt};n[1].sortProperty!==void 0&&(Ge.value=n[1].sortProperty),k=new We({props:Ge}),be.push(()=>Ae(k,"value",gt));function dt(A){n[10](A)}let Ue={options:Qt};n[1].scoreComparator!==void 0&&(Ue.value=n[1].scoreComparator),Y=new jt({props:Ue}),be.push(()=>Ae(Y,"value",dt));function ht(A){n[13](A)}let Ke={options:mt};return n[1].rating!==void 0&&(Ke.value=n[1].rating),j=new We({props:Ke}),be.push(()=>Ae(j,"value",ht)),T=new Te({props:{title:"Return to searching.",$$slots:{default:[Kt]},$$scope:{ctx:n}}}),T.$on("click",n[6]),z=new Te({props:{title:"Reset sort and filter.",type:"secondary",$$slots:{default:[Ht]},$$scope:{ctx:n}}}),z.$on("click",n[7]),{c(){e=E("div"),s=E("h3"),s.textContent=t,l=P(),r=E("label"),o=E("b"),o.textContent=f,i=P(),c=E("div"),L(a.$$.fragment),p=P(),L(k.$$.fragment),D=P(),h=E("label"),w=E("b"),w.textContent=g,S=P(),I=E("div"),L(Y.$$.fragment),Z=P(),K=E("input"),ae=P(),$=E("label"),q=E("b"),q.textContent=J,W=P(),Q=E("div"),L(j.$$.fragment),B=P(),L(T.$$.fragment),H=P(),L(z.$$.fragment),this.h()},l(A){e=C(A,"DIV",{class:!0});var G=R(e);s=C(G,"H3",{"data-svelte-h":!0}),ce(s)!=="svelte-15zouq3"&&(s.textContent=t),l=N(G),r=C(G,"LABEL",{class:!0});var me=R(r);o=C(me,"B",{"data-svelte-h":!0}),ce(o)!=="svelte-ekzpgg"&&(o.textContent=f),i=N(me),c=C(me,"DIV",{class:!0});var ge=R(c);V(a.$$.fragment,ge),p=N(ge),V(k.$$.fragment,ge),ge.forEach(_),me.forEach(_),D=N(G),h=C(G,"LABEL",{class:!0});var de=R(h);w=C(de,"B",{"data-svelte-h":!0}),ce(w)!=="svelte-1flca3"&&(w.textContent=g),S=N(de),I=C(de,"DIV",{class:!0});var he=R(I);V(Y.$$.fragment,he),Z=N(he),K=C(he,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),he.forEach(_),de.forEach(_),ae=N(G),$=C(G,"LABEL",{class:!0});var $e=R($);q=C($e,"B",{"data-svelte-h":!0}),ce(q)!=="svelte-1evbw58"&&(q.textContent=J),W=N($e),Q=C($e,"DIV",{class:!0});var De=R(Q);V(j.$$.fragment,De),De.forEach(_),$e.forEach(_),B=N(G),V(T.$$.fragment,G),H=N(G),V(z.$$.fragment,G),G.forEach(_),this.h()},h(){d(c,"class","row svelte-1omoy36"),d(r,"class","svelte-1omoy36"),d(K,"type","number"),d(K,"min",0),d(K,"max",1e5),d(K,"step",1),d(K,"class","svelte-1omoy36"),d(I,"class","row svelte-1omoy36"),d(h,"class","svelte-1omoy36"),d(Q,"class","row svelte-1omoy36"),d($,"class","svelte-1omoy36"),d(e,"class","container svelte-1omoy36")},m(A,G){O(A,e,G),v(e,s),v(e,l),v(e,r),v(r,o),v(r,i),v(r,c),F(a,c,null),v(c,p),F(k,c,null),v(e,D),v(e,h),v(h,w),v(h,S),v(h,I),F(Y,I,null),v(I,Z),v(I,K),ke(K,n[0]),v(e,ae),v(e,$),v($,q),v($,W),v($,Q),F(j,Q,null),v(e,B),F(T,e,null),v(e,H),F(z,e,null),se=!0,ve||(Ce=[ie(K,"input",n[11]),ie(K,"keyup",n[12])],ve=!0)},p(A,G){const me={};!u&&G&2&&(u=!0,me.value=A[1].sortDirection,Be(()=>u=!1)),a.$set(me);const ge={};!m&&G&2&&(m=!0,ge.value=A[1].sortProperty,Be(()=>m=!1)),k.$set(ge);const de={};!oe&&G&2&&(oe=!0,de.value=A[1].scoreComparator,Be(()=>oe=!1)),Y.$set(de),G&1&&ot(K.value)!==A[0]&&ke(K,A[0]);const he={};!Ee&&G&2&&(Ee=!0,he.value=A[1].rating,Be(()=>Ee=!1)),j.$set(he);const $e={};G&32768&&($e.$$scope={dirty:G,ctx:A}),T.$set($e);const De={};G&32768&&(De.$$scope={dirty:G,ctx:A}),z.$set(De)},i(A){se||(b(a.$$.fragment,A),b(k.$$.fragment,A),b(Y.$$.fragment,A),b(j.$$.fragment,A),b(T.$$.fragment,A),b(z.$$.fragment,A),se=!0)},o(A){y(a.$$.fragment,A),y(k.$$.fragment,A),y(Y.$$.fragment,A),y(j.$$.fragment,A),y(T.$$.fragment,A),y(z.$$.fragment,A),se=!1},d(A){A&&_(e),M(a),M(k),M(Y),M(j),M(T),M(z),ve=!1,je(Ce)}}}function Yt(n){let e,s,t,l,r,o,f,i,c,a,u,p,k,m,D,h=n[2]&&Ye(n);return{c(){e=E("button"),s=E("i"),t=P(),l=E("span"),r=X(n[4]),o=P(),f=E("i"),i=P(),c=E("span"),a=X(n[3]),u=P(),h&&h.c(),p=ue(),this.h()},l(w){e=C(w,"BUTTON",{class:!0});var g=R(e);s=C(g,"I",{class:!0}),R(s).forEach(_),t=N(g),l=C(g,"SPAN",{});var S=R(l);r=x(S,n[4]),S.forEach(_),o=N(g),f=C(g,"I",{class:!0}),R(f).forEach(_),i=N(g),c=C(g,"SPAN",{});var I=R(c);a=x(I,n[3]),I.forEach(_),g.forEach(_),u=N(w),h&&h.l(w),p=ue(),this.h()},h(){d(s,"class","codicon codicon-filter svelte-1omoy36"),d(f,"class","codicon codicon-arrow-swap svelte-1omoy36"),d(e,"class","svelte-1omoy36")},m(w,g){O(w,e,g),v(e,s),v(e,t),v(e,l),v(l,r),v(e,o),v(e,f),v(e,i),v(e,c),v(c,a),O(w,u,g),h&&h.m(w,g),O(w,p,g),k=!0,m||(D=ie(e,"click",n[5]),m=!0)},p(w,[g]){(!k||g&16)&&Oe(r,w[4]),(!k||g&8)&&Oe(a,w[3]),w[2]?h?(h.p(w,g),g&4&&b(h,1)):(h=Ye(w),h.c(),b(h,1),h.m(p.parentNode,p)):h&&(ee(),y(h,1,1,()=>{h=null}),te())},i(w){k||(b(h),k=!0)},o(w){y(h),k=!1},d(w){w&&(_(e),_(u),_(p)),h&&h.d(w),m=!1,D()}}}const Zt=Object.freeze({id:"Uploaded",score:"Score",updated:"Updated"}),Jt=Object.freeze({desc:"codicon codicon-arrow-down",asc:"codicon codicon-arrow-up"}),Qt=Object.freeze({">=":"≥","<=":"≤"}),mt=Object.freeze({all:"All",safe:"Safe",questionable:"Questionable",explicit:"Explicit"}),Xt=Object.freeze({id:{asc:"Oldest",desc:"Newest"},score:{asc:"Worst",desc:"Best"},updated:{asc:"Inactive",desc:"Active"}}),xt=(n,e,s)=>{let t=n==="all"?void 0:mt[n],l=e===0&&s===">="?void 0:`Score${s}${Re(e)}`;return[t,l].filter(r=>r!==void 0).join(",")||"All"};function es(n,e,s){let t,l,r;pe(n,fe,g=>s(1,r=g));const o=Se();let f=!1;const i=()=>s(2,f=!0),c=()=>{s(2,f=!1),o("sortfilterupdate")},a=()=>{fe.reset(),s(0,u=r.scoreValue)};let u;function p(g){n.$$.not_equal(r.sortDirection,g)&&(r.sortDirection=g,fe.set(r))}function k(g){n.$$.not_equal(r.sortProperty,g)&&(r.sortProperty=g,fe.set(r))}function m(g){n.$$.not_equal(r.scoreComparator,g)&&(r.scoreComparator=g,fe.set(r))}function D(){u=ot(this.value),s(0,u),s(1,r)}const h=g=>ft(g)&&g.target.blur();function w(g){n.$$.not_equal(r.rating,g)&&(r.rating=g,fe.set(r))}return n.$$.update=()=>{if(n.$$.dirty&3){u===void 0&&s(0,u=r.scoreValue);let g=Number(u);isNaN(g)||$t(fe,r.scoreValue=g,r)}n.$$.dirty&2&&s(4,t=xt(r.rating,r.scoreValue,r.scoreComparator)),n.$$.dirty&2&&s(3,l=Xt[r.sortProperty][r.sortDirection])},[u,r,f,l,t,i,c,a,p,k,m,D,h,w]}class ts extends le{constructor(e){super(),re(this,e,es,Yt,ne,{})}}function ss(n){let e,s;return e=new _t({props:{post:n[1]}}),e.$on("click",n[2]),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,l){F(e,t,l),s=!0},p(t,l){const r={};l&2&&(r.post=t[1]),e.$set(r)},i(t){s||(b(e.$$.fragment,t),s=!0)},o(t){y(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function ns(n){let e,s;return e=new Tt({props:{src:n[1].file_url,poster:n[1].sample_url,width:n[1].width,height:n[1].height,loop:n[1].tags.some(Je)}}),e.$on("click",n[2]),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,l){F(e,t,l),s=!0},p(t,l){const r={};l&2&&(r.src=t[1].file_url),l&2&&(r.poster=t[1].sample_url),l&2&&(r.width=t[1].width),l&2&&(r.height=t[1].height),l&2&&(r.loop=t[1].tags.some(Je)),e.$set(r)},i(t){s||(b(e.$$.fragment,t),s=!0)},o(t){y(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function ls(n){let e,s;return e=new Rt({props:{post:n[1],open:n[0]}}),e.$on("click",n[2]),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,l){F(e,t,l),s=!0},p(t,l){const r={};l&2&&(r.post=t[1]),l&1&&(r.open=t[0]),e.$set(r)},i(t){s||(b(e.$$.fragment,t),s=!0)},o(t){y(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function Ze(n){let e,s;return e=new pt({props:{post:n[1]}}),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,l){F(e,t,l),s=!0},p(t,l){const r={};l&2&&(r.post=t[1]),e.$set(r)},i(t){s||(b(e.$$.fragment,t),s=!0)},o(t){y(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function rs(n){let e,s,t,l,r,o;const f=[ls,ns,ss],i=[];function c(u,p){return u[1].type==="image"?0:u[1].type==="video"?1:2}s=c(n),t=i[s]=f[s](n);let a=n[0]&&Ze(n);return{c(){e=E("div"),t.c(),l=P(),a&&a.c(),this.h()},l(u){e=C(u,"DIV",{id:!0,class:!0});var p=R(e);t.l(p),l=N(p),a&&a.l(p),p.forEach(_),this.h()},h(){d(e,"id",r="post_"+n[1].id),d(e,"class","post svelte-uali72"),we(e,"open",n[0])},m(u,p){O(u,e,p),i[s].m(e,null),v(e,l),a&&a.m(e,null),o=!0},p(u,[p]){let k=s;s=c(u),s===k?i[s].p(u,p):(ee(),y(i[k],1,1,()=>{i[k]=null}),te(),t=i[s],t?t.p(u,p):(t=i[s]=f[s](u),t.c()),b(t,1),t.m(e,l)),u[0]?a?(a.p(u,p),p&1&&b(a,1)):(a=Ze(u),a.c(),b(a,1),a.m(e,null)):a&&(ee(),y(a,1,1,()=>{a=null}),te()),(!o||p&2&&r!==(r="post_"+u[1].id))&&d(e,"id",r),(!o||p&1)&&we(e,"open",u[0])},i(u){o||(b(t),b(a),o=!0)},o(u){y(t),y(a),o=!1},d(u){u&&_(e),i[s].d(),a&&a.d()}}}const Je=n=>n.name=="loop";function os(n,e,s){let{post:t}=e,{open:l=!1}=e;const r=()=>{s(0,l=!l)};return n.$$set=o=>{"post"in o&&s(1,t=o.post),"open"in o&&s(0,l=o.open)},[l,t,r]}class as extends le{constructor(e){super(),re(this,e,os,rs,ne,{post:1,open:0})}}function Qe(n){let e,s=n[0].type==="video"?"▶":"GIF",t;return{c(){e=E("span"),t=X(s),this.h()},l(l){e=C(l,"SPAN",{class:!0});var r=R(e);t=x(r,s),r.forEach(_),this.h()},h(){d(e,"class","type svelte-14imjnt")},m(l,r){O(l,e,r),v(e,t)},p(l,r){r&1&&s!==(s=l[0].type==="video"?"▶":"GIF")&&Oe(t,s)},d(l){l&&_(e)}}}function is(n){let e,s,t,l,r,o=Re(n[0].score)+"",f,i,c,a,u,p=n[0].type!=="image"&&Qe(n);return{c(){e=E("div"),s=E("img"),l=P(),r=E("span"),f=X(o),i=P(),p&&p.c(),this.h()},l(k){e=C(k,"DIV",{id:!0,class:!0,style:!0});var m=R(e);s=C(m,"IMG",{src:!0,alt:!0,class:!0,tabindex:!0,loading:!0}),l=N(m),r=C(m,"SPAN",{class:!0});var D=R(r);f=x(D,o),D.forEach(_),i=N(m),p&&p.l(m),m.forEach(_),this.h()},h(){_e(s.src,t=n[1])||d(s,"src",t),d(s,"alt","post"),d(s,"class","post-media svelte-14imjnt"),d(s,"tabindex","-1"),d(s,"loading","lazy"),d(r,"class","score svelte-14imjnt"),d(e,"id",c="post_"+n[0].id),d(e,"class","post svelte-14imjnt"),Ve(e,"grid-row","span "+n[2]),we(e,"open",open)},m(k,m){O(k,e,m),v(e,s),v(e,l),v(e,r),v(r,f),v(e,i),p&&p.m(e,null),a||(u=[ie(e,"click",n[3]),ie(e,"keydown",n[4])],a=!0)},p(k,[m]){m&2&&!_e(s.src,t=k[1])&&d(s,"src",t),m&1&&o!==(o=Re(k[0].score)+"")&&Oe(f,o),k[0].type!=="image"?p?p.p(k,m):(p=Qe(k),p.c(),p.m(e,null)):p&&(p.d(1),p=null),m&1&&c!==(c="post_"+k[0].id)&&d(e,"id",c),m&0&&we(e,"open",open)},i:U,o:U,d(k){k&&_(e),p&&p.d(),a=!1,je(u)}}}function cs(n,e,s){let t,{post:l}=e,r=Math.min(Math.round(l.height/l.width*5),15);const o=c=>c.endsWith(".jpg")||c.endsWith(".jpeg")||c.endsWith(".png")||c.endsWith(".webp");function f(c){Fe.call(this,n,c)}const i=c=>{ft(c)&&c.target.click()};return n.$$set=c=>{"post"in c&&s(0,l=c.post)},n.$$.update=()=>{n.$$.dirty&1&&s(1,t=o(l.sample_url)?l.sample_url:l.preview_url)},[l,t,r,f,i]}class us extends le{constructor(e){super(),re(this,e,cs,is,ne,{post:0})}}function fs(n){let e,s,t,l;const r=n[3].default,o=vt(r,n,n[2],null);return{c(){e=E("div"),o&&o.c(),this.h()},l(f){e=C(f,"DIV",{role:!0,tabindex:!0,class:!0});var i=R(e);o&&o.l(i),i.forEach(_),this.h()},h(){d(e,"role","none"),d(e,"tabindex","-1"),d(e,"class","dialog svelte-1kq1os1")},m(f,i){O(f,e,i),o&&o.m(e,null),n[5](e),s=!0,t||(l=[ie(e,"keydown",n[4]),ie(e,"click",bt(ps))],t=!0)},p(f,[i]){o&&o.p&&(!s||i&4)&&kt(o,r,f,f[2],s?yt(r,f[2],i,null):wt(f[2]),null)},i(f){s||(b(o,f),s=!0)},o(f){y(o,f),s=!1},d(f){f&&_(e),o&&o.d(f),n[5](null),t=!1,je(l)}}}const ps=()=>{};function _s(n,e,s){let{$$slots:t={},$$scope:l}=e;const r=Se(),o=()=>r("close");let f;Me(async()=>{f.focus()});const i=a=>{a.code==="Escape"&&o()};function c(a){be[a?"unshift":"push"](()=>{f=a,s(0,f)})}return n.$$set=a=>{"$$scope"in a&&s(2,l=a.$$scope)},[f,o,l,t,i,c]}class ms extends le{constructor(e){super(),re(this,e,_s,fs,ne,{})}}function gs(n){let e,s;return e=new _t({props:{post:n[0]}}),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,l){F(e,t,l),s=!0},p(t,l){const r={};l&1&&(r.post=t[0]),e.$set(r)},i(t){s||(b(e.$$.fragment,t),s=!0)},o(t){y(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function ds(n){let e,s;return{c(){e=E("video"),this.h()},l(t){e=C(t,"VIDEO",{src:!0,class:!0}),R(e).forEach(_),this.h()},h(){_e(e.src,s=n[0].file_url)||d(e,"src",s),e.controls=!0,d(e,"class","svelte-zzd83x")},m(t,l){O(t,e,l)},p(t,l){l&1&&!_e(e.src,s=t[0].file_url)&&d(e,"src",s)},i:U,o:U,d(t){t&&_(e)}}}function hs(n){let e,s,t,l,r;return{c(){e=E("img"),this.h()},l(o){e=C(o,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){_e(e.src,s=n[0].file_url)||d(e,"src",s),d(e,"alt",t="Image of Post "+n[0].id),d(e,"class","svelte-zzd83x"),we(e,"zoomed",n[1])},m(o,f){O(o,e,f),l||(r=ie(e,"click",n[3]),l=!0)},p(o,f){f&1&&!_e(e.src,s=o[0].file_url)&&d(e,"src",s),f&1&&t!==(t="Image of Post "+o[0].id)&&d(e,"alt",t),f&2&&we(e,"zoomed",o[1])},i:U,o:U,d(o){o&&_(e),l=!1,r()}}}function $s(n){let e;return{c(){e=E("i"),this.h()},l(s){e=C(s,"I",{class:!0}),R(e).forEach(_),this.h()},h(){d(e,"class","codicon codicon-close")},m(s,t){O(s,e,t)},p:U,d(s){s&&_(e)}}}function vs(n){let e,s,t,l,r,o,f,i,c,a;const u=[hs,ds,gs],p=[];function k(m,D){return m[0].type==="image"?0:m[0].type==="video"?1:2}return s=k(n),t=p[s]=u[s](n),r=new At({props:{class:"button-close",$$slots:{default:[$s]},$$scope:{ctx:n}}}),r.$on("click",n[4]),c=new pt({props:{post:n[0]}}),{c(){e=E("div"),t.c(),l=P(),L(r.$$.fragment),o=P(),f=E("i"),i=P(),L(c.$$.fragment),this.h()},l(m){e=C(m,"DIV",{class:!0});var D=R(e);t.l(D),l=N(D),V(r.$$.fragment,D),o=N(D),f=C(D,"I",{class:!0}),R(f).forEach(_),D.forEach(_),i=N(m),V(c.$$.fragment,m),this.h()},h(){d(f,"class","codicon codicon-chevron-down svelte-zzd83x"),d(e,"class","svelte-zzd83x")},m(m,D){O(m,e,D),p[s].m(e,null),v(e,l),F(r,e,null),v(e,o),v(e,f),O(m,i,D),F(c,m,D),a=!0},p(m,D){let h=s;s=k(m),s===h?p[s].p(m,D):(ee(),y(p[h],1,1,()=>{p[h]=null}),te(),t=p[s],t?t.p(m,D):(t=p[s]=u[s](m),t.c()),b(t,1),t.m(e,l));const w={};D&64&&(w.$$scope={dirty:D,ctx:m}),r.$set(w);const g={};D&1&&(g.post=m[0]),c.$set(g)},i(m){a||(b(t),b(r.$$.fragment,m),b(c.$$.fragment,m),a=!0)},o(m){y(t),y(r.$$.fragment,m),y(c.$$.fragment,m),a=!1},d(m){m&&(_(e),_(i)),p[s].d(),M(r),M(c,m)}}}function bs(n){let e,s;return e=new ms({props:{$$slots:{default:[vs]},$$scope:{ctx:n}}}),e.$on("close",n[5]),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,l){F(e,t,l),s=!0},p(t,[l]){const r={};l&67&&(r.$$scope={dirty:l,ctx:t}),e.$set(r)},i(t){s||(b(e.$$.fragment,t),s=!0)},o(t){y(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function ks(n,e,s){const t=Se();let{post:l}=e,r=l.width/l.height<.33;const o=()=>s(1,r=!r),f=()=>t("close");function i(c){Fe.call(this,n,c)}return n.$$set=c=>{"post"in c&&s(0,l=c.post)},[l,r,t,o,f,i]}class ws extends le{constructor(e){super(),re(this,e,ks,bs,ne,{post:0})}}function Xe(n,e,s){const t=n.slice();return t[8]=e[s],t}function xe(n,e,s){const t=n.slice();return t[8]=e[s],t}function ys(n){let e,s,t,l,r=ye(n[2].posts),o=[];for(let c=0;c<r.length;c+=1)o[c]=et(Xe(n,r,c));const f=c=>y(o[c],1,1,()=>{o[c]=null});let i=n[1]&&n[0]!==void 0&&tt(n);return{c(){e=E("section");for(let c=0;c<o.length;c+=1)o[c].c();s=P(),i&&i.c(),t=ue(),this.h()},l(c){e=C(c,"SECTION",{class:!0,style:!0});var a=R(e);for(let u=0;u<o.length;u+=1)o[u].l(a);a.forEach(_),s=N(c),i&&i.l(c),t=ue(),this.h()},h(){d(e,"class","multi svelte-q6spg0"),Ve(e,"grid-template-columns","repeat("+n[3]+", 1fr)")},m(c,a){O(c,e,a);for(let u=0;u<o.length;u+=1)o[u]&&o[u].m(e,null);O(c,s,a),i&&i.m(c,a),O(c,t,a),l=!0},p(c,a){if(a&5){r=ye(c[2].posts);let u;for(u=0;u<r.length;u+=1){const p=Xe(c,r,u);o[u]?(o[u].p(p,a),b(o[u],1)):(o[u]=et(p),o[u].c(),b(o[u],1),o[u].m(e,null))}for(ee(),u=r.length;u<o.length;u+=1)f(u);te()}(!l||a&8)&&Ve(e,"grid-template-columns","repeat("+c[3]+", 1fr)"),c[1]&&c[0]!==void 0?i?(i.p(c,a),a&3&&b(i,1)):(i=tt(c),i.c(),b(i,1),i.m(t.parentNode,t)):i&&(ee(),y(i,1,1,()=>{i=null}),te())},i(c){if(!l){for(let a=0;a<r.length;a+=1)b(o[a]);b(i),l=!0}},o(c){o=o.filter(Boolean);for(let a=0;a<o.length;a+=1)y(o[a]);y(i),l=!1},d(c){c&&(_(e),_(s),_(t)),ze(o,c),i&&i.d(c)}}}function Ss(n){let e,s,t=ye(n[2].posts),l=[];for(let o=0;o<t.length;o+=1)l[o]=st(xe(n,t,o));const r=o=>y(l[o],1,1,()=>{l[o]=null});return{c(){e=E("section");for(let o=0;o<l.length;o+=1)l[o].c();this.h()},l(o){e=C(o,"SECTION",{class:!0});var f=R(e);for(let i=0;i<l.length;i+=1)l[i].l(f);f.forEach(_),this.h()},h(){d(e,"class","single svelte-q6spg0")},m(o,f){O(o,e,f);for(let i=0;i<l.length;i+=1)l[i]&&l[i].m(e,null);s=!0},p(o,f){if(f&4){t=ye(o[2].posts);let i;for(i=0;i<t.length;i+=1){const c=xe(o,t,i);l[i]?(l[i].p(c,f),b(l[i],1)):(l[i]=st(c),l[i].c(),b(l[i],1),l[i].m(e,null))}for(ee(),i=t.length;i<l.length;i+=1)r(i);te()}},i(o){if(!s){for(let f=0;f<t.length;f+=1)b(l[f]);s=!0}},o(o){l=l.filter(Boolean);for(let f=0;f<l.length;f+=1)y(l[f]);s=!1},d(o){o&&_(e),ze(l,o)}}}function et(n){let e,s;function t(){return n[5](n[8])}return e=new us({props:{post:n[8]}}),e.$on("click",t),{c(){L(e.$$.fragment)},l(l){V(e.$$.fragment,l)},m(l,r){F(e,l,r),s=!0},p(l,r){n=l;const o={};r&4&&(o.post=n[8]),e.$set(o)},i(l){s||(b(e.$$.fragment,l),s=!0)},o(l){y(e.$$.fragment,l),s=!1},d(l){M(e,l)}}}function tt(n){let e,s;return e=new ws({props:{post:n[0]}}),e.$on("close",n[6]),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,l){F(e,t,l),s=!0},p(t,l){const r={};l&1&&(r.post=t[0]),e.$set(r)},i(t){s||(b(e.$$.fragment,t),s=!0)},o(t){y(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function st(n){let e,s;return e=new as({props:{post:n[8]}}),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,l){F(e,t,l),s=!0},p(t,l){const r={};l&4&&(r.post=t[8]),e.$set(r)},i(t){s||(b(e.$$.fragment,t),s=!0)},o(t){y(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function Es(n){let e,s,t=Re(n[2].postCount)+"",l,r,o,f,i,c,a,u,p;f=new ts({}),f.$on("sortfilterupdate",n[4]);const k=[Ss,ys],m=[];function D(h,w){return h[3]==="1"?0:1}return c=D(n),a=m[c]=k[c](n),{c(){e=E("div"),s=E("span"),l=X(t),r=X(" posts"),o=P(),L(f.$$.fragment),i=P(),a.c(),u=ue(),this.h()},l(h){e=C(h,"DIV",{class:!0});var w=R(e);s=C(w,"SPAN",{});var g=R(s);l=x(g,t),r=x(g," posts"),g.forEach(_),o=N(w),V(f.$$.fragment,w),w.forEach(_),i=N(h),a.l(h),u=ue(),this.h()},h(){d(e,"class","svelte-q6spg0")},m(h,w){O(h,e,w),v(e,s),v(s,l),v(s,r),v(e,o),F(f,e,null),O(h,i,w),m[c].m(h,w),O(h,u,w),p=!0},p(h,[w]){(!p||w&4)&&t!==(t=Re(h[2].postCount)+"")&&Oe(l,t);let g=c;c=D(h),c===g?m[c].p(h,w):(ee(),y(m[g],1,1,()=>{m[g]=null}),te(),a=m[c],a?a.p(h,w):(a=m[c]=k[c](h),a.c()),b(a,1),a.m(u.parentNode,u))},i(h){p||(b(f.$$.fragment,h),b(a),p=!0)},o(h){y(f.$$.fragment,h),y(a),p=!1},d(h){h&&(_(e),_(i),_(u)),M(f),m[c].d(h)}}}function Cs(n,e,s){let t,l;pe(n,Ne,u=>s(2,t=u)),pe(n,Ot,u=>s(3,l=u));let r,o=location.hash.length>2;const f=()=>{s(1,o=location.hash.length>2)};Me(()=>{window.addEventListener("hashchange",f)}),at(()=>{window.removeEventListener("hashchange",f)});function i(u){Fe.call(this,n,u)}return[r,o,t,l,i,u=>{s(0,r=u),location.hash=`fullscreen_${u.id}`},()=>{s(0,r=void 0),history.back()}]}class Is extends le{constructor(e){super(),re(this,e,Cs,Es,ne,{})}}function Ds(n){let e;return{c(){e=E("div")},l(s){e=C(s,"DIV",{}),R(e).forEach(_)},m(s,t){O(s,e,t),n[2](e)},p:U,i:U,o:U,d(s){s&&_(e),n[2](null)}}}function Ps(n,e,s){let{rootMargin:t}=e;const l=Se(),r=new IntersectionObserver(i=>{i[0].isIntersecting&&l("intersection")},{rootMargin:t});let o;function f(i){be[i?"unshift":"push"](()=>{o=i,s(0,o)})}return n.$$set=i=>{"rootMargin"in i&&s(1,t=i.rootMargin)},n.$$.update=()=>{n.$$.dirty&1&&(r.disconnect(),o&&r.observe(o))},[o,t,f]}class Ns extends le{constructor(e){super(),re(this,e,Ps,Ds,ne,{rootMargin:1})}}function Os(n){let e,s,t,l,r="You have seen everything there is to see...";return{c(){e=E("img"),t=P(),l=E("p"),l.textContent=r,this.h()},l(o){e=C(o,"IMG",{src:!0,alt:!0,class:!0}),t=N(o),l=C(o,"P",{"data-svelte-h":!0}),ce(l)!=="svelte-1i75mtf"&&(l.textContent=r),this.h()},h(){_e(e.src,s=ct+"/assets/shironeko-x.png")||d(e,"src",s),d(e,"alt","No more results to load"),d(e,"class","svelte-1pkma0d")},m(o,f){O(o,e,f),O(o,t,f),O(o,l,f)},p:U,i:U,o:U,d(o){o&&(_(e),_(t),_(l))}}}class Ts extends le{constructor(e){super(),re(this,e,null,Os,ne,{})}}function nt(n,e,s){const t=n.slice();return t[9]=e[s],t}function lt(n){let e,s;return e=new Vt({props:{tag:n[9]}}),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,l){F(e,t,l),s=!0},p(t,l){const r={};l&4&&(r.tag=t[9]),e.$set(r)},i(t){s||(b(e.$$.fragment,t),s=!0)},o(t){y(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function Rs(n){let e;return{c(){e=X("Create supertag")},l(s){e=x(s,"Create supertag")},m(s,t){O(s,e,t)},d(s){s&&_(e)}}}function Bs(n){let e,s,t="Create Supertag",l,r,o,f,i,c="Name",a,u,p,k,m,D="Description",h,w,g,S,I,Y="Tags",oe,Z,K,ae,$,q,J,W,Q=ye(n[2]),j=[];for(let B=0;B<Q.length;B+=1)j[B]=lt(nt(n,Q,B));const Ee=B=>y(j[B],1,1,()=>{j[B]=null});return $=new Te({props:{title:n[3]?"Click to create supertag":"Enter a valid name to continue",disabled:!n[3],$$slots:{default:[Rs]},$$scope:{ctx:n}}}),$.$on("click",n[8]),{c(){e=E("section"),s=E("h3"),s.textContent=t,l=P(),r=E("button"),o=P(),f=E("div"),i=E("label"),i.textContent=c,a=P(),u=E("input"),p=P(),k=E("div"),m=E("label"),m.textContent=D,h=P(),w=E("input"),g=P(),S=E("div"),I=E("span"),I.textContent=Y,oe=P(),Z=E("ol");for(let B=0;B<j.length;B+=1)j[B].c();K=P(),ae=E("div"),L($.$$.fragment),this.h()},l(B){e=C(B,"SECTION",{class:!0});var T=R(e);s=C(T,"H3",{"data-svelte-h":!0}),ce(s)!=="svelte-ho1cwx"&&(s.textContent=t),l=N(T),r=C(T,"BUTTON",{class:!0}),R(r).forEach(_),o=N(T),f=C(T,"DIV",{class:!0});var H=R(f);i=C(H,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),ce(i)!=="svelte-10k8a68"&&(i.textContent=c),a=N(H),u=C(H,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),H.forEach(_),p=N(T),k=C(T,"DIV",{class:!0});var z=R(k);m=C(z,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),ce(m)!=="svelte-14n9kp6"&&(m.textContent=D),h=N(z),w=C(z,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),z.forEach(_),g=N(T),S=C(T,"DIV",{class:!0});var se=R(S);I=C(se,"SPAN",{class:!0,"data-svelte-h":!0}),ce(I)!=="svelte-7hjyox"&&(I.textContent=Y),oe=N(se),Z=C(se,"OL",{class:!0});var ve=R(Z);for(let Ie=0;Ie<j.length;Ie+=1)j[Ie].l(ve);ve.forEach(_),se.forEach(_),K=N(T),ae=C(T,"DIV",{class:!0});var Ce=R(ae);V($.$$.fragment,Ce),Ce.forEach(_),T.forEach(_),this.h()},h(){d(r,"class",it("codicon codicon-close")+" svelte-xkjm86"),d(i,"for","supertag-name"),d(i,"class","svelte-xkjm86"),d(u,"type","text"),d(u,"placeholder","Descriptive name"),d(u,"id","supertag-name"),d(u,"class","svelte-xkjm86"),d(f,"class","svelte-xkjm86"),d(m,"for","supertag-description"),d(m,"class","svelte-xkjm86"),d(w,"type","text"),d(w,"placeholder","Short description"),d(w,"id","supertag-description"),d(w,"class","svelte-xkjm86"),d(k,"class","svelte-xkjm86"),d(I,"class","svelte-xkjm86"),d(Z,"class","svelte-xkjm86"),d(S,"class","svelte-xkjm86"),d(ae,"class","last svelte-xkjm86"),d(e,"class","svelte-xkjm86")},m(B,T){O(B,e,T),v(e,s),v(e,l),v(e,r),v(e,o),v(e,f),v(f,i),v(f,a),v(f,u),ke(u,n[0]),v(e,p),v(e,k),v(k,m),v(k,h),v(k,w),ke(w,n[1]),v(e,g),v(e,S),v(S,I),v(S,oe),v(S,Z);for(let H=0;H<j.length;H+=1)j[H]&&j[H].m(Z,null);v(e,K),v(e,ae),F($,ae,null),q=!0,J||(W=[ie(r,"click",n[5]),ie(u,"input",n[6]),ie(w,"input",n[7])],J=!0)},p(B,T){if(T&1&&u.value!==B[0]&&ke(u,B[0]),T&2&&w.value!==B[1]&&ke(w,B[1]),T&4){Q=ye(B[2]);let z;for(z=0;z<Q.length;z+=1){const se=nt(B,Q,z);j[z]?(j[z].p(se,T),b(j[z],1)):(j[z]=lt(se),j[z].c(),b(j[z],1),j[z].m(Z,null))}for(ee(),z=Q.length;z<j.length;z+=1)Ee(z);te()}const H={};T&8&&(H.title=B[3]?"Click to create supertag":"Enter a valid name to continue"),T&8&&(H.disabled=!B[3]),T&4096&&(H.$$scope={dirty:T,ctx:B}),$.$set(H)},i(B){if(!q){for(let T=0;T<Q.length;T+=1)b(j[T]);b($.$$.fragment,B),q=!0}},o(B){j=j.filter(Boolean);for(let T=0;T<j.length;T+=1)y(j[T]);y($.$$.fragment,B),q=!1},d(B){B&&_(e),ze(j,B),M($),J=!1,je(W)}}}function As(n){let e,s;return e=new ut({props:{$$slots:{default:[Bs]},$$scope:{ctx:n}}}),e.$on("close",n[5]),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,l){F(e,t,l),s=!0},p(t,[l]){const r={};l&4111&&(r.$$scope={dirty:l,ctx:t}),e.$set(r)},i(t){s||(b(e.$$.fragment,t),s=!0)},o(t){y(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function js(n,e,s){let t,{name:l=""}=e,{description:r=""}=e,{tags:o}=e;const f=Se(),i=()=>f("close");function c(){l=this.value,s(0,l)}function a(){r=this.value,s(1,r)}const u=()=>{f("submit",{name:l,description:r,tags:o.map(({modifier:p,name:k})=>({modifier:p,name:k}))}),i()};return n.$$set=p=>{"name"in p&&s(0,l=p.name),"description"in p&&s(1,r=p.description),"tags"in p&&s(2,o=p.tags)},n.$$.update=()=>{n.$$.dirty&5&&s(3,t=typeof l=="string"&&l!==""&&o.length>1)},[l,r,o,t,f,i,c,a,u]}class Ls extends le{constructor(e){super(),re(this,e,js,As,ne,{name:0,description:1,tags:2})}}function Vs(n){let e,s,t,l,r,o,f,i,c,a;return{c(){e=E("div"),s=E("div"),t=E("i"),l=P(),r=E("div"),o=E("h3"),f=X(n[0]),i=P(),c=E("span"),a=X(n[2]),this.h()},l(u){e=C(u,"DIV",{class:!0});var p=R(e);s=C(p,"DIV",{class:!0});var k=R(s);t=C(k,"I",{class:!0}),R(t).forEach(_),k.forEach(_),l=N(p),r=C(p,"DIV",{});var m=R(r);o=C(m,"H3",{class:!0});var D=R(o);f=x(D,n[0]),D.forEach(_),i=N(m),c=C(m,"SPAN",{});var h=R(c);a=x(h,n[2]),h.forEach(_),m.forEach(_),p.forEach(_),this.h()},h(){d(t,"class",it(n[1])+" svelte-1tvgln1"),d(s,"class","icon svelte-1tvgln1"),d(o,"class","svelte-1tvgln1"),d(e,"class","error svelte-1tvgln1")},m(u,p){O(u,e,p),v(e,s),v(s,t),v(e,l),v(e,r),v(r,o),v(o,f),v(r,i),v(r,c),v(c,a)},p:U,i:U,o:U,d(u){u&&_(e)}}}function Fs(n,e,s){let{error:t}=e,l=t.message==="Failed to fetch"?"Connection Error":"Application Error",r=t.message==="Failed to fetch"?"codicon codicon-debug-disconnect":"codicon codicon-error",o=t.message==="Failed to fetch"?"Failed to connect to the server. Make sure you have a stable internet connection.":t.message;return n.$$set=f=>{"error"in f&&s(3,t=f.error)},[l,r,o,t]}class Ms extends le{constructor(e){super(),re(this,e,Fs,Vs,ne,{error:3})}}function zs(n){let e;return{c(){e=X("Search")},l(s){e=x(s,"Search")},m(s,t){O(s,e,t)},d(s){s&&_(e)}}}function qs(n){let e,s,t,l,r,o;const f=[Ks,Us],i=[];function c(a,u){return a[2].postCount===0?0:1}return s=c(n),t=i[s]=f[s](n),r=new Ft({}),{c(){e=E("section"),t.c(),l=P(),L(r.$$.fragment),this.h()},l(a){e=C(a,"SECTION",{class:!0});var u=R(e);t.l(u),u.forEach(_),l=N(a),V(r.$$.fragment,a),this.h()},h(){d(e,"class","svelte-rk0y4a")},m(a,u){O(a,e,u),i[s].m(e,null),O(a,l,u),F(r,a,u),o=!0},p(a,u){let p=s;s=c(a),s===p?i[s].p(a,u):(ee(),y(i[p],1,1,()=>{i[p]=null}),te(),t=i[s],t?t.p(a,u):(t=i[s]=f[s](a),t.c()),b(t,1),t.m(e,null))},i(a){o||(b(t),b(r.$$.fragment,a),o=!0)},o(a){y(t),y(r.$$.fragment,a),o=!1},d(a){a&&(_(e),_(l)),i[s].d(),M(r,a)}}}function Gs(n){let e,s;return e=new Ms({props:{error:n[0]}}),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,l){F(e,t,l),s=!0},p(t,l){const r={};l&1&&(r.error=t[0]),e.$set(r)},i(t){s||(b(e.$$.fragment,t),s=!0)},o(t){y(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function Us(n){let e,s,t,l,r,o;e=new Is({}),e.$on("sortfilterupdate",n[7]);const f=[Ws,Hs],i=[];function c(a,u){return a[2].posts.length===a[2].postCount?0:1}return t=c(n),l=i[t]=f[t](n),{c(){L(e.$$.fragment),s=P(),l.c(),r=ue()},l(a){V(e.$$.fragment,a),s=N(a),l.l(a),r=ue()},m(a,u){F(e,a,u),O(a,s,u),i[t].m(a,u),O(a,r,u),o=!0},p(a,u){let p=t;t=c(a),t===p?i[t].p(a,u):(ee(),y(i[p],1,1,()=>{i[p]=null}),te(),l=i[t],l?l.p(a,u):(l=i[t]=f[t](a),l.c()),b(l,1),l.m(r.parentNode,r))},i(a){o||(b(e.$$.fragment,a),b(l),o=!0)},o(a){y(e.$$.fragment,a),y(l),o=!1},d(a){a&&(_(s),_(r)),M(e,a),i[t].d(a)}}}function Ks(n){let e,s;return e=new Ut({}),e.$on("sortfilterupdate",n[7]),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,l){F(e,t,l),s=!0},p:U,i(t){s||(b(e.$$.fragment,t),s=!0)},o(t){y(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function Hs(n){let e,s;return e=new Ns({props:{rootMargin:"1000px"}}),e.$on("intersection",n[8]),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,l){F(e,t,l),s=!0},p:U,i(t){s||(b(e.$$.fragment,t),s=!0)},o(t){y(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function Ws(n){let e,s;return e=new Ts({}),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,l){F(e,t,l),s=!0},p:U,i(t){s||(b(e.$$.fragment,t),s=!0)},o(t){y(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function rt(n){let e,s;return e=new Ls({props:{tags:n[4]}}),e.$on("close",n[13]),e.$on("submit",n[14]),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,l){F(e,t,l),s=!0},p(t,l){const r={};l&16&&(r.tags=t[4]),e.$set(r)},i(t){s||(b(e.$$.fragment,t),s=!0)},o(t){y(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function Ys(n){let e,s,t,l,r,o,f,i,c,a,u,p,k,m;s=new St({}),l=new It({props:{placeholder:"Search for tags",fetchSuggestions:n[6]}}),l.$on("pick",n[9]),o=new Te({props:{title:"Search with the tags above",$$slots:{default:[zs]},$$scope:{ctx:n}}}),o.$on("click",n[7]),i=new Et({props:{tags:[...n[4],...n[3]]}}),i.$on("click",n[10]),i.$on("contextmenu",n[11]),i.$on("createSupertag",n[12]);const D=[Gs,qs],h=[];function w(S,I){return S[0]?0:S[2].requested?1:-1}~(a=w(n))&&(u=h[a]=D[a](n));let g=n[1]&&rt(n);return{c(){e=E("section"),L(s.$$.fragment),t=P(),L(l.$$.fragment),r=P(),L(o.$$.fragment),f=P(),L(i.$$.fragment),c=P(),u&&u.c(),p=P(),g&&g.c(),k=ue(),this.h()},l(S){e=C(S,"SECTION",{id:!0,class:!0});var I=R(e);V(s.$$.fragment,I),t=N(I),V(l.$$.fragment,I),r=N(I),V(o.$$.fragment,I),f=N(I),V(i.$$.fragment,I),I.forEach(_),c=N(S),u&&u.l(S),p=N(S),g&&g.l(S),k=ue(),this.h()},h(){d(e,"id","search"),d(e,"class","svelte-rk0y4a")},m(S,I){O(S,e,I),F(s,e,null),v(e,t),F(l,e,null),v(e,r),F(o,e,null),v(e,f),F(i,e,null),O(S,c,I),~a&&h[a].m(S,I),O(S,p,I),g&&g.m(S,I),O(S,k,I),m=!0},p(S,[I]){const Y={};I&8388608&&(Y.$$scope={dirty:I,ctx:S}),o.$set(Y);const oe={};I&24&&(oe.tags=[...S[4],...S[3]]),i.$set(oe);let Z=a;a=w(S),a===Z?~a&&h[a].p(S,I):(u&&(ee(),y(h[Z],1,1,()=>{h[Z]=null}),te()),~a?(u=h[a],u?u.p(S,I):(u=h[a]=D[a](S),u.c()),b(u,1),u.m(p.parentNode,p)):u=null),S[1]?g?(g.p(S,I),I&2&&b(g,1)):(g=rt(S),g.c(),b(g,1),g.m(k.parentNode,k)):g&&(ee(),y(g,1,1,()=>{g=null}),te())},i(S){m||(b(s.$$.fragment,S),b(l.$$.fragment,S),b(o.$$.fragment,S),b(i.$$.fragment,S),b(u),b(g),m=!0)},o(S){y(s.$$.fragment,S),y(l.$$.fragment,S),y(o.$$.fragment,S),y(i.$$.fragment,S),y(u),y(g),m=!1},d(S){S&&(_(e),_(c),_(p),_(k)),M(s),M(l),M(o),M(i),~a&&h[a].d(S),g&&g.d(S)}}}const Zs=()=>{const n=new URL(location.href);if(!n.searchParams.has("tags"))return;const s=(n.searchParams.get("tags")??"").split(";");if(!(!Array.isArray(s)||s.length===0))return s};function Js(n,e,s){let t,l,r,o,f,i;pe(n,Ne,$=>s(2,t=$)),pe(n,Le,$=>s(3,l=$)),pe(n,fe,$=>s(17,r=$)),pe(n,Lt,$=>s(18,o=$)),pe(n,Pe,$=>s(4,f=$)),pe(n,He,$=>s(5,i=$));let c=!1,a,u=!1,p=0;const k=async $=>{const q=await Pt($);return[...i.items.filter(({name:W})=>W.toLowerCase().includes($.toLowerCase())).map(W=>({label:W.name,count:W.tags.length,type:"supertag"})),...q]},m=Zs();m&&m.forEach($=>{f.some(q=>q.name===$)||Pe.addByName($)});const D=()=>new Ct().withPid(t.pageCount).withTags(f).withBlockedContent(o).withSortProperty(r.sortProperty).withSortDirection(r.sortDirection).withScoreValue(r.scoreValue).withScoreComparator(r.scoreComparator).withRating(r.rating).withSupertags(l),h=async $=>{if(!c){s(0,a=void 0),c=!0;try{const q=t.pageCount;await $(),Mt(q).catch(()=>{})}catch(q){s(0,a=q),console.warn(q)}finally{c=!1}}},w=async()=>{Ne.reset(),p=0,h(async()=>{const[$,q]=await D().getPageAndCount();console.log($,q),Ne.addPage($,q)})},g=async()=>{h(async()=>{const $=await D().getPage();Ne.addPage($)})},S=$=>{var q,J;if(console.log($),($.key==="/"||$.key==="s")&&(!document.activeElement||document.activeElement===document.body)&&((q=document.getElementById("searchbar"))==null||q.focus(),$.preventDefault(),$.stopPropagation()),$.ctrlKey&&$.key==="Enter"&&($.preventDefault(),$.stopPropagation(),w()),$.ctrlKey&&$.key==="m"&&((J=document.getElementById("select-modifier"))==null||J.click()),$.ctrlKey&&$.key==="ArrowDown"){const W=document.getElementsByClassName("post-media");W[p].focus(),p=Math.min(p+1,Math.max(0,W.length-1))}$.ctrlKey&&$.key==="ArrowUp"&&(document.getElementsByClassName("post-media")[p].focus(),p=Math.max(p-1,0))};return Me(()=>{document.addEventListener("keydown",S)}),at(()=>{document.removeEventListener("keydown",S)}),[a,u,t,l,f,i,k,w,g,async $=>{const q=$.detail;if(q.type==="supertag"){const J=i.items.find(W=>W.name===q.label);if(!J){console.log("Supertag not present.");return}Le.addOrReplace(J)}else{const J=await Nt($.detail.label);Pe.addOrReplace({name:$.detail.label,modifier:$.detail.modifier,count:$.detail.count,type:J.type})}},$=>"description"in $.detail?Le.removeByName($.detail.name):Pe.removeByName($.detail.name),$=>{"description"in $.detail||($.detail.modifier=Dt($.detail.modifier),Pe.addOrReplace($.detail))},()=>s(1,u=!0),()=>s(1,u=!1),$=>He.add($.detail)]}class hn extends le{constructor(e){super(),re(this,e,Js,Ys,ne,{})}}export{hn as component};
