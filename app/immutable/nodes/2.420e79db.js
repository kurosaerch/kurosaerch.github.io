import{s as x,D as _e,f as I,a as P,g as C,h as O,y as fe,c as N,d as $,j as d,r as pt,i as T,u as b,E as ye,F as ce,G as qe,H as Ge,l as oe,m as ie,v as Y,I as ue,e as de,n as Re,C as re,J as It,p as pe,K as Ve,L as dt,M as je,k as ke,N as Le,w as Ct,O as Dt,z as Pt,A as Nt,B as Ot,o as Ce,P as De}from"../chunks/scheduler.0a29c992.js";import{S as ee,i as te,b as L,d as F,m as A,a as w,t as S,e as B,g as ne,c as le,f as Me}from"../chunks/index.6d8df040.js";import{e as Ie}from"../chunks/each.e59479a4.js";import{D as _t,r as Tt}from"../chunks/result-columns-store.7454cbad.js";import{T as Fe}from"../chunks/TextButton.f6017ea8.js";import{D as Vt}from"../chunks/DetailedTag.6129a1d8.js";import{K as Mt,A as Rt}from"../chunks/ActiveTagList.0ac41c7b.js";import{b as mt}from"../chunks/paths.933865f7.js";import{s as Ee,f as be,r as Se,a as ze,S as Lt}from"../chunks/active-supertags-store.11df592d.js";import{i as gt,D as ht,g as $t,G as Ft,V as At,a as Ye,I as Bt,b as jt,c as Gt}from"../chunks/Details.477f83d6.js";import{f as Ae}from"../chunks/format-tag.7e313273.js";import{R as zt,I as vt}from"../chunks/ModifierSelect.51f2ca82.js";import{S as Ze}from"../chunks/Select.0781c4e2.js";import{R as qt}from"../chunks/RotatingTextSelect.f25d5f18.js";import{a as Ut}from"../chunks/always-loop-store.ec22e8f2.js";import{S as Ht,n as Kt,s as Je}from"../chunks/supertags-store.4f059353.js";import{S as Wt}from"../chunks/ScrollUpButton.be9a5994.js";import{g as Yt,a as Zt}from"../chunks/tags.49324235.js";import{l as Jt}from"../chunks/analytics.eca95ce1.js";import{a as Be}from"../chunks/active-tags-store.a60398a6.js";import{b as Qt}from"../chunks/blocked-content-store.2a43e35e.js";function Qe(l,e,s){const t=l.slice();return t[9]=e[s],t}function Xe(l){let e,s;return e=new Vt({props:{tag:l[9]}}),{c(){L(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,n){A(e,t,n),s=!0},p(t,n){const r={};n&4&&(r.tag=t[9]),e.$set(r)},i(t){s||(w(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){B(e,t)}}}function Xt(l){let e;return{c(){e=oe("Create supertag")},l(s){e=ie(s,"Create supertag")},m(s,t){T(s,e,t)},d(s){s&&$(e)}}}function xt(l){let e,s,t="Create Supertag",n,r,o,a,i,u="Name",c,m,_,g,E,D="Description",v,f,h,p,k,V="Tags",j,M,K,J,y,H,Q,X,se=Ie(l[2]),q=[];for(let G=0;G<se.length;G+=1)q[G]=Xe(Qe(l,se,G));const Pe=G=>S(q[G],1,1,()=>{q[G]=null});return y=new Fe({props:{title:l[3]?"Click to create supertag":"Enter a valid name to continue",disabled:!l[3],$$slots:{default:[Xt]},$$scope:{ctx:l}}}),y.$on("click",l[8]),{c(){e=I("section"),s=I("h3"),s.textContent=t,n=P(),r=I("button"),o=P(),a=I("div"),i=I("label"),i.textContent=u,c=P(),m=I("input"),_=P(),g=I("div"),E=I("label"),E.textContent=D,v=P(),f=I("input"),h=P(),p=I("div"),k=I("span"),k.textContent=V,j=P(),M=I("ol");for(let G=0;G<q.length;G+=1)q[G].c();K=P(),J=I("div"),L(y.$$.fragment),this.h()},l(G){e=C(G,"SECTION",{class:!0});var R=O(e);s=C(R,"H3",{"data-svelte-h":!0}),fe(s)!=="svelte-ho1cwx"&&(s.textContent=t),n=N(R),r=C(R,"BUTTON",{class:!0}),O(r).forEach($),o=N(R),a=C(R,"DIV",{class:!0});var Z=O(a);i=C(Z,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),fe(i)!=="svelte-10k8a68"&&(i.textContent=u),c=N(Z),m=C(Z,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),Z.forEach($),_=N(R),g=C(R,"DIV",{class:!0});var U=O(g);E=C(U,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),fe(E)!=="svelte-14n9kp6"&&(E.textContent=D),v=N(U),f=C(U,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),U.forEach($),h=N(R),p=C(R,"DIV",{class:!0});var ae=O(p);k=C(ae,"SPAN",{class:!0,"data-svelte-h":!0}),fe(k)!=="svelte-7hjyox"&&(k.textContent=V),j=N(ae),M=C(ae,"OL",{class:!0});var we=O(M);for(let Oe=0;Oe<q.length;Oe+=1)q[Oe].l(we);we.forEach($),ae.forEach($),K=N(R),J=C(R,"DIV",{class:!0});var Ne=O(J);F(y.$$.fragment,Ne),Ne.forEach($),R.forEach($),this.h()},h(){d(r,"class",pt("codicon codicon-close")+" svelte-xkjm86"),d(i,"for","supertag-name"),d(i,"class","svelte-xkjm86"),d(m,"type","text"),d(m,"placeholder","Descriptive name"),d(m,"id","supertag-name"),d(m,"class","svelte-xkjm86"),d(a,"class","svelte-xkjm86"),d(E,"for","supertag-description"),d(E,"class","svelte-xkjm86"),d(f,"type","text"),d(f,"placeholder","Short description"),d(f,"id","supertag-description"),d(f,"class","svelte-xkjm86"),d(g,"class","svelte-xkjm86"),d(k,"class","svelte-xkjm86"),d(M,"class","svelte-xkjm86"),d(p,"class","svelte-xkjm86"),d(J,"class","last svelte-xkjm86"),d(e,"class","svelte-xkjm86")},m(G,R){T(G,e,R),b(e,s),b(e,n),b(e,r),b(e,o),b(e,a),b(a,i),b(a,c),b(a,m),ye(m,l[0]),b(e,_),b(e,g),b(g,E),b(g,v),b(g,f),ye(f,l[1]),b(e,h),b(e,p),b(p,k),b(p,j),b(p,M);for(let Z=0;Z<q.length;Z+=1)q[Z]&&q[Z].m(M,null);b(e,K),b(e,J),A(y,J,null),H=!0,Q||(X=[ce(r,"click",l[5]),ce(m,"input",l[6]),ce(f,"input",l[7])],Q=!0)},p(G,R){if(R&1&&m.value!==G[0]&&ye(m,G[0]),R&2&&f.value!==G[1]&&ye(f,G[1]),R&4){se=Ie(G[2]);let U;for(U=0;U<se.length;U+=1){const ae=Qe(G,se,U);q[U]?(q[U].p(ae,R),w(q[U],1)):(q[U]=Xe(ae),q[U].c(),w(q[U],1),q[U].m(M,null))}for(ne(),U=se.length;U<q.length;U+=1)Pe(U);le()}const Z={};R&8&&(Z.title=G[3]?"Click to create supertag":"Enter a valid name to continue"),R&8&&(Z.disabled=!G[3]),R&4096&&(Z.$$scope={dirty:R,ctx:G}),y.$set(Z)},i(G){if(!H){for(let R=0;R<se.length;R+=1)w(q[R]);w(y.$$.fragment,G),H=!0}},o(G){q=q.filter(Boolean);for(let R=0;R<q.length;R+=1)S(q[R]);S(y.$$.fragment,G),H=!1},d(G){G&&$(e),qe(q,G),B(y),Q=!1,Ge(X)}}}function es(l){let e,s;return e=new _t({props:{$$slots:{default:[xt]},$$scope:{ctx:l}}}),e.$on("close",l[5]),{c(){L(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,n){A(e,t,n),s=!0},p(t,[n]){const r={};n&4111&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){s||(w(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){B(e,t)}}}function ts(l,e,s){let t,{name:n=""}=e,{description:r=""}=e,{tags:o}=e;const a=_e(),i=()=>a("close");function u(){n=this.value,s(0,n)}function c(){r=this.value,s(1,r)}const m=()=>{a("submit",{name:n,description:r,tags:o.map(({modifier:_,name:g})=>({modifier:_,name:g}))}),i()};return l.$$set=_=>{"name"in _&&s(0,n=_.name),"description"in _&&s(1,r=_.description),"tags"in _&&s(2,o=_.tags)},l.$$.update=()=>{l.$$.dirty&5&&s(3,t=typeof n=="string"&&n!==""&&o.length>1)},[n,r,o,t,a,i,u,c,m]}class ss extends ee{constructor(e){super(),te(this,e,ts,es,x,{name:0,description:1,tags:2})}}function ns(l){let e,s,t,n,r,o,a,i,u,c;return{c(){e=I("div"),s=I("div"),t=I("i"),n=P(),r=I("div"),o=I("h3"),a=oe(l[0]),i=P(),u=I("span"),c=oe(l[2]),this.h()},l(m){e=C(m,"DIV",{class:!0});var _=O(e);s=C(_,"DIV",{class:!0});var g=O(s);t=C(g,"I",{class:!0}),O(t).forEach($),g.forEach($),n=N(_),r=C(_,"DIV",{});var E=O(r);o=C(E,"H3",{class:!0});var D=O(o);a=ie(D,l[0]),D.forEach($),i=N(E),u=C(E,"SPAN",{});var v=O(u);c=ie(v,l[2]),v.forEach($),E.forEach($),_.forEach($),this.h()},h(){d(t,"class",pt(l[1])+" svelte-1tvgln1"),d(s,"class","icon svelte-1tvgln1"),d(o,"class","svelte-1tvgln1"),d(e,"class","error svelte-1tvgln1")},m(m,_){T(m,e,_),b(e,s),b(s,t),b(e,n),b(e,r),b(r,o),b(o,a),b(r,i),b(r,u),b(u,c)},p:Y,i:Y,o:Y,d(m){m&&$(e)}}}function ls(l,e,s){let{error:t}=e,n=t.message==="Failed to fetch"?"Connection Error":"Application Error",r=t.message==="Failed to fetch"?"codicon codicon-debug-disconnect":"codicon codicon-error",o=t.message==="Failed to fetch"?"Failed to connect to the server. Make sure you have a stable internet connection.":t.message;return l.$$set=a=>{"error"in a&&s(3,t=a.error)},[n,r,o,t]}class rs extends ee{constructor(e){super(),te(this,e,ls,ns,x,{error:3})}}function os(l){let e,s,t,n,r="You have seen everything there is to see...";return{c(){e=I("img"),t=P(),n=I("p"),n.textContent=r,this.h()},l(o){e=C(o,"IMG",{src:!0,alt:!0,class:!0}),t=N(o),n=C(o,"P",{"data-svelte-h":!0}),fe(n)!=="svelte-1i75mtf"&&(n.textContent=r),this.h()},h(){ue(e.src,s=mt+"/assets/shironeko-x.png")||d(e,"src",s),d(e,"alt","No more results to load"),d(e,"class","svelte-1pkma0d")},m(o,a){T(o,e,a),T(o,t,a),T(o,n,a)},p:Y,i:Y,o:Y,d(o){o&&($(e),$(t),$(n))}}}class is extends ee{constructor(e){super(),te(this,e,null,os,x,{})}}function xe(l){let e,s;return e=new _t({props:{$$slots:{default:[us]},$$scope:{ctx:l}}}),e.$on("close",l[7]),{c(){L(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,n){A(e,t,n),s=!0},p(t,n){const r={};n&65543&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){s||(w(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){B(e,t)}}}function as(l){let e;return{c(){e=oe("Done")},l(s){e=ie(s,"Done")},m(s,t){T(s,e,t)},d(s){s&&$(e)}}}function cs(l){let e;return{c(){e=oe("Reset")},l(s){e=ie(s,"Reset")},m(s,t){T(s,e,t)},d(s){s&&$(e)}}}function us(l){let e,s,t="Sorting and Filtering",n,r,o,a="Sorting",i,u,c,m,_,g,E,D,v,f,h="Filtering by Score",p,k,V,j,M,K,J,y,H,Q="Filtering by Rating",X,se,q,Pe,G,R,Z,U,ae,we,Ne;function Oe(z){l[10](z)}let Ue={options:ds};l[1].direction!==void 0&&(Ue.value=l[1].direction),c=new zt({props:Ue}),pe.push(()=>Me(c,"value",Oe));function yt(z){l[11](z)}let He={options:ps};l[1].property!==void 0&&(He.value=l[1].property),g=new Ze({props:He}),pe.push(()=>Me(g,"value",yt));function Et(z){l[12](z)}let Ke={options:_s};l[2].scoreComparator!==void 0&&(Ke.value=l[2].scoreComparator),V=new qt({props:Ke}),pe.push(()=>Me(V,"value",Et));function St(z){l[14](z)}let We={options:bt};return l[2].rating!==void 0&&(We.value=l[2].rating),q=new Ze({props:We}),pe.push(()=>Me(q,"value",St)),R=new Fe({props:{title:"Return to searching.",$$slots:{default:[as]},$$scope:{ctx:l}}}),R.$on("click",l[7]),U=new Fe({props:{title:"Reset sort and filter.",type:"secondary",$$slots:{default:[cs]},$$scope:{ctx:l}}}),U.$on("click",l[9]),{c(){e=I("div"),s=I("h3"),s.textContent=t,n=P(),r=I("div"),o=I("b"),o.textContent=a,i=P(),u=I("div"),L(c.$$.fragment),_=P(),L(g.$$.fragment),D=P(),v=I("div"),f=I("b"),f.textContent=h,p=P(),k=I("div"),L(V.$$.fragment),M=P(),K=I("input"),J=P(),y=I("div"),H=I("b"),H.textContent=Q,X=P(),se=I("div"),L(q.$$.fragment),G=P(),L(R.$$.fragment),Z=P(),L(U.$$.fragment),this.h()},l(z){e=C(z,"DIV",{class:!0});var W=O(e);s=C(W,"H3",{"data-svelte-h":!0}),fe(s)!=="svelte-15zouq3"&&(s.textContent=t),n=N(W),r=C(W,"DIV",{});var me=O(r);o=C(me,"B",{class:!0,"data-svelte-h":!0}),fe(o)!=="svelte-ekzpgg"&&(o.textContent=a),i=N(me),u=C(me,"DIV",{class:!0});var ge=O(u);F(c.$$.fragment,ge),_=N(ge),F(g.$$.fragment,ge),ge.forEach($),me.forEach($),D=N(W),v=C(W,"DIV",{});var he=O(v);f=C(he,"B",{class:!0,"data-svelte-h":!0}),fe(f)!=="svelte-1flca3"&&(f.textContent=h),p=N(he),k=C(he,"DIV",{class:!0});var $e=O(k);F(V.$$.fragment,$e),M=N($e),K=C($e,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),$e.forEach($),he.forEach($),J=N(W),y=C(W,"DIV",{});var ve=O(y);H=C(ve,"B",{class:!0,"data-svelte-h":!0}),fe(H)!=="svelte-1evbw58"&&(H.textContent=Q),X=N(ve),se=C(ve,"DIV",{class:!0});var Te=O(se);F(q.$$.fragment,Te),Te.forEach($),ve.forEach($),G=N(W),F(R.$$.fragment,W),Z=N(W),F(U.$$.fragment,W),W.forEach($),this.h()},h(){d(o,"class","svelte-gf4ubn"),d(u,"class","row svelte-gf4ubn"),d(f,"class","svelte-gf4ubn"),d(K,"type","number"),d(K,"min",0),d(K,"max",1e5),d(K,"step",1),d(K,"class","svelte-gf4ubn"),d(k,"class","row svelte-gf4ubn"),d(H,"class","svelte-gf4ubn"),d(se,"class","row svelte-gf4ubn"),d(e,"class","container svelte-gf4ubn")},m(z,W){T(z,e,W),b(e,s),b(e,n),b(e,r),b(r,o),b(r,i),b(r,u),A(c,u,null),b(u,_),A(g,u,null),b(e,D),b(e,v),b(v,f),b(v,p),b(v,k),A(V,k,null),b(k,M),b(k,K),ye(K,l[0]),b(e,J),b(e,y),b(y,H),b(y,X),b(y,se),A(q,se,null),b(e,G),A(R,e,null),b(e,Z),A(U,e,null),ae=!0,we||(Ne=[ce(K,"input",l[13]),ce(K,"keyup",l[8])],we=!0)},p(z,W){const me={};!m&&W&2&&(m=!0,me.value=z[1].direction,Ve(()=>m=!1)),c.$set(me);const ge={};!E&&W&2&&(E=!0,ge.value=z[1].property,Ve(()=>E=!1)),g.$set(ge);const he={};!j&&W&4&&(j=!0,he.value=z[2].scoreComparator,Ve(()=>j=!1)),V.$set(he),W&1&&dt(K.value)!==z[0]&&ye(K,z[0]);const $e={};!Pe&&W&4&&(Pe=!0,$e.value=z[2].rating,Ve(()=>Pe=!1)),q.$set($e);const ve={};W&65536&&(ve.$$scope={dirty:W,ctx:z}),R.$set(ve);const Te={};W&65536&&(Te.$$scope={dirty:W,ctx:z}),U.$set(Te)},i(z){ae||(w(c.$$.fragment,z),w(g.$$.fragment,z),w(V.$$.fragment,z),w(q.$$.fragment,z),w(R.$$.fragment,z),w(U.$$.fragment,z),ae=!0)},o(z){S(c.$$.fragment,z),S(g.$$.fragment,z),S(V.$$.fragment,z),S(q.$$.fragment,z),S(R.$$.fragment,z),S(U.$$.fragment,z),ae=!1},d(z){z&&$(e),B(c),B(g),B(V),B(q),B(R),B(U),we=!1,Ge(Ne)}}}function fs(l){let e,s,t,n,r,o,a,i,u,c,m,_,g,E,D,v=l[3]&&xe(l);return{c(){e=I("button"),s=I("i"),t=P(),n=I("span"),r=oe(l[5]),o=P(),a=I("i"),i=P(),u=I("span"),c=oe(l[4]),m=P(),v&&v.c(),_=de(),this.h()},l(f){e=C(f,"BUTTON",{class:!0});var h=O(e);s=C(h,"I",{class:!0}),O(s).forEach($),t=N(h),n=C(h,"SPAN",{});var p=O(n);r=ie(p,l[5]),p.forEach($),o=N(h),a=C(h,"I",{class:!0}),O(a).forEach($),i=N(h),u=C(h,"SPAN",{});var k=O(u);c=ie(k,l[4]),k.forEach($),h.forEach($),m=N(f),v&&v.l(f),_=de(),this.h()},h(){d(s,"class","codicon codicon-filter svelte-gf4ubn"),d(a,"class","codicon codicon-arrow-swap svelte-gf4ubn"),d(e,"class","svelte-gf4ubn")},m(f,h){T(f,e,h),b(e,s),b(e,t),b(e,n),b(n,r),b(e,o),b(e,a),b(e,i),b(e,u),b(u,c),T(f,m,h),v&&v.m(f,h),T(f,_,h),g=!0,E||(D=ce(e,"click",l[6]),E=!0)},p(f,[h]){(!g||h&32)&&Re(r,f[5]),(!g||h&16)&&Re(c,f[4]),f[3]?v?(v.p(f,h),h&8&&w(v,1)):(v=xe(f),v.c(),w(v,1),v.m(_.parentNode,_)):v&&(ne(),S(v,1,1,()=>{v=null}),le())},i(f){g||(w(v),g=!0)},o(f){S(v),g=!1},d(f){f&&($(e),$(m),$(_)),v&&v.d(f),E=!1,D()}}}const ps=Object.freeze({id:"Uploaded",score:"Score",updated:"Updated",random:"Random"}),ds=Object.freeze({desc:"codicon codicon-arrow-down",asc:"codicon codicon-arrow-up"}),_s=Object.freeze({">=":"≥","<=":"≤"}),bt=Object.freeze({all:"All",safe:"Safe",questionable:"Questionable",explicit:"Explicit"}),ms=Object.freeze({id:{asc:"Oldest",desc:"Newest"},score:{asc:"Worst",desc:"Best"},updated:{asc:"Inactive",desc:"Active"},random:{asc:"Random",desc:"Random"}}),gs=(l,e,s)=>{let t=l==="all"?void 0:bt[l],n=e===0&&s===">="?void 0:`Score${s}${Ae(e)}`;return[t,n].filter(r=>r!==void 0).join(",")||"All"};function hs(l,e,s){let t,n,r,o;re(l,Ee,p=>s(1,r=p)),re(l,be,p=>s(2,o=p));const a=_e();let i=!1;const u=()=>s(3,i=!0),c=()=>{s(3,i=!1),a("sortfilterupdate")},m=p=>{var k;return gt(p)&&((k=p.target)==null?void 0:k.blur())},_=()=>{Ee.reset(),be.reset(),s(0,g=o.scoreValue)};let g;function E(p){l.$$.not_equal(r.direction,p)&&(r.direction=p,Ee.set(r))}function D(p){l.$$.not_equal(r.property,p)&&(r.property=p,Ee.set(r))}function v(p){l.$$.not_equal(o.scoreComparator,p)&&(o.scoreComparator=p,be.set(o))}function f(){g=dt(this.value),s(0,g),s(2,o)}function h(p){l.$$.not_equal(o.rating,p)&&(o.rating=p,be.set(o))}return l.$$.update=()=>{if(l.$$.dirty&5){g===void 0&&s(0,g=o.scoreValue);let p=Number(g);isNaN(p)||It(be,o.scoreValue=p,o)}l.$$.dirty&4&&s(5,t=gs(o.rating,o.scoreValue,o.scoreComparator)),l.$$.dirty&2&&s(4,n=ms[r.property][r.direction])},[g,r,o,i,n,t,u,c,m,_,E,D,v,f,h]}class $s extends ee{constructor(e){super(),te(this,e,hs,fs,x,{})}}function vs(l){const e=l.slice(),s=$t(e[1].file_url,e[1].sample_url,e[1].preview_url);return e[7]=s,e}function bs(l){let e,s;return e=new Ft({props:{post:l[1]}}),e.$on("click",l[4]),{c(){L(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,n){A(e,t,n),s=!0},p(t,n){const r={};n&2&&(r.post=t[1]),e.$set(r)},i(t){s||(w(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){B(e,t)}}}function ks(l){let e,s;return e=new At({props:{src:l[7].animated,poster:l[7].static,width:l[1].width,height:l[1].height,loop:l[2]||Ye(l[1].tags)}}),e.$on("click",l[4]),{c(){L(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,n){A(e,t,n),s=!0},p(t,n){const r={};n&2&&(r.src=t[7].animated),n&2&&(r.poster=t[7].static),n&2&&(r.width=t[1].width),n&2&&(r.height=t[1].height),n&6&&(r.loop=t[2]||Ye(t[1].tags)),e.$set(r)},i(t){s||(w(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){B(e,t)}}}function ws(l){let e,s;return e=new Bt({props:{post:l[1],open:l[0]}}),e.$on("click",l[4]),{c(){L(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,n){A(e,t,n),s=!0},p(t,n){const r={};n&2&&(r.post=t[1]),n&1&&(r.open=t[0]),e.$set(r)},i(t){s||(w(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){B(e,t)}}}function ys(l){let e;return{c(){e=I("i"),this.h()},l(s){e=C(s,"I",{class:!0}),O(e).forEach($),this.h()},h(){d(e,"class","codicon codicon-screen-full")},m(s,t){T(s,e,t)},p:Y,d(s){s&&$(e)}}}function et(l){let e,s;return e=new ht({props:{post:l[1]}}),{c(){L(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,n){A(e,t,n),s=!0},p(t,n){const r={};n&2&&(r.post=t[1]),e.$set(r)},i(t){s||(w(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){B(e,t)}}}function Es(l){let e,s,t,n,r,o,a,i,u,c;const m=[ws,ks,bs],_=[];function g(v,f){return v[1].type==="image"?0:v[1].type==="video"?1:2}function E(v,f){return f===1?vs(v):v}s=g(l),t=_[s]=m[s](E(l,s)),r=new vt({props:{class:"button-fullscreen","aria-label":"Enter Fullscreen mode",$$slots:{default:[ys]},$$scope:{ctx:l}}}),r.$on("click",l[5]);let D=l[0]&&et(l);return{c(){e=I("div"),t.c(),n=P(),L(r.$$.fragment),o=P(),D&&D.c(),this.h()},l(v){e=C(v,"DIV",{id:!0,class:!0});var f=O(e);t.l(f),n=N(f),F(r.$$.fragment,f),o=N(f),D&&D.l(f),f.forEach($),this.h()},h(){d(e,"id",a="post_"+l[1].id),d(e,"class","post svelte-pwgq1f"),je(e,"open",l[0])},m(v,f){T(v,e,f),_[s].m(e,null),b(e,n),A(r,e,null),b(e,o),D&&D.m(e,null),i=!0,u||(c=ce(e,"keydown",l[6]),u=!0)},p(v,[f]){let h=s;s=g(v),s===h?_[s].p(E(v,s),f):(ne(),S(_[h],1,1,()=>{_[h]=null}),le(),t=_[s],t?t.p(E(v,s),f):(t=_[s]=m[s](E(v,s)),t.c()),w(t,1),t.m(e,n));const p={};f&256&&(p.$$scope={dirty:f,ctx:v}),r.$set(p),v[0]?D?(D.p(v,f),f&1&&w(D,1)):(D=et(v),D.c(),w(D,1),D.m(e,null)):D&&(ne(),S(D,1,1,()=>{D=null}),le()),(!i||f&2&&a!==(a="post_"+v[1].id))&&d(e,"id",a),(!i||f&1)&&je(e,"open",v[0])},i(v){i||(w(t),w(r.$$.fragment,v),w(D),i=!0)},o(v){S(t),S(r.$$.fragment,v),S(D),i=!1},d(v){v&&$(e),_[s].d(),B(r),D&&D.d(),u=!1,c()}}}function Ss(l,e,s){let t;re(l,Ut,c=>s(2,t=c));const n=_e(),r=()=>s(0,a=!a);let{post:o}=e,{open:a=!1}=e;const i=()=>n("fullscreen"),u=c=>{c.key==="f"&&n("fullscreen")};return l.$$set=c=>{"post"in c&&s(1,o=c.post),"open"in c&&s(0,a=c.open)},[a,o,t,n,r,i,u]}class Is extends ee{constructor(e){super(),te(this,e,Ss,Es,x,{post:1,open:0})}}function tt(l){let e,s=l[0].type==="video"?"▶":"GIF",t;return{c(){e=I("span"),t=oe(s),this.h()},l(n){e=C(n,"SPAN",{class:!0});var r=O(e);t=ie(r,s),r.forEach($),this.h()},h(){d(e,"class","type svelte-14imjnt")},m(n,r){T(n,e,r),b(e,t)},p(n,r){r&1&&s!==(s=n[0].type==="video"?"▶":"GIF")&&Re(t,s)},d(n){n&&$(e)}}}function Cs(l){let e,s,t,n,r,o=Ae(l[0].score)+"",a,i,u,c,m,_=l[0].type!=="image"&&tt(l);return{c(){e=I("div"),s=I("img"),n=P(),r=I("span"),a=oe(o),i=P(),_&&_.c(),this.h()},l(g){e=C(g,"DIV",{id:!0,class:!0,style:!0});var E=O(e);s=C(E,"IMG",{src:!0,alt:!0,class:!0,tabindex:!0,loading:!0}),n=N(E),r=C(E,"SPAN",{class:!0});var D=O(r);a=ie(D,o),D.forEach($),i=N(E),_&&_.l(E),E.forEach($),this.h()},h(){ue(s.src,t=l[1])||d(s,"src",t),d(s,"alt","post"),d(s,"class","post-media svelte-14imjnt"),d(s,"tabindex","-1"),d(s,"loading","lazy"),d(r,"class","score svelte-14imjnt"),d(e,"id",u="post_"+l[0].id),d(e,"class","post svelte-14imjnt"),ke(e,"grid-row","span "+l[2]),je(e,"open",open)},m(g,E){T(g,e,E),b(e,s),b(e,n),b(e,r),b(r,a),b(e,i),_&&_.m(e,null),c||(m=[ce(e,"click",l[3]),ce(e,"keydown",l[4])],c=!0)},p(g,[E]){E&2&&!ue(s.src,t=g[1])&&d(s,"src",t),E&1&&o!==(o=Ae(g[0].score)+"")&&Re(a,o),g[0].type!=="image"?_?_.p(g,E):(_=tt(g),_.c(),_.m(e,null)):_&&(_.d(1),_=null),E&1&&u!==(u="post_"+g[0].id)&&d(e,"id",u),E&0&&je(e,"open",open)},i:Y,o:Y,d(g){g&&$(e),_&&_.d(),c=!1,Ge(m)}}}function Ds(l,e,s){let t,{post:n}=e,r=Math.min(Math.round(n.height/n.width*5),15);const o=u=>u.endsWith(".jpg")||u.endsWith(".jpeg")||u.endsWith(".png")||u.endsWith(".webp");function a(u){Le.call(this,l,u)}const i=u=>{var c;(gt(u)||u.key==="f")&&((c=u.target)==null||c.click())};return l.$$set=u=>{"post"in u&&s(0,n=u.post)},l.$$.update=()=>{l.$$.dirty&1&&s(1,t=o(n.sample_url)?n.sample_url:n.preview_url)},[n,t,r,a,i]}class Ps extends ee{constructor(e){super(),te(this,e,Ds,Cs,x,{post:0})}}function Ns(l){let e,s,t,n;const r=l[3].default,o=Ct(r,l,l[2],null);return{c(){e=I("div"),o&&o.c(),this.h()},l(a){e=C(a,"DIV",{role:!0,tabindex:!0,class:!0});var i=O(e);o&&o.l(i),i.forEach($),this.h()},h(){d(e,"role","none"),d(e,"tabindex","-1"),d(e,"class","dialog fullscreen svelte-1j44awz")},m(a,i){T(a,e,i),o&&o.m(e,null),l[5](e),s=!0,t||(n=[ce(e,"keydown",l[4]),ce(e,"click",Dt(Os))],t=!0)},p(a,[i]){o&&o.p&&(!s||i&4)&&Pt(o,r,a,a[2],s?Ot(r,a[2],i,null):Nt(a[2]),null)},i(a){s||(w(o,a),s=!0)},o(a){S(o,a),s=!1},d(a){a&&$(e),o&&o.d(a),l[5](null),t=!1,Ge(n)}}}const Os=()=>{};function Ts(l,e,s){let{$$slots:t={},$$scope:n}=e;const r=_e(),o=()=>r("close"),a=_=>{_.key==="Escape"&&o()};let i=()=>{document.fullscreenElement||o()},u;Ce(async()=>{u.focus(),document.addEventListener("keydown",a),document.addEventListener("fullscreenchange",i)}),De(async()=>{document.removeEventListener("keydown",a),document.removeEventListener("fullscreenchange",i)});const c=_=>{_.code==="Escape"&&o()};function m(_){pe[_?"unshift":"push"](()=>{u=_,s(0,u)})}return l.$$set=_=>{"$$scope"in _&&s(2,n=_.$$scope)},[u,o,n,t,c,m]}class Vs extends ee{constructor(e){super(),te(this,e,Ts,Ns,x,{})}}function Ms(l){let e;return{c(){e=I("div")},l(s){e=C(s,"DIV",{}),O(e).forEach($)},m(s,t){T(s,e,t),l[2](e)},p:Y,i:Y,o:Y,d(s){s&&$(e),l[2](null)}}}function Rs(l,e,s){let{rootMargin:t}=e;const n=_e(),r=new IntersectionObserver(i=>{i[0].isIntersecting&&n("intersection")},{rootMargin:t});let o;function a(i){pe[i?"unshift":"push"](()=>{o=i,s(0,o)})}return l.$$set=i=>{"rootMargin"in i&&s(1,t=i.rootMargin)},l.$$.update=()=>{l.$$.dirty&1&&(r.disconnect(),o&&r.observe(o))},[o,t,a]}class kt extends ee{constructor(e){super(),te(this,e,Rs,Ms,x,{rootMargin:1})}}function Ls(l){const e=l.slice(),s=jt(e[0].file_url,e[0].sample_url,e[0].preview_url);return e[4]=s,e}function Fs(l){const e=l.slice(),s=$t(e[0].file_url,e[0].sample_url,e[0].preview_url);return e[4]=s,e}function st(l){let e,s,t,n;return{c(){e=I("img"),this.h()},l(r){e=C(r,"IMG",{src:!0,alt:!0,title:!0,class:!0}),this.h()},h(){ue(e.src,s=l[4].animated)||d(e,"src",s),d(e,"alt",t="[GIF] post #"+l[0].id),d(e,"title",n="[GIF] post #"+l[0].id),d(e,"class","svelte-1z0vyw4")},m(r,o){T(r,e,o)},p(r,o){o&1&&!ue(e.src,s=r[4].animated)&&d(e,"src",s),o&1&&t!==(t="[GIF] post #"+r[0].id)&&d(e,"alt",t),o&1&&n!==(n="[GIF] post #"+r[0].id)&&d(e,"title",n)},d(r){r&&$(e)}}}function nt(l){let e,s,t,n;return{c(){e=I("video"),this.h()},l(r){e=C(r,"VIDEO",{src:!0,poster:!0,title:!0,preload:!0,class:!0}),O(e).forEach($),this.h()},h(){ue(e.src,s=l[4].animated)||d(e,"src",s),d(e,"poster",t=l[4].static),e.loop=!0,d(e,"title",n="[VIDEO] post #"+l[0].id),e.controls=!0,d(e,"preload","metadata"),e.autoplay=!0,d(e,"class","svelte-1z0vyw4")},m(r,o){T(r,e,o),l[2](e)},p(r,o){o&1&&!ue(e.src,s=r[4].animated)&&d(e,"src",s),o&1&&t!==(t=r[4].static)&&d(e,"poster",t),o&1&&n!==(n="[VIDEO] post #"+r[0].id)&&d(e,"title",n)},d(r){r&&$(e),l[2](null)}}}function As(l){let e,s,t,n;return{c(){e=I("img"),this.h()},l(r){e=C(r,"IMG",{src:!0,alt:!0,title:!0,class:!0}),this.h()},h(){ue(e.src,s=l[0].sample_url)||d(e,"src",s),d(e,"alt",t="[IMAGE] post #"+l[0].id),d(e,"title",n="[IMAGE] post #"+l[0].id),d(e,"class","svelte-1z0vyw4")},m(r,o){T(r,e,o)},p(r,o){o&1&&!ue(e.src,s=r[0].sample_url)&&d(e,"src",s),o&1&&t!==(t="[IMAGE] post #"+r[0].id)&&d(e,"alt",t),o&1&&n!==(n="[IMAGE] post #"+r[0].id)&&d(e,"title",n)},d(r){r&&$(e)}}}function Bs(l){let e;function s(o,a){return o[0].type==="image"?As:o[0].type==="video"?nt:st}function t(o,a){return a===nt?Fs(o):a===st?Ls(o):o}let n=s(l),r=n(t(l,n));return{c(){r.c(),e=de()},l(o){r.l(o),e=de()},m(o,a){r.m(o,a),T(o,e,a)},p(o,[a]){n===(n=s(o))&&r?r.p(t(o,n),a):(r.d(1),r=n(t(o,n)),r&&(r.c(),r.m(e.parentNode,e)))},i:Y,o:Y,d(o){o&&$(e),r.d(o)}}}function js(l,e,s){let{post:t}=e,n;const r=a=>{t.type==="video"&&n&&(a.key==="ArrowLeft"&&(a.preventDefault(),a.stopPropagation(),s(1,n.currentTime=Math.max(0,n.currentTime-5),n)),a.key==="ArrowRight"&&(a.preventDefault(),a.stopPropagation(),s(1,n.currentTime=Math.min(n.duration,n.currentTime+5),n)))};Ce(()=>document.addEventListener("keydown",r)),De(()=>document.removeEventListener("keydown",r));function o(a){pe[a?"unshift":"push"](()=>{n=a,s(1,n)})}return l.$$set=a=>{"post"in a&&s(0,t=a.post)},[t,n,o]}class Gs extends ee{constructor(e){super(),te(this,e,js,Bs,x,{post:0})}}function zs(l){let e,s,t,n,r;return{c(){e=I("div"),s=I("img"),this.h()},l(o){e=C(o,"DIV",{id:!0,class:!0});var a=O(e);s=C(a,"IMG",{src:!0,alt:!0,class:!0}),a.forEach($),this.h()},h(){ue(s.src,t=l[1])||d(s,"src",t),d(s,"alt",n="post #"+l[0].id),d(s,"class","svelte-1lfcts5"),d(e,"id",r=l[0].id.toString()),d(e,"class","svelte-1lfcts5")},m(o,a){T(o,e,a),b(e,s)},p(o,[a]){a&2&&!ue(s.src,t=o[1])&&d(s,"src",t),a&1&&n!==(n="post #"+o[0].id)&&d(s,"alt",n),a&1&&r!==(r=o[0].id.toString())&&d(e,"id",r)},i:Y,o:Y,d(o){o&&$(e)}}}function qs(l,e,s){let t,{post:n}=e;return l.$$set=r=>{"post"in r&&s(0,n=r.post)},l.$$.update=()=>{l.$$.dirty&1&&s(1,t=Gt(n.sample_url)?n.preview_url:n.sample_url)},[n,t]}class wt extends ee{constructor(e){super(),te(this,e,qs,zs,x,{post:0})}}function lt(l){let e,s;return e=new wt({props:{post:l[5]}}),{c(){L(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,n){A(e,t,n),s=!0},p(t,n){const r={};n&32&&(r.post=t[5]),e.$set(r)},i(t){s||(w(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){B(e,t)}}}function rt(l){let e,s;return e=new wt({props:{post:l[4]}}),{c(){L(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,n){A(e,t,n),s=!0},p(t,n){const r={};n&16&&(r.post=t[4]),e.$set(r)},i(t){s||(w(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){B(e,t)}}}function Us(l){let e,s,t,n,r,o,a,i,u,c,m,_,g,E,D,v,f,h,p,k=l[5]&&lt(l);a=new Gs({props:{post:l[6]}}),c=new ht({props:{post:l[6]}});let V=l[4]&&rt(l);return v=new kt({props:{rootMargin:window.innerHeight*2+"px"}}),v.$on("intersection",l[10]),{c(){e=I("div"),s=I("div"),t=P(),k&&k.c(),n=P(),r=I("div"),o=I("div"),L(a.$$.fragment),i=P(),u=I("div"),L(c.$$.fragment),_=P(),V&&V.c(),g=P(),E=I("div"),D=P(),L(v.$$.fragment),this.h()},l(j){e=C(j,"DIV",{class:!0});var M=O(e);s=C(M,"DIV",{style:!0,class:!0}),O(s).forEach($),t=N(M),k&&k.l(M),n=N(M),r=C(M,"DIV",{class:!0,id:!0});var K=O(r);o=C(K,"DIV",{class:!0});var J=O(o);F(a.$$.fragment,J),J.forEach($),i=N(K),u=C(K,"DIV",{class:!0});var y=O(u);F(c.$$.fragment,y),y.forEach($),K.forEach($),_=N(M),V&&V.l(M),g=N(M),E=C(M,"DIV",{style:!0,class:!0}),O(E).forEach($),D=N(M),F(v.$$.fragment,M),M.forEach($),this.h()},h(){ke(s,"height",Math.max(0,l[0]-1)*100+"vh"),d(s,"class","svelte-1lf13n6"),d(o,"class","screen snap-item svelte-1lf13n6"),d(u,"class","screen snap-item svelte-1lf13n6"),d(r,"class","screen snap-item snap-container horizontal svelte-1lf13n6"),d(r,"id",m=l[6].id.toString()),ke(E,"height",(l[1].posts.length-l[0]-1)*100+"vh"),d(E,"class","svelte-1lf13n6"),d(e,"class","root screen snap-container svelte-1lf13n6")},m(j,M){T(j,e,M),b(e,s),b(e,t),k&&k.m(e,null),b(e,n),b(e,r),b(r,o),A(a,o,null),b(r,i),b(r,u),A(c,u,null),l[9](r),b(e,_),V&&V.m(e,null),b(e,g),b(e,E),b(e,D),A(v,e,null),l[11](e),f=!0,h||(p=ce(e,"scroll",l[8]),h=!0)},p(j,[M]){(!f||M&1)&&ke(s,"height",Math.max(0,j[0]-1)*100+"vh"),j[5]?k?(k.p(j,M),M&32&&w(k,1)):(k=lt(j),k.c(),w(k,1),k.m(e,n)):k&&(ne(),S(k,1,1,()=>{k=null}),le());const K={};M&64&&(K.post=j[6]),a.$set(K);const J={};M&64&&(J.post=j[6]),c.$set(J),(!f||M&64&&m!==(m=j[6].id.toString()))&&d(r,"id",m),j[4]?V?(V.p(j,M),M&16&&w(V,1)):(V=rt(j),V.c(),w(V,1),V.m(e,g)):V&&(ne(),S(V,1,1,()=>{V=null}),le()),(!f||M&3)&&ke(E,"height",(j[1].posts.length-j[0]-1)*100+"vh")},i(j){f||(w(k),w(a.$$.fragment,j),w(c.$$.fragment,j),w(V),w(v.$$.fragment,j),f=!0)},o(j){S(k),S(a.$$.fragment,j),S(c.$$.fragment,j),S(V),S(v.$$.fragment,j),f=!1},d(j){j&&$(e),k&&k.d(),B(a),B(c),l[9](null),V&&V.d(),B(v),l[11](null),h=!1,p()}}}function Hs(l,e,s){let t,n,r,o;re(l,Se,f=>s(1,o=f));let{index:a}=e,i,u;const c=_e(),m=()=>{u&&(u.scrollIntoView(),s(3,u.scrollLeft=0,u))},_=f=>{let h=f.target,p=h.getBoundingClientRect().height,k=h.scrollTop/p,V=Math.round(k);Math.abs(k-V)<.001&&V!=a&&(console.log("INDEX: "+V),s(0,a=V),m())},g=f=>{f.key==="d"&&(f.preventDefault(),f.stopPropagation(),u.scrollLeft==0?(console.log("details"),u.scrollBy({left:i.clientWidth,top:0,behavior:"smooth"})):(console.log("back"),u.scrollBy({left:-i.clientWidth,top:0,behavior:"smooth"}))),f.key==="ArrowUp"&&(f.preventDefault(),f.stopPropagation(),i.scrollBy({left:0,top:-i.clientHeight,behavior:"smooth"})),f.key==="ArrowDown"&&(f.preventDefault(),f.stopPropagation(),i.scrollBy({left:0,top:i.clientHeight,behavior:"smooth"}))};Ce(()=>document.addEventListener("keydown",g)),De(()=>document.removeEventListener("keydown",g));function E(f){pe[f?"unshift":"push"](()=>{u=f,s(3,u)})}const D=()=>c("endreached");function v(f){pe[f?"unshift":"push"](()=>{i=f,s(2,i)})}return l.$$set=f=>{"index"in f&&s(0,a=f.index)},l.$$.update=()=>{l.$$.dirty&3&&s(6,t=o.posts[a]),l.$$.dirty&3&&s(5,n=a>0?o.posts[a-1]:void 0),l.$$.dirty&3&&s(4,r=a<o.posts.length-1?o.posts[a+1]:void 0)},[a,o,i,u,r,n,t,c,_,E,D,v]}class Ks extends ee{constructor(e){super(),te(this,e,Hs,Us,x,{index:0})}}function Ws(l){let e;return{c(){e=I("i"),this.h()},l(s){e=C(s,"I",{class:!0}),O(e).forEach($),this.h()},h(){d(e,"class","codicon codicon-close")},m(s,t){T(s,e,t)},p:Y,d(s){s&&$(e)}}}function Ys(l){let e,s,t,n,r;function o(i){l[2](i)}let a={};return l[0]!==void 0&&(a.index=l[0]),e=new Ks({props:a}),pe.push(()=>Me(e,"index",o)),e.$on("endreached",l[3]),n=new vt({props:{class:"button-close",$$slots:{default:[Ws]},$$scope:{ctx:l}}}),n.$on("click",l[4]),{c(){L(e.$$.fragment),t=P(),L(n.$$.fragment)},l(i){F(e.$$.fragment,i),t=N(i),F(n.$$.fragment,i)},m(i,u){A(e,i,u),T(i,t,u),A(n,i,u),r=!0},p(i,u){const c={};!s&&u&1&&(s=!0,c.index=i[0],Ve(()=>s=!1)),e.$set(c);const m={};u&128&&(m.$$scope={dirty:u,ctx:i}),n.$set(m)},i(i){r||(w(e.$$.fragment,i),w(n.$$.fragment,i),r=!0)},o(i){S(e.$$.fragment,i),S(n.$$.fragment,i),r=!1},d(i){i&&$(t),B(e,i),B(n,i)}}}function Zs(l){let e,s;return e=new Vs({props:{$$slots:{default:[Ys]},$$scope:{ctx:l}}}),e.$on("close",l[5]),{c(){L(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,n){A(e,t,n),s=!0},p(t,[n]){const r={};n&129&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){s||(w(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){B(e,t)}}}function Js(l,e,s){let{index:t}=e;const n=_e(),r=c=>{c.key==="f"&&(c.preventDefault(),c.stopPropagation(),n("close"))};Ce(()=>document.addEventListener("keydown",r)),De(()=>document.removeEventListener("keydown",r));function o(c){t=c,s(0,t)}function a(c){Le.call(this,l,c)}const i=()=>n("close");function u(c){Le.call(this,l,c)}return l.$$set=c=>{"index"in c&&s(0,t=c.index)},[t,n,o,a,i,u]}class Qs extends ee{constructor(e){super(),te(this,e,Js,Zs,x,{index:0})}}function ot(l,e,s){const t=l.slice();return t[10]=e[s],t[12]=s,t}function it(l,e,s){const t=l.slice();return t[10]=e[s],t[12]=s,t}function Xs(l){let e,s,t=Ie(l[2].posts),n=[];for(let o=0;o<t.length;o+=1)n[o]=at(ot(l,t,o));const r=o=>S(n[o],1,1,()=>{n[o]=null});return{c(){e=I("section");for(let o=0;o<n.length;o+=1)n[o].c();this.h()},l(o){e=C(o,"SECTION",{class:!0,style:!0});var a=O(e);for(let i=0;i<n.length;i+=1)n[i].l(a);a.forEach($),this.h()},h(){d(e,"class","multi-column svelte-pioq3k"),ke(e,"grid-template-columns","repeat("+l[3]+", 1fr)")},m(o,a){T(o,e,a);for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(e,null);s=!0},p(o,a){if(a&5){t=Ie(o[2].posts);let i;for(i=0;i<t.length;i+=1){const u=ot(o,t,i);n[i]?(n[i].p(u,a),w(n[i],1)):(n[i]=at(u),n[i].c(),w(n[i],1),n[i].m(e,null))}for(ne(),i=t.length;i<n.length;i+=1)r(i);le()}(!s||a&8)&&ke(e,"grid-template-columns","repeat("+o[3]+", 1fr)")},i(o){if(!s){for(let a=0;a<t.length;a+=1)w(n[a]);s=!0}},o(o){n=n.filter(Boolean);for(let a=0;a<n.length;a+=1)S(n[a]);s=!1},d(o){o&&$(e),qe(n,o)}}}function xs(l){let e,s,t=Ie(l[2].posts),n=[];for(let o=0;o<t.length;o+=1)n[o]=ct(it(l,t,o));const r=o=>S(n[o],1,1,()=>{n[o]=null});return{c(){e=I("section");for(let o=0;o<n.length;o+=1)n[o].c();this.h()},l(o){e=C(o,"SECTION",{class:!0});var a=O(e);for(let i=0;i<n.length;i+=1)n[i].l(a);a.forEach($),this.h()},h(){d(e,"class","single-column svelte-pioq3k")},m(o,a){T(o,e,a);for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(e,null);s=!0},p(o,a){if(a&5){t=Ie(o[2].posts);let i;for(i=0;i<t.length;i+=1){const u=it(o,t,i);n[i]?(n[i].p(u,a),w(n[i],1)):(n[i]=ct(u),n[i].c(),w(n[i],1),n[i].m(e,null))}for(ne(),i=t.length;i<n.length;i+=1)r(i);le()}},i(o){if(!s){for(let a=0;a<t.length;a+=1)w(n[a]);s=!0}},o(o){n=n.filter(Boolean);for(let a=0;a<n.length;a+=1)S(n[a]);s=!1},d(o){o&&$(e),qe(n,o)}}}function at(l){let e,s;function t(){return l[6](l[10],l[12])}return e=new Ps({props:{post:l[10]}}),e.$on("click",t),{c(){L(e.$$.fragment)},l(n){F(e.$$.fragment,n)},m(n,r){A(e,n,r),s=!0},p(n,r){l=n;const o={};r&4&&(o.post=l[10]),e.$set(o)},i(n){s||(w(e.$$.fragment,n),s=!0)},o(n){S(e.$$.fragment,n),s=!1},d(n){B(e,n)}}}function ct(l){let e,s;function t(){return l[5](l[10],l[12])}return e=new Is({props:{post:l[10]}}),e.$on("fullscreen",t),{c(){L(e.$$.fragment)},l(n){F(e.$$.fragment,n)},m(n,r){A(e,n,r),s=!0},p(n,r){l=n;const o={};r&4&&(o.post=l[10]),e.$set(o)},i(n){s||(w(e.$$.fragment,n),s=!0)},o(n){S(e.$$.fragment,n),s=!1},d(n){B(e,n)}}}function ut(l){let e,s;return e=new Qs({props:{index:l[0].index}}),e.$on("close",l[7]),e.$on("endreached",l[8]),{c(){L(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,n){A(e,t,n),s=!0},p(t,n){const r={};n&1&&(r.index=t[0].index),e.$set(r)},i(t){s||(w(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){B(e,t)}}}function en(l){let e,s,t=Ae(l[2].postCount)+"",n,r,o,a,i,u,c,m,_,g;a=new $s({}),a.$on("sortfilterupdate",l[4]);const E=[xs,Xs],D=[];function v(h,p){return h[3]==="1"?0:1}u=v(l),c=D[u]=E[u](l);let f=l[1]&&l[0]&&ut(l);return{c(){e=I("div"),s=I("span"),n=oe(t),r=oe(" posts"),o=P(),L(a.$$.fragment),i=P(),c.c(),m=P(),f&&f.c(),_=de(),this.h()},l(h){e=C(h,"DIV",{class:!0});var p=O(e);s=C(p,"SPAN",{});var k=O(s);n=ie(k,t),r=ie(k," posts"),k.forEach($),o=N(p),F(a.$$.fragment,p),p.forEach($),i=N(h),c.l(h),m=N(h),f&&f.l(h),_=de(),this.h()},h(){d(e,"class","svelte-pioq3k")},m(h,p){T(h,e,p),b(e,s),b(s,n),b(s,r),b(e,o),A(a,e,null),T(h,i,p),D[u].m(h,p),T(h,m,p),f&&f.m(h,p),T(h,_,p),g=!0},p(h,[p]){(!g||p&4)&&t!==(t=Ae(h[2].postCount)+"")&&Re(n,t);let k=u;u=v(h),u===k?D[u].p(h,p):(ne(),S(D[k],1,1,()=>{D[k]=null}),le(),c=D[u],c?c.p(h,p):(c=D[u]=E[u](h),c.c()),w(c,1),c.m(m.parentNode,m)),h[1]&&h[0]?f?(f.p(h,p),p&3&&w(f,1)):(f=ut(h),f.c(),w(f,1),f.m(_.parentNode,_)):f&&(ne(),S(f,1,1,()=>{f=null}),le())},i(h){g||(w(a.$$.fragment,h),w(c),w(f),g=!0)},o(h){S(a.$$.fragment,h),S(c),S(f),g=!1},d(h){h&&($(e),$(i),$(m),$(_)),B(a),D[u].d(h),f&&f.d(h)}}}function tn(l,e,s){let t,n;re(l,Se,g=>s(2,t=g)),re(l,Tt,g=>s(3,n=g));let r,o=location.hash.length>2;const a=()=>{s(1,o=location.hash.length>2)};Ce(()=>{window.addEventListener("hashchange",a)}),De(()=>{window.removeEventListener("hashchange",a)});function i(g){Le.call(this,l,g)}const u=(g,E)=>{s(0,r={post:g,index:E}),location.hash="fullscreen"},c=(g,E)=>{s(0,r={post:g,index:E}),location.hash="fullscreen"},m=()=>{var g,E;(g=r==null?void 0:r.post)!=null&&g.id&&((E=document.querySelector(`#post_${r.post.id} .post-media`))==null||E.focus()),s(0,r=void 0),history.back()};function _(g){Le.call(this,l,g)}return[r,o,t,n,i,u,c,m,_]}class sn extends ee{constructor(e){super(),te(this,e,tn,en,x,{})}}function nn(l){let e;return{c(){e=oe("Reset Filter")},l(s){e=ie(s,"Reset Filter")},m(s,t){T(s,e,t)},d(s){s&&$(e)}}}function ln(l){let e,s,t,n,r="We couldn't find any posts matching your tags. Sorry...",o,a,i;return a=new Fe({props:{title:"In case your filter caused all posts to vanish. Reset it.",$$slots:{default:[nn]},$$scope:{ctx:l}}}),a.$on("click",l[1]),{c(){e=I("img"),t=P(),n=I("p"),n.textContent=r,o=P(),L(a.$$.fragment),this.h()},l(u){e=C(u,"IMG",{src:!0,alt:!0,class:!0}),t=N(u),n=C(u,"P",{"data-svelte-h":!0}),fe(n)!=="svelte-1utxj3w"&&(n.textContent=r),o=N(u),F(a.$$.fragment,u),this.h()},h(){ue(e.src,s=mt+"/assets/shironeko-confused.png")||d(e,"src",s),d(e,"alt","Nothing here..."),d(e,"class","svelte-1bb5e7g")},m(u,c){T(u,e,c),T(u,t,c),T(u,n,c),T(u,o,c),A(a,u,c),i=!0},p(u,[c]){const m={};c&4&&(m.$$scope={dirty:c,ctx:u}),a.$set(m)},i(u){i||(w(a.$$.fragment,u),i=!0)},o(u){S(a.$$.fragment,u),i=!1},d(u){u&&($(e),$(t),$(n),$(o)),B(a,u)}}}function rn(l){const e=_e();return[e,()=>{Ee.reset(),be.reset(),e("sortfilterupdate")}]}class on extends ee{constructor(e){super(),te(this,e,rn,ln,x,{})}}function an(l){let e;return{c(){e=oe("Search")},l(s){e=ie(s,"Search")},m(s,t){T(s,e,t)},d(s){s&&$(e)}}}function cn(l){let e,s,t,n,r,o;const a=[pn,fn],i=[];function u(c,m){return c[2].postCount===0?0:1}return s=u(l),t=i[s]=a[s](l),r=new Wt({}),{c(){e=I("section"),t.c(),n=P(),L(r.$$.fragment),this.h()},l(c){e=C(c,"SECTION",{class:!0});var m=O(e);t.l(m),m.forEach($),n=N(c),F(r.$$.fragment,c),this.h()},h(){d(e,"class","svelte-rk0y4a")},m(c,m){T(c,e,m),i[s].m(e,null),T(c,n,m),A(r,c,m),o=!0},p(c,m){let _=s;s=u(c),s===_?i[s].p(c,m):(ne(),S(i[_],1,1,()=>{i[_]=null}),le(),t=i[s],t?t.p(c,m):(t=i[s]=a[s](c),t.c()),w(t,1),t.m(e,null))},i(c){o||(w(t),w(r.$$.fragment,c),o=!0)},o(c){S(t),S(r.$$.fragment,c),o=!1},d(c){c&&($(e),$(n)),i[s].d(),B(r,c)}}}function un(l){let e,s;return e=new rs({props:{error:l[0]}}),{c(){L(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,n){A(e,t,n),s=!0},p(t,n){const r={};n&1&&(r.error=t[0]),e.$set(r)},i(t){s||(w(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){B(e,t)}}}function fn(l){let e,s,t,n,r,o;e=new sn({}),e.$on("sortfilterupdate",l[7]),e.$on("endreached",l[8]);const a=[_n,dn],i=[];function u(c,m){return c[2].posts.length===c[2].postCount?0:1}return t=u(l),n=i[t]=a[t](l),{c(){L(e.$$.fragment),s=P(),n.c(),r=de()},l(c){F(e.$$.fragment,c),s=N(c),n.l(c),r=de()},m(c,m){A(e,c,m),T(c,s,m),i[t].m(c,m),T(c,r,m),o=!0},p(c,m){let _=t;t=u(c),t===_?i[t].p(c,m):(ne(),S(i[_],1,1,()=>{i[_]=null}),le(),n=i[t],n?n.p(c,m):(n=i[t]=a[t](c),n.c()),w(n,1),n.m(r.parentNode,r))},i(c){o||(w(e.$$.fragment,c),w(n),o=!0)},o(c){S(e.$$.fragment,c),S(n),o=!1},d(c){c&&($(s),$(r)),B(e,c),i[t].d(c)}}}function pn(l){let e,s;return e=new on({}),e.$on("sortfilterupdate",l[7]),{c(){L(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,n){A(e,t,n),s=!0},p:Y,i(t){s||(w(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){B(e,t)}}}function dn(l){let e,s;return e=new kt({props:{rootMargin:"1000px"}}),e.$on("intersection",l[8]),{c(){L(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,n){A(e,t,n),s=!0},p:Y,i(t){s||(w(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){B(e,t)}}}function _n(l){let e,s;return e=new is({}),{c(){L(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,n){A(e,t,n),s=!0},p:Y,i(t){s||(w(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){B(e,t)}}}function ft(l){let e,s;return e=new ss({props:{tags:l[4]}}),e.$on("close",l[13]),e.$on("submit",l[14]),{c(){L(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,n){A(e,t,n),s=!0},p(t,n){const r={};n&16&&(r.tags=t[4]),e.$set(r)},i(t){s||(w(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){B(e,t)}}}function mn(l){let e,s,t,n,r,o,a,i,u,c,m,_,g,E;s=new Mt({}),n=new Ht({props:{placeholder:"Search for tags",fetchSuggestions:l[6]}}),n.$on("pick",l[9]),o=new Fe({props:{title:"Search with the tags above",$$slots:{default:[an]},$$scope:{ctx:l}}}),o.$on("click",l[7]),i=new Rt({props:{tags:[...l[4],...l[3]]}}),i.$on("click",l[10]),i.$on("contextmenu",l[11]),i.$on("createSupertag",l[12]);const D=[un,cn],v=[];function f(p,k){return p[0]?0:p[2].requested?1:-1}~(c=f(l))&&(m=v[c]=D[c](l));let h=l[1]&&ft(l);return{c(){e=I("section"),L(s.$$.fragment),t=P(),L(n.$$.fragment),r=P(),L(o.$$.fragment),a=P(),L(i.$$.fragment),u=P(),m&&m.c(),_=P(),h&&h.c(),g=de(),this.h()},l(p){e=C(p,"SECTION",{id:!0,class:!0});var k=O(e);F(s.$$.fragment,k),t=N(k),F(n.$$.fragment,k),r=N(k),F(o.$$.fragment,k),a=N(k),F(i.$$.fragment,k),k.forEach($),u=N(p),m&&m.l(p),_=N(p),h&&h.l(p),g=de(),this.h()},h(){d(e,"id","search"),d(e,"class","svelte-rk0y4a")},m(p,k){T(p,e,k),A(s,e,null),b(e,t),A(n,e,null),b(e,r),A(o,e,null),b(e,a),A(i,e,null),T(p,u,k),~c&&v[c].m(p,k),T(p,_,k),h&&h.m(p,k),T(p,g,k),E=!0},p(p,[k]){const V={};k&8388608&&(V.$$scope={dirty:k,ctx:p}),o.$set(V);const j={};k&24&&(j.tags=[...p[4],...p[3]]),i.$set(j);let M=c;c=f(p),c===M?~c&&v[c].p(p,k):(m&&(ne(),S(v[M],1,1,()=>{v[M]=null}),le()),~c?(m=v[c],m?m.p(p,k):(m=v[c]=D[c](p),m.c()),w(m,1),m.m(_.parentNode,_)):m=null),p[1]?h?(h.p(p,k),k&2&&w(h,1)):(h=ft(p),h.c(),w(h,1),h.m(g.parentNode,g)):h&&(ne(),S(h,1,1,()=>{h=null}),le())},i(p){E||(w(s.$$.fragment,p),w(n.$$.fragment,p),w(o.$$.fragment,p),w(i.$$.fragment,p),w(m),w(h),E=!0)},o(p){S(s.$$.fragment,p),S(n.$$.fragment,p),S(o.$$.fragment,p),S(i.$$.fragment,p),S(m),S(h),E=!1},d(p){p&&($(e),$(u),$(_),$(g)),B(s),B(n),B(o),B(i),~c&&v[c].d(p),h&&h.d(p)}}}function gn(l,e,s){let t,n,r,o,a,i,u;re(l,Se,y=>s(2,t=y)),re(l,ze,y=>s(3,n=y)),re(l,be,y=>s(17,r=y)),re(l,Ee,y=>s(18,o=y)),re(l,Qt,y=>s(19,a=y)),re(l,Be,y=>s(4,i=y)),re(l,Je,y=>s(5,u=y));let c=!1,m,_=!1,g=0;const E=async y=>{const H=await Yt(y);return[...u.items.filter(({name:X})=>X.toLowerCase().includes(y.toLowerCase())).map(X=>({label:X.name,count:X.tags.length,type:"supertag"})),...H]},D=()=>new Lt().withPid(t.pageCount).withTags(i).withBlockedContent(a).withSortProperty(o.property).withSortDirection(o.direction).withScoreValue(r.scoreValue).withScoreComparator(r.scoreComparator).withRating(r.rating).withSupertags(n),v=async y=>{if(!c){s(0,m=void 0),c=!0;try{const H=t.pageCount;await y(),Jt(H).catch(()=>{})}catch(H){s(0,m=H),console.warn(H)}finally{c=!1}}},f=async()=>{Se.reset(),g=0,v(async()=>{const[y,H]=await D().getPageAndCount();Se.addPage(y,H)})},h=async()=>{v(async()=>{const y=await D().getPage();Se.addPage(y)})},p=y=>{var H,Q;if((y.key==="/"||y.key==="s")&&(!document.activeElement||document.activeElement===document.body)&&((H=document.getElementById("searchbar"))==null||H.focus(),y.preventDefault(),y.stopPropagation()),y.ctrlKey&&y.key==="Enter"&&(y.preventDefault(),y.stopPropagation(),f()),y.ctrlKey&&y.key==="m"&&((Q=document.getElementById("select-modifier"))==null||Q.click()),y.ctrlKey&&y.key==="ArrowDown"){const X=document.getElementsByClassName("post-media");X[g].focus(),g=Math.min(g+1,Math.max(0,X.length-1))}y.ctrlKey&&y.key==="ArrowUp"&&(document.getElementsByClassName("post-media")[g].focus(),g=Math.max(g-1,0))};return Ce(async()=>{document.addEventListener("keydown",p)}),De(()=>{document.removeEventListener("keydown",p)}),[m,_,t,n,i,u,E,f,h,async y=>{const H=y.detail;if(H.type==="supertag"){const Q=u.items.find(X=>X.name===H.label);if(!Q){console.warn("Supertag not present.");return}ze.addOrReplace(Q)}else{const Q=await Zt(y.detail.label);Be.addOrReplace({name:y.detail.label,modifier:y.detail.modifier,count:y.detail.count,type:(Q==null?void 0:Q.type)??"tag"})}},y=>"description"in y.detail?ze.removeByName(y.detail.name):Be.removeByName(y.detail.name),y=>{"description"in y.detail||(y.detail.modifier=Kt(y.detail.modifier),Be.addOrReplace(y.detail))},()=>s(1,_=!0),()=>s(1,_=!1),y=>Je.add(y.detail)]}class An extends ee{constructor(e){super(),te(this,e,gn,mn,x,{})}}export{An as component};
