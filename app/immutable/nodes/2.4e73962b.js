import{s as x,D as _e,f as S,a as P,g as I,h as V,y as fe,c as N,d as h,j as _,r as pt,i as O,u as v,E as ye,F as ce,G as qe,H as Ge,l as oe,m as ie,v as Y,I as ue,e as de,n as Te,C as re,J as It,p as pe,K as Ve,L as dt,M as je,k as ke,N as Me,w as Ct,O as Dt,z as Pt,A as Nt,B as Vt,o as Le,P as Ae}from"../chunks/scheduler.0a29c992.js";import{S as ee,i as te,b as F,d as L,m as A,a as w,t as E,e as B,g as se,c as le,f as Oe}from"../chunks/index.6d8df040.js";import{e as Ie}from"../chunks/each.e59479a4.js";import{D as _t,r as Ot}from"../chunks/result-columns-store.7454cbad.js";import{T as Re}from"../chunks/TextButton.f6017ea8.js";import{D as Tt}from"../chunks/DetailedTag.6129a1d8.js";import{K as Mt,A as Rt}from"../chunks/ActiveTagList.0ac41c7b.js";import{b as mt}from"../chunks/paths.05bbb49d.js";import{s as Ee,f as be,r as Se,a as ze,S as Ft}from"../chunks/active-supertags-store.11df592d.js";import{i as gt,D as ht,g as $t,G as Lt,V as At,a as Ye,I as Bt,b as jt,c as Gt}from"../chunks/Details.9d1a216e.js";import{f as Fe}from"../chunks/format-tag.7e313273.js";import{R as zt,I as vt}from"../chunks/ModifierSelect.51f2ca82.js";import{S as Ze}from"../chunks/Select.0781c4e2.js";import{R as qt}from"../chunks/RotatingTextSelect.f25d5f18.js";import{a as Ut}from"../chunks/always-loop-store.ec22e8f2.js";import{S as Ht,n as Kt,s as Je}from"../chunks/supertags-store.656814ef.js";import{S as Wt}from"../chunks/ScrollUpButton.be9a5994.js";import{g as Yt,a as Zt}from"../chunks/tags.49324235.js";import{l as Jt}from"../chunks/analytics.eca95ce1.js";import{a as Be}from"../chunks/active-tags-store.a60398a6.js";import{b as Qt}from"../chunks/blocked-content-store.2a43e35e.js";function Qe(l,e,n){const t=l.slice();return t[9]=e[n],t}function Xe(l){let e,n;return e=new Tt({props:{tag:l[9]}}),{c(){F(e.$$.fragment)},l(t){L(e.$$.fragment,t)},m(t,s){A(e,t,s),n=!0},p(t,s){const r={};s&4&&(r.tag=t[9]),e.$set(r)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){E(e.$$.fragment,t),n=!1},d(t){B(e,t)}}}function Xt(l){let e;return{c(){e=oe("Create supertag")},l(n){e=ie(n,"Create supertag")},m(n,t){O(n,e,t)},d(n){n&&h(e)}}}function xt(l){let e,n,t="Create Supertag",s,r,o,a,i,u="Name",c,p,m,b,C,D="Description",$,f,g,d,k,T="Tags",j,M,K,J,y,H,Q,X,ne=Ie(l[2]),q=[];for(let G=0;G<ne.length;G+=1)q[G]=Xe(Qe(l,ne,G));const Ce=G=>E(q[G],1,1,()=>{q[G]=null});return y=new Re({props:{title:l[3]?"Click to create supertag":"Enter a valid name to continue",disabled:!l[3],$$slots:{default:[Xt]},$$scope:{ctx:l}}}),y.$on("click",l[8]),{c(){e=S("section"),n=S("h3"),n.textContent=t,s=P(),r=S("button"),o=P(),a=S("div"),i=S("label"),i.textContent=u,c=P(),p=S("input"),m=P(),b=S("div"),C=S("label"),C.textContent=D,$=P(),f=S("input"),g=P(),d=S("div"),k=S("span"),k.textContent=T,j=P(),M=S("ol");for(let G=0;G<q.length;G+=1)q[G].c();K=P(),J=S("div"),F(y.$$.fragment),this.h()},l(G){e=I(G,"SECTION",{class:!0});var R=V(e);n=I(R,"H3",{"data-svelte-h":!0}),fe(n)!=="svelte-ho1cwx"&&(n.textContent=t),s=N(R),r=I(R,"BUTTON",{class:!0}),V(r).forEach(h),o=N(R),a=I(R,"DIV",{class:!0});var Z=V(a);i=I(Z,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),fe(i)!=="svelte-10k8a68"&&(i.textContent=u),c=N(Z),p=I(Z,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),Z.forEach(h),m=N(R),b=I(R,"DIV",{class:!0});var U=V(b);C=I(U,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),fe(C)!=="svelte-14n9kp6"&&(C.textContent=D),$=N(U),f=I(U,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),U.forEach(h),g=N(R),d=I(R,"DIV",{class:!0});var ae=V(d);k=I(ae,"SPAN",{class:!0,"data-svelte-h":!0}),fe(k)!=="svelte-7hjyox"&&(k.textContent=T),j=N(ae),M=I(ae,"OL",{class:!0});var we=V(M);for(let Pe=0;Pe<q.length;Pe+=1)q[Pe].l(we);we.forEach(h),ae.forEach(h),K=N(R),J=I(R,"DIV",{class:!0});var De=V(J);L(y.$$.fragment,De),De.forEach(h),R.forEach(h),this.h()},h(){_(r,"class",pt("codicon codicon-close")+" svelte-xkjm86"),_(i,"for","supertag-name"),_(i,"class","svelte-xkjm86"),_(p,"type","text"),_(p,"placeholder","Descriptive name"),_(p,"id","supertag-name"),_(p,"class","svelte-xkjm86"),_(a,"class","svelte-xkjm86"),_(C,"for","supertag-description"),_(C,"class","svelte-xkjm86"),_(f,"type","text"),_(f,"placeholder","Short description"),_(f,"id","supertag-description"),_(f,"class","svelte-xkjm86"),_(b,"class","svelte-xkjm86"),_(k,"class","svelte-xkjm86"),_(M,"class","svelte-xkjm86"),_(d,"class","svelte-xkjm86"),_(J,"class","last svelte-xkjm86"),_(e,"class","svelte-xkjm86")},m(G,R){O(G,e,R),v(e,n),v(e,s),v(e,r),v(e,o),v(e,a),v(a,i),v(a,c),v(a,p),ye(p,l[0]),v(e,m),v(e,b),v(b,C),v(b,$),v(b,f),ye(f,l[1]),v(e,g),v(e,d),v(d,k),v(d,j),v(d,M);for(let Z=0;Z<q.length;Z+=1)q[Z]&&q[Z].m(M,null);v(e,K),v(e,J),A(y,J,null),H=!0,Q||(X=[ce(r,"click",l[5]),ce(p,"input",l[6]),ce(f,"input",l[7])],Q=!0)},p(G,R){if(R&1&&p.value!==G[0]&&ye(p,G[0]),R&2&&f.value!==G[1]&&ye(f,G[1]),R&4){ne=Ie(G[2]);let U;for(U=0;U<ne.length;U+=1){const ae=Qe(G,ne,U);q[U]?(q[U].p(ae,R),w(q[U],1)):(q[U]=Xe(ae),q[U].c(),w(q[U],1),q[U].m(M,null))}for(se(),U=ne.length;U<q.length;U+=1)Ce(U);le()}const Z={};R&8&&(Z.title=G[3]?"Click to create supertag":"Enter a valid name to continue"),R&8&&(Z.disabled=!G[3]),R&4096&&(Z.$$scope={dirty:R,ctx:G}),y.$set(Z)},i(G){if(!H){for(let R=0;R<ne.length;R+=1)w(q[R]);w(y.$$.fragment,G),H=!0}},o(G){q=q.filter(Boolean);for(let R=0;R<q.length;R+=1)E(q[R]);E(y.$$.fragment,G),H=!1},d(G){G&&h(e),qe(q,G),B(y),Q=!1,Ge(X)}}}function en(l){let e,n;return e=new _t({props:{$$slots:{default:[xt]},$$scope:{ctx:l}}}),e.$on("close",l[5]),{c(){F(e.$$.fragment)},l(t){L(e.$$.fragment,t)},m(t,s){A(e,t,s),n=!0},p(t,[s]){const r={};s&4111&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){E(e.$$.fragment,t),n=!1},d(t){B(e,t)}}}function tn(l,e,n){let t,{name:s=""}=e,{description:r=""}=e,{tags:o}=e;const a=_e(),i=()=>a("close");function u(){s=this.value,n(0,s)}function c(){r=this.value,n(1,r)}const p=()=>{a("submit",{name:s,description:r,tags:o.map(({modifier:m,name:b})=>({modifier:m,name:b}))}),i()};return l.$$set=m=>{"name"in m&&n(0,s=m.name),"description"in m&&n(1,r=m.description),"tags"in m&&n(2,o=m.tags)},l.$$.update=()=>{l.$$.dirty&5&&n(3,t=typeof s=="string"&&s!==""&&o.length>1)},[s,r,o,t,a,i,u,c,p]}class nn extends ee{constructor(e){super(),te(this,e,tn,en,x,{name:0,description:1,tags:2})}}function sn(l){let e,n,t,s,r,o,a,i,u,c;return{c(){e=S("div"),n=S("div"),t=S("i"),s=P(),r=S("div"),o=S("h3"),a=oe(l[0]),i=P(),u=S("span"),c=oe(l[2]),this.h()},l(p){e=I(p,"DIV",{class:!0});var m=V(e);n=I(m,"DIV",{class:!0});var b=V(n);t=I(b,"I",{class:!0}),V(t).forEach(h),b.forEach(h),s=N(m),r=I(m,"DIV",{});var C=V(r);o=I(C,"H3",{class:!0});var D=V(o);a=ie(D,l[0]),D.forEach(h),i=N(C),u=I(C,"SPAN",{});var $=V(u);c=ie($,l[2]),$.forEach(h),C.forEach(h),m.forEach(h),this.h()},h(){_(t,"class",pt(l[1])+" svelte-1tvgln1"),_(n,"class","icon svelte-1tvgln1"),_(o,"class","svelte-1tvgln1"),_(e,"class","error svelte-1tvgln1")},m(p,m){O(p,e,m),v(e,n),v(n,t),v(e,s),v(e,r),v(r,o),v(o,a),v(r,i),v(r,u),v(u,c)},p:Y,i:Y,o:Y,d(p){p&&h(e)}}}function ln(l,e,n){let{error:t}=e,s=t.message==="Failed to fetch"?"Connection Error":"Application Error",r=t.message==="Failed to fetch"?"codicon codicon-debug-disconnect":"codicon codicon-error",o=t.message==="Failed to fetch"?"Failed to connect to the server. Make sure you have a stable internet connection.":t.message;return l.$$set=a=>{"error"in a&&n(3,t=a.error)},[s,r,o,t]}class rn extends ee{constructor(e){super(),te(this,e,ln,sn,x,{error:3})}}function on(l){let e,n,t,s,r="You have seen everything there is to see...";return{c(){e=S("img"),t=P(),s=S("p"),s.textContent=r,this.h()},l(o){e=I(o,"IMG",{src:!0,alt:!0,class:!0}),t=N(o),s=I(o,"P",{"data-svelte-h":!0}),fe(s)!=="svelte-1i75mtf"&&(s.textContent=r),this.h()},h(){ue(e.src,n=mt+"/assets/shironeko-x.png")||_(e,"src",n),_(e,"alt","No more results to load"),_(e,"class","svelte-1pkma0d")},m(o,a){O(o,e,a),O(o,t,a),O(o,s,a)},p:Y,i:Y,o:Y,d(o){o&&(h(e),h(t),h(s))}}}class an extends ee{constructor(e){super(),te(this,e,null,on,x,{})}}function xe(l){let e,n;return e=new _t({props:{$$slots:{default:[fn]},$$scope:{ctx:l}}}),e.$on("close",l[7]),{c(){F(e.$$.fragment)},l(t){L(e.$$.fragment,t)},m(t,s){A(e,t,s),n=!0},p(t,s){const r={};s&65543&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){E(e.$$.fragment,t),n=!1},d(t){B(e,t)}}}function cn(l){let e;return{c(){e=oe("Done")},l(n){e=ie(n,"Done")},m(n,t){O(n,e,t)},d(n){n&&h(e)}}}function un(l){let e;return{c(){e=oe("Reset")},l(n){e=ie(n,"Reset")},m(n,t){O(n,e,t)},d(n){n&&h(e)}}}function fn(l){let e,n,t="Sorting and Filtering",s,r,o,a="Sorting",i,u,c,p,m,b,C,D,$,f,g="Filtering by Score",d,k,T,j,M,K,J,y,H,Q="Filtering by Rating",X,ne,q,Ce,G,R,Z,U,ae,we,De;function Pe(z){l[10](z)}let Ue={options:_n};l[1].direction!==void 0&&(Ue.value=l[1].direction),c=new zt({props:Ue}),pe.push(()=>Oe(c,"value",Pe));function yt(z){l[11](z)}let He={options:dn};l[1].property!==void 0&&(He.value=l[1].property),b=new Ze({props:He}),pe.push(()=>Oe(b,"value",yt));function Et(z){l[12](z)}let Ke={options:mn};l[2].scoreComparator!==void 0&&(Ke.value=l[2].scoreComparator),T=new qt({props:Ke}),pe.push(()=>Oe(T,"value",Et));function St(z){l[14](z)}let We={options:bt};return l[2].rating!==void 0&&(We.value=l[2].rating),q=new Ze({props:We}),pe.push(()=>Oe(q,"value",St)),R=new Re({props:{title:"Return to searching.",$$slots:{default:[cn]},$$scope:{ctx:l}}}),R.$on("click",l[7]),U=new Re({props:{title:"Reset sort and filter.",type:"secondary",$$slots:{default:[un]},$$scope:{ctx:l}}}),U.$on("click",l[9]),{c(){e=S("div"),n=S("h3"),n.textContent=t,s=P(),r=S("div"),o=S("b"),o.textContent=a,i=P(),u=S("div"),F(c.$$.fragment),m=P(),F(b.$$.fragment),D=P(),$=S("div"),f=S("b"),f.textContent=g,d=P(),k=S("div"),F(T.$$.fragment),M=P(),K=S("input"),J=P(),y=S("div"),H=S("b"),H.textContent=Q,X=P(),ne=S("div"),F(q.$$.fragment),G=P(),F(R.$$.fragment),Z=P(),F(U.$$.fragment),this.h()},l(z){e=I(z,"DIV",{class:!0});var W=V(e);n=I(W,"H3",{"data-svelte-h":!0}),fe(n)!=="svelte-15zouq3"&&(n.textContent=t),s=N(W),r=I(W,"DIV",{});var me=V(r);o=I(me,"B",{class:!0,"data-svelte-h":!0}),fe(o)!=="svelte-ekzpgg"&&(o.textContent=a),i=N(me),u=I(me,"DIV",{class:!0});var ge=V(u);L(c.$$.fragment,ge),m=N(ge),L(b.$$.fragment,ge),ge.forEach(h),me.forEach(h),D=N(W),$=I(W,"DIV",{});var he=V($);f=I(he,"B",{class:!0,"data-svelte-h":!0}),fe(f)!=="svelte-1flca3"&&(f.textContent=g),d=N(he),k=I(he,"DIV",{class:!0});var $e=V(k);L(T.$$.fragment,$e),M=N($e),K=I($e,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),$e.forEach(h),he.forEach(h),J=N(W),y=I(W,"DIV",{});var ve=V(y);H=I(ve,"B",{class:!0,"data-svelte-h":!0}),fe(H)!=="svelte-1evbw58"&&(H.textContent=Q),X=N(ve),ne=I(ve,"DIV",{class:!0});var Ne=V(ne);L(q.$$.fragment,Ne),Ne.forEach(h),ve.forEach(h),G=N(W),L(R.$$.fragment,W),Z=N(W),L(U.$$.fragment,W),W.forEach(h),this.h()},h(){_(o,"class","svelte-gf4ubn"),_(u,"class","row svelte-gf4ubn"),_(f,"class","svelte-gf4ubn"),_(K,"type","number"),_(K,"min",0),_(K,"max",1e5),_(K,"step",1),_(K,"class","svelte-gf4ubn"),_(k,"class","row svelte-gf4ubn"),_(H,"class","svelte-gf4ubn"),_(ne,"class","row svelte-gf4ubn"),_(e,"class","container svelte-gf4ubn")},m(z,W){O(z,e,W),v(e,n),v(e,s),v(e,r),v(r,o),v(r,i),v(r,u),A(c,u,null),v(u,m),A(b,u,null),v(e,D),v(e,$),v($,f),v($,d),v($,k),A(T,k,null),v(k,M),v(k,K),ye(K,l[0]),v(e,J),v(e,y),v(y,H),v(y,X),v(y,ne),A(q,ne,null),v(e,G),A(R,e,null),v(e,Z),A(U,e,null),ae=!0,we||(De=[ce(K,"input",l[13]),ce(K,"keyup",l[8])],we=!0)},p(z,W){const me={};!p&&W&2&&(p=!0,me.value=z[1].direction,Ve(()=>p=!1)),c.$set(me);const ge={};!C&&W&2&&(C=!0,ge.value=z[1].property,Ve(()=>C=!1)),b.$set(ge);const he={};!j&&W&4&&(j=!0,he.value=z[2].scoreComparator,Ve(()=>j=!1)),T.$set(he),W&1&&dt(K.value)!==z[0]&&ye(K,z[0]);const $e={};!Ce&&W&4&&(Ce=!0,$e.value=z[2].rating,Ve(()=>Ce=!1)),q.$set($e);const ve={};W&65536&&(ve.$$scope={dirty:W,ctx:z}),R.$set(ve);const Ne={};W&65536&&(Ne.$$scope={dirty:W,ctx:z}),U.$set(Ne)},i(z){ae||(w(c.$$.fragment,z),w(b.$$.fragment,z),w(T.$$.fragment,z),w(q.$$.fragment,z),w(R.$$.fragment,z),w(U.$$.fragment,z),ae=!0)},o(z){E(c.$$.fragment,z),E(b.$$.fragment,z),E(T.$$.fragment,z),E(q.$$.fragment,z),E(R.$$.fragment,z),E(U.$$.fragment,z),ae=!1},d(z){z&&h(e),B(c),B(b),B(T),B(q),B(R),B(U),we=!1,Ge(De)}}}function pn(l){let e,n,t,s,r,o,a,i,u,c,p,m,b,C,D,$=l[3]&&xe(l);return{c(){e=S("button"),n=S("i"),t=P(),s=S("span"),r=oe(l[5]),o=P(),a=S("i"),i=P(),u=S("span"),c=oe(l[4]),p=P(),$&&$.c(),m=de(),this.h()},l(f){e=I(f,"BUTTON",{class:!0});var g=V(e);n=I(g,"I",{class:!0}),V(n).forEach(h),t=N(g),s=I(g,"SPAN",{});var d=V(s);r=ie(d,l[5]),d.forEach(h),o=N(g),a=I(g,"I",{class:!0}),V(a).forEach(h),i=N(g),u=I(g,"SPAN",{});var k=V(u);c=ie(k,l[4]),k.forEach(h),g.forEach(h),p=N(f),$&&$.l(f),m=de(),this.h()},h(){_(n,"class","codicon codicon-filter svelte-gf4ubn"),_(a,"class","codicon codicon-arrow-swap svelte-gf4ubn"),_(e,"class","svelte-gf4ubn")},m(f,g){O(f,e,g),v(e,n),v(e,t),v(e,s),v(s,r),v(e,o),v(e,a),v(e,i),v(e,u),v(u,c),O(f,p,g),$&&$.m(f,g),O(f,m,g),b=!0,C||(D=ce(e,"click",l[6]),C=!0)},p(f,[g]){(!b||g&32)&&Te(r,f[5]),(!b||g&16)&&Te(c,f[4]),f[3]?$?($.p(f,g),g&8&&w($,1)):($=xe(f),$.c(),w($,1),$.m(m.parentNode,m)):$&&(se(),E($,1,1,()=>{$=null}),le())},i(f){b||(w($),b=!0)},o(f){E($),b=!1},d(f){f&&(h(e),h(p),h(m)),$&&$.d(f),C=!1,D()}}}const dn=Object.freeze({id:"Uploaded",score:"Score",updated:"Updated",random:"Random"}),_n=Object.freeze({desc:"codicon codicon-arrow-down",asc:"codicon codicon-arrow-up"}),mn=Object.freeze({">=":"≥","<=":"≤"}),bt=Object.freeze({all:"All",safe:"Safe",questionable:"Questionable",explicit:"Explicit"}),gn=Object.freeze({id:{asc:"Oldest",desc:"Newest"},score:{asc:"Worst",desc:"Best"},updated:{asc:"Inactive",desc:"Active"},random:{asc:"Random",desc:"Random"}}),hn=(l,e,n)=>{let t=l==="all"?void 0:bt[l],s=e===0&&n===">="?void 0:`Score${n}${Fe(e)}`;return[t,s].filter(r=>r!==void 0).join(",")||"All"};function $n(l,e,n){let t,s,r,o;re(l,Ee,d=>n(1,r=d)),re(l,be,d=>n(2,o=d));const a=_e();let i=!1;const u=()=>n(3,i=!0),c=()=>{n(3,i=!1),a("sortfilterupdate")},p=d=>{var k;return gt(d)&&((k=d.target)==null?void 0:k.blur())},m=()=>{Ee.reset(),be.reset(),n(0,b=o.scoreValue)};let b;function C(d){l.$$.not_equal(r.direction,d)&&(r.direction=d,Ee.set(r))}function D(d){l.$$.not_equal(r.property,d)&&(r.property=d,Ee.set(r))}function $(d){l.$$.not_equal(o.scoreComparator,d)&&(o.scoreComparator=d,be.set(o))}function f(){b=dt(this.value),n(0,b),n(2,o)}function g(d){l.$$.not_equal(o.rating,d)&&(o.rating=d,be.set(o))}return l.$$.update=()=>{if(l.$$.dirty&5){b===void 0&&n(0,b=o.scoreValue);let d=Number(b);isNaN(d)||It(be,o.scoreValue=d,o)}l.$$.dirty&4&&n(5,t=hn(o.rating,o.scoreValue,o.scoreComparator)),l.$$.dirty&2&&n(4,s=gn[r.property][r.direction])},[b,r,o,i,s,t,u,c,p,m,C,D,$,f,g]}class vn extends ee{constructor(e){super(),te(this,e,$n,pn,x,{})}}function bn(l){const e=l.slice(),n=$t(e[1].file_url,e[1].sample_url,e[1].preview_url);return e[7]=n,e}function kn(l){let e,n;return e=new Lt({props:{post:l[1]}}),e.$on("click",l[4]),{c(){F(e.$$.fragment)},l(t){L(e.$$.fragment,t)},m(t,s){A(e,t,s),n=!0},p(t,s){const r={};s&2&&(r.post=t[1]),e.$set(r)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){E(e.$$.fragment,t),n=!1},d(t){B(e,t)}}}function wn(l){let e,n;return e=new At({props:{src:l[7].animated,poster:l[7].static,width:l[1].width,height:l[1].height,loop:l[2]||Ye(l[1].tags)}}),e.$on("click",l[4]),{c(){F(e.$$.fragment)},l(t){L(e.$$.fragment,t)},m(t,s){A(e,t,s),n=!0},p(t,s){const r={};s&2&&(r.src=t[7].animated),s&2&&(r.poster=t[7].static),s&2&&(r.width=t[1].width),s&2&&(r.height=t[1].height),s&6&&(r.loop=t[2]||Ye(t[1].tags)),e.$set(r)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){E(e.$$.fragment,t),n=!1},d(t){B(e,t)}}}function yn(l){let e,n;return e=new Bt({props:{post:l[1],open:l[0]}}),e.$on("click",l[4]),{c(){F(e.$$.fragment)},l(t){L(e.$$.fragment,t)},m(t,s){A(e,t,s),n=!0},p(t,s){const r={};s&2&&(r.post=t[1]),s&1&&(r.open=t[0]),e.$set(r)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){E(e.$$.fragment,t),n=!1},d(t){B(e,t)}}}function En(l){let e;return{c(){e=S("i"),this.h()},l(n){e=I(n,"I",{class:!0}),V(e).forEach(h),this.h()},h(){_(e,"class","codicon codicon-screen-full")},m(n,t){O(n,e,t)},p:Y,d(n){n&&h(e)}}}function et(l){let e,n;return e=new ht({props:{post:l[1]}}),{c(){F(e.$$.fragment)},l(t){L(e.$$.fragment,t)},m(t,s){A(e,t,s),n=!0},p(t,s){const r={};s&2&&(r.post=t[1]),e.$set(r)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){E(e.$$.fragment,t),n=!1},d(t){B(e,t)}}}function Sn(l){let e,n,t,s,r,o,a,i,u,c;const p=[yn,wn,kn],m=[];function b($,f){return $[1].type==="image"?0:$[1].type==="video"?1:2}function C($,f){return f===1?bn($):$}n=b(l),t=m[n]=p[n](C(l,n)),r=new vt({props:{class:"button-fullscreen","aria-label":"Enter Fullscreen mode",$$slots:{default:[En]},$$scope:{ctx:l}}}),r.$on("click",l[5]);let D=l[0]&&et(l);return{c(){e=S("div"),t.c(),s=P(),F(r.$$.fragment),o=P(),D&&D.c(),this.h()},l($){e=I($,"DIV",{id:!0,class:!0});var f=V(e);t.l(f),s=N(f),L(r.$$.fragment,f),o=N(f),D&&D.l(f),f.forEach(h),this.h()},h(){_(e,"id",a="post_"+l[1].id),_(e,"class","post svelte-pwgq1f"),je(e,"open",l[0])},m($,f){O($,e,f),m[n].m(e,null),v(e,s),A(r,e,null),v(e,o),D&&D.m(e,null),i=!0,u||(c=ce(e,"keydown",l[6]),u=!0)},p($,[f]){let g=n;n=b($),n===g?m[n].p(C($,n),f):(se(),E(m[g],1,1,()=>{m[g]=null}),le(),t=m[n],t?t.p(C($,n),f):(t=m[n]=p[n](C($,n)),t.c()),w(t,1),t.m(e,s));const d={};f&256&&(d.$$scope={dirty:f,ctx:$}),r.$set(d),$[0]?D?(D.p($,f),f&1&&w(D,1)):(D=et($),D.c(),w(D,1),D.m(e,null)):D&&(se(),E(D,1,1,()=>{D=null}),le()),(!i||f&2&&a!==(a="post_"+$[1].id))&&_(e,"id",a),(!i||f&1)&&je(e,"open",$[0])},i($){i||(w(t),w(r.$$.fragment,$),w(D),i=!0)},o($){E(t),E(r.$$.fragment,$),E(D),i=!1},d($){$&&h(e),m[n].d(),B(r),D&&D.d(),u=!1,c()}}}function In(l,e,n){let t;re(l,Ut,c=>n(2,t=c));const s=_e(),r=()=>n(0,a=!a);let{post:o}=e,{open:a=!1}=e;const i=()=>s("fullscreen"),u=c=>{c.key==="f"&&s("fullscreen")};return l.$$set=c=>{"post"in c&&n(1,o=c.post),"open"in c&&n(0,a=c.open)},[a,o,t,s,r,i,u]}class Cn extends ee{constructor(e){super(),te(this,e,In,Sn,x,{post:1,open:0})}}function tt(l){let e,n=l[0].type==="video"?"▶":"GIF",t;return{c(){e=S("span"),t=oe(n),this.h()},l(s){e=I(s,"SPAN",{class:!0});var r=V(e);t=ie(r,n),r.forEach(h),this.h()},h(){_(e,"class","type svelte-14imjnt")},m(s,r){O(s,e,r),v(e,t)},p(s,r){r&1&&n!==(n=s[0].type==="video"?"▶":"GIF")&&Te(t,n)},d(s){s&&h(e)}}}function Dn(l){let e,n,t,s,r,o=Fe(l[0].score)+"",a,i,u,c,p,m=l[0].type!=="image"&&tt(l);return{c(){e=S("div"),n=S("img"),s=P(),r=S("span"),a=oe(o),i=P(),m&&m.c(),this.h()},l(b){e=I(b,"DIV",{id:!0,class:!0,style:!0});var C=V(e);n=I(C,"IMG",{src:!0,alt:!0,class:!0,tabindex:!0,loading:!0}),s=N(C),r=I(C,"SPAN",{class:!0});var D=V(r);a=ie(D,o),D.forEach(h),i=N(C),m&&m.l(C),C.forEach(h),this.h()},h(){ue(n.src,t=l[1])||_(n,"src",t),_(n,"alt","post"),_(n,"class","post-media svelte-14imjnt"),_(n,"tabindex","-1"),_(n,"loading","lazy"),_(r,"class","score svelte-14imjnt"),_(e,"id",u="post_"+l[0].id),_(e,"class","post svelte-14imjnt"),ke(e,"grid-row","span "+l[2]),je(e,"open",open)},m(b,C){O(b,e,C),v(e,n),v(e,s),v(e,r),v(r,a),v(e,i),m&&m.m(e,null),c||(p=[ce(e,"click",l[3]),ce(e,"keydown",l[4])],c=!0)},p(b,[C]){C&2&&!ue(n.src,t=b[1])&&_(n,"src",t),C&1&&o!==(o=Fe(b[0].score)+"")&&Te(a,o),b[0].type!=="image"?m?m.p(b,C):(m=tt(b),m.c(),m.m(e,null)):m&&(m.d(1),m=null),C&1&&u!==(u="post_"+b[0].id)&&_(e,"id",u),C&0&&je(e,"open",open)},i:Y,o:Y,d(b){b&&h(e),m&&m.d(),c=!1,Ge(p)}}}function Pn(l,e,n){let t,{post:s}=e,r=Math.min(Math.round(s.height/s.width*5),15);const o=u=>u.endsWith(".jpg")||u.endsWith(".jpeg")||u.endsWith(".png")||u.endsWith(".webp");function a(u){Me.call(this,l,u)}const i=u=>{var c;(gt(u)||u.key==="f")&&((c=u.target)==null||c.click())};return l.$$set=u=>{"post"in u&&n(0,s=u.post)},l.$$.update=()=>{l.$$.dirty&1&&n(1,t=o(s.sample_url)?s.sample_url:s.preview_url)},[s,t,r,a,i]}class Nn extends ee{constructor(e){super(),te(this,e,Pn,Dn,x,{post:0})}}function Vn(l){let e,n,t,s;const r=l[3].default,o=Ct(r,l,l[2],null);return{c(){e=S("div"),o&&o.c(),this.h()},l(a){e=I(a,"DIV",{role:!0,tabindex:!0,class:!0});var i=V(e);o&&o.l(i),i.forEach(h),this.h()},h(){_(e,"role","none"),_(e,"tabindex","-1"),_(e,"class","dialog fullscreen svelte-1j44awz")},m(a,i){O(a,e,i),o&&o.m(e,null),l[5](e),n=!0,t||(s=[ce(e,"keydown",l[4]),ce(e,"click",Dt(On))],t=!0)},p(a,[i]){o&&o.p&&(!n||i&4)&&Pt(o,r,a,a[2],n?Vt(r,a[2],i,null):Nt(a[2]),null)},i(a){n||(w(o,a),n=!0)},o(a){E(o,a),n=!1},d(a){a&&h(e),o&&o.d(a),l[5](null),t=!1,Ge(s)}}}const On=()=>{};function Tn(l,e,n){let{$$slots:t={},$$scope:s}=e;const r=_e(),o=()=>r("close"),a=m=>{m.key==="Escape"&&o()};let i=()=>{document.fullscreenElement||o()},u;Le(async()=>{u.focus(),document.addEventListener("keydown",a),document.addEventListener("fullscreenchange",i)}),Ae(async()=>{document.removeEventListener("keydown",a),document.removeEventListener("fullscreenchange",i)});const c=m=>{m.code==="Escape"&&o()};function p(m){pe[m?"unshift":"push"](()=>{u=m,n(0,u)})}return l.$$set=m=>{"$$scope"in m&&n(2,s=m.$$scope)},[u,o,s,t,c,p]}class Mn extends ee{constructor(e){super(),te(this,e,Tn,Vn,x,{})}}function Rn(l){let e;return{c(){e=S("div")},l(n){e=I(n,"DIV",{}),V(e).forEach(h)},m(n,t){O(n,e,t),l[2](e)},p:Y,i:Y,o:Y,d(n){n&&h(e),l[2](null)}}}function Fn(l,e,n){let{rootMargin:t}=e;const s=_e(),r=new IntersectionObserver(i=>{i[0].isIntersecting&&s("intersection")},{rootMargin:t});let o;function a(i){pe[i?"unshift":"push"](()=>{o=i,n(0,o)})}return l.$$set=i=>{"rootMargin"in i&&n(1,t=i.rootMargin)},l.$$.update=()=>{l.$$.dirty&1&&(r.disconnect(),o&&r.observe(o))},[o,t,a]}class kt extends ee{constructor(e){super(),te(this,e,Fn,Rn,x,{rootMargin:1})}}function Ln(l){const e=l.slice(),n=jt(e[0].file_url,e[0].sample_url,e[0].preview_url);return e[4]=n,e}function An(l){const e=l.slice(),n=$t(e[0].file_url,e[0].sample_url,e[0].preview_url);return e[4]=n,e}function nt(l){let e,n,t,s;return{c(){e=S("img"),this.h()},l(r){e=I(r,"IMG",{src:!0,alt:!0,title:!0,class:!0}),this.h()},h(){ue(e.src,n=l[4].animated)||_(e,"src",n),_(e,"alt",t="[GIF] post #"+l[0].id),_(e,"title",s="[GIF] post #"+l[0].id),_(e,"class","svelte-1z0vyw4")},m(r,o){O(r,e,o)},p(r,o){o&1&&!ue(e.src,n=r[4].animated)&&_(e,"src",n),o&1&&t!==(t="[GIF] post #"+r[0].id)&&_(e,"alt",t),o&1&&s!==(s="[GIF] post #"+r[0].id)&&_(e,"title",s)},d(r){r&&h(e)}}}function st(l){let e,n,t,s;return{c(){e=S("video"),this.h()},l(r){e=I(r,"VIDEO",{src:!0,poster:!0,title:!0,preload:!0,class:!0}),V(e).forEach(h),this.h()},h(){ue(e.src,n=l[4].animated)||_(e,"src",n),_(e,"poster",t=l[4].static),e.loop=!0,_(e,"title",s="[VIDEO] post #"+l[0].id),e.controls=!0,_(e,"preload","metadata"),e.autoplay=!0,_(e,"class","svelte-1z0vyw4")},m(r,o){O(r,e,o),l[2](e)},p(r,o){o&1&&!ue(e.src,n=r[4].animated)&&_(e,"src",n),o&1&&t!==(t=r[4].static)&&_(e,"poster",t),o&1&&s!==(s="[VIDEO] post #"+r[0].id)&&_(e,"title",s)},d(r){r&&h(e),l[2](null)}}}function Bn(l){let e,n,t,s;return{c(){e=S("img"),this.h()},l(r){e=I(r,"IMG",{src:!0,alt:!0,title:!0,class:!0}),this.h()},h(){ue(e.src,n=l[0].sample_url)||_(e,"src",n),_(e,"alt",t="[IMAGE] post #"+l[0].id),_(e,"title",s="[IMAGE] post #"+l[0].id),_(e,"class","svelte-1z0vyw4")},m(r,o){O(r,e,o)},p(r,o){o&1&&!ue(e.src,n=r[0].sample_url)&&_(e,"src",n),o&1&&t!==(t="[IMAGE] post #"+r[0].id)&&_(e,"alt",t),o&1&&s!==(s="[IMAGE] post #"+r[0].id)&&_(e,"title",s)},d(r){r&&h(e)}}}function jn(l){let e;function n(o,a){return o[0].type==="image"?Bn:o[0].type==="video"?st:nt}function t(o,a){return a===st?An(o):a===nt?Ln(o):o}let s=n(l),r=s(t(l,s));return{c(){r.c(),e=de()},l(o){r.l(o),e=de()},m(o,a){r.m(o,a),O(o,e,a)},p(o,[a]){s===(s=n(o))&&r?r.p(t(o,s),a):(r.d(1),r=s(t(o,s)),r&&(r.c(),r.m(e.parentNode,e)))},i:Y,o:Y,d(o){o&&h(e),r.d(o)}}}function Gn(l,e,n){let{post:t}=e,s;const r=a=>{t.type==="video"&&s&&(a.key==="ArrowLeft"&&(a.preventDefault(),a.stopPropagation(),n(1,s.currentTime=Math.max(0,s.currentTime-5),s)),a.key==="ArrowRight"&&(a.preventDefault(),a.stopPropagation(),n(1,s.currentTime=Math.min(s.duration,s.currentTime+5),s)))};Le(()=>document.addEventListener("keydown",r)),Ae(()=>document.removeEventListener("keydown",r));function o(a){pe[a?"unshift":"push"](()=>{s=a,n(1,s)})}return l.$$set=a=>{"post"in a&&n(0,t=a.post)},[t,s,o]}class zn extends ee{constructor(e){super(),te(this,e,Gn,jn,x,{post:0})}}function qn(l){let e,n,t,s,r;return{c(){e=S("div"),n=S("img"),this.h()},l(o){e=I(o,"DIV",{id:!0,class:!0});var a=V(e);n=I(a,"IMG",{src:!0,alt:!0,class:!0}),a.forEach(h),this.h()},h(){ue(n.src,t=l[1])||_(n,"src",t),_(n,"alt",s="post #"+l[0].id),_(n,"class","svelte-1lfcts5"),_(e,"id",r=l[0].id.toString()),_(e,"class","svelte-1lfcts5")},m(o,a){O(o,e,a),v(e,n)},p(o,[a]){a&2&&!ue(n.src,t=o[1])&&_(n,"src",t),a&1&&s!==(s="post #"+o[0].id)&&_(n,"alt",s),a&1&&r!==(r=o[0].id.toString())&&_(e,"id",r)},i:Y,o:Y,d(o){o&&h(e)}}}function Un(l,e,n){let t,{post:s}=e;return l.$$set=r=>{"post"in r&&n(0,s=r.post)},l.$$.update=()=>{l.$$.dirty&1&&n(1,t=Gt(s.sample_url)?s.preview_url:s.sample_url)},[s,t]}class wt extends ee{constructor(e){super(),te(this,e,Un,qn,x,{post:0})}}function lt(l){let e,n;return e=new wt({props:{post:l[5]}}),{c(){F(e.$$.fragment)},l(t){L(e.$$.fragment,t)},m(t,s){A(e,t,s),n=!0},p(t,s){const r={};s&32&&(r.post=t[5]),e.$set(r)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){E(e.$$.fragment,t),n=!1},d(t){B(e,t)}}}function rt(l){let e,n;return e=new wt({props:{post:l[4]}}),{c(){F(e.$$.fragment)},l(t){L(e.$$.fragment,t)},m(t,s){A(e,t,s),n=!0},p(t,s){const r={};s&16&&(r.post=t[4]),e.$set(r)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){E(e.$$.fragment,t),n=!1},d(t){B(e,t)}}}function Hn(l){let e,n,t,s,r,o,a,i,u,c,p,m,b,C,D,$,f,g,d,k=l[5]&&lt(l);a=new zn({props:{post:l[6]}}),c=new ht({props:{post:l[6]}});let T=l[4]&&rt(l);return $=new kt({props:{rootMargin:window.innerHeight*2+"px"}}),$.$on("intersection",l[10]),{c(){e=S("div"),n=S("div"),t=P(),k&&k.c(),s=P(),r=S("div"),o=S("div"),F(a.$$.fragment),i=P(),u=S("div"),F(c.$$.fragment),m=P(),T&&T.c(),b=P(),C=S("div"),D=P(),F($.$$.fragment),this.h()},l(j){e=I(j,"DIV",{class:!0});var M=V(e);n=I(M,"DIV",{style:!0,class:!0}),V(n).forEach(h),t=N(M),k&&k.l(M),s=N(M),r=I(M,"DIV",{class:!0,id:!0});var K=V(r);o=I(K,"DIV",{class:!0});var J=V(o);L(a.$$.fragment,J),J.forEach(h),i=N(K),u=I(K,"DIV",{class:!0});var y=V(u);L(c.$$.fragment,y),y.forEach(h),K.forEach(h),m=N(M),T&&T.l(M),b=N(M),C=I(M,"DIV",{style:!0,class:!0}),V(C).forEach(h),D=N(M),L($.$$.fragment,M),M.forEach(h),this.h()},h(){ke(n,"height",Math.max(0,l[0]-1)*100+"vh"),_(n,"class","svelte-1lf13n6"),_(o,"class","screen snap-item svelte-1lf13n6"),_(u,"class","screen snap-item svelte-1lf13n6"),_(r,"class","screen snap-item snap-container horizontal svelte-1lf13n6"),_(r,"id",p=l[6].id.toString()),ke(C,"height",(l[1].posts.length-l[0]-1)*100+"vh"),_(C,"class","svelte-1lf13n6"),_(e,"class","root screen snap-container svelte-1lf13n6")},m(j,M){O(j,e,M),v(e,n),v(e,t),k&&k.m(e,null),v(e,s),v(e,r),v(r,o),A(a,o,null),v(r,i),v(r,u),A(c,u,null),l[9](r),v(e,m),T&&T.m(e,null),v(e,b),v(e,C),v(e,D),A($,e,null),l[11](e),f=!0,g||(d=ce(e,"scroll",l[8]),g=!0)},p(j,[M]){(!f||M&1)&&ke(n,"height",Math.max(0,j[0]-1)*100+"vh"),j[5]?k?(k.p(j,M),M&32&&w(k,1)):(k=lt(j),k.c(),w(k,1),k.m(e,s)):k&&(se(),E(k,1,1,()=>{k=null}),le());const K={};M&64&&(K.post=j[6]),a.$set(K);const J={};M&64&&(J.post=j[6]),c.$set(J),(!f||M&64&&p!==(p=j[6].id.toString()))&&_(r,"id",p),j[4]?T?(T.p(j,M),M&16&&w(T,1)):(T=rt(j),T.c(),w(T,1),T.m(e,b)):T&&(se(),E(T,1,1,()=>{T=null}),le()),(!f||M&3)&&ke(C,"height",(j[1].posts.length-j[0]-1)*100+"vh")},i(j){f||(w(k),w(a.$$.fragment,j),w(c.$$.fragment,j),w(T),w($.$$.fragment,j),f=!0)},o(j){E(k),E(a.$$.fragment,j),E(c.$$.fragment,j),E(T),E($.$$.fragment,j),f=!1},d(j){j&&h(e),k&&k.d(),B(a),B(c),l[9](null),T&&T.d(),B($),l[11](null),g=!1,d()}}}function Kn(l,e,n){let t,s,r,o;re(l,Se,f=>n(1,o=f));let{index:a}=e,i,u;const c=_e(),p=()=>{u&&(u.scrollIntoView(),n(3,u.scrollLeft=0,u))},m=f=>{let g=f.target,d=g.getBoundingClientRect().height,k=g.scrollTop/d,T=Math.round(k);Math.abs(k-T)<.001&&T!=a&&(console.log("INDEX: "+T),n(0,a=T),p())},b=f=>{f.key==="d"&&(f.preventDefault(),f.stopPropagation(),u.scrollLeft==0?(console.log("details"),u.scrollBy({left:i.clientWidth,top:0,behavior:"smooth"})):(console.log("back"),u.scrollBy({left:-i.clientWidth,top:0,behavior:"smooth"}))),f.key==="ArrowUp"&&(f.preventDefault(),f.stopPropagation(),i.scrollBy({left:0,top:-i.clientHeight,behavior:"smooth"})),f.key==="ArrowDown"&&(f.preventDefault(),f.stopPropagation(),i.scrollBy({left:0,top:i.clientHeight,behavior:"smooth"}))};Le(()=>{document.addEventListener("keydown",b),u.scrollIntoView()}),Ae(()=>document.removeEventListener("keydown",b));function C(f){pe[f?"unshift":"push"](()=>{u=f,n(3,u)})}const D=()=>c("endreached");function $(f){pe[f?"unshift":"push"](()=>{i=f,n(2,i)})}return l.$$set=f=>{"index"in f&&n(0,a=f.index)},l.$$.update=()=>{l.$$.dirty&3&&n(6,t=o.posts[a]),l.$$.dirty&3&&n(5,s=a>0?o.posts[a-1]:void 0),l.$$.dirty&3&&n(4,r=a<o.posts.length-1?o.posts[a+1]:void 0)},[a,o,i,u,r,s,t,c,m,C,D,$]}class Wn extends ee{constructor(e){super(),te(this,e,Kn,Hn,x,{index:0})}}function Yn(l){let e;return{c(){e=S("i"),this.h()},l(n){e=I(n,"I",{class:!0}),V(e).forEach(h),this.h()},h(){_(e,"class","codicon codicon-close")},m(n,t){O(n,e,t)},p:Y,d(n){n&&h(e)}}}function Zn(l){let e,n,t,s,r;function o(i){l[2](i)}let a={};return l[0]!==void 0&&(a.index=l[0]),e=new Wn({props:a}),pe.push(()=>Oe(e,"index",o)),e.$on("endreached",l[3]),s=new vt({props:{class:"button-close",$$slots:{default:[Yn]},$$scope:{ctx:l}}}),s.$on("click",l[4]),{c(){F(e.$$.fragment),t=P(),F(s.$$.fragment)},l(i){L(e.$$.fragment,i),t=N(i),L(s.$$.fragment,i)},m(i,u){A(e,i,u),O(i,t,u),A(s,i,u),r=!0},p(i,u){const c={};!n&&u&1&&(n=!0,c.index=i[0],Ve(()=>n=!1)),e.$set(c);const p={};u&128&&(p.$$scope={dirty:u,ctx:i}),s.$set(p)},i(i){r||(w(e.$$.fragment,i),w(s.$$.fragment,i),r=!0)},o(i){E(e.$$.fragment,i),E(s.$$.fragment,i),r=!1},d(i){i&&h(t),B(e,i),B(s,i)}}}function Jn(l){let e,n;return e=new Mn({props:{$$slots:{default:[Zn]},$$scope:{ctx:l}}}),e.$on("close",l[5]),{c(){F(e.$$.fragment)},l(t){L(e.$$.fragment,t)},m(t,s){A(e,t,s),n=!0},p(t,[s]){const r={};s&129&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){E(e.$$.fragment,t),n=!1},d(t){B(e,t)}}}function Qn(l,e,n){let{index:t}=e;const s=_e(),r=c=>{c.key==="f"&&(c.preventDefault(),c.stopPropagation(),s("close"))};Le(()=>document.addEventListener("keydown",r)),Ae(()=>document.removeEventListener("keydown",r));function o(c){t=c,n(0,t)}function a(c){Me.call(this,l,c)}const i=()=>s("close");function u(c){Me.call(this,l,c)}return l.$$set=c=>{"index"in c&&n(0,t=c.index)},[t,s,o,a,i,u]}class Xn extends ee{constructor(e){super(),te(this,e,Qn,Jn,x,{index:0})}}function ot(l,e,n){const t=l.slice();return t[8]=e[n],t[10]=n,t}function it(l,e,n){const t=l.slice();return t[8]=e[n],t[10]=n,t}function xn(l){let e,n,t=Ie(l[1].posts),s=[];for(let o=0;o<t.length;o+=1)s[o]=at(ot(l,t,o));const r=o=>E(s[o],1,1,()=>{s[o]=null});return{c(){e=S("section");for(let o=0;o<s.length;o+=1)s[o].c();this.h()},l(o){e=I(o,"SECTION",{class:!0,style:!0});var a=V(e);for(let i=0;i<s.length;i+=1)s[i].l(a);a.forEach(h),this.h()},h(){_(e,"class","multi-column svelte-pioq3k"),ke(e,"grid-template-columns","repeat("+l[2]+", 1fr)")},m(o,a){O(o,e,a);for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(e,null);n=!0},p(o,a){if(a&3){t=Ie(o[1].posts);let i;for(i=0;i<t.length;i+=1){const u=ot(o,t,i);s[i]?(s[i].p(u,a),w(s[i],1)):(s[i]=at(u),s[i].c(),w(s[i],1),s[i].m(e,null))}for(se(),i=t.length;i<s.length;i+=1)r(i);le()}(!n||a&4)&&ke(e,"grid-template-columns","repeat("+o[2]+", 1fr)")},i(o){if(!n){for(let a=0;a<t.length;a+=1)w(s[a]);n=!0}},o(o){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)E(s[a]);n=!1},d(o){o&&h(e),qe(s,o)}}}function es(l){let e,n,t=Ie(l[1].posts),s=[];for(let o=0;o<t.length;o+=1)s[o]=ct(it(l,t,o));const r=o=>E(s[o],1,1,()=>{s[o]=null});return{c(){e=S("section");for(let o=0;o<s.length;o+=1)s[o].c();this.h()},l(o){e=I(o,"SECTION",{class:!0});var a=V(e);for(let i=0;i<s.length;i+=1)s[i].l(a);a.forEach(h),this.h()},h(){_(e,"class","single-column svelte-pioq3k")},m(o,a){O(o,e,a);for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(e,null);n=!0},p(o,a){if(a&3){t=Ie(o[1].posts);let i;for(i=0;i<t.length;i+=1){const u=it(o,t,i);s[i]?(s[i].p(u,a),w(s[i],1)):(s[i]=ct(u),s[i].c(),w(s[i],1),s[i].m(e,null))}for(se(),i=t.length;i<s.length;i+=1)r(i);le()}},i(o){if(!n){for(let a=0;a<t.length;a+=1)w(s[a]);n=!0}},o(o){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)E(s[a]);n=!1},d(o){o&&h(e),qe(s,o)}}}function at(l){let e,n;function t(){return l[5](l[10])}return e=new Nn({props:{post:l[8]}}),e.$on("click",t),{c(){F(e.$$.fragment)},l(s){L(e.$$.fragment,s)},m(s,r){A(e,s,r),n=!0},p(s,r){l=s;const o={};r&2&&(o.post=l[8]),e.$set(o)},i(s){n||(w(e.$$.fragment,s),n=!0)},o(s){E(e.$$.fragment,s),n=!1},d(s){B(e,s)}}}function ct(l){let e,n;function t(){return l[4](l[10])}return e=new Cn({props:{post:l[8]}}),e.$on("fullscreen",t),{c(){F(e.$$.fragment)},l(s){L(e.$$.fragment,s)},m(s,r){A(e,s,r),n=!0},p(s,r){l=s;const o={};r&2&&(o.post=l[8]),e.$set(o)},i(s){n||(w(e.$$.fragment,s),n=!0)},o(s){E(e.$$.fragment,s),n=!1},d(s){B(e,s)}}}function ut(l){let e,n;return e=new Xn({props:{index:l[0]}}),e.$on("close",l[6]),e.$on("endreached",l[7]),{c(){F(e.$$.fragment)},l(t){L(e.$$.fragment,t)},m(t,s){A(e,t,s),n=!0},p(t,s){const r={};s&1&&(r.index=t[0]),e.$set(r)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){E(e.$$.fragment,t),n=!1},d(t){B(e,t)}}}function ts(l){let e,n,t=Fe(l[1].postCount)+"",s,r,o,a,i,u,c,p,m,b;a=new vn({}),a.$on("sortfilterupdate",l[3]);const C=[es,xn],D=[];function $(g,d){return g[2]==="1"?0:1}u=$(l),c=D[u]=C[u](l);let f=l[0]!==void 0&&ut(l);return{c(){e=S("div"),n=S("span"),s=oe(t),r=oe(" posts"),o=P(),F(a.$$.fragment),i=P(),c.c(),p=P(),f&&f.c(),m=de(),this.h()},l(g){e=I(g,"DIV",{class:!0});var d=V(e);n=I(d,"SPAN",{});var k=V(n);s=ie(k,t),r=ie(k," posts"),k.forEach(h),o=N(d),L(a.$$.fragment,d),d.forEach(h),i=N(g),c.l(g),p=N(g),f&&f.l(g),m=de(),this.h()},h(){_(e,"class","svelte-pioq3k")},m(g,d){O(g,e,d),v(e,n),v(n,s),v(n,r),v(e,o),A(a,e,null),O(g,i,d),D[u].m(g,d),O(g,p,d),f&&f.m(g,d),O(g,m,d),b=!0},p(g,[d]){(!b||d&2)&&t!==(t=Fe(g[1].postCount)+"")&&Te(s,t);let k=u;u=$(g),u===k?D[u].p(g,d):(se(),E(D[k],1,1,()=>{D[k]=null}),le(),c=D[u],c?c.p(g,d):(c=D[u]=C[u](g),c.c()),w(c,1),c.m(p.parentNode,p)),g[0]!==void 0?f?(f.p(g,d),d&1&&w(f,1)):(f=ut(g),f.c(),w(f,1),f.m(m.parentNode,m)):f&&(se(),E(f,1,1,()=>{f=null}),le())},i(g){b||(w(a.$$.fragment,g),w(c),w(f),b=!0)},o(g){E(a.$$.fragment,g),E(c),E(f),b=!1},d(g){g&&(h(e),h(i),h(p),h(m)),B(a),D[u].d(g),f&&f.d(g)}}}function ns(l,e,n){let t,s;re(l,Se,p=>n(1,t=p)),re(l,Ot,p=>n(2,s=p));let r;function o(p){Me.call(this,l,p)}const a=p=>{console.log("Viewing index: "+p),n(0,r=p)},i=p=>{console.log("Viewing index: "+p),n(0,r=p)},u=()=>{n(0,r=void 0)};function c(p){Me.call(this,l,p)}return[r,t,s,o,a,i,u,c]}class ss extends ee{constructor(e){super(),te(this,e,ns,ts,x,{})}}function ls(l){let e;return{c(){e=oe("Reset Filter")},l(n){e=ie(n,"Reset Filter")},m(n,t){O(n,e,t)},d(n){n&&h(e)}}}function rs(l){let e,n,t,s,r="We couldn't find any posts matching your tags. Sorry...",o,a,i;return a=new Re({props:{title:"In case your filter caused all posts to vanish. Reset it.",$$slots:{default:[ls]},$$scope:{ctx:l}}}),a.$on("click",l[1]),{c(){e=S("img"),t=P(),s=S("p"),s.textContent=r,o=P(),F(a.$$.fragment),this.h()},l(u){e=I(u,"IMG",{src:!0,alt:!0,class:!0}),t=N(u),s=I(u,"P",{"data-svelte-h":!0}),fe(s)!=="svelte-1utxj3w"&&(s.textContent=r),o=N(u),L(a.$$.fragment,u),this.h()},h(){ue(e.src,n=mt+"/assets/shironeko-confused.png")||_(e,"src",n),_(e,"alt","Nothing here..."),_(e,"class","svelte-1bb5e7g")},m(u,c){O(u,e,c),O(u,t,c),O(u,s,c),O(u,o,c),A(a,u,c),i=!0},p(u,[c]){const p={};c&4&&(p.$$scope={dirty:c,ctx:u}),a.$set(p)},i(u){i||(w(a.$$.fragment,u),i=!0)},o(u){E(a.$$.fragment,u),i=!1},d(u){u&&(h(e),h(t),h(s),h(o)),B(a,u)}}}function os(l){const e=_e();return[e,()=>{Ee.reset(),be.reset(),e("sortfilterupdate")}]}class is extends ee{constructor(e){super(),te(this,e,os,rs,x,{})}}function as(l){let e;return{c(){e=oe("Search")},l(n){e=ie(n,"Search")},m(n,t){O(n,e,t)},d(n){n&&h(e)}}}function cs(l){let e,n,t,s,r,o;const a=[ps,fs],i=[];function u(c,p){return c[2].postCount===0?0:1}return n=u(l),t=i[n]=a[n](l),r=new Wt({}),{c(){e=S("section"),t.c(),s=P(),F(r.$$.fragment),this.h()},l(c){e=I(c,"SECTION",{class:!0});var p=V(e);t.l(p),p.forEach(h),s=N(c),L(r.$$.fragment,c),this.h()},h(){_(e,"class","svelte-rk0y4a")},m(c,p){O(c,e,p),i[n].m(e,null),O(c,s,p),A(r,c,p),o=!0},p(c,p){let m=n;n=u(c),n===m?i[n].p(c,p):(se(),E(i[m],1,1,()=>{i[m]=null}),le(),t=i[n],t?t.p(c,p):(t=i[n]=a[n](c),t.c()),w(t,1),t.m(e,null))},i(c){o||(w(t),w(r.$$.fragment,c),o=!0)},o(c){E(t),E(r.$$.fragment,c),o=!1},d(c){c&&(h(e),h(s)),i[n].d(),B(r,c)}}}function us(l){let e,n;return e=new rn({props:{error:l[0]}}),{c(){F(e.$$.fragment)},l(t){L(e.$$.fragment,t)},m(t,s){A(e,t,s),n=!0},p(t,s){const r={};s&1&&(r.error=t[0]),e.$set(r)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){E(e.$$.fragment,t),n=!1},d(t){B(e,t)}}}function fs(l){let e,n,t,s,r,o;e=new ss({}),e.$on("sortfilterupdate",l[7]),e.$on("endreached",l[8]);const a=[_s,ds],i=[];function u(c,p){return c[2].posts.length===c[2].postCount?0:1}return t=u(l),s=i[t]=a[t](l),{c(){F(e.$$.fragment),n=P(),s.c(),r=de()},l(c){L(e.$$.fragment,c),n=N(c),s.l(c),r=de()},m(c,p){A(e,c,p),O(c,n,p),i[t].m(c,p),O(c,r,p),o=!0},p(c,p){let m=t;t=u(c),t===m?i[t].p(c,p):(se(),E(i[m],1,1,()=>{i[m]=null}),le(),s=i[t],s?s.p(c,p):(s=i[t]=a[t](c),s.c()),w(s,1),s.m(r.parentNode,r))},i(c){o||(w(e.$$.fragment,c),w(s),o=!0)},o(c){E(e.$$.fragment,c),E(s),o=!1},d(c){c&&(h(n),h(r)),B(e,c),i[t].d(c)}}}function ps(l){let e,n;return e=new is({}),e.$on("sortfilterupdate",l[7]),{c(){F(e.$$.fragment)},l(t){L(e.$$.fragment,t)},m(t,s){A(e,t,s),n=!0},p:Y,i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){E(e.$$.fragment,t),n=!1},d(t){B(e,t)}}}function ds(l){let e,n;return e=new kt({props:{rootMargin:"1000px"}}),e.$on("intersection",l[8]),{c(){F(e.$$.fragment)},l(t){L(e.$$.fragment,t)},m(t,s){A(e,t,s),n=!0},p:Y,i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){E(e.$$.fragment,t),n=!1},d(t){B(e,t)}}}function _s(l){let e,n;return e=new an({}),{c(){F(e.$$.fragment)},l(t){L(e.$$.fragment,t)},m(t,s){A(e,t,s),n=!0},p:Y,i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){E(e.$$.fragment,t),n=!1},d(t){B(e,t)}}}function ft(l){let e,n;return e=new nn({props:{tags:l[4]}}),e.$on("close",l[13]),e.$on("submit",l[14]),{c(){F(e.$$.fragment)},l(t){L(e.$$.fragment,t)},m(t,s){A(e,t,s),n=!0},p(t,s){const r={};s&16&&(r.tags=t[4]),e.$set(r)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){E(e.$$.fragment,t),n=!1},d(t){B(e,t)}}}function ms(l){let e,n,t,s,r,o,a,i,u,c,p,m,b,C;n=new Mt({}),s=new Ht({props:{placeholder:"Search for tags",fetchSuggestions:l[6]}}),s.$on("pick",l[9]),o=new Re({props:{title:"Search with the tags above",$$slots:{default:[as]},$$scope:{ctx:l}}}),o.$on("click",l[7]),i=new Rt({props:{tags:[...l[4],...l[3]]}}),i.$on("click",l[10]),i.$on("contextmenu",l[11]),i.$on("createSupertag",l[12]);const D=[us,cs],$=[];function f(d,k){return d[0]?0:d[2].requested?1:-1}~(c=f(l))&&(p=$[c]=D[c](l));let g=l[1]&&ft(l);return{c(){e=S("section"),F(n.$$.fragment),t=P(),F(s.$$.fragment),r=P(),F(o.$$.fragment),a=P(),F(i.$$.fragment),u=P(),p&&p.c(),m=P(),g&&g.c(),b=de(),this.h()},l(d){e=I(d,"SECTION",{id:!0,class:!0});var k=V(e);L(n.$$.fragment,k),t=N(k),L(s.$$.fragment,k),r=N(k),L(o.$$.fragment,k),a=N(k),L(i.$$.fragment,k),k.forEach(h),u=N(d),p&&p.l(d),m=N(d),g&&g.l(d),b=de(),this.h()},h(){_(e,"id","search"),_(e,"class","svelte-rk0y4a")},m(d,k){O(d,e,k),A(n,e,null),v(e,t),A(s,e,null),v(e,r),A(o,e,null),v(e,a),A(i,e,null),O(d,u,k),~c&&$[c].m(d,k),O(d,m,k),g&&g.m(d,k),O(d,b,k),C=!0},p(d,[k]){const T={};k&8388608&&(T.$$scope={dirty:k,ctx:d}),o.$set(T);const j={};k&24&&(j.tags=[...d[4],...d[3]]),i.$set(j);let M=c;c=f(d),c===M?~c&&$[c].p(d,k):(p&&(se(),E($[M],1,1,()=>{$[M]=null}),le()),~c?(p=$[c],p?p.p(d,k):(p=$[c]=D[c](d),p.c()),w(p,1),p.m(m.parentNode,m)):p=null),d[1]?g?(g.p(d,k),k&2&&w(g,1)):(g=ft(d),g.c(),w(g,1),g.m(b.parentNode,b)):g&&(se(),E(g,1,1,()=>{g=null}),le())},i(d){C||(w(n.$$.fragment,d),w(s.$$.fragment,d),w(o.$$.fragment,d),w(i.$$.fragment,d),w(p),w(g),C=!0)},o(d){E(n.$$.fragment,d),E(s.$$.fragment,d),E(o.$$.fragment,d),E(i.$$.fragment,d),E(p),E(g),C=!1},d(d){d&&(h(e),h(u),h(m),h(b)),B(n),B(s),B(o),B(i),~c&&$[c].d(d),g&&g.d(d)}}}function gs(l,e,n){let t,s,r,o,a,i,u;re(l,Se,y=>n(2,t=y)),re(l,ze,y=>n(3,s=y)),re(l,be,y=>n(17,r=y)),re(l,Ee,y=>n(18,o=y)),re(l,Qt,y=>n(19,a=y)),re(l,Be,y=>n(4,i=y)),re(l,Je,y=>n(5,u=y));let c=!1,p,m=!1,b=0;const C=async y=>{const H=await Yt(y);return[...u.items.filter(({name:X})=>X.toLowerCase().includes(y.toLowerCase())).map(X=>({label:X.name,count:X.tags.length,type:"supertag"})),...H]},D=()=>new Ft().withPid(t.pageCount).withTags(i).withBlockedContent(a).withSortProperty(o.property).withSortDirection(o.direction).withScoreValue(r.scoreValue).withScoreComparator(r.scoreComparator).withRating(r.rating).withSupertags(s),$=async y=>{if(!c){n(0,p=void 0),c=!0;try{const H=t.pageCount;await y(),Jt(H).catch(()=>{})}catch(H){n(0,p=H),console.warn(H)}finally{c=!1}}},f=async()=>{Se.reset(),b=0,$(async()=>{const[y,H]=await D().getPageAndCount();Se.addPage(y,H)})},g=async()=>{$(async()=>{const y=await D().getPage();Se.addPage(y)})},d=y=>{var H,Q;if((y.key==="/"||y.key==="s")&&(!document.activeElement||document.activeElement===document.body)&&((H=document.getElementById("searchbar"))==null||H.focus(),y.preventDefault(),y.stopPropagation()),y.ctrlKey&&y.key==="Enter"&&(y.preventDefault(),y.stopPropagation(),f()),y.ctrlKey&&y.key==="m"&&((Q=document.getElementById("select-modifier"))==null||Q.click()),y.ctrlKey&&y.key==="ArrowDown"){const X=document.getElementsByClassName("post-media");X[b].focus(),b=Math.min(b+1,Math.max(0,X.length-1))}y.ctrlKey&&y.key==="ArrowUp"&&(document.getElementsByClassName("post-media")[b].focus(),b=Math.max(b-1,0))};return Le(async()=>{document.addEventListener("keydown",d)}),Ae(()=>{document.removeEventListener("keydown",d)}),[p,m,t,s,i,u,C,f,g,async y=>{const H=y.detail;if(H.type==="supertag"){const Q=u.items.find(X=>X.name===H.label);if(!Q){console.warn("Supertag not present.");return}ze.addOrReplace(Q)}else{const Q=await Zt(y.detail.label);Be.addOrReplace({name:y.detail.label,modifier:y.detail.modifier,count:y.detail.count,type:(Q==null?void 0:Q.type)??"tag"})}},y=>"description"in y.detail?ze.removeByName(y.detail.name):Be.removeByName(y.detail.name),y=>{"description"in y.detail||(y.detail.modifier=Kt(y.detail.modifier),Be.addOrReplace(y.detail))},()=>n(1,m=!0),()=>n(1,m=!1),y=>Je.add(y.detail)]}class As extends ee{constructor(e){super(),te(this,e,gs,ms,x,{})}}export{As as component};
