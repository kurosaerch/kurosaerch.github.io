import{s as oe,D as _e,f as C,a as P,g as I,h as O,y as ue,c as T,d as h,j as v,r as ct,i as N,u as k,E as we,F as re,G as Ue,H as Be,l as ee,m as te,v as U,I as fe,e as pe,n as Te,C as x,J as kt,p as be,K as Le,L as ut,M as Ee,k as ze,N as Ke,w as wt,O as yt,z as Et,A as St,B as Ct,o as Fe,P as Ae}from"../chunks/scheduler.0a29c992.js";import{S as ie,i as ae,b as L,d as V,m as j,a as y,t as E,e as M,g as se,c as ne,f as Ve}from"../chunks/index.6d8df040.js";import{e as Se}from"../chunks/each.e59479a4.js";import{D as ft,r as It}from"../chunks/result-columns-store.7454cbad.js";import{T as Oe}from"../chunks/TextButton.f6017ea8.js";import{D as Dt}from"../chunks/DetailedTag.6129a1d8.js";import{K as Nt,A as Pt}from"../chunks/ActiveTagList.8fd46b8a.js";import{b as pt}from"../chunks/paths.196365dd.js";import{s as ye,f as ve,r as Pe,a as qe,S as Tt}from"../chunks/active-supertags-store.9cb29271.js";import{i as _t,D as dt,g as Ot,G as mt,V as Rt,a as Ge,I as Lt}from"../chunks/Details.0777a3ba.js";import{f as Re}from"../chunks/format-tag.7e313273.js";import{R as Vt,I as Me}from"../chunks/ModifierSelect.51f2ca82.js";import{S as Je}from"../chunks/Select.0781c4e2.js";import{R as jt}from"../chunks/RotatingTextSelect.f25d5f18.js";import{a as gt}from"../chunks/always-loop-store.ec22e8f2.js";import{S as Mt,n as Bt,s as Qe}from"../chunks/supertags-store.1c37991b.js";import{S as Ft}from"../chunks/ScrollUpButton.be9a5994.js";import{g as At,a as qt}from"../chunks/tags.49324235.js";import{l as zt}from"../chunks/analytics.eca95ce1.js";import{a as je}from"../chunks/active-tags-store.a60398a6.js";import{b as Gt}from"../chunks/blocked-content-store.2a43e35e.js";function Xe(l,e,s){const t=l.slice();return t[9]=e[s],t}function xe(l){let e,s;return e=new Dt({props:{tag:l[9]}}),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,n){j(e,t,n),s=!0},p(t,n){const o={};n&4&&(o.tag=t[9]),e.$set(o)},i(t){s||(y(e.$$.fragment,t),s=!0)},o(t){E(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function Ut(l){let e;return{c(){e=ee("Create supertag")},l(s){e=te(s,"Create supertag")},m(s,t){N(s,e,t)},d(s){s&&h(e)}}}function Kt(l){let e,s,t="Create Supertag",n,o,r,a,i,p="Name",c,d,m,$,S,b="Description",_,g,u,f,D,H="Tags",Q,W,K,ce,w,z,Z,J,X=Se(l[2]),A=[];for(let B=0;B<X.length;B+=1)A[B]=xe(Xe(l,X,B));const Ce=B=>E(A[B],1,1,()=>{A[B]=null});return w=new Oe({props:{title:l[3]?"Click to create supertag":"Enter a valid name to continue",disabled:!l[3],$$slots:{default:[Ut]},$$scope:{ctx:l}}}),w.$on("click",l[8]),{c(){e=C("section"),s=C("h3"),s.textContent=t,n=P(),o=C("button"),r=P(),a=C("div"),i=C("label"),i.textContent=p,c=P(),d=C("input"),m=P(),$=C("div"),S=C("label"),S.textContent=b,_=P(),g=C("input"),u=P(),f=C("div"),D=C("span"),D.textContent=H,Q=P(),W=C("ol");for(let B=0;B<A.length;B+=1)A[B].c();K=P(),ce=C("div"),L(w.$$.fragment),this.h()},l(B){e=I(B,"SECTION",{class:!0});var R=O(e);s=I(R,"H3",{"data-svelte-h":!0}),ue(s)!=="svelte-ho1cwx"&&(s.textContent=t),n=T(R),o=I(R,"BUTTON",{class:!0}),O(o).forEach(h),r=T(R),a=I(R,"DIV",{class:!0});var Y=O(a);i=I(Y,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),ue(i)!=="svelte-10k8a68"&&(i.textContent=p),c=T(Y),d=I(Y,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),Y.forEach(h),m=T(R),$=I(R,"DIV",{class:!0});var q=O($);S=I(q,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),ue(S)!=="svelte-14n9kp6"&&(S.textContent=b),_=T(q),g=I(q,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),q.forEach(h),u=T(R),f=I(R,"DIV",{class:!0});var le=O(f);D=I(le,"SPAN",{class:!0,"data-svelte-h":!0}),ue(D)!=="svelte-7hjyox"&&(D.textContent=H),Q=T(le),W=I(le,"OL",{class:!0});var ke=O(W);for(let De=0;De<A.length;De+=1)A[De].l(ke);ke.forEach(h),le.forEach(h),K=T(R),ce=I(R,"DIV",{class:!0});var Ie=O(ce);V(w.$$.fragment,Ie),Ie.forEach(h),R.forEach(h),this.h()},h(){v(o,"class",ct("codicon codicon-close")+" svelte-xkjm86"),v(i,"for","supertag-name"),v(i,"class","svelte-xkjm86"),v(d,"type","text"),v(d,"placeholder","Descriptive name"),v(d,"id","supertag-name"),v(d,"class","svelte-xkjm86"),v(a,"class","svelte-xkjm86"),v(S,"for","supertag-description"),v(S,"class","svelte-xkjm86"),v(g,"type","text"),v(g,"placeholder","Short description"),v(g,"id","supertag-description"),v(g,"class","svelte-xkjm86"),v($,"class","svelte-xkjm86"),v(D,"class","svelte-xkjm86"),v(W,"class","svelte-xkjm86"),v(f,"class","svelte-xkjm86"),v(ce,"class","last svelte-xkjm86"),v(e,"class","svelte-xkjm86")},m(B,R){N(B,e,R),k(e,s),k(e,n),k(e,o),k(e,r),k(e,a),k(a,i),k(a,c),k(a,d),we(d,l[0]),k(e,m),k(e,$),k($,S),k($,_),k($,g),we(g,l[1]),k(e,u),k(e,f),k(f,D),k(f,Q),k(f,W);for(let Y=0;Y<A.length;Y+=1)A[Y]&&A[Y].m(W,null);k(e,K),k(e,ce),j(w,ce,null),z=!0,Z||(J=[re(o,"click",l[5]),re(d,"input",l[6]),re(g,"input",l[7])],Z=!0)},p(B,R){if(R&1&&d.value!==B[0]&&we(d,B[0]),R&2&&g.value!==B[1]&&we(g,B[1]),R&4){X=Se(B[2]);let q;for(q=0;q<X.length;q+=1){const le=Xe(B,X,q);A[q]?(A[q].p(le,R),y(A[q],1)):(A[q]=xe(le),A[q].c(),y(A[q],1),A[q].m(W,null))}for(se(),q=X.length;q<A.length;q+=1)Ce(q);ne()}const Y={};R&8&&(Y.title=B[3]?"Click to create supertag":"Enter a valid name to continue"),R&8&&(Y.disabled=!B[3]),R&4096&&(Y.$$scope={dirty:R,ctx:B}),w.$set(Y)},i(B){if(!z){for(let R=0;R<X.length;R+=1)y(A[R]);y(w.$$.fragment,B),z=!0}},o(B){A=A.filter(Boolean);for(let R=0;R<A.length;R+=1)E(A[R]);E(w.$$.fragment,B),z=!1},d(B){B&&h(e),Ue(A,B),M(w),Z=!1,Be(J)}}}function Ht(l){let e,s;return e=new ft({props:{$$slots:{default:[Kt]},$$scope:{ctx:l}}}),e.$on("close",l[5]),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,n){j(e,t,n),s=!0},p(t,[n]){const o={};n&4111&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){s||(y(e.$$.fragment,t),s=!0)},o(t){E(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function Wt(l,e,s){let t,{name:n=""}=e,{description:o=""}=e,{tags:r}=e;const a=_e(),i=()=>a("close");function p(){n=this.value,s(0,n)}function c(){o=this.value,s(1,o)}const d=()=>{a("submit",{name:n,description:o,tags:r.map(({modifier:m,name:$})=>({modifier:m,name:$}))}),i()};return l.$$set=m=>{"name"in m&&s(0,n=m.name),"description"in m&&s(1,o=m.description),"tags"in m&&s(2,r=m.tags)},l.$$.update=()=>{l.$$.dirty&5&&s(3,t=typeof n=="string"&&n!==""&&r.length>1)},[n,o,r,t,a,i,p,c,d]}class Yt extends ie{constructor(e){super(),ae(this,e,Wt,Ht,oe,{name:0,description:1,tags:2})}}function Zt(l){let e,s,t,n,o,r,a,i,p,c;return{c(){e=C("div"),s=C("div"),t=C("i"),n=P(),o=C("div"),r=C("h3"),a=ee(l[0]),i=P(),p=C("span"),c=ee(l[2]),this.h()},l(d){e=I(d,"DIV",{class:!0});var m=O(e);s=I(m,"DIV",{class:!0});var $=O(s);t=I($,"I",{class:!0}),O(t).forEach(h),$.forEach(h),n=T(m),o=I(m,"DIV",{});var S=O(o);r=I(S,"H3",{class:!0});var b=O(r);a=te(b,l[0]),b.forEach(h),i=T(S),p=I(S,"SPAN",{});var _=O(p);c=te(_,l[2]),_.forEach(h),S.forEach(h),m.forEach(h),this.h()},h(){v(t,"class",ct(l[1])+" svelte-1tvgln1"),v(s,"class","icon svelte-1tvgln1"),v(r,"class","svelte-1tvgln1"),v(e,"class","error svelte-1tvgln1")},m(d,m){N(d,e,m),k(e,s),k(s,t),k(e,n),k(e,o),k(o,r),k(r,a),k(o,i),k(o,p),k(p,c)},p:U,i:U,o:U,d(d){d&&h(e)}}}function Jt(l,e,s){let{error:t}=e,n=t.message==="Failed to fetch"?"Connection Error":"Application Error",o=t.message==="Failed to fetch"?"codicon codicon-debug-disconnect":"codicon codicon-error",r=t.message==="Failed to fetch"?"Failed to connect to the server. Make sure you have a stable internet connection.":t.message;return l.$$set=a=>{"error"in a&&s(3,t=a.error)},[n,o,r,t]}class Qt extends ie{constructor(e){super(),ae(this,e,Jt,Zt,oe,{error:3})}}function Xt(l){let e,s,t,n,o="You have seen everything there is to see...";return{c(){e=C("img"),t=P(),n=C("p"),n.textContent=o,this.h()},l(r){e=I(r,"IMG",{src:!0,alt:!0,class:!0}),t=T(r),n=I(r,"P",{"data-svelte-h":!0}),ue(n)!=="svelte-1i75mtf"&&(n.textContent=o),this.h()},h(){fe(e.src,s=pt+"/assets/shironeko-x.png")||v(e,"src",s),v(e,"alt","No more results to load"),v(e,"class","svelte-1pkma0d")},m(r,a){N(r,e,a),N(r,t,a),N(r,n,a)},p:U,i:U,o:U,d(r){r&&(h(e),h(t),h(n))}}}class xt extends ie{constructor(e){super(),ae(this,e,null,Xt,oe,{})}}function et(l){let e,s;return e=new ft({props:{$$slots:{default:[ss]},$$scope:{ctx:l}}}),e.$on("close",l[7]),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,n){j(e,t,n),s=!0},p(t,n){const o={};n&65543&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){s||(y(e.$$.fragment,t),s=!0)},o(t){E(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function es(l){let e;return{c(){e=ee("Done")},l(s){e=te(s,"Done")},m(s,t){N(s,e,t)},d(s){s&&h(e)}}}function ts(l){let e;return{c(){e=ee("Reset")},l(s){e=te(s,"Reset")},m(s,t){N(s,e,t)},d(s){s&&h(e)}}}function ss(l){let e,s,t="Sorting and Filtering",n,o,r,a="Sorting",i,p,c,d,m,$,S,b,_,g,u="Filtering by Score",f,D,H,Q,W,K,ce,w,z,Z="Filtering by Rating",J,X,A,Ce,B,R,Y,q,le,ke,Ie;function De(F){l[10](F)}let He={options:rs};l[1].direction!==void 0&&(He.value=l[1].direction),c=new Vt({props:He}),be.push(()=>Ve(c,"value",De));function $t(F){l[11](F)}let We={options:ls};l[1].property!==void 0&&(We.value=l[1].property),$=new Je({props:We}),be.push(()=>Ve($,"value",$t));function vt(F){l[12](F)}let Ye={options:os};l[2].scoreComparator!==void 0&&(Ye.value=l[2].scoreComparator),H=new jt({props:Ye}),be.push(()=>Ve(H,"value",vt));function bt(F){l[14](F)}let Ze={options:ht};return l[2].rating!==void 0&&(Ze.value=l[2].rating),A=new Je({props:Ze}),be.push(()=>Ve(A,"value",bt)),R=new Oe({props:{title:"Return to searching.",$$slots:{default:[es]},$$scope:{ctx:l}}}),R.$on("click",l[7]),q=new Oe({props:{title:"Reset sort and filter.",type:"secondary",$$slots:{default:[ts]},$$scope:{ctx:l}}}),q.$on("click",l[9]),{c(){e=C("div"),s=C("h3"),s.textContent=t,n=P(),o=C("div"),r=C("b"),r.textContent=a,i=P(),p=C("div"),L(c.$$.fragment),m=P(),L($.$$.fragment),b=P(),_=C("div"),g=C("b"),g.textContent=u,f=P(),D=C("div"),L(H.$$.fragment),W=P(),K=C("input"),ce=P(),w=C("div"),z=C("b"),z.textContent=Z,J=P(),X=C("div"),L(A.$$.fragment),B=P(),L(R.$$.fragment),Y=P(),L(q.$$.fragment),this.h()},l(F){e=I(F,"DIV",{class:!0});var G=O(e);s=I(G,"H3",{"data-svelte-h":!0}),ue(s)!=="svelte-15zouq3"&&(s.textContent=t),n=T(G),o=I(G,"DIV",{});var de=O(o);r=I(de,"B",{class:!0,"data-svelte-h":!0}),ue(r)!=="svelte-ekzpgg"&&(r.textContent=a),i=T(de),p=I(de,"DIV",{class:!0});var me=O(p);V(c.$$.fragment,me),m=T(me),V($.$$.fragment,me),me.forEach(h),de.forEach(h),b=T(G),_=I(G,"DIV",{});var ge=O(_);g=I(ge,"B",{class:!0,"data-svelte-h":!0}),ue(g)!=="svelte-1flca3"&&(g.textContent=u),f=T(ge),D=I(ge,"DIV",{class:!0});var he=O(D);V(H.$$.fragment,he),W=T(he),K=I(he,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),he.forEach(h),ge.forEach(h),ce=T(G),w=I(G,"DIV",{});var $e=O(w);z=I($e,"B",{class:!0,"data-svelte-h":!0}),ue(z)!=="svelte-1evbw58"&&(z.textContent=Z),J=T($e),X=I($e,"DIV",{class:!0});var Ne=O(X);V(A.$$.fragment,Ne),Ne.forEach(h),$e.forEach(h),B=T(G),V(R.$$.fragment,G),Y=T(G),V(q.$$.fragment,G),G.forEach(h),this.h()},h(){v(r,"class","svelte-gf4ubn"),v(p,"class","row svelte-gf4ubn"),v(g,"class","svelte-gf4ubn"),v(K,"type","number"),v(K,"min",0),v(K,"max",1e5),v(K,"step",1),v(K,"class","svelte-gf4ubn"),v(D,"class","row svelte-gf4ubn"),v(z,"class","svelte-gf4ubn"),v(X,"class","row svelte-gf4ubn"),v(e,"class","container svelte-gf4ubn")},m(F,G){N(F,e,G),k(e,s),k(e,n),k(e,o),k(o,r),k(o,i),k(o,p),j(c,p,null),k(p,m),j($,p,null),k(e,b),k(e,_),k(_,g),k(_,f),k(_,D),j(H,D,null),k(D,W),k(D,K),we(K,l[0]),k(e,ce),k(e,w),k(w,z),k(w,J),k(w,X),j(A,X,null),k(e,B),j(R,e,null),k(e,Y),j(q,e,null),le=!0,ke||(Ie=[re(K,"input",l[13]),re(K,"keyup",l[8])],ke=!0)},p(F,G){const de={};!d&&G&2&&(d=!0,de.value=F[1].direction,Le(()=>d=!1)),c.$set(de);const me={};!S&&G&2&&(S=!0,me.value=F[1].property,Le(()=>S=!1)),$.$set(me);const ge={};!Q&&G&4&&(Q=!0,ge.value=F[2].scoreComparator,Le(()=>Q=!1)),H.$set(ge),G&1&&ut(K.value)!==F[0]&&we(K,F[0]);const he={};!Ce&&G&4&&(Ce=!0,he.value=F[2].rating,Le(()=>Ce=!1)),A.$set(he);const $e={};G&65536&&($e.$$scope={dirty:G,ctx:F}),R.$set($e);const Ne={};G&65536&&(Ne.$$scope={dirty:G,ctx:F}),q.$set(Ne)},i(F){le||(y(c.$$.fragment,F),y($.$$.fragment,F),y(H.$$.fragment,F),y(A.$$.fragment,F),y(R.$$.fragment,F),y(q.$$.fragment,F),le=!0)},o(F){E(c.$$.fragment,F),E($.$$.fragment,F),E(H.$$.fragment,F),E(A.$$.fragment,F),E(R.$$.fragment,F),E(q.$$.fragment,F),le=!1},d(F){F&&h(e),M(c),M($),M(H),M(A),M(R),M(q),ke=!1,Be(Ie)}}}function ns(l){let e,s,t,n,o,r,a,i,p,c,d,m,$,S,b,_=l[3]&&et(l);return{c(){e=C("button"),s=C("i"),t=P(),n=C("span"),o=ee(l[5]),r=P(),a=C("i"),i=P(),p=C("span"),c=ee(l[4]),d=P(),_&&_.c(),m=pe(),this.h()},l(g){e=I(g,"BUTTON",{class:!0});var u=O(e);s=I(u,"I",{class:!0}),O(s).forEach(h),t=T(u),n=I(u,"SPAN",{});var f=O(n);o=te(f,l[5]),f.forEach(h),r=T(u),a=I(u,"I",{class:!0}),O(a).forEach(h),i=T(u),p=I(u,"SPAN",{});var D=O(p);c=te(D,l[4]),D.forEach(h),u.forEach(h),d=T(g),_&&_.l(g),m=pe(),this.h()},h(){v(s,"class","codicon codicon-filter svelte-gf4ubn"),v(a,"class","codicon codicon-arrow-swap svelte-gf4ubn"),v(e,"class","svelte-gf4ubn")},m(g,u){N(g,e,u),k(e,s),k(e,t),k(e,n),k(n,o),k(e,r),k(e,a),k(e,i),k(e,p),k(p,c),N(g,d,u),_&&_.m(g,u),N(g,m,u),$=!0,S||(b=re(e,"click",l[6]),S=!0)},p(g,[u]){(!$||u&32)&&Te(o,g[5]),(!$||u&16)&&Te(c,g[4]),g[3]?_?(_.p(g,u),u&8&&y(_,1)):(_=et(g),_.c(),y(_,1),_.m(m.parentNode,m)):_&&(se(),E(_,1,1,()=>{_=null}),ne())},i(g){$||(y(_),$=!0)},o(g){E(_),$=!1},d(g){g&&(h(e),h(d),h(m)),_&&_.d(g),S=!1,b()}}}const ls=Object.freeze({id:"Uploaded",score:"Score",updated:"Updated",random:"Random"}),rs=Object.freeze({desc:"codicon codicon-arrow-down",asc:"codicon codicon-arrow-up"}),os=Object.freeze({">=":"≥","<=":"≤"}),ht=Object.freeze({all:"All",safe:"Safe",questionable:"Questionable",explicit:"Explicit"}),is=Object.freeze({id:{asc:"Oldest",desc:"Newest"},score:{asc:"Worst",desc:"Best"},updated:{asc:"Inactive",desc:"Active"},random:{asc:"Random",desc:"Random"}}),as=(l,e,s)=>{let t=l==="all"?void 0:ht[l],n=e===0&&s===">="?void 0:`Score${s}${Re(e)}`;return[t,n].filter(o=>o!==void 0).join(",")||"All"};function cs(l,e,s){let t,n,o,r;x(l,ye,f=>s(1,o=f)),x(l,ve,f=>s(2,r=f));const a=_e();let i=!1;const p=()=>s(3,i=!0),c=()=>{s(3,i=!1),a("sortfilterupdate")},d=f=>{var D;return _t(f)&&((D=f.target)==null?void 0:D.blur())},m=()=>{ye.reset(),ve.reset(),s(0,$=r.scoreValue)};let $;function S(f){l.$$.not_equal(o.direction,f)&&(o.direction=f,ye.set(o))}function b(f){l.$$.not_equal(o.property,f)&&(o.property=f,ye.set(o))}function _(f){l.$$.not_equal(r.scoreComparator,f)&&(r.scoreComparator=f,ve.set(r))}function g(){$=ut(this.value),s(0,$),s(2,r)}function u(f){l.$$.not_equal(r.rating,f)&&(r.rating=f,ve.set(r))}return l.$$.update=()=>{if(l.$$.dirty&5){$===void 0&&s(0,$=r.scoreValue);let f=Number($);isNaN(f)||kt(ve,r.scoreValue=f,r)}l.$$.dirty&4&&s(5,t=as(r.rating,r.scoreValue,r.scoreComparator)),l.$$.dirty&2&&s(4,n=is[o.property][o.direction])},[$,o,r,i,n,t,p,c,d,m,S,b,_,g,u]}class us extends ie{constructor(e){super(),ae(this,e,cs,ns,oe,{})}}function fs(l){const e=l.slice(),s=Ot(e[1].file_url,e[1].sample_url,e[1].preview_url);return e[7]=s,e}function ps(l){let e,s;return e=new mt({props:{post:l[1]}}),e.$on("click",l[4]),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,n){j(e,t,n),s=!0},p(t,n){const o={};n&2&&(o.post=t[1]),e.$set(o)},i(t){s||(y(e.$$.fragment,t),s=!0)},o(t){E(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function _s(l){let e,s;return e=new Rt({props:{src:l[7].animated,poster:l[7].static,width:l[1].width,height:l[1].height,loop:l[2]||Ge(l[1].tags)}}),e.$on("click",l[4]),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,n){j(e,t,n),s=!0},p(t,n){const o={};n&2&&(o.src=t[7].animated),n&2&&(o.poster=t[7].static),n&2&&(o.width=t[1].width),n&2&&(o.height=t[1].height),n&6&&(o.loop=t[2]||Ge(t[1].tags)),e.$set(o)},i(t){s||(y(e.$$.fragment,t),s=!0)},o(t){E(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function ds(l){let e,s;return e=new Lt({props:{post:l[1],open:l[0]}}),e.$on("click",l[4]),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,n){j(e,t,n),s=!0},p(t,n){const o={};n&2&&(o.post=t[1]),n&1&&(o.open=t[0]),e.$set(o)},i(t){s||(y(e.$$.fragment,t),s=!0)},o(t){E(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function ms(l){let e;return{c(){e=C("i"),this.h()},l(s){e=I(s,"I",{class:!0}),O(e).forEach(h),this.h()},h(){v(e,"class","codicon codicon-screen-full")},m(s,t){N(s,e,t)},p:U,d(s){s&&h(e)}}}function tt(l){let e,s;return e=new dt({props:{post:l[1]}}),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,n){j(e,t,n),s=!0},p(t,n){const o={};n&2&&(o.post=t[1]),e.$set(o)},i(t){s||(y(e.$$.fragment,t),s=!0)},o(t){E(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function gs(l){let e,s,t,n,o,r,a,i,p,c;const d=[ds,_s,ps],m=[];function $(_,g){return _[1].type==="image"?0:_[1].type==="video"?1:2}function S(_,g){return g===1?fs(_):_}s=$(l),t=m[s]=d[s](S(l,s)),o=new Me({props:{class:"button-fullscreen","aria-label":"Enter Fullscreen mode",$$slots:{default:[ms]},$$scope:{ctx:l}}}),o.$on("click",l[5]);let b=l[0]&&tt(l);return{c(){e=C("div"),t.c(),n=P(),L(o.$$.fragment),r=P(),b&&b.c(),this.h()},l(_){e=I(_,"DIV",{id:!0,class:!0});var g=O(e);t.l(g),n=T(g),V(o.$$.fragment,g),r=T(g),b&&b.l(g),g.forEach(h),this.h()},h(){v(e,"id",a="post_"+l[1].id),v(e,"class","post svelte-pwgq1f"),Ee(e,"open",l[0])},m(_,g){N(_,e,g),m[s].m(e,null),k(e,n),j(o,e,null),k(e,r),b&&b.m(e,null),i=!0,p||(c=re(e,"keydown",l[6]),p=!0)},p(_,[g]){let u=s;s=$(_),s===u?m[s].p(S(_,s),g):(se(),E(m[u],1,1,()=>{m[u]=null}),ne(),t=m[s],t?t.p(S(_,s),g):(t=m[s]=d[s](S(_,s)),t.c()),y(t,1),t.m(e,n));const f={};g&256&&(f.$$scope={dirty:g,ctx:_}),o.$set(f),_[0]?b?(b.p(_,g),g&1&&y(b,1)):(b=tt(_),b.c(),y(b,1),b.m(e,null)):b&&(se(),E(b,1,1,()=>{b=null}),ne()),(!i||g&2&&a!==(a="post_"+_[1].id))&&v(e,"id",a),(!i||g&1)&&Ee(e,"open",_[0])},i(_){i||(y(t),y(o.$$.fragment,_),y(b),i=!0)},o(_){E(t),E(o.$$.fragment,_),E(b),i=!1},d(_){_&&h(e),m[s].d(),M(o),b&&b.d(),p=!1,c()}}}function hs(l,e,s){let t;x(l,gt,c=>s(2,t=c));const n=_e(),o=()=>s(0,a=!a);let{post:r}=e,{open:a=!1}=e;const i=()=>n("fullscreen"),p=c=>{c.key==="f"&&n("fullscreen")};return l.$$set=c=>{"post"in c&&s(1,r=c.post),"open"in c&&s(0,a=c.open)},[a,r,t,n,o,i,p]}class $s extends ie{constructor(e){super(),ae(this,e,hs,gs,oe,{post:1,open:0})}}function st(l){let e,s=l[0].type==="video"?"▶":"GIF",t;return{c(){e=C("span"),t=ee(s),this.h()},l(n){e=I(n,"SPAN",{class:!0});var o=O(e);t=te(o,s),o.forEach(h),this.h()},h(){v(e,"class","type svelte-14imjnt")},m(n,o){N(n,e,o),k(e,t)},p(n,o){o&1&&s!==(s=n[0].type==="video"?"▶":"GIF")&&Te(t,s)},d(n){n&&h(e)}}}function vs(l){let e,s,t,n,o,r=Re(l[0].score)+"",a,i,p,c,d,m=l[0].type!=="image"&&st(l);return{c(){e=C("div"),s=C("img"),n=P(),o=C("span"),a=ee(r),i=P(),m&&m.c(),this.h()},l($){e=I($,"DIV",{id:!0,class:!0,style:!0});var S=O(e);s=I(S,"IMG",{src:!0,alt:!0,class:!0,tabindex:!0,loading:!0}),n=T(S),o=I(S,"SPAN",{class:!0});var b=O(o);a=te(b,r),b.forEach(h),i=T(S),m&&m.l(S),S.forEach(h),this.h()},h(){fe(s.src,t=l[1])||v(s,"src",t),v(s,"alt","post"),v(s,"class","post-media svelte-14imjnt"),v(s,"tabindex","-1"),v(s,"loading","lazy"),v(o,"class","score svelte-14imjnt"),v(e,"id",p="post_"+l[0].id),v(e,"class","post svelte-14imjnt"),ze(e,"grid-row","span "+l[2]),Ee(e,"open",open)},m($,S){N($,e,S),k(e,s),k(e,n),k(e,o),k(o,a),k(e,i),m&&m.m(e,null),c||(d=[re(e,"click",l[3]),re(e,"keydown",l[4])],c=!0)},p($,[S]){S&2&&!fe(s.src,t=$[1])&&v(s,"src",t),S&1&&r!==(r=Re($[0].score)+"")&&Te(a,r),$[0].type!=="image"?m?m.p($,S):(m=st($),m.c(),m.m(e,null)):m&&(m.d(1),m=null),S&1&&p!==(p="post_"+$[0].id)&&v(e,"id",p),S&0&&Ee(e,"open",open)},i:U,o:U,d($){$&&h(e),m&&m.d(),c=!1,Be(d)}}}function bs(l,e,s){let t,{post:n}=e,o=Math.min(Math.round(n.height/n.width*5),15);const r=p=>p.endsWith(".jpg")||p.endsWith(".jpeg")||p.endsWith(".png")||p.endsWith(".webp");function a(p){Ke.call(this,l,p)}const i=p=>{var c;(_t(p)||p.key==="f")&&((c=p.target)==null||c.click())};return l.$$set=p=>{"post"in p&&s(0,n=p.post)},l.$$.update=()=>{l.$$.dirty&1&&s(1,t=r(n.sample_url)?n.sample_url:n.preview_url)},[n,t,o,a,i]}class ks extends ie{constructor(e){super(),ae(this,e,bs,vs,oe,{post:0})}}function ws(l){let e,s,t,n;const o=l[3].default,r=wt(o,l,l[2],null);return{c(){e=C("div"),r&&r.c(),this.h()},l(a){e=I(a,"DIV",{role:!0,tabindex:!0,class:!0});var i=O(e);r&&r.l(i),i.forEach(h),this.h()},h(){v(e,"role","none"),v(e,"tabindex","-1"),v(e,"class","dialog fullscreen svelte-1j44awz")},m(a,i){N(a,e,i),r&&r.m(e,null),l[5](e),s=!0,t||(n=[re(e,"keydown",l[4]),re(e,"click",yt(ys))],t=!0)},p(a,[i]){r&&r.p&&(!s||i&4)&&Et(r,o,a,a[2],s?Ct(o,a[2],i,null):St(a[2]),null)},i(a){s||(y(r,a),s=!0)},o(a){E(r,a),s=!1},d(a){a&&h(e),r&&r.d(a),l[5](null),t=!1,Be(n)}}}const ys=()=>{};function Es(l,e,s){let{$$slots:t={},$$scope:n}=e;const o=_e(),r=()=>o("close"),a=m=>{m.key==="Escape"&&r()};let i=()=>{document.fullscreenElement||r()},p;Fe(async()=>{p.focus(),document.addEventListener("keydown",a),document.addEventListener("fullscreenchange",i);try{await p.requestFullscreen()}catch{}}),Ae(async()=>{document.removeEventListener("keydown",a),document.removeEventListener("fullscreenchange",i);try{await document.exitFullscreen()}catch{}});const c=m=>{m.code==="Escape"&&r()};function d(m){be[m?"unshift":"push"](()=>{p=m,s(0,p)})}return l.$$set=m=>{"$$scope"in m&&s(2,n=m.$$scope)},[p,r,n,t,c,d]}class Ss extends ie{constructor(e){super(),ae(this,e,Es,ws,oe,{})}}function Cs(l){let e,s;return e=new mt({props:{post:l[0]}}),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,n){j(e,t,n),s=!0},p(t,n){const o={};n&1&&(o.post=t[0]),e.$set(o)},i(t){s||(y(e.$$.fragment,t),s=!0)},o(t){E(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function Is(l){let e,s;return{c(){e=C("video"),this.h()},l(t){e=I(t,"VIDEO",{class:!0,src:!0}),O(e).forEach(h),this.h()},h(){v(e,"class","post-media svelte-12glt11"),fe(e.src,s=l[0].file_url)||v(e,"src",s),e.controls=!0,e.loop=l[4]},m(t,n){N(t,e,n),l[6](e)},p(t,n){n&1&&!fe(e.src,s=t[0].file_url)&&v(e,"src",s)},i:U,o:U,d(t){t&&h(e),l[6](null)}}}function Ds(l){let e,s,t,n,o;return{c(){e=C("img"),this.h()},l(r){e=I(r,"IMG",{class:!0,src:!0,alt:!0}),this.h()},h(){v(e,"class","post-media svelte-12glt11"),fe(e.src,s=l[0].file_url)||v(e,"src",s),v(e,"alt",t="Image of Post "+l[0].id),Ee(e,"zoomed",l[1])},m(r,a){N(r,e,a),n||(o=re(e,"click",l[5]),n=!0)},p(r,a){a&1&&!fe(e.src,s=r[0].file_url)&&v(e,"src",s),a&1&&t!==(t="Image of Post "+r[0].id)&&v(e,"alt",t),a&2&&Ee(e,"zoomed",r[1])},i:U,o:U,d(r){r&&h(e),n=!1,o()}}}function Ns(l){let e;return{c(){e=C("i"),this.h()},l(s){e=I(s,"I",{class:!0}),O(e).forEach(h),this.h()},h(){v(e,"class","codicon codicon-close")},m(s,t){N(s,e,t)},p:U,d(s){s&&h(e)}}}function Ps(l){let e;return{c(){e=C("i"),this.h()},l(s){e=I(s,"I",{class:!0}),O(e).forEach(h),this.h()},h(){v(e,"class","codicon codicon-chevron-left")},m(s,t){N(s,e,t)},p:U,d(s){s&&h(e)}}}function Ts(l){let e;return{c(){e=C("i"),this.h()},l(s){e=I(s,"I",{class:!0}),O(e).forEach(h),this.h()},h(){v(e,"class","codicon codicon-chevron-right")},m(s,t){N(s,e,t)},p:U,d(s){s&&h(e)}}}function Os(l){let e,s,t,n,o,r,a,i,p,c,d,m,$,S;const b=[Ds,Is,Cs],_=[];function g(u,f){return u[0].type==="image"?0:u[0].type==="video"?1:2}return s=g(l),t=_[s]=b[s](l),a=new dt({props:{post:l[0]}}),p=new Me({props:{class:"button-close",$$slots:{default:[Ns]},$$scope:{ctx:l}}}),p.$on("click",l[7]),d=new Me({props:{class:"button-previous",$$slots:{default:[Ps]},$$scope:{ctx:l}}}),d.$on("click",l[8]),$=new Me({props:{class:"button-next",$$slots:{default:[Ts]},$$scope:{ctx:l}}}),$.$on("click",l[9]),{c(){e=C("div"),t.c(),n=P(),o=C("i"),r=P(),L(a.$$.fragment),i=P(),L(p.$$.fragment),c=P(),L(d.$$.fragment),m=P(),L($.$$.fragment),this.h()},l(u){e=I(u,"DIV",{class:!0});var f=O(e);t.l(f),n=T(f),o=I(f,"I",{class:!0}),O(o).forEach(h),f.forEach(h),r=T(u),V(a.$$.fragment,u),i=T(u),V(p.$$.fragment,u),c=T(u),V(d.$$.fragment,u),m=T(u),V($.$$.fragment,u),this.h()},h(){v(o,"class","codicon codicon-chevron-down svelte-12glt11"),v(e,"class","svelte-12glt11")},m(u,f){N(u,e,f),_[s].m(e,null),k(e,n),k(e,o),N(u,r,f),j(a,u,f),N(u,i,f),j(p,u,f),N(u,c,f),j(d,u,f),N(u,m,f),j($,u,f),S=!0},p(u,f){let D=s;s=g(u),s===D?_[s].p(u,f):(se(),E(_[D],1,1,()=>{_[D]=null}),ne(),t=_[s],t?t.p(u,f):(t=_[s]=b[s](u),t.c()),y(t,1),t.m(e,n));const H={};f&1&&(H.post=u[0]),a.$set(H);const Q={};f&8192&&(Q.$$scope={dirty:f,ctx:u}),p.$set(Q);const W={};f&8192&&(W.$$scope={dirty:f,ctx:u}),d.$set(W);const K={};f&8192&&(K.$$scope={dirty:f,ctx:u}),$.$set(K)},i(u){S||(y(t),y(a.$$.fragment,u),y(p.$$.fragment,u),y(d.$$.fragment,u),y($.$$.fragment,u),S=!0)},o(u){E(t),E(a.$$.fragment,u),E(p.$$.fragment,u),E(d.$$.fragment,u),E($.$$.fragment,u),S=!1},d(u){u&&(h(e),h(r),h(i),h(c),h(m)),_[s].d(),M(a,u),M(p,u),M(d,u),M($,u)}}}function Rs(l){let e,s;return e=new Ss({props:{$$slots:{default:[Os]},$$scope:{ctx:l}}}),e.$on("close",l[10]),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,n){j(e,t,n),s=!0},p(t,[n]){const o={};n&8199&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){s||(y(e.$$.fragment,t),s=!0)},o(t){E(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function Ls(l,e,s){let t;x(l,gt,_=>s(11,t=_));const n=_e(),o=_=>{if(_.key==="f"&&(_.preventDefault(),_.stopPropagation(),n("close")),_.key==="ArrowLeft"&&(_.preventDefault(),_.stopPropagation(),n("previous")),_.key==="ArrowRight"&&(_.preventDefault(),_.stopPropagation(),n("next")),_.key===" "||_.key==="k"){_.preventDefault(),_.stopPropagation(),i&&(i.paused?i.play():i.pause());const g=document.querySelector(".fullscreen.circle");g&&g.click()}i&&(_.key==="j"?s(2,i.currentTime=Math.max(0,i.currentTime-5),i):_.key==="l"&&s(2,i.currentTime=Math.min(i.duration,i.currentTime+5),i))};let{post:r}=e,a=r.width/r.height<.33,i,p=t||Ge(r.tags);Fe(()=>{document.addEventListener("keydown",o)}),Ae(()=>document.removeEventListener("keydown",o));const c=()=>s(1,a=!a);function d(_){be[_?"unshift":"push"](()=>{i=_,s(2,i)})}const m=()=>n("close"),$=()=>n("previous"),S=()=>n("next");function b(_){Ke.call(this,l,_)}return l.$$set=_=>{"post"in _&&s(0,r=_.post)},[r,a,i,n,p,c,d,m,$,S,b]}class Vs extends ie{constructor(e){super(),ae(this,e,Ls,Rs,oe,{post:0})}}function nt(l,e,s){const t=l.slice();return t[12]=e[s],t[14]=s,t}function lt(l,e,s){const t=l.slice();return t[12]=e[s],t[14]=s,t}function js(l){let e,s,t=Se(l[2].posts),n=[];for(let r=0;r<t.length;r+=1)n[r]=rt(nt(l,t,r));const o=r=>E(n[r],1,1,()=>{n[r]=null});return{c(){e=C("section");for(let r=0;r<n.length;r+=1)n[r].c();this.h()},l(r){e=I(r,"SECTION",{class:!0,style:!0});var a=O(e);for(let i=0;i<n.length;i+=1)n[i].l(a);a.forEach(h),this.h()},h(){v(e,"class","multi svelte-q6spg0"),ze(e,"grid-template-columns","repeat("+l[3]+", 1fr)")},m(r,a){N(r,e,a);for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(e,null);s=!0},p(r,a){if(a&5){t=Se(r[2].posts);let i;for(i=0;i<t.length;i+=1){const p=nt(r,t,i);n[i]?(n[i].p(p,a),y(n[i],1)):(n[i]=rt(p),n[i].c(),y(n[i],1),n[i].m(e,null))}for(se(),i=t.length;i<n.length;i+=1)o(i);ne()}(!s||a&8)&&ze(e,"grid-template-columns","repeat("+r[3]+", 1fr)")},i(r){if(!s){for(let a=0;a<t.length;a+=1)y(n[a]);s=!0}},o(r){n=n.filter(Boolean);for(let a=0;a<n.length;a+=1)E(n[a]);s=!1},d(r){r&&h(e),Ue(n,r)}}}function Ms(l){let e,s,t=Se(l[2].posts),n=[];for(let r=0;r<t.length;r+=1)n[r]=ot(lt(l,t,r));const o=r=>E(n[r],1,1,()=>{n[r]=null});return{c(){e=C("section");for(let r=0;r<n.length;r+=1)n[r].c();this.h()},l(r){e=I(r,"SECTION",{class:!0});var a=O(e);for(let i=0;i<n.length;i+=1)n[i].l(a);a.forEach(h),this.h()},h(){v(e,"class","single svelte-q6spg0")},m(r,a){N(r,e,a);for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(e,null);s=!0},p(r,a){if(a&5){t=Se(r[2].posts);let i;for(i=0;i<t.length;i+=1){const p=lt(r,t,i);n[i]?(n[i].p(p,a),y(n[i],1)):(n[i]=ot(p),n[i].c(),y(n[i],1),n[i].m(e,null))}for(se(),i=t.length;i<n.length;i+=1)o(i);ne()}},i(r){if(!s){for(let a=0;a<t.length;a+=1)y(n[a]);s=!0}},o(r){n=n.filter(Boolean);for(let a=0;a<n.length;a+=1)E(n[a]);s=!1},d(r){r&&h(e),Ue(n,r)}}}function rt(l){let e,s;function t(){return l[7](l[12],l[14])}return e=new ks({props:{post:l[12]}}),e.$on("click",t),{c(){L(e.$$.fragment)},l(n){V(e.$$.fragment,n)},m(n,o){j(e,n,o),s=!0},p(n,o){l=n;const r={};o&4&&(r.post=l[12]),e.$set(r)},i(n){s||(y(e.$$.fragment,n),s=!0)},o(n){E(e.$$.fragment,n),s=!1},d(n){M(e,n)}}}function ot(l){let e,s;function t(){return l[6](l[12],l[14])}return e=new $s({props:{post:l[12]}}),e.$on("fullscreen",t),{c(){L(e.$$.fragment)},l(n){V(e.$$.fragment,n)},m(n,o){j(e,n,o),s=!0},p(n,o){l=n;const r={};o&4&&(r.post=l[12]),e.$set(r)},i(n){s||(y(e.$$.fragment,n),s=!0)},o(n){E(e.$$.fragment,n),s=!1},d(n){M(e,n)}}}function it(l){let e,s;return e=new Vs({props:{post:l[0].post}}),e.$on("close",l[8]),e.$on("previous",l[9]),e.$on("next",l[10]),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,n){j(e,t,n),s=!0},p(t,n){const o={};n&1&&(o.post=t[0].post),e.$set(o)},i(t){s||(y(e.$$.fragment,t),s=!0)},o(t){E(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function Bs(l){let e,s,t=Re(l[2].postCount)+"",n,o,r,a,i,p,c,d,m,$;a=new us({}),a.$on("sortfilterupdate",l[5]);const S=[Ms,js],b=[];function _(u,f){return u[3]==="1"?0:1}p=_(l),c=b[p]=S[p](l);let g=l[1]&&l[0]!==void 0&&it(l);return{c(){e=C("div"),s=C("span"),n=ee(t),o=ee(" posts"),r=P(),L(a.$$.fragment),i=P(),c.c(),d=P(),g&&g.c(),m=pe(),this.h()},l(u){e=I(u,"DIV",{class:!0});var f=O(e);s=I(f,"SPAN",{});var D=O(s);n=te(D,t),o=te(D," posts"),D.forEach(h),r=T(f),V(a.$$.fragment,f),f.forEach(h),i=T(u),c.l(u),d=T(u),g&&g.l(u),m=pe(),this.h()},h(){v(e,"class","svelte-q6spg0")},m(u,f){N(u,e,f),k(e,s),k(s,n),k(s,o),k(e,r),j(a,e,null),N(u,i,f),b[p].m(u,f),N(u,d,f),g&&g.m(u,f),N(u,m,f),$=!0},p(u,[f]){(!$||f&4)&&t!==(t=Re(u[2].postCount)+"")&&Te(n,t);let D=p;p=_(u),p===D?b[p].p(u,f):(se(),E(b[D],1,1,()=>{b[D]=null}),ne(),c=b[p],c?c.p(u,f):(c=b[p]=S[p](u),c.c()),y(c,1),c.m(d.parentNode,d)),u[1]&&u[0]!==void 0?g?(g.p(u,f),f&3&&y(g,1)):(g=it(u),g.c(),y(g,1),g.m(m.parentNode,m)):g&&(se(),E(g,1,1,()=>{g=null}),ne())},i(u){$||(y(a.$$.fragment,u),y(c),y(g),$=!0)},o(u){E(a.$$.fragment,u),E(c),E(g),$=!1},d(u){u&&(h(e),h(i),h(d),h(m)),M(a),b[p].d(u),g&&g.d(u)}}}function Fs(l,e,s){let t,n;x(l,Pe,b=>s(2,t=b)),x(l,It,b=>s(3,n=b));const o=_e(),r=()=>{s(1,i=location.hash.length>2)};let a,i=location.hash.length>2;Fe(()=>{window.addEventListener("hashchange",r)}),Ae(()=>{window.removeEventListener("hashchange",r)});function p(b){Ke.call(this,l,b)}return[a,i,t,n,o,p,(b,_)=>{s(0,a={post:b,index:_}),location.hash="fullscreen"},(b,_)=>{s(0,a={post:b,index:_}),location.hash="fullscreen"},()=>{var b,_;(b=a==null?void 0:a.post)!=null&&b.id&&((_=document.querySelector(`#post_${a.post.id} .post-media`))==null||_.focus()),s(0,a=void 0),history.back()},()=>{let b=Math.max(a.index-1,0);s(0,a={index:b,post:t.posts[b]})},()=>{let b=Math.min(a.index+1,t.posts.length);s(0,a={index:b,post:t.posts[b]}),b>t.posts.length-3&&t.posts.length!==t.postCount&&o("endreached")}]}class As extends ie{constructor(e){super(),ae(this,e,Fs,Bs,oe,{})}}function qs(l){let e;return{c(){e=ee("Reset Filter")},l(s){e=te(s,"Reset Filter")},m(s,t){N(s,e,t)},d(s){s&&h(e)}}}function zs(l){let e,s,t,n,o="We couldn't find any posts matching your tags. Sorry...",r,a,i;return a=new Oe({props:{title:"In case your filter caused all posts to vanish. Reset it.",$$slots:{default:[qs]},$$scope:{ctx:l}}}),a.$on("click",l[1]),{c(){e=C("img"),t=P(),n=C("p"),n.textContent=o,r=P(),L(a.$$.fragment),this.h()},l(p){e=I(p,"IMG",{src:!0,alt:!0,class:!0}),t=T(p),n=I(p,"P",{"data-svelte-h":!0}),ue(n)!=="svelte-1utxj3w"&&(n.textContent=o),r=T(p),V(a.$$.fragment,p),this.h()},h(){fe(e.src,s=pt+"/assets/shironeko-confused.png")||v(e,"src",s),v(e,"alt","Nothing here..."),v(e,"class","svelte-1bb5e7g")},m(p,c){N(p,e,c),N(p,t,c),N(p,n,c),N(p,r,c),j(a,p,c),i=!0},p(p,[c]){const d={};c&4&&(d.$$scope={dirty:c,ctx:p}),a.$set(d)},i(p){i||(y(a.$$.fragment,p),i=!0)},o(p){E(a.$$.fragment,p),i=!1},d(p){p&&(h(e),h(t),h(n),h(r)),M(a,p)}}}function Gs(l){const e=_e();return[e,()=>{ye.reset(),ve.reset(),e("sortfilterupdate")}]}class Us extends ie{constructor(e){super(),ae(this,e,Gs,zs,oe,{})}}function Ks(l){let e;return{c(){e=C("div")},l(s){e=I(s,"DIV",{}),O(e).forEach(h)},m(s,t){N(s,e,t),l[2](e)},p:U,i:U,o:U,d(s){s&&h(e),l[2](null)}}}function Hs(l,e,s){let{rootMargin:t}=e;const n=_e(),o=new IntersectionObserver(i=>{i[0].isIntersecting&&n("intersection")},{rootMargin:t});let r;function a(i){be[i?"unshift":"push"](()=>{r=i,s(0,r)})}return l.$$set=i=>{"rootMargin"in i&&s(1,t=i.rootMargin)},l.$$.update=()=>{l.$$.dirty&1&&(o.disconnect(),r&&o.observe(r))},[r,t,a]}class Ws extends ie{constructor(e){super(),ae(this,e,Hs,Ks,oe,{rootMargin:1})}}function Ys(l){let e;return{c(){e=ee("Search")},l(s){e=te(s,"Search")},m(s,t){N(s,e,t)},d(s){s&&h(e)}}}function Zs(l){let e,s,t,n,o,r;const a=[Xs,Qs],i=[];function p(c,d){return c[2].postCount===0?0:1}return s=p(l),t=i[s]=a[s](l),o=new Ft({}),{c(){e=C("section"),t.c(),n=P(),L(o.$$.fragment),this.h()},l(c){e=I(c,"SECTION",{class:!0});var d=O(e);t.l(d),d.forEach(h),n=T(c),V(o.$$.fragment,c),this.h()},h(){v(e,"class","svelte-rk0y4a")},m(c,d){N(c,e,d),i[s].m(e,null),N(c,n,d),j(o,c,d),r=!0},p(c,d){let m=s;s=p(c),s===m?i[s].p(c,d):(se(),E(i[m],1,1,()=>{i[m]=null}),ne(),t=i[s],t?t.p(c,d):(t=i[s]=a[s](c),t.c()),y(t,1),t.m(e,null))},i(c){r||(y(t),y(o.$$.fragment,c),r=!0)},o(c){E(t),E(o.$$.fragment,c),r=!1},d(c){c&&(h(e),h(n)),i[s].d(),M(o,c)}}}function Js(l){let e,s;return e=new Qt({props:{error:l[0]}}),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,n){j(e,t,n),s=!0},p(t,n){const o={};n&1&&(o.error=t[0]),e.$set(o)},i(t){s||(y(e.$$.fragment,t),s=!0)},o(t){E(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function Qs(l){let e,s,t,n,o,r;e=new As({}),e.$on("sortfilterupdate",l[7]),e.$on("endreached",l[8]);const a=[en,xs],i=[];function p(c,d){return c[2].posts.length===c[2].postCount?0:1}return t=p(l),n=i[t]=a[t](l),{c(){L(e.$$.fragment),s=P(),n.c(),o=pe()},l(c){V(e.$$.fragment,c),s=T(c),n.l(c),o=pe()},m(c,d){j(e,c,d),N(c,s,d),i[t].m(c,d),N(c,o,d),r=!0},p(c,d){let m=t;t=p(c),t===m?i[t].p(c,d):(se(),E(i[m],1,1,()=>{i[m]=null}),ne(),n=i[t],n?n.p(c,d):(n=i[t]=a[t](c),n.c()),y(n,1),n.m(o.parentNode,o))},i(c){r||(y(e.$$.fragment,c),y(n),r=!0)},o(c){E(e.$$.fragment,c),E(n),r=!1},d(c){c&&(h(s),h(o)),M(e,c),i[t].d(c)}}}function Xs(l){let e,s;return e=new Us({}),e.$on("sortfilterupdate",l[7]),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,n){j(e,t,n),s=!0},p:U,i(t){s||(y(e.$$.fragment,t),s=!0)},o(t){E(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function xs(l){let e,s;return e=new Ws({props:{rootMargin:"1000px"}}),e.$on("intersection",l[8]),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,n){j(e,t,n),s=!0},p:U,i(t){s||(y(e.$$.fragment,t),s=!0)},o(t){E(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function en(l){let e,s;return e=new xt({}),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,n){j(e,t,n),s=!0},p:U,i(t){s||(y(e.$$.fragment,t),s=!0)},o(t){E(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function at(l){let e,s;return e=new Yt({props:{tags:l[4]}}),e.$on("close",l[13]),e.$on("submit",l[14]),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,n){j(e,t,n),s=!0},p(t,n){const o={};n&16&&(o.tags=t[4]),e.$set(o)},i(t){s||(y(e.$$.fragment,t),s=!0)},o(t){E(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function tn(l){let e,s,t,n,o,r,a,i,p,c,d,m,$,S;s=new Nt({}),n=new Mt({props:{placeholder:"Search for tags",fetchSuggestions:l[6]}}),n.$on("pick",l[9]),r=new Oe({props:{title:"Search with the tags above",$$slots:{default:[Ys]},$$scope:{ctx:l}}}),r.$on("click",l[7]),i=new Pt({props:{tags:[...l[4],...l[3]]}}),i.$on("click",l[10]),i.$on("contextmenu",l[11]),i.$on("createSupertag",l[12]);const b=[Js,Zs],_=[];function g(f,D){return f[0]?0:f[2].requested?1:-1}~(c=g(l))&&(d=_[c]=b[c](l));let u=l[1]&&at(l);return{c(){e=C("section"),L(s.$$.fragment),t=P(),L(n.$$.fragment),o=P(),L(r.$$.fragment),a=P(),L(i.$$.fragment),p=P(),d&&d.c(),m=P(),u&&u.c(),$=pe(),this.h()},l(f){e=I(f,"SECTION",{id:!0,class:!0});var D=O(e);V(s.$$.fragment,D),t=T(D),V(n.$$.fragment,D),o=T(D),V(r.$$.fragment,D),a=T(D),V(i.$$.fragment,D),D.forEach(h),p=T(f),d&&d.l(f),m=T(f),u&&u.l(f),$=pe(),this.h()},h(){v(e,"id","search"),v(e,"class","svelte-rk0y4a")},m(f,D){N(f,e,D),j(s,e,null),k(e,t),j(n,e,null),k(e,o),j(r,e,null),k(e,a),j(i,e,null),N(f,p,D),~c&&_[c].m(f,D),N(f,m,D),u&&u.m(f,D),N(f,$,D),S=!0},p(f,[D]){const H={};D&8388608&&(H.$$scope={dirty:D,ctx:f}),r.$set(H);const Q={};D&24&&(Q.tags=[...f[4],...f[3]]),i.$set(Q);let W=c;c=g(f),c===W?~c&&_[c].p(f,D):(d&&(se(),E(_[W],1,1,()=>{_[W]=null}),ne()),~c?(d=_[c],d?d.p(f,D):(d=_[c]=b[c](f),d.c()),y(d,1),d.m(m.parentNode,m)):d=null),f[1]?u?(u.p(f,D),D&2&&y(u,1)):(u=at(f),u.c(),y(u,1),u.m($.parentNode,$)):u&&(se(),E(u,1,1,()=>{u=null}),ne())},i(f){S||(y(s.$$.fragment,f),y(n.$$.fragment,f),y(r.$$.fragment,f),y(i.$$.fragment,f),y(d),y(u),S=!0)},o(f){E(s.$$.fragment,f),E(n.$$.fragment,f),E(r.$$.fragment,f),E(i.$$.fragment,f),E(d),E(u),S=!1},d(f){f&&(h(e),h(p),h(m),h($)),M(s),M(n),M(r),M(i),~c&&_[c].d(f),u&&u.d(f)}}}function sn(l,e,s){let t,n,o,r,a,i,p;x(l,Pe,w=>s(2,t=w)),x(l,qe,w=>s(3,n=w)),x(l,ve,w=>s(17,o=w)),x(l,ye,w=>s(18,r=w)),x(l,Gt,w=>s(19,a=w)),x(l,je,w=>s(4,i=w)),x(l,Qe,w=>s(5,p=w));let c=!1,d,m=!1,$=0;const S=async w=>{const z=await At(w);return[...p.items.filter(({name:J})=>J.toLowerCase().includes(w.toLowerCase())).map(J=>({label:J.name,count:J.tags.length,type:"supertag"})),...z]},b=()=>new Tt().withPid(t.pageCount).withTags(i).withBlockedContent(a).withSortProperty(r.property).withSortDirection(r.direction).withScoreValue(o.scoreValue).withScoreComparator(o.scoreComparator).withRating(o.rating).withSupertags(n),_=async w=>{if(!c){s(0,d=void 0),c=!0;try{const z=t.pageCount;await w(),zt(z).catch(()=>{})}catch(z){s(0,d=z),console.warn(z)}finally{c=!1}}},g=async()=>{Pe.reset(),$=0,_(async()=>{const[w,z]=await b().getPageAndCount();Pe.addPage(w,z)})},u=async()=>{_(async()=>{const w=await b().getPage();Pe.addPage(w)})},f=w=>{var z,Z;if((w.key==="/"||w.key==="s")&&(!document.activeElement||document.activeElement===document.body)&&((z=document.getElementById("searchbar"))==null||z.focus(),w.preventDefault(),w.stopPropagation()),w.ctrlKey&&w.key==="Enter"&&(w.preventDefault(),w.stopPropagation(),g()),w.ctrlKey&&w.key==="m"&&((Z=document.getElementById("select-modifier"))==null||Z.click()),w.ctrlKey&&w.key==="ArrowDown"){const J=document.getElementsByClassName("post-media");J[$].focus(),$=Math.min($+1,Math.max(0,J.length-1))}w.ctrlKey&&w.key==="ArrowUp"&&(document.getElementsByClassName("post-media")[$].focus(),$=Math.max($-1,0))};return Fe(async()=>{document.addEventListener("keydown",f)}),Ae(()=>{document.removeEventListener("keydown",f)}),[d,m,t,n,i,p,S,g,u,async w=>{const z=w.detail;if(z.type==="supertag"){const Z=p.items.find(J=>J.name===z.label);if(!Z){console.warn("Supertag not present.");return}qe.addOrReplace(Z)}else{const Z=await qt(w.detail.label);je.addOrReplace({name:w.detail.label,modifier:w.detail.modifier,count:w.detail.count,type:(Z==null?void 0:Z.type)??"tag"})}},w=>"description"in w.detail?qe.removeByName(w.detail.name):je.removeByName(w.detail.name),w=>{"description"in w.detail||(w.detail.modifier=Bt(w.detail.modifier),je.addOrReplace(w.detail))},()=>s(1,m=!0),()=>s(1,m=!1),w=>Qe.add(w.detail)]}class Sn extends ie{constructor(e){super(),ae(this,e,sn,tn,oe,{})}}export{Sn as component};
