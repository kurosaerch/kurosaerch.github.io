import{s as ne,f as S,a as N,g as C,c as O,y as ce,D as pe,j as g,i as P,d,E as me,l as X,m as x,e as _e,h as T,u as v,F as ie,n as Oe,C as fe,G as vt,p as ke,H as we,I as je,J as it,K as Ae,L as ye,v as U,k as Fe,M as Me,w as bt,N as kt,z as wt,A as yt,B as Et,o as qe,O as ze,P as Ge,r as ct}from"../chunks/scheduler.88299003.js";import{S as le,i as re,b as j,d as B,m as L,a as k,t as y,e as A,g as ee,c as te,f as Be}from"../chunks/index.15b414ac.js";import{s as ue,r as Ne,K as St,A as Ct,a as Ve,S as It}from"../chunks/search-builder.1bb73e3b.js";import{S as Dt,n as Pt,s as Ye}from"../chunks/supertags-store.112748a7.js";import{T as Te}from"../chunks/TextButton.2f318c50.js";import{g as Nt,a as Ot}from"../chunks/tags.58927cde.js";import{a as Pe}from"../chunks/active-tags-store.ee1f6602.js";import{b as ut}from"../chunks/paths.93fa373f.js";import{e as Ee}from"../chunks/each.e59479a4.js";import{D as ft,r as Tt}from"../chunks/Dialog.f8853b6f.js";import{i as pt,D as _t,G as mt,V as Rt,I as jt}from"../chunks/Details.d670f3fc.js";import{f as Re}from"../chunks/format-tag.d6c065e3.js";import{R as Bt,I as Le}from"../chunks/ModifierSelect.623aacd6.js";import{S as Ze}from"../chunks/Select.22805bc7.js";import{R as Lt}from"../chunks/RotatingTextSelect.7e32facf.js";import{b as At}from"../chunks/blocked-content-store.805c4a3d.js";import{D as Vt}from"../chunks/DetailedTag.28ff9b0d.js";import{S as Ft}from"../chunks/ScrollUpButton.cfa21b3f.js";import{l as Mt}from"../chunks/analytics.12ea4383.js";function qt(l){let e;return{c(){e=X("Reset Filter")},l(s){e=x(s,"Reset Filter")},m(s,t){P(s,e,t)},d(s){s&&d(e)}}}function zt(l){let e,s,t,n,r="We couldn't find any posts matching your tags. Sorry...",o,a,i;return a=new Te({props:{title:"In case your filter caused all posts to vanish. Reset it.",$$slots:{default:[qt]},$$scope:{ctx:l}}}),a.$on("click",l[1]),{c(){e=S("img"),t=N(),n=S("p"),n.textContent=r,o=N(),j(a.$$.fragment),this.h()},l(u){e=C(u,"IMG",{src:!0,alt:!0,class:!0}),t=O(u),n=C(u,"P",{"data-svelte-h":!0}),ce(n)!=="svelte-1utxj3w"&&(n.textContent=r),o=O(u),B(a.$$.fragment,u),this.h()},h(){pe(e.src,s=ut+"/assets/shironeko-confused.png")||g(e,"src",s),g(e,"alt","Nothing here..."),g(e,"class","svelte-1bb5e7g")},m(u,c){P(u,e,c),P(u,t,c),P(u,n,c),P(u,o,c),L(a,u,c),i=!0},p(u,[c]){const p={};c&4&&(p.$$scope={dirty:c,ctx:u}),a.$set(p)},i(u){i||(k(a.$$.fragment,u),i=!0)},o(u){y(a.$$.fragment,u),i=!1},d(u){u&&(d(e),d(t),d(n),d(o)),A(a,u)}}}function Gt(l){const e=me();return[e,()=>{ue.reset(),e("sortfilterupdate")}]}class Ut extends le{constructor(e){super(),re(this,e,Gt,zt,ne,{})}}function Je(l){let e,s;return e=new ft({props:{$$slots:{default:[Wt]},$$scope:{ctx:l}}}),e.$on("close",l[6]),{c(){j(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,n){L(e,t,n),s=!0},p(t,n){const r={};n&32771&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){s||(k(e.$$.fragment,t),s=!0)},o(t){y(e.$$.fragment,t),s=!1},d(t){A(e,t)}}}function Kt(l){let e;return{c(){e=X("Done")},l(s){e=x(s,"Done")},m(s,t){P(s,e,t)},d(s){s&&d(e)}}}function Ht(l){let e;return{c(){e=X("Reset")},l(s){e=x(s,"Reset")},m(s,t){P(s,e,t)},d(s){s&&d(e)}}}function Wt(l){let e,s,t="Sorting and Filtering",n,r,o,a="Sorting",i,u,c,p,f,_,$,I,E,w,m="Filtering by Score",h,D,Y,oe,Z,K,ae,b,z,J="Filtering by Rating",W,Q,M,Se,V,R,H,q,se,be,Ce;function Ie(F){l[8](F)}let Ue={options:Jt};l[1].sortDirection!==void 0&&(Ue.value=l[1].sortDirection),c=new Bt({props:Ue}),ke.push(()=>Be(c,"value",Ie));function gt(F){l[9](F)}let Ke={options:Zt};l[1].sortProperty!==void 0&&(Ke.value=l[1].sortProperty),_=new Ze({props:Ke}),ke.push(()=>Be(_,"value",gt));function ht(F){l[10](F)}let He={options:Qt};l[1].scoreComparator!==void 0&&(He.value=l[1].scoreComparator),Y=new Lt({props:He}),ke.push(()=>Be(Y,"value",ht));function $t(F){l[13](F)}let We={options:dt};return l[1].rating!==void 0&&(We.value=l[1].rating),M=new Ze({props:We}),ke.push(()=>Be(M,"value",$t)),R=new Te({props:{title:"Return to searching.",$$slots:{default:[Kt]},$$scope:{ctx:l}}}),R.$on("click",l[6]),q=new Te({props:{title:"Reset sort and filter.",type:"secondary",$$slots:{default:[Ht]},$$scope:{ctx:l}}}),q.$on("click",l[7]),{c(){e=S("div"),s=S("h3"),s.textContent=t,n=N(),r=S("label"),o=S("b"),o.textContent=a,i=N(),u=S("div"),j(c.$$.fragment),f=N(),j(_.$$.fragment),I=N(),E=S("label"),w=S("b"),w.textContent=m,h=N(),D=S("div"),j(Y.$$.fragment),Z=N(),K=S("input"),ae=N(),b=S("label"),z=S("b"),z.textContent=J,W=N(),Q=S("div"),j(M.$$.fragment),V=N(),j(R.$$.fragment),H=N(),j(q.$$.fragment),this.h()},l(F){e=C(F,"DIV",{class:!0});var G=T(e);s=C(G,"H3",{"data-svelte-h":!0}),ce(s)!=="svelte-15zouq3"&&(s.textContent=t),n=O(G),r=C(G,"LABEL",{class:!0});var de=T(r);o=C(de,"B",{"data-svelte-h":!0}),ce(o)!=="svelte-ekzpgg"&&(o.textContent=a),i=O(de),u=C(de,"DIV",{class:!0});var ge=T(u);B(c.$$.fragment,ge),f=O(ge),B(_.$$.fragment,ge),ge.forEach(d),de.forEach(d),I=O(G),E=C(G,"LABEL",{class:!0});var he=T(E);w=C(he,"B",{"data-svelte-h":!0}),ce(w)!=="svelte-1flca3"&&(w.textContent=m),h=O(he),D=C(he,"DIV",{class:!0});var $e=T(D);B(Y.$$.fragment,$e),Z=O($e),K=C($e,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),$e.forEach(d),he.forEach(d),ae=O(G),b=C(G,"LABEL",{class:!0});var ve=T(b);z=C(ve,"B",{"data-svelte-h":!0}),ce(z)!=="svelte-1evbw58"&&(z.textContent=J),W=O(ve),Q=C(ve,"DIV",{class:!0});var De=T(Q);B(M.$$.fragment,De),De.forEach(d),ve.forEach(d),V=O(G),B(R.$$.fragment,G),H=O(G),B(q.$$.fragment,G),G.forEach(d),this.h()},h(){g(u,"class","row svelte-1omoy36"),g(r,"class","svelte-1omoy36"),g(K,"type","number"),g(K,"min",0),g(K,"max",1e5),g(K,"step",1),g(K,"class","svelte-1omoy36"),g(D,"class","row svelte-1omoy36"),g(E,"class","svelte-1omoy36"),g(Q,"class","row svelte-1omoy36"),g(b,"class","svelte-1omoy36"),g(e,"class","container svelte-1omoy36")},m(F,G){P(F,e,G),v(e,s),v(e,n),v(e,r),v(r,o),v(r,i),v(r,u),L(c,u,null),v(u,f),L(_,u,null),v(e,I),v(e,E),v(E,w),v(E,h),v(E,D),L(Y,D,null),v(D,Z),v(D,K),we(K,l[0]),v(e,ae),v(e,b),v(b,z),v(b,W),v(b,Q),L(M,Q,null),v(e,V),L(R,e,null),v(e,H),L(q,e,null),se=!0,be||(Ce=[ie(K,"input",l[11]),ie(K,"keyup",l[12])],be=!0)},p(F,G){const de={};!p&&G&2&&(p=!0,de.value=F[1].sortDirection,je(()=>p=!1)),c.$set(de);const ge={};!$&&G&2&&($=!0,ge.value=F[1].sortProperty,je(()=>$=!1)),_.$set(ge);const he={};!oe&&G&2&&(oe=!0,he.value=F[1].scoreComparator,je(()=>oe=!1)),Y.$set(he),G&1&&it(K.value)!==F[0]&&we(K,F[0]);const $e={};!Se&&G&2&&(Se=!0,$e.value=F[1].rating,je(()=>Se=!1)),M.$set($e);const ve={};G&32768&&(ve.$$scope={dirty:G,ctx:F}),R.$set(ve);const De={};G&32768&&(De.$$scope={dirty:G,ctx:F}),q.$set(De)},i(F){se||(k(c.$$.fragment,F),k(_.$$.fragment,F),k(Y.$$.fragment,F),k(M.$$.fragment,F),k(R.$$.fragment,F),k(q.$$.fragment,F),se=!0)},o(F){y(c.$$.fragment,F),y(_.$$.fragment,F),y(Y.$$.fragment,F),y(M.$$.fragment,F),y(R.$$.fragment,F),y(q.$$.fragment,F),se=!1},d(F){F&&d(e),A(c),A(_),A(Y),A(M),A(R),A(q),be=!1,Ae(Ce)}}}function Yt(l){let e,s,t,n,r,o,a,i,u,c,p,f,_,$,I,E=l[2]&&Je(l);return{c(){e=S("button"),s=S("i"),t=N(),n=S("span"),r=X(l[4]),o=N(),a=S("i"),i=N(),u=S("span"),c=X(l[3]),p=N(),E&&E.c(),f=_e(),this.h()},l(w){e=C(w,"BUTTON",{class:!0});var m=T(e);s=C(m,"I",{class:!0}),T(s).forEach(d),t=O(m),n=C(m,"SPAN",{});var h=T(n);r=x(h,l[4]),h.forEach(d),o=O(m),a=C(m,"I",{class:!0}),T(a).forEach(d),i=O(m),u=C(m,"SPAN",{});var D=T(u);c=x(D,l[3]),D.forEach(d),m.forEach(d),p=O(w),E&&E.l(w),f=_e(),this.h()},h(){g(s,"class","codicon codicon-filter svelte-1omoy36"),g(a,"class","codicon codicon-arrow-swap svelte-1omoy36"),g(e,"class","svelte-1omoy36")},m(w,m){P(w,e,m),v(e,s),v(e,t),v(e,n),v(n,r),v(e,o),v(e,a),v(e,i),v(e,u),v(u,c),P(w,p,m),E&&E.m(w,m),P(w,f,m),_=!0,$||(I=ie(e,"click",l[5]),$=!0)},p(w,[m]){(!_||m&16)&&Oe(r,w[4]),(!_||m&8)&&Oe(c,w[3]),w[2]?E?(E.p(w,m),m&4&&k(E,1)):(E=Je(w),E.c(),k(E,1),E.m(f.parentNode,f)):E&&(ee(),y(E,1,1,()=>{E=null}),te())},i(w){_||(k(E),_=!0)},o(w){y(E),_=!1},d(w){w&&(d(e),d(p),d(f)),E&&E.d(w),$=!1,I()}}}const Zt=Object.freeze({id:"Uploaded",score:"Score",updated:"Updated"}),Jt=Object.freeze({desc:"codicon codicon-arrow-down",asc:"codicon codicon-arrow-up"}),Qt=Object.freeze({">=":"≥","<=":"≤"}),dt=Object.freeze({all:"All",safe:"Safe",questionable:"Questionable",explicit:"Explicit"}),Xt=Object.freeze({id:{asc:"Oldest",desc:"Newest"},score:{asc:"Worst",desc:"Best"},updated:{asc:"Inactive",desc:"Active"}}),xt=(l,e,s)=>{let t=l==="all"?void 0:dt[l],n=e===0&&s===">="?void 0:`Score${s}${Re(e)}`;return[t,n].filter(r=>r!==void 0).join(",")||"All"};function es(l,e,s){let t,n,r;fe(l,ue,m=>s(1,r=m));const o=me();let a=!1;const i=()=>s(2,a=!0),u=()=>{s(2,a=!1),o("sortfilterupdate")},c=()=>{ue.reset(),s(0,p=r.scoreValue)};let p;function f(m){l.$$.not_equal(r.sortDirection,m)&&(r.sortDirection=m,ue.set(r))}function _(m){l.$$.not_equal(r.sortProperty,m)&&(r.sortProperty=m,ue.set(r))}function $(m){l.$$.not_equal(r.scoreComparator,m)&&(r.scoreComparator=m,ue.set(r))}function I(){p=it(this.value),s(0,p),s(1,r)}const E=m=>pt(m)&&m.target.blur();function w(m){l.$$.not_equal(r.rating,m)&&(r.rating=m,ue.set(r))}return l.$$.update=()=>{if(l.$$.dirty&3){p===void 0&&s(0,p=r.scoreValue);let m=Number(p);isNaN(m)||vt(ue,r.scoreValue=m,r)}l.$$.dirty&2&&s(4,t=xt(r.rating,r.scoreValue,r.scoreComparator)),l.$$.dirty&2&&s(3,n=Xt[r.sortProperty][r.sortDirection])},[p,r,a,n,t,i,u,c,f,_,$,I,E,w]}class ts extends le{constructor(e){super(),re(this,e,es,Yt,ne,{})}}function ss(l){let e,s;return e=new mt({props:{post:l[1]}}),e.$on("click",l[3]),{c(){j(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,n){L(e,t,n),s=!0},p(t,n){const r={};n&2&&(r.post=t[1]),e.$set(r)},i(t){s||(k(e.$$.fragment,t),s=!0)},o(t){y(e.$$.fragment,t),s=!1},d(t){A(e,t)}}}function ns(l){let e,s;return e=new Rt({props:{src:l[1].file_url,poster:l[1].sample_url,width:l[1].width,height:l[1].height,loop:l[1].tags.some(Xe)}}),e.$on("click",l[3]),{c(){j(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,n){L(e,t,n),s=!0},p(t,n){const r={};n&2&&(r.src=t[1].file_url),n&2&&(r.poster=t[1].sample_url),n&2&&(r.width=t[1].width),n&2&&(r.height=t[1].height),n&2&&(r.loop=t[1].tags.some(Xe)),e.$set(r)},i(t){s||(k(e.$$.fragment,t),s=!0)},o(t){y(e.$$.fragment,t),s=!1},d(t){A(e,t)}}}function ls(l){let e,s;return e=new jt({props:{post:l[1],open:l[0]}}),e.$on("click",l[3]),{c(){j(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,n){L(e,t,n),s=!0},p(t,n){const r={};n&2&&(r.post=t[1]),n&1&&(r.open=t[0]),e.$set(r)},i(t){s||(k(e.$$.fragment,t),s=!0)},o(t){y(e.$$.fragment,t),s=!1},d(t){A(e,t)}}}function rs(l){let e;return{c(){e=S("i"),this.h()},l(s){e=C(s,"I",{class:!0}),T(e).forEach(d),this.h()},h(){g(e,"class","codicon codicon-screen-full")},m(s,t){P(s,e,t)},p:U,d(s){s&&d(e)}}}function Qe(l){let e,s;return e=new _t({props:{post:l[1]}}),{c(){j(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,n){L(e,t,n),s=!0},p(t,n){const r={};n&2&&(r.post=t[1]),e.$set(r)},i(t){s||(k(e.$$.fragment,t),s=!0)},o(t){y(e.$$.fragment,t),s=!1},d(t){A(e,t)}}}function os(l){let e,s,t,n,r,o,a,i;const u=[ls,ns,ss],c=[];function p(_,$){return _[1].type==="image"?0:_[1].type==="video"?1:2}s=p(l),t=c[s]=u[s](l),r=new Le({props:{class:"button-fullscreen","aria-label":"Enter Fullscreen mode",$$slots:{default:[rs]},$$scope:{ctx:l}}}),r.$on("click",l[4]);let f=l[0]&&Qe(l);return{c(){e=S("div"),t.c(),n=N(),j(r.$$.fragment),o=N(),f&&f.c(),this.h()},l(_){e=C(_,"DIV",{id:!0,class:!0});var $=T(e);t.l($),n=O($),B(r.$$.fragment,$),o=O($),f&&f.l($),$.forEach(d),this.h()},h(){g(e,"id",a="post_"+l[1].id),g(e,"class","post svelte-pwgq1f"),ye(e,"open",l[0])},m(_,$){P(_,e,$),c[s].m(e,null),v(e,n),L(r,e,null),v(e,o),f&&f.m(e,null),i=!0},p(_,[$]){let I=s;s=p(_),s===I?c[s].p(_,$):(ee(),y(c[I],1,1,()=>{c[I]=null}),te(),t=c[s],t?t.p(_,$):(t=c[s]=u[s](_),t.c()),k(t,1),t.m(e,n));const E={};$&32&&(E.$$scope={dirty:$,ctx:_}),r.$set(E),_[0]?f?(f.p(_,$),$&1&&k(f,1)):(f=Qe(_),f.c(),k(f,1),f.m(e,null)):f&&(ee(),y(f,1,1,()=>{f=null}),te()),(!i||$&2&&a!==(a="post_"+_[1].id))&&g(e,"id",a),(!i||$&1)&&ye(e,"open",_[0])},i(_){i||(k(t),k(r.$$.fragment,_),k(f),i=!0)},o(_){y(t),y(r.$$.fragment,_),y(f),i=!1},d(_){_&&d(e),c[s].d(),A(r),f&&f.d()}}}const Xe=l=>l.name==="loop";function as(l,e,s){const t=me(),n=()=>s(0,o=!o);let{post:r}=e,{open:o=!1}=e;const a=()=>t("fullscreen");return l.$$set=i=>{"post"in i&&s(1,r=i.post),"open"in i&&s(0,o=i.open)},[o,r,t,n,a]}class is extends le{constructor(e){super(),re(this,e,as,os,ne,{post:1,open:0})}}function xe(l){let e,s=l[0].type==="video"?"▶":"GIF",t;return{c(){e=S("span"),t=X(s),this.h()},l(n){e=C(n,"SPAN",{class:!0});var r=T(e);t=x(r,s),r.forEach(d),this.h()},h(){g(e,"class","type svelte-14imjnt")},m(n,r){P(n,e,r),v(e,t)},p(n,r){r&1&&s!==(s=n[0].type==="video"?"▶":"GIF")&&Oe(t,s)},d(n){n&&d(e)}}}function cs(l){let e,s,t,n,r,o,a=Re(l[0].score)+"",i,u,c,p,f=l[0].type!=="image"&&xe(l);return{c(){e=S("div"),s=S("img"),r=N(),o=S("span"),i=X(a),u=N(),f&&f.c(),this.h()},l(_){e=C(_,"DIV",{class:!0,style:!0});var $=T(e);s=C($,"IMG",{src:!0,alt:!0,class:!0,tabindex:!0,loading:!0,id:!0}),r=O($),o=C($,"SPAN",{class:!0});var I=T(o);i=x(I,a),I.forEach(d),u=O($),f&&f.l($),$.forEach(d),this.h()},h(){pe(s.src,t=l[1])||g(s,"src",t),g(s,"alt","post"),g(s,"class","post-media svelte-14imjnt"),g(s,"tabindex","-1"),g(s,"loading","lazy"),g(s,"id",n="post_"+l[0].id),g(o,"class","score svelte-14imjnt"),g(e,"class","post svelte-14imjnt"),Fe(e,"grid-row","span "+l[2]),ye(e,"open",open)},m(_,$){P(_,e,$),v(e,s),v(e,r),v(e,o),v(o,i),v(e,u),f&&f.m(e,null),c||(p=[ie(e,"click",l[3]),ie(e,"keydown",l[4])],c=!0)},p(_,[$]){$&2&&!pe(s.src,t=_[1])&&g(s,"src",t),$&1&&n!==(n="post_"+_[0].id)&&g(s,"id",n),$&1&&a!==(a=Re(_[0].score)+"")&&Oe(i,a),_[0].type!=="image"?f?f.p(_,$):(f=xe(_),f.c(),f.m(e,null)):f&&(f.d(1),f=null),$&0&&ye(e,"open",open)},i:U,o:U,d(_){_&&d(e),f&&f.d(),c=!1,Ae(p)}}}function us(l,e,s){let t,{post:n}=e,r=Math.min(Math.round(n.height/n.width*5),15);const o=u=>u.endsWith(".jpg")||u.endsWith(".jpeg")||u.endsWith(".png")||u.endsWith(".webp");function a(u){Me.call(this,l,u)}const i=u=>{pt(u)&&u.target.click()};return l.$$set=u=>{"post"in u&&s(0,n=u.post)},l.$$.update=()=>{l.$$.dirty&1&&s(1,t=o(n.sample_url)?n.sample_url:n.preview_url)},[n,t,r,a,i]}class fs extends le{constructor(e){super(),re(this,e,us,cs,ne,{post:0})}}function ps(l){let e,s,t,n;const r=l[3].default,o=bt(r,l,l[2],null);return{c(){e=S("div"),o&&o.c(),this.h()},l(a){e=C(a,"DIV",{role:!0,tabindex:!0,class:!0});var i=T(e);o&&o.l(i),i.forEach(d),this.h()},h(){g(e,"role","none"),g(e,"tabindex","-1"),g(e,"class","dialog svelte-1kq1os1")},m(a,i){P(a,e,i),o&&o.m(e,null),l[5](e),s=!0,t||(n=[ie(e,"keydown",l[4]),ie(e,"click",kt(_s))],t=!0)},p(a,[i]){o&&o.p&&(!s||i&4)&&wt(o,r,a,a[2],s?Et(r,a[2],i,null):yt(a[2]),null)},i(a){s||(k(o,a),s=!0)},o(a){y(o,a),s=!1},d(a){a&&d(e),o&&o.d(a),l[5](null),t=!1,Ae(n)}}}const _s=()=>{};function ms(l,e,s){let{$$slots:t={},$$scope:n}=e;const r=me(),o=()=>r("close"),a=p=>{p.key==="Escape"&&o()};let i;qe(async()=>{i.focus(),document.addEventListener("keydown",a)}),ze(()=>document.removeEventListener("keydown",a));const u=p=>{p.code==="Escape"&&o()};function c(p){ke[p?"unshift":"push"](()=>{i=p,s(0,i)})}return l.$$set=p=>{"$$scope"in p&&s(2,n=p.$$scope)},[i,o,n,t,u,c]}class ds extends le{constructor(e){super(),re(this,e,ms,ps,ne,{})}}function gs(l){let e,s;return e=new mt({props:{post:l[0]}}),{c(){j(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,n){L(e,t,n),s=!0},p(t,n){const r={};n&1&&(r.post=t[0]),e.$set(r)},i(t){s||(k(e.$$.fragment,t),s=!0)},o(t){y(e.$$.fragment,t),s=!1},d(t){A(e,t)}}}function hs(l){let e,s;return{c(){e=S("video"),this.h()},l(t){e=C(t,"VIDEO",{src:!0,class:!0}),T(e).forEach(d),this.h()},h(){pe(e.src,s=l[0].file_url)||g(e,"src",s),e.controls=!0,g(e,"class","svelte-hmjydu")},m(t,n){P(t,e,n)},p(t,n){n&1&&!pe(e.src,s=t[0].file_url)&&g(e,"src",s)},i:U,o:U,d(t){t&&d(e)}}}function $s(l){let e,s,t,n,r;return{c(){e=S("img"),this.h()},l(o){e=C(o,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){pe(e.src,s=l[0].file_url)||g(e,"src",s),g(e,"alt",t="Image of Post "+l[0].id),g(e,"class","svelte-hmjydu"),ye(e,"zoomed",l[1])},m(o,a){P(o,e,a),n||(r=ie(e,"click",l[3]),n=!0)},p(o,a){a&1&&!pe(e.src,s=o[0].file_url)&&g(e,"src",s),a&1&&t!==(t="Image of Post "+o[0].id)&&g(e,"alt",t),a&2&&ye(e,"zoomed",o[1])},i:U,o:U,d(o){o&&d(e),n=!1,r()}}}function vs(l){let e,s,t,n,r,o,a,i;const u=[$s,hs,gs],c=[];function p(f,_){return f[0].type==="image"?0:f[0].type==="video"?1:2}return s=p(l),t=c[s]=u[s](l),a=new _t({props:{post:l[0]}}),{c(){e=S("div"),t.c(),n=N(),r=S("i"),o=N(),j(a.$$.fragment),this.h()},l(f){e=C(f,"DIV",{class:!0});var _=T(e);t.l(_),n=O(_),r=C(_,"I",{class:!0}),T(r).forEach(d),_.forEach(d),o=O(f),B(a.$$.fragment,f),this.h()},h(){g(r,"class","codicon codicon-chevron-down svelte-hmjydu"),g(e,"class","svelte-hmjydu")},m(f,_){P(f,e,_),c[s].m(e,null),v(e,n),v(e,r),P(f,o,_),L(a,f,_),i=!0},p(f,_){let $=s;s=p(f),s===$?c[s].p(f,_):(ee(),y(c[$],1,1,()=>{c[$]=null}),te(),t=c[s],t?t.p(f,_):(t=c[s]=u[s](f),t.c()),k(t,1),t.m(e,n));const I={};_&1&&(I.post=f[0]),a.$set(I)},i(f){i||(k(t),k(a.$$.fragment,f),i=!0)},o(f){y(t),y(a.$$.fragment,f),i=!1},d(f){f&&(d(e),d(o)),c[s].d(),A(a,f)}}}function bs(l){let e;return{c(){e=S("i"),this.h()},l(s){e=C(s,"I",{class:!0}),T(e).forEach(d),this.h()},h(){g(e,"class","codicon codicon-close")},m(s,t){P(s,e,t)},p:U,d(s){s&&d(e)}}}function ks(l){let e;return{c(){e=S("i"),this.h()},l(s){e=C(s,"I",{class:!0}),T(e).forEach(d),this.h()},h(){g(e,"class","codicon codicon-chevron-left")},m(s,t){P(s,e,t)},p:U,d(s){s&&d(e)}}}function ws(l){let e;return{c(){e=S("i"),this.h()},l(s){e=C(s,"I",{class:!0}),T(e).forEach(d),this.h()},h(){g(e,"class","codicon codicon-chevron-right")},m(s,t){P(s,e,t)},p:U,d(s){s&&d(e)}}}function ys(l){let e,s,t,n,r,o,a,i;return e=new ds({props:{$$slots:{default:[vs]},$$scope:{ctx:l}}}),e.$on("close",l[4]),t=new Le({props:{class:"button-close",$$slots:{default:[bs]},$$scope:{ctx:l}}}),t.$on("click",l[5]),r=new Le({props:{class:"button-previous",$$slots:{default:[ks]},$$scope:{ctx:l}}}),r.$on("click",l[6]),a=new Le({props:{class:"button-next",$$slots:{default:[ws]},$$scope:{ctx:l}}}),a.$on("click",l[7]),{c(){j(e.$$.fragment),s=N(),j(t.$$.fragment),n=N(),j(r.$$.fragment),o=N(),j(a.$$.fragment)},l(u){B(e.$$.fragment,u),s=O(u),B(t.$$.fragment,u),n=O(u),B(r.$$.fragment,u),o=O(u),B(a.$$.fragment,u)},m(u,c){L(e,u,c),P(u,s,c),L(t,u,c),P(u,n,c),L(r,u,c),P(u,o,c),L(a,u,c),i=!0},p(u,[c]){const p={};c&259&&(p.$$scope={dirty:c,ctx:u}),e.$set(p);const f={};c&256&&(f.$$scope={dirty:c,ctx:u}),t.$set(f);const _={};c&256&&(_.$$scope={dirty:c,ctx:u}),r.$set(_);const $={};c&256&&($.$$scope={dirty:c,ctx:u}),a.$set($)},i(u){i||(k(e.$$.fragment,u),k(t.$$.fragment,u),k(r.$$.fragment,u),k(a.$$.fragment,u),i=!0)},o(u){y(e.$$.fragment,u),y(t.$$.fragment,u),y(r.$$.fragment,u),y(a.$$.fragment,u),i=!1},d(u){u&&(d(s),d(n),d(o)),A(e,u),A(t,u),A(r,u),A(a,u)}}}function Es(l,e,s){const t=me();let{post:n}=e,r=n.width/n.height<.33;const o=()=>s(1,r=!r);function a(p){Me.call(this,l,p)}const i=()=>t("close"),u=()=>t("previous"),c=()=>t("next");return l.$$set=p=>{"post"in p&&s(0,n=p.post)},[n,r,t,o,a,i,u,c]}class Ss extends le{constructor(e){super(),re(this,e,Es,ys,ne,{post:0})}}function et(l,e,s){const t=l.slice();return t[12]=e[s],t[14]=s,t}function tt(l,e,s){const t=l.slice();return t[12]=e[s],t[14]=s,t}function Cs(l){let e,s,t=Ee(l[2].posts),n=[];for(let o=0;o<t.length;o+=1)n[o]=st(et(l,t,o));const r=o=>y(n[o],1,1,()=>{n[o]=null});return{c(){e=S("section");for(let o=0;o<n.length;o+=1)n[o].c();this.h()},l(o){e=C(o,"SECTION",{class:!0,style:!0});var a=T(e);for(let i=0;i<n.length;i+=1)n[i].l(a);a.forEach(d),this.h()},h(){g(e,"class","multi svelte-q6spg0"),Fe(e,"grid-template-columns","repeat("+l[3]+", 1fr)")},m(o,a){P(o,e,a);for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(e,null);s=!0},p(o,a){if(a&5){t=Ee(o[2].posts);let i;for(i=0;i<t.length;i+=1){const u=et(o,t,i);n[i]?(n[i].p(u,a),k(n[i],1)):(n[i]=st(u),n[i].c(),k(n[i],1),n[i].m(e,null))}for(ee(),i=t.length;i<n.length;i+=1)r(i);te()}(!s||a&8)&&Fe(e,"grid-template-columns","repeat("+o[3]+", 1fr)")},i(o){if(!s){for(let a=0;a<t.length;a+=1)k(n[a]);s=!0}},o(o){n=n.filter(Boolean);for(let a=0;a<n.length;a+=1)y(n[a]);s=!1},d(o){o&&d(e),Ge(n,o)}}}function Is(l){let e,s,t=Ee(l[2].posts),n=[];for(let o=0;o<t.length;o+=1)n[o]=nt(tt(l,t,o));const r=o=>y(n[o],1,1,()=>{n[o]=null});return{c(){e=S("section");for(let o=0;o<n.length;o+=1)n[o].c();this.h()},l(o){e=C(o,"SECTION",{class:!0});var a=T(e);for(let i=0;i<n.length;i+=1)n[i].l(a);a.forEach(d),this.h()},h(){g(e,"class","single svelte-q6spg0")},m(o,a){P(o,e,a);for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(e,null);s=!0},p(o,a){if(a&5){t=Ee(o[2].posts);let i;for(i=0;i<t.length;i+=1){const u=tt(o,t,i);n[i]?(n[i].p(u,a),k(n[i],1)):(n[i]=nt(u),n[i].c(),k(n[i],1),n[i].m(e,null))}for(ee(),i=t.length;i<n.length;i+=1)r(i);te()}},i(o){if(!s){for(let a=0;a<t.length;a+=1)k(n[a]);s=!0}},o(o){n=n.filter(Boolean);for(let a=0;a<n.length;a+=1)y(n[a]);s=!1},d(o){o&&d(e),Ge(n,o)}}}function st(l){let e,s;function t(){return l[7](l[12],l[14])}return e=new fs({props:{post:l[12]}}),e.$on("click",t),{c(){j(e.$$.fragment)},l(n){B(e.$$.fragment,n)},m(n,r){L(e,n,r),s=!0},p(n,r){l=n;const o={};r&4&&(o.post=l[12]),e.$set(o)},i(n){s||(k(e.$$.fragment,n),s=!0)},o(n){y(e.$$.fragment,n),s=!1},d(n){A(e,n)}}}function nt(l){let e,s;function t(){return l[6](l[12],l[14])}return e=new is({props:{post:l[12]}}),e.$on("fullscreen",t),{c(){j(e.$$.fragment)},l(n){B(e.$$.fragment,n)},m(n,r){L(e,n,r),s=!0},p(n,r){l=n;const o={};r&4&&(o.post=l[12]),e.$set(o)},i(n){s||(k(e.$$.fragment,n),s=!0)},o(n){y(e.$$.fragment,n),s=!1},d(n){A(e,n)}}}function lt(l){let e,s;return e=new Ss({props:{post:l[0].post}}),e.$on("close",l[8]),e.$on("previous",l[9]),e.$on("next",l[10]),{c(){j(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,n){L(e,t,n),s=!0},p(t,n){const r={};n&1&&(r.post=t[0].post),e.$set(r)},i(t){s||(k(e.$$.fragment,t),s=!0)},o(t){y(e.$$.fragment,t),s=!1},d(t){A(e,t)}}}function Ds(l){let e,s,t=Re(l[2].postCount)+"",n,r,o,a,i,u,c,p,f,_;a=new ts({}),a.$on("sortfilterupdate",l[5]);const $=[Is,Cs],I=[];function E(m,h){return m[3]==="1"?0:1}u=E(l),c=I[u]=$[u](l);let w=l[1]&&l[0]!==void 0&&lt(l);return{c(){e=S("div"),s=S("span"),n=X(t),r=X(" posts"),o=N(),j(a.$$.fragment),i=N(),c.c(),p=N(),w&&w.c(),f=_e(),this.h()},l(m){e=C(m,"DIV",{class:!0});var h=T(e);s=C(h,"SPAN",{});var D=T(s);n=x(D,t),r=x(D," posts"),D.forEach(d),o=O(h),B(a.$$.fragment,h),h.forEach(d),i=O(m),c.l(m),p=O(m),w&&w.l(m),f=_e(),this.h()},h(){g(e,"class","svelte-q6spg0")},m(m,h){P(m,e,h),v(e,s),v(s,n),v(s,r),v(e,o),L(a,e,null),P(m,i,h),I[u].m(m,h),P(m,p,h),w&&w.m(m,h),P(m,f,h),_=!0},p(m,[h]){(!_||h&4)&&t!==(t=Re(m[2].postCount)+"")&&Oe(n,t);let D=u;u=E(m),u===D?I[u].p(m,h):(ee(),y(I[D],1,1,()=>{I[D]=null}),te(),c=I[u],c?c.p(m,h):(c=I[u]=$[u](m),c.c()),k(c,1),c.m(p.parentNode,p)),m[1]&&m[0]!==void 0?w?(w.p(m,h),h&3&&k(w,1)):(w=lt(m),w.c(),k(w,1),w.m(f.parentNode,f)):w&&(ee(),y(w,1,1,()=>{w=null}),te())},i(m){_||(k(a.$$.fragment,m),k(c),k(w),_=!0)},o(m){y(a.$$.fragment,m),y(c),y(w),_=!1},d(m){m&&(d(e),d(i),d(p),d(f)),A(a),I[u].d(m),w&&w.d(m)}}}function Ps(l,e,s){let t,n;fe(l,Ne,I=>s(2,t=I)),fe(l,Tt,I=>s(3,n=I));const r=me(),o=()=>{s(1,i=location.hash.length>2)};let a,i=location.hash.length>2;qe(()=>{window.addEventListener("hashchange",o)}),ze(()=>{window.removeEventListener("hashchange",o)});function u(I){Me.call(this,l,I)}return[a,i,t,n,r,u,(I,E)=>{s(0,a={post:I,index:E}),location.hash="fullscreen"},(I,E)=>{s(0,a={post:I,index:E}),location.hash="fullscreen"},()=>{var I,E;(I=a==null?void 0:a.post)!=null&&I.id&&((E=document.getElementById(`post_${a.post.id}`))==null||E.focus()),s(0,a=void 0),history.back()},()=>{let I=Math.max(a.index-1,0);s(0,a={index:I,post:t.posts[I]})},()=>{let I=Math.min(a.index+1,t.posts.length);s(0,a={index:I,post:t.posts[I]}),I>t.posts.length-3&&t.posts.length!==t.postCount&&r("endreached")}]}class Ns extends le{constructor(e){super(),re(this,e,Ps,Ds,ne,{})}}function Os(l){let e;return{c(){e=S("div")},l(s){e=C(s,"DIV",{}),T(e).forEach(d)},m(s,t){P(s,e,t),l[2](e)},p:U,i:U,o:U,d(s){s&&d(e),l[2](null)}}}function Ts(l,e,s){let{rootMargin:t}=e;const n=me(),r=new IntersectionObserver(i=>{i[0].isIntersecting&&n("intersection")},{rootMargin:t});let o;function a(i){ke[i?"unshift":"push"](()=>{o=i,s(0,o)})}return l.$$set=i=>{"rootMargin"in i&&s(1,t=i.rootMargin)},l.$$.update=()=>{l.$$.dirty&1&&(r.disconnect(),o&&r.observe(o))},[o,t,a]}class Rs extends le{constructor(e){super(),re(this,e,Ts,Os,ne,{rootMargin:1})}}function js(l){let e,s,t,n,r="You have seen everything there is to see...";return{c(){e=S("img"),t=N(),n=S("p"),n.textContent=r,this.h()},l(o){e=C(o,"IMG",{src:!0,alt:!0,class:!0}),t=O(o),n=C(o,"P",{"data-svelte-h":!0}),ce(n)!=="svelte-1i75mtf"&&(n.textContent=r),this.h()},h(){pe(e.src,s=ut+"/assets/shironeko-x.png")||g(e,"src",s),g(e,"alt","No more results to load"),g(e,"class","svelte-1pkma0d")},m(o,a){P(o,e,a),P(o,t,a),P(o,n,a)},p:U,i:U,o:U,d(o){o&&(d(e),d(t),d(n))}}}class Bs extends le{constructor(e){super(),re(this,e,null,js,ne,{})}}function rt(l,e,s){const t=l.slice();return t[9]=e[s],t}function ot(l){let e,s;return e=new Vt({props:{tag:l[9]}}),{c(){j(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,n){L(e,t,n),s=!0},p(t,n){const r={};n&4&&(r.tag=t[9]),e.$set(r)},i(t){s||(k(e.$$.fragment,t),s=!0)},o(t){y(e.$$.fragment,t),s=!1},d(t){A(e,t)}}}function Ls(l){let e;return{c(){e=X("Create supertag")},l(s){e=x(s,"Create supertag")},m(s,t){P(s,e,t)},d(s){s&&d(e)}}}function As(l){let e,s,t="Create Supertag",n,r,o,a,i,u="Name",c,p,f,_,$,I="Description",E,w,m,h,D,Y="Tags",oe,Z,K,ae,b,z,J,W,Q=Ee(l[2]),M=[];for(let V=0;V<Q.length;V+=1)M[V]=ot(rt(l,Q,V));const Se=V=>y(M[V],1,1,()=>{M[V]=null});return b=new Te({props:{title:l[3]?"Click to create supertag":"Enter a valid name to continue",disabled:!l[3],$$slots:{default:[Ls]},$$scope:{ctx:l}}}),b.$on("click",l[8]),{c(){e=S("section"),s=S("h3"),s.textContent=t,n=N(),r=S("button"),o=N(),a=S("div"),i=S("label"),i.textContent=u,c=N(),p=S("input"),f=N(),_=S("div"),$=S("label"),$.textContent=I,E=N(),w=S("input"),m=N(),h=S("div"),D=S("span"),D.textContent=Y,oe=N(),Z=S("ol");for(let V=0;V<M.length;V+=1)M[V].c();K=N(),ae=S("div"),j(b.$$.fragment),this.h()},l(V){e=C(V,"SECTION",{class:!0});var R=T(e);s=C(R,"H3",{"data-svelte-h":!0}),ce(s)!=="svelte-ho1cwx"&&(s.textContent=t),n=O(R),r=C(R,"BUTTON",{class:!0}),T(r).forEach(d),o=O(R),a=C(R,"DIV",{class:!0});var H=T(a);i=C(H,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),ce(i)!=="svelte-10k8a68"&&(i.textContent=u),c=O(H),p=C(H,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),H.forEach(d),f=O(R),_=C(R,"DIV",{class:!0});var q=T(_);$=C(q,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),ce($)!=="svelte-14n9kp6"&&($.textContent=I),E=O(q),w=C(q,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),q.forEach(d),m=O(R),h=C(R,"DIV",{class:!0});var se=T(h);D=C(se,"SPAN",{class:!0,"data-svelte-h":!0}),ce(D)!=="svelte-7hjyox"&&(D.textContent=Y),oe=O(se),Z=C(se,"OL",{class:!0});var be=T(Z);for(let Ie=0;Ie<M.length;Ie+=1)M[Ie].l(be);be.forEach(d),se.forEach(d),K=O(R),ae=C(R,"DIV",{class:!0});var Ce=T(ae);B(b.$$.fragment,Ce),Ce.forEach(d),R.forEach(d),this.h()},h(){g(r,"class",ct("codicon codicon-close")+" svelte-xkjm86"),g(i,"for","supertag-name"),g(i,"class","svelte-xkjm86"),g(p,"type","text"),g(p,"placeholder","Descriptive name"),g(p,"id","supertag-name"),g(p,"class","svelte-xkjm86"),g(a,"class","svelte-xkjm86"),g($,"for","supertag-description"),g($,"class","svelte-xkjm86"),g(w,"type","text"),g(w,"placeholder","Short description"),g(w,"id","supertag-description"),g(w,"class","svelte-xkjm86"),g(_,"class","svelte-xkjm86"),g(D,"class","svelte-xkjm86"),g(Z,"class","svelte-xkjm86"),g(h,"class","svelte-xkjm86"),g(ae,"class","last svelte-xkjm86"),g(e,"class","svelte-xkjm86")},m(V,R){P(V,e,R),v(e,s),v(e,n),v(e,r),v(e,o),v(e,a),v(a,i),v(a,c),v(a,p),we(p,l[0]),v(e,f),v(e,_),v(_,$),v(_,E),v(_,w),we(w,l[1]),v(e,m),v(e,h),v(h,D),v(h,oe),v(h,Z);for(let H=0;H<M.length;H+=1)M[H]&&M[H].m(Z,null);v(e,K),v(e,ae),L(b,ae,null),z=!0,J||(W=[ie(r,"click",l[5]),ie(p,"input",l[6]),ie(w,"input",l[7])],J=!0)},p(V,R){if(R&1&&p.value!==V[0]&&we(p,V[0]),R&2&&w.value!==V[1]&&we(w,V[1]),R&4){Q=Ee(V[2]);let q;for(q=0;q<Q.length;q+=1){const se=rt(V,Q,q);M[q]?(M[q].p(se,R),k(M[q],1)):(M[q]=ot(se),M[q].c(),k(M[q],1),M[q].m(Z,null))}for(ee(),q=Q.length;q<M.length;q+=1)Se(q);te()}const H={};R&8&&(H.title=V[3]?"Click to create supertag":"Enter a valid name to continue"),R&8&&(H.disabled=!V[3]),R&4096&&(H.$$scope={dirty:R,ctx:V}),b.$set(H)},i(V){if(!z){for(let R=0;R<Q.length;R+=1)k(M[R]);k(b.$$.fragment,V),z=!0}},o(V){M=M.filter(Boolean);for(let R=0;R<M.length;R+=1)y(M[R]);y(b.$$.fragment,V),z=!1},d(V){V&&d(e),Ge(M,V),A(b),J=!1,Ae(W)}}}function Vs(l){let e,s;return e=new ft({props:{$$slots:{default:[As]},$$scope:{ctx:l}}}),e.$on("close",l[5]),{c(){j(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,n){L(e,t,n),s=!0},p(t,[n]){const r={};n&4111&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){s||(k(e.$$.fragment,t),s=!0)},o(t){y(e.$$.fragment,t),s=!1},d(t){A(e,t)}}}function Fs(l,e,s){let t,{name:n=""}=e,{description:r=""}=e,{tags:o}=e;const a=me(),i=()=>a("close");function u(){n=this.value,s(0,n)}function c(){r=this.value,s(1,r)}const p=()=>{a("submit",{name:n,description:r,tags:o.map(({modifier:f,name:_})=>({modifier:f,name:_}))}),i()};return l.$$set=f=>{"name"in f&&s(0,n=f.name),"description"in f&&s(1,r=f.description),"tags"in f&&s(2,o=f.tags)},l.$$.update=()=>{l.$$.dirty&5&&s(3,t=typeof n=="string"&&n!==""&&o.length>1)},[n,r,o,t,a,i,u,c,p]}class Ms extends le{constructor(e){super(),re(this,e,Fs,Vs,ne,{name:0,description:1,tags:2})}}function qs(l){let e,s,t,n,r,o,a,i,u,c;return{c(){e=S("div"),s=S("div"),t=S("i"),n=N(),r=S("div"),o=S("h3"),a=X(l[0]),i=N(),u=S("span"),c=X(l[2]),this.h()},l(p){e=C(p,"DIV",{class:!0});var f=T(e);s=C(f,"DIV",{class:!0});var _=T(s);t=C(_,"I",{class:!0}),T(t).forEach(d),_.forEach(d),n=O(f),r=C(f,"DIV",{});var $=T(r);o=C($,"H3",{class:!0});var I=T(o);a=x(I,l[0]),I.forEach(d),i=O($),u=C($,"SPAN",{});var E=T(u);c=x(E,l[2]),E.forEach(d),$.forEach(d),f.forEach(d),this.h()},h(){g(t,"class",ct(l[1])+" svelte-1tvgln1"),g(s,"class","icon svelte-1tvgln1"),g(o,"class","svelte-1tvgln1"),g(e,"class","error svelte-1tvgln1")},m(p,f){P(p,e,f),v(e,s),v(s,t),v(e,n),v(e,r),v(r,o),v(o,a),v(r,i),v(r,u),v(u,c)},p:U,i:U,o:U,d(p){p&&d(e)}}}function zs(l,e,s){let{error:t}=e,n=t.message==="Failed to fetch"?"Connection Error":"Application Error",r=t.message==="Failed to fetch"?"codicon codicon-debug-disconnect":"codicon codicon-error",o=t.message==="Failed to fetch"?"Failed to connect to the server. Make sure you have a stable internet connection.":t.message;return l.$$set=a=>{"error"in a&&s(3,t=a.error)},[n,r,o,t]}class Gs extends le{constructor(e){super(),re(this,e,zs,qs,ne,{error:3})}}function Us(l){let e;return{c(){e=X("Search")},l(s){e=x(s,"Search")},m(s,t){P(s,e,t)},d(s){s&&d(e)}}}function Ks(l){let e,s,t,n,r,o;const a=[Ys,Ws],i=[];function u(c,p){return c[2].postCount===0?0:1}return s=u(l),t=i[s]=a[s](l),r=new Ft({}),{c(){e=S("section"),t.c(),n=N(),j(r.$$.fragment),this.h()},l(c){e=C(c,"SECTION",{class:!0});var p=T(e);t.l(p),p.forEach(d),n=O(c),B(r.$$.fragment,c),this.h()},h(){g(e,"class","svelte-rk0y4a")},m(c,p){P(c,e,p),i[s].m(e,null),P(c,n,p),L(r,c,p),o=!0},p(c,p){let f=s;s=u(c),s===f?i[s].p(c,p):(ee(),y(i[f],1,1,()=>{i[f]=null}),te(),t=i[s],t?t.p(c,p):(t=i[s]=a[s](c),t.c()),k(t,1),t.m(e,null))},i(c){o||(k(t),k(r.$$.fragment,c),o=!0)},o(c){y(t),y(r.$$.fragment,c),o=!1},d(c){c&&(d(e),d(n)),i[s].d(),A(r,c)}}}function Hs(l){let e,s;return e=new Gs({props:{error:l[0]}}),{c(){j(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,n){L(e,t,n),s=!0},p(t,n){const r={};n&1&&(r.error=t[0]),e.$set(r)},i(t){s||(k(e.$$.fragment,t),s=!0)},o(t){y(e.$$.fragment,t),s=!1},d(t){A(e,t)}}}function Ws(l){let e,s,t,n,r,o;e=new Ns({}),e.$on("sortfilterupdate",l[7]),e.$on("endreached",l[8]);const a=[Js,Zs],i=[];function u(c,p){return c[2].posts.length===c[2].postCount?0:1}return t=u(l),n=i[t]=a[t](l),{c(){j(e.$$.fragment),s=N(),n.c(),r=_e()},l(c){B(e.$$.fragment,c),s=O(c),n.l(c),r=_e()},m(c,p){L(e,c,p),P(c,s,p),i[t].m(c,p),P(c,r,p),o=!0},p(c,p){let f=t;t=u(c),t===f?i[t].p(c,p):(ee(),y(i[f],1,1,()=>{i[f]=null}),te(),n=i[t],n?n.p(c,p):(n=i[t]=a[t](c),n.c()),k(n,1),n.m(r.parentNode,r))},i(c){o||(k(e.$$.fragment,c),k(n),o=!0)},o(c){y(e.$$.fragment,c),y(n),o=!1},d(c){c&&(d(s),d(r)),A(e,c),i[t].d(c)}}}function Ys(l){let e,s;return e=new Ut({}),e.$on("sortfilterupdate",l[7]),{c(){j(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,n){L(e,t,n),s=!0},p:U,i(t){s||(k(e.$$.fragment,t),s=!0)},o(t){y(e.$$.fragment,t),s=!1},d(t){A(e,t)}}}function Zs(l){let e,s;return e=new Rs({props:{rootMargin:"1000px"}}),e.$on("intersection",l[8]),{c(){j(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,n){L(e,t,n),s=!0},p:U,i(t){s||(k(e.$$.fragment,t),s=!0)},o(t){y(e.$$.fragment,t),s=!1},d(t){A(e,t)}}}function Js(l){let e,s;return e=new Bs({}),{c(){j(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,n){L(e,t,n),s=!0},p:U,i(t){s||(k(e.$$.fragment,t),s=!0)},o(t){y(e.$$.fragment,t),s=!1},d(t){A(e,t)}}}function at(l){let e,s;return e=new Ms({props:{tags:l[4]}}),e.$on("close",l[13]),e.$on("submit",l[14]),{c(){j(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,n){L(e,t,n),s=!0},p(t,n){const r={};n&16&&(r.tags=t[4]),e.$set(r)},i(t){s||(k(e.$$.fragment,t),s=!0)},o(t){y(e.$$.fragment,t),s=!1},d(t){A(e,t)}}}function Qs(l){let e,s,t,n,r,o,a,i,u,c,p,f,_,$;s=new St({}),n=new Dt({props:{placeholder:"Search for tags",fetchSuggestions:l[6]}}),n.$on("pick",l[9]),o=new Te({props:{title:"Search with the tags above",$$slots:{default:[Us]},$$scope:{ctx:l}}}),o.$on("click",l[7]),i=new Ct({props:{tags:[...l[4],...l[3]]}}),i.$on("click",l[10]),i.$on("contextmenu",l[11]),i.$on("createSupertag",l[12]);const I=[Hs,Ks],E=[];function w(h,D){return h[0]?0:h[2].requested?1:-1}~(c=w(l))&&(p=E[c]=I[c](l));let m=l[1]&&at(l);return{c(){e=S("section"),j(s.$$.fragment),t=N(),j(n.$$.fragment),r=N(),j(o.$$.fragment),a=N(),j(i.$$.fragment),u=N(),p&&p.c(),f=N(),m&&m.c(),_=_e(),this.h()},l(h){e=C(h,"SECTION",{id:!0,class:!0});var D=T(e);B(s.$$.fragment,D),t=O(D),B(n.$$.fragment,D),r=O(D),B(o.$$.fragment,D),a=O(D),B(i.$$.fragment,D),D.forEach(d),u=O(h),p&&p.l(h),f=O(h),m&&m.l(h),_=_e(),this.h()},h(){g(e,"id","search"),g(e,"class","svelte-rk0y4a")},m(h,D){P(h,e,D),L(s,e,null),v(e,t),L(n,e,null),v(e,r),L(o,e,null),v(e,a),L(i,e,null),P(h,u,D),~c&&E[c].m(h,D),P(h,f,D),m&&m.m(h,D),P(h,_,D),$=!0},p(h,[D]){const Y={};D&8388608&&(Y.$$scope={dirty:D,ctx:h}),o.$set(Y);const oe={};D&24&&(oe.tags=[...h[4],...h[3]]),i.$set(oe);let Z=c;c=w(h),c===Z?~c&&E[c].p(h,D):(p&&(ee(),y(E[Z],1,1,()=>{E[Z]=null}),te()),~c?(p=E[c],p?p.p(h,D):(p=E[c]=I[c](h),p.c()),k(p,1),p.m(f.parentNode,f)):p=null),h[1]?m?(m.p(h,D),D&2&&k(m,1)):(m=at(h),m.c(),k(m,1),m.m(_.parentNode,_)):m&&(ee(),y(m,1,1,()=>{m=null}),te())},i(h){$||(k(s.$$.fragment,h),k(n.$$.fragment,h),k(o.$$.fragment,h),k(i.$$.fragment,h),k(p),k(m),$=!0)},o(h){y(s.$$.fragment,h),y(n.$$.fragment,h),y(o.$$.fragment,h),y(i.$$.fragment,h),y(p),y(m),$=!1},d(h){h&&(d(e),d(u),d(f),d(_)),A(s),A(n),A(o),A(i),~c&&E[c].d(h),m&&m.d(h)}}}const Xs=()=>{const l=new URL(location.href);if(!l.searchParams.has("tags"))return;const s=(l.searchParams.get("tags")??"").split(";");if(!(!Array.isArray(s)||s.length===0))return s};function xs(l,e,s){let t,n,r,o,a,i;fe(l,Ne,b=>s(2,t=b)),fe(l,Ve,b=>s(3,n=b)),fe(l,ue,b=>s(17,r=b)),fe(l,At,b=>s(18,o=b)),fe(l,Pe,b=>s(4,a=b)),fe(l,Ye,b=>s(5,i=b));let u=!1,c,p=!1,f=0;const _=async b=>{const z=await Nt(b);return[...i.items.filter(({name:W})=>W.toLowerCase().includes(b.toLowerCase())).map(W=>({label:W.name,count:W.tags.length,type:"supertag"})),...z]},$=Xs();$&&$.forEach(b=>{a.some(z=>z.name===b)||Pe.addByName(b)});const I=()=>new It().withPid(t.pageCount).withTags(a).withBlockedContent(o).withSortProperty(r.sortProperty).withSortDirection(r.sortDirection).withScoreValue(r.scoreValue).withScoreComparator(r.scoreComparator).withRating(r.rating).withSupertags(n),E=async b=>{if(!u){s(0,c=void 0),u=!0;try{const z=t.pageCount;await b(),Mt(z).catch(()=>{})}catch(z){s(0,c=z),console.warn(z)}finally{u=!1}}},w=async()=>{Ne.reset(),f=0,E(async()=>{const[b,z]=await I().getPageAndCount();console.log(b,z),Ne.addPage(b,z)})},m=async()=>{E(async()=>{const b=await I().getPage();Ne.addPage(b)})},h=b=>{var z,J;if((b.key==="/"||b.key==="s")&&(!document.activeElement||document.activeElement===document.body)&&((z=document.getElementById("searchbar"))==null||z.focus(),b.preventDefault(),b.stopPropagation()),b.ctrlKey&&b.key==="Enter"&&(b.preventDefault(),b.stopPropagation(),w()),b.ctrlKey&&b.key==="m"&&((J=document.getElementById("select-modifier"))==null||J.click()),b.ctrlKey&&b.key==="ArrowDown"){const W=document.getElementsByClassName("post-media");W[f].focus(),f=Math.min(f+1,Math.max(0,W.length-1))}b.ctrlKey&&b.key==="ArrowUp"&&(document.getElementsByClassName("post-media")[f].focus(),f=Math.max(f-1,0))};return qe(()=>{document.addEventListener("keydown",h)}),ze(()=>{document.removeEventListener("keydown",h)}),[c,p,t,n,a,i,_,w,m,async b=>{const z=b.detail;if(z.type==="supertag"){const J=i.items.find(W=>W.name===z.label);if(!J){console.log("Supertag not present.");return}Ve.addOrReplace(J)}else{const J=await Ot(b.detail.label);Pe.addOrReplace({name:b.detail.label,modifier:b.detail.modifier,count:b.detail.count,type:J.type})}},b=>"description"in b.detail?Ve.removeByName(b.detail.name):Pe.removeByName(b.detail.name),b=>{"description"in b.detail||(b.detail.modifier=Pt(b.detail.modifier),Pe.addOrReplace(b.detail))},()=>s(1,p=!0),()=>s(1,p=!1),b=>Ye.add(b.detail)]}class bn extends le{constructor(e){super(),re(this,e,xs,Qs,ne,{})}}export{bn as component};
