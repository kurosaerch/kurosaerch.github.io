import{s as oe,e as R,a as z,H as ne,t as L,m as le,c as D,f as S,g as O,b as U,G as ie,d as A,o as P,h as i,i as ee,j as K,q as ce,k as B}from"../chunks/scheduler.9ddb58b7.js";import{S as me,i as ue,c as F,b as J,m as W,t as X,a as Y,d as Z}from"../chunks/index.ea5578de.js";import{e as ae}from"../chunks/each.e59479a4.js";import{K as pe,A as ge}from"../chunks/KurosearchTitle.86a5f3ea.js";import{S as fe}from"../chunks/Searchbar.17afebe2.js";import{g as he,a as de}from"../chunks/tags.49324235.js";import{a as x,r as _e}from"../chunks/results-store.db609e32.js";import{a as G}from"../chunks/blocking-group-data.358160cd.js";import{S as we,f as Se,s as ye}from"../chunks/search-builder.1f09dd7e.js";import{b as ve}from"../chunks/blocked-content-store.5328bd93.js";import{n as be,s as ke}from"../chunks/supertags-store.a61cddbd.js";function se(s,n,o){const a=s.slice();return a[16]=n[o],a}function re(s){let n,o=s[16][0]+"",a,f,d=s[16][1]+"",m;return{c(){n=R("p"),a=L(o),f=L("="),m=L(d),this.h()},l(u){n=D(u,"P",{class:!0});var r=U(n);a=A(r,o),f=A(r,"="),m=A(r,d),r.forEach(S),this.h()},h(){P(n,"class","fixed svelte-15wziqd")},m(u,r){ee(u,n,r),i(n,a),i(n,f),i(n,m)},p(u,r){r&16&&o!==(o=u[16][0]+"")&&K(a,o),r&16&&d!==(d=u[16][1]+"")&&K(m,d)},d(u){u&&S(n)}}}function Ce(s){let n,o,a,f,d,m,u,r,T,y,b,$,p,q,H,j,N,v,e=s[3][0]+"",k,w,_=s[3][1]+"",M,E;f=new pe({}),m=new fe({props:{placeholder:"Search for tags",fetchSuggestions:s[7]}}),m.$on("pick",s[12]),r=new ge({props:{tags:[...s[2],...s[1]]}}),r.$on("click",s[13]),r.$on("contextmenu",s[14]);let Q=ae(s[4]),c=[];for(let t=0;t<Q.length;t+=1)c[t]=re(se(s,Q,t));return{c(){n=R("meta"),o=z(),a=R("section"),F(f.$$.fragment),d=z(),F(m.$$.fragment),u=z(),F(r.$$.fragment),T=z(),y=R("code"),b=new ne(!1),$=z(),p=R("code"),q=R("p"),H=L(s[5]),j=z();for(let t=0;t<c.length;t+=1)c[t].c();N=z(),v=R("p"),k=L(e),w=L("="),M=L(_),this.h()},l(t){const h=le("svelte-2w1wl5",document.head);n=D(h,"META",{name:!0,content:!0}),h.forEach(S),o=O(t),a=D(t,"SECTION",{class:!0});var l=U(a);J(f.$$.fragment,l),d=O(l),J(m.$$.fragment,l),u=O(l),J(r.$$.fragment,l),T=O(l),y=D(l,"CODE",{class:!0});var g=U(y);b=ie(g,!1),g.forEach(S),$=O(l),p=D(l,"CODE",{class:!0});var C=U(p);q=D(C,"P",{class:!0});var te=U(q);H=A(te,s[5]),te.forEach(S),j=O(C);for(let I=0;I<c.length;I+=1)c[I].l(C);N=O(C),v=D(C,"P",{class:!0});var V=U(v);k=A(V,e),w=A(V,"="),M=A(V,_),V.forEach(S),C.forEach(S),l.forEach(S),this.h()},h(){document.title="kurosearch - Query Builder",P(n,"name","description"),P(n,"content","Test your kurosearch queries. Useful if you already know how to use rule34.xxx"),b.a=null,P(y,"class","svelte-15wziqd"),P(q,"class","base svelte-15wziqd"),P(v,"class","tags svelte-15wziqd"),P(p,"class","svelte-15wziqd"),P(a,"class","svelte-15wziqd")},m(t,h){i(document.head,n),ee(t,o,h),ee(t,a,h),W(f,a,null),i(a,d),W(m,a,null),i(a,u),W(r,a,null),i(a,T),i(a,y),b.m(s[0],y),i(a,$),i(a,p),i(p,q),i(q,H),i(p,j);for(let l=0;l<c.length;l+=1)c[l]&&c[l].m(p,null);i(p,N),i(p,v),i(v,k),i(v,w),i(v,M),E=!0},p(t,[h]){const l={};if(h&6&&(l.tags=[...t[2],...t[1]]),r.$set(l),(!E||h&1)&&b.p(t[0]),(!E||h&32)&&K(H,t[5]),h&16){Q=ae(t[4]);let g;for(g=0;g<Q.length;g+=1){const C=se(t,Q,g);c[g]?c[g].p(C,h):(c[g]=re(C),c[g].c(),c[g].m(p,N))}for(;g<c.length;g+=1)c[g].d(1);c.length=Q.length}(!E||h&8)&&e!==(e=t[3][0]+"")&&K(k,e),(!E||h&8)&&_!==(_=t[3][1]+"")&&K(M,_)},i(t){E||(X(f.$$.fragment,t),X(m.$$.fragment,t),X(r.$$.fragment,t),E=!0)},o(t){Y(f.$$.fragment,t),Y(m.$$.fragment,t),Y(r.$$.fragment,t),E=!1},d(t){t&&(S(o),S(a)),S(n),Z(f),Z(m),Z(r),ce(c,t)}}}function Te(s,n,o){let a,f,d,m,u,r,T,y,b,$,p;B(s,x,e=>o(1,u=e)),B(s,Se,e=>o(8,r=e)),B(s,ye,e=>o(9,T=e)),B(s,ve,e=>o(10,y=e)),B(s,G,e=>o(2,b=e)),B(s,_e,e=>o(11,$=e)),B(s,ke,e=>o(6,p=e));const q=async e=>{const k=await he(e);return[...p.items.filter(({name:_})=>_.toLowerCase().includes(e.toLowerCase())).map(_=>({label:_.name,count:_.tags.length,type:"supertag"})),...k]},H=e=>{try{return new URL(e)}catch{return null}},j=async e=>{const k=e.detail;if(k.type==="supertag"){const w=p.items.find(_=>_.name===k.label);if(!w){console.warn("Supertag not present.");return}x.addOrReplace(w)}else{const w=await de(e.detail.label);G.addOrReplace({name:e.detail.label,modifier:e.detail.modifier,count:e.detail.count,type:(w==null?void 0:w.type)??"tag"})}},N=e=>"description"in e.detail?x.removeByName(e.detail.name):G.removeByName(e.detail.name),v=e=>{"description"in e.detail||(e.detail.modifier=be(e.detail.modifier),G.addOrReplace(e.detail))};return s.$$.update=()=>{s.$$.dirty&3846&&o(0,a=H(new we().withPid($.pageCount).withTags(b).withBlockedContent(y).withSortProperty(T.property).withSortDirection(T.direction).withScoreValue(r.scoreValue).withScoreComparator(r.scoreComparator).withRating(r.rating).withSupertags(u).getQuery())),s.$$.dirty&1&&o(5,f=a&&`${a.protocol}//${a.hostname}`),s.$$.dirty&1&&o(4,d=a?[...a.searchParams.entries()].filter(([e])=>["page","s","q","fields","json","limit"].includes(e)):[]),s.$$.dirty&1&&o(3,m=a?[...a.searchParams.entries()].find(([e])=>e==="tags")??["tags",""]:["tags",""])},[a,u,b,m,d,f,p,q,r,T,y,$,j,N,v]}class He extends me{constructor(n){super(),ue(this,n,Te,Ce,oe,{})}}export{He as component};
