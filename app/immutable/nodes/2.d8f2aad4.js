import{s as _e,D as Ae,f as S,a as P,g as I,h as O,y as fe,c as N,d as $,j as h,r as Rt,i as T,u as m,E as Ge,F as ke,G as qe,H as lt,l as oe,m as ie,v as Y,I as ve,w as Yt,J as Zt,z as Jt,A as Qt,B as Xt,o as xe,K as et,p as Se,e as we,k as Oe,n as Ve,C as $e,L as Ye,M as nt,N as st,O as xt,P as Ft}from"../chunks/scheduler.85675055.js";import{S as de,i as me,b as V,d as A,m as R,a as b,t as C,e as F,g as ae,c as ce,f as Ze}from"../chunks/index.ea0af91c.js";import{e as ye}from"../chunks/each.e59479a4.js";import{D as Mt,r as Lt}from"../chunks/result-columns-store.a3e4d2a4.js";import{T as Je}from"../chunks/TextButton.a96d38ad.js";import{D as en}from"../chunks/DetailedTag.cb5ce0aa.js";import{K as tn,A as nn}from"../chunks/ActiveTagList.763a7979.js";import{b as Bt}from"../chunks/paths.2d9378db.js";import{f as Qe}from"../chunks/format-tag.7e313273.js";import{r as je,s as ze,f as Me,a as ot,S as sn}from"../chunks/active-supertags-store.2b048ae8.js";import{I as Gt,R as ln}from"../chunks/ModifierSelect.3c9e6862.js";import{g as rn,a as jt,i as on,R as an,S as cn,b as un,E as zt,c as fn,d as it,P as pn,C as _n,e as qt,D as dn,G as mn,V as gn,f as at,I as hn}from"../chunks/Details.afd3b3d5.js";import{h as ct,u as $n}from"../chunks/await_block.0dccef1e.js";import{L as Ut}from"../chunks/LoadingAnimation.35c83be1.js";import{a as vn}from"../chunks/always-loop-store.4abde366.js";import{S as ut}from"../chunks/Select.3ebe44e4.js";import{R as bn}from"../chunks/RotatingTextSelect.36b288e3.js";import{S as kn,n as wn,s as ft}from"../chunks/supertags-store.beaa1017.js";import{S as yn}from"../chunks/ScrollUpButton.1db89484.js";import{g as Cn,a as En}from"../chunks/tags.49324235.js";import{l as Sn}from"../chunks/analytics.eca95ce1.js";import{a as tt}from"../chunks/active-tags-store.34c52565.js";import{b as In}from"../chunks/blocked-content-store.d3c5af58.js";function pt(l,e,n){const t=l.slice();return t[9]=e[n],t}function _t(l){let e,n;return e=new en({props:{tag:l[9]}}),{c(){V(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,s){R(e,t,s),n=!0},p(t,s){const o={};s&4&&(o.tag=t[9]),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){F(e,t)}}}function Dn(l){let e;return{c(){e=oe("Create supertag")},l(n){e=ie(n,"Create supertag")},m(n,t){T(n,e,t)},d(n){n&&$(e)}}}function Pn(l){let e,n,t="Create Supertag",s,o,r,a,i,u="Name",c,_,g,y,w,E="Description",k,d,p,f,v,Z="Tags",H,X,J,se,te,D,x,ne,U=ye(l[2]),q=[];for(let L=0;L<U.length;L+=1)q[L]=_t(pt(l,U,L));const le=L=>C(q[L],1,1,()=>{q[L]=null});return te=new Je({props:{title:l[3]?"Click to create supertag":"Enter a valid name to continue",disabled:!l[3],$$slots:{default:[Dn]},$$scope:{ctx:l}}}),te.$on("click",l[8]),{c(){e=S("section"),n=S("h3"),n.textContent=t,s=P(),o=S("button"),r=P(),a=S("div"),i=S("label"),i.textContent=u,c=P(),_=S("input"),g=P(),y=S("div"),w=S("label"),w.textContent=E,k=P(),d=S("input"),p=P(),f=S("div"),v=S("span"),v.textContent=Z,H=P(),X=S("ol");for(let L=0;L<q.length;L+=1)q[L].c();J=P(),se=S("div"),V(te.$$.fragment),this.h()},l(L){e=I(L,"SECTION",{class:!0});var B=O(e);n=I(B,"H3",{"data-svelte-h":!0}),fe(n)!=="svelte-ho1cwx"&&(n.textContent=t),s=N(B),o=I(B,"BUTTON",{class:!0}),O(o).forEach($),r=N(B),a=I(B,"DIV",{class:!0});var Q=O(a);i=I(Q,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),fe(i)!=="svelte-10k8a68"&&(i.textContent=u),c=N(Q),_=I(Q,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),Q.forEach($),g=N(B),y=I(B,"DIV",{class:!0});var W=O(y);w=I(W,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),fe(w)!=="svelte-14n9kp6"&&(w.textContent=E),k=N(W),d=I(W,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),W.forEach($),p=N(B),f=I(B,"DIV",{class:!0});var pe=O(f);v=I(pe,"SPAN",{class:!0,"data-svelte-h":!0}),fe(v)!=="svelte-7hjyox"&&(v.textContent=Z),H=N(pe),X=I(pe,"OL",{class:!0});var ge=O(X);for(let De=0;De<q.length;De+=1)q[De].l(ge);ge.forEach($),pe.forEach($),J=N(B),se=I(B,"DIV",{class:!0});var Ie=O(se);A(te.$$.fragment,Ie),Ie.forEach($),B.forEach($),this.h()},h(){h(o,"class",Rt("codicon codicon-close")+" svelte-1x6vc81"),h(i,"for","supertag-name"),h(i,"class","svelte-1x6vc81"),h(_,"type","text"),h(_,"placeholder","Descriptive name"),h(_,"id","supertag-name"),h(_,"class","svelte-1x6vc81"),h(a,"class","svelte-1x6vc81"),h(w,"for","supertag-description"),h(w,"class","svelte-1x6vc81"),h(d,"type","text"),h(d,"placeholder","Short description"),h(d,"id","supertag-description"),h(d,"class","svelte-1x6vc81"),h(y,"class","svelte-1x6vc81"),h(v,"class","svelte-1x6vc81"),h(X,"class","svelte-1x6vc81"),h(f,"class","svelte-1x6vc81"),h(se,"class","last svelte-1x6vc81"),h(e,"class","svelte-1x6vc81")},m(L,B){T(L,e,B),m(e,n),m(e,s),m(e,o),m(e,r),m(e,a),m(a,i),m(a,c),m(a,_),Ge(_,l[0]),m(e,g),m(e,y),m(y,w),m(y,k),m(y,d),Ge(d,l[1]),m(e,p),m(e,f),m(f,v),m(f,H),m(f,X);for(let Q=0;Q<q.length;Q+=1)q[Q]&&q[Q].m(X,null);m(e,J),m(e,se),R(te,se,null),D=!0,x||(ne=[ke(o,"click",l[5]),ke(_,"input",l[6]),ke(d,"input",l[7])],x=!0)},p(L,B){if(B&1&&_.value!==L[0]&&Ge(_,L[0]),B&2&&d.value!==L[1]&&Ge(d,L[1]),B&4){U=ye(L[2]);let W;for(W=0;W<U.length;W+=1){const pe=pt(L,U,W);q[W]?(q[W].p(pe,B),b(q[W],1)):(q[W]=_t(pe),q[W].c(),b(q[W],1),q[W].m(X,null))}for(ae(),W=U.length;W<q.length;W+=1)le(W);ce()}const Q={};B&8&&(Q.title=L[3]?"Click to create supertag":"Enter a valid name to continue"),B&8&&(Q.disabled=!L[3]),B&4096&&(Q.$$scope={dirty:B,ctx:L}),te.$set(Q)},i(L){if(!D){for(let B=0;B<U.length;B+=1)b(q[B]);b(te.$$.fragment,L),D=!0}},o(L){q=q.filter(Boolean);for(let B=0;B<q.length;B+=1)C(q[B]);C(te.$$.fragment,L),D=!1},d(L){L&&$(e),qe(q,L),F(te),x=!1,lt(ne)}}}function Nn(l){let e,n;return e=new Mt({props:{$$slots:{default:[Pn]},$$scope:{ctx:l}}}),e.$on("close",l[5]),{c(){V(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,s){R(e,t,s),n=!0},p(t,[s]){const o={};s&4111&&(o.$$scope={dirty:s,ctx:t}),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){F(e,t)}}}function Tn(l,e,n){let t,{name:s=""}=e,{description:o=""}=e,{tags:r}=e;const a=Ae(),i=()=>a("close");function u(){s=this.value,n(0,s)}function c(){o=this.value,n(1,o)}const _=()=>{a("submit",{name:s,description:o,tags:r.map(({modifier:g,name:y})=>({modifier:g,name:y}))}),i()};return l.$$set=g=>{"name"in g&&n(0,s=g.name),"description"in g&&n(1,o=g.description),"tags"in g&&n(2,r=g.tags)},l.$$.update=()=>{l.$$.dirty&5&&n(3,t=typeof s=="string"&&s!==""&&r.length>1)},[s,o,r,t,a,i,u,c,_]}class On extends de{constructor(e){super(),me(this,e,Tn,Nn,_e,{name:0,description:1,tags:2})}}function Vn(l){let e,n,t,s,o,r,a,i,u,c;return{c(){e=S("div"),n=S("div"),t=S("i"),s=P(),o=S("div"),r=S("h3"),a=oe(l[0]),i=P(),u=S("span"),c=oe(l[2]),this.h()},l(_){e=I(_,"DIV",{class:!0});var g=O(e);n=I(g,"DIV",{class:!0});var y=O(n);t=I(y,"I",{class:!0}),O(t).forEach($),y.forEach($),s=N(g),o=I(g,"DIV",{});var w=O(o);r=I(w,"H3",{class:!0});var E=O(r);a=ie(E,l[0]),E.forEach($),i=N(w),u=I(w,"SPAN",{});var k=O(u);c=ie(k,l[2]),k.forEach($),w.forEach($),g.forEach($),this.h()},h(){h(t,"class",Rt(l[1])+" svelte-1yohziu"),h(n,"class","icon svelte-1yohziu"),h(r,"class","svelte-1yohziu"),h(e,"class","error svelte-1yohziu")},m(_,g){T(_,e,g),m(e,n),m(n,t),m(e,s),m(e,o),m(o,r),m(r,a),m(o,i),m(o,u),m(u,c)},p:Y,i:Y,o:Y,d(_){_&&$(e)}}}function An(l,e,n){let{error:t}=e,s=t.message==="Failed to fetch"?"Connection Error":"Application Error",o=t.message==="Failed to fetch"?"codicon codicon-debug-disconnect":"codicon codicon-error",r=t.message==="Failed to fetch"?"Failed to connect to the server. Make sure you have a stable internet connection.":t.message;return l.$$set=a=>{"error"in a&&n(3,t=a.error)},[s,o,r,t]}class Rn extends de{constructor(e){super(),me(this,e,An,Vn,_e,{error:3})}}function Fn(l){let e,n,t,s,o="You have seen everything there is to see...";return{c(){e=S("img"),t=P(),s=S("p"),s.textContent=o,this.h()},l(r){e=I(r,"IMG",{src:!0,alt:!0,class:!0}),t=N(r),s=I(r,"P",{"data-svelte-h":!0}),fe(s)!=="svelte-1i75mtf"&&(s.textContent=o),this.h()},h(){ve(e.src,n=Bt+"/assets/shironeko-x.png")||h(e,"src",n),h(e,"alt","No more results to load"),h(e,"class","svelte-1pkma0d")},m(r,a){T(r,e,a),T(r,t,a),T(r,s,a)},p:Y,i:Y,o:Y,d(r){r&&($(e),$(t),$(s))}}}class Mn extends de{constructor(e){super(),me(this,e,null,Fn,_e,{})}}const Xe=l=>`post_${l}`;function Ln(l){let e,n,t,s;const o=l[3].default,r=Yt(o,l,l[2],null);return{c(){e=S("div"),r&&r.c(),this.h()},l(a){e=I(a,"DIV",{role:!0,tabindex:!0,class:!0});var i=O(e);r&&r.l(i),i.forEach($),this.h()},h(){h(e,"role","none"),h(e,"tabindex","-1"),h(e,"class","svelte-1gmivor")},m(a,i){T(a,e,i),r&&r.m(e,null),l[4](e),n=!0,t||(s=[ke(e,"click",Zt(Bn)),ke(e,"keydown",l[1])],t=!0)},p(a,[i]){r&&r.p&&(!n||i&4)&&Jt(r,o,a,a[2],n?Xt(o,a[2],i,null):Qt(a[2]),null)},i(a){n||(b(r,a),n=!0)},o(a){C(r,a),n=!1},d(a){a&&$(e),r&&r.d(a),l[4](null),t=!1,lt(s)}}}const Bn=()=>{};function Gn(l,e,n){let{$$slots:t={},$$scope:s}=e;const o=Ae(),r=()=>o("close"),a=c=>{c.key==="Escape"&&(console.log("escape close"),r())};let i;xe(async()=>{i.focus();try{await i.requestFullscreen()}catch{}}),et(async()=>{try{await document.exitFullscreen()}catch{}console.log("dialog destroy")});function u(c){Se[c?"unshift":"push"](()=>{i=c,n(0,i)})}return l.$$set=c=>{"$$scope"in c&&n(2,s=c.$$scope)},[i,a,s,t,u]}class jn extends de{constructor(e){super(),me(this,e,Gn,Ln,_e,{})}}function zn(l){let e;return{c(){e=S("div")},l(n){e=I(n,"DIV",{}),O(e).forEach($)},m(n,t){T(n,e,t),l[2](e)},p:Y,i:Y,o:Y,d(n){n&&$(e),l[2](null)}}}function qn(l,e,n){let{rootMargin:t}=e;const s=Ae(),o=new IntersectionObserver(i=>{i[0].isIntersecting&&s("intersection")},{rootMargin:t});let r;function a(i){Se[i?"unshift":"push"](()=>{r=i,n(0,r)})}return l.$$set=i=>{"rootMargin"in i&&n(1,t=i.rootMargin)},l.$$.update=()=>{l.$$.dirty&1&&(o.disconnect(),r&&o.observe(r))},[r,t,a]}class Ht extends de{constructor(e){super(),me(this,e,qn,zn,_e,{rootMargin:1})}}const Be=new IntersectionObserver(l=>{for(const e of l)if(e.target){const n=e.target;e.isIntersecting&&n.autoplay&&n.paused&&n.play(),!e.isIntersecting&&!n.paused&&n.pause()}},{rootMargin:"-1px",threshold:.001});function Un(l){const e=l.slice(),n=rn(e[0].file_url,e[0].sample_url,e[0].preview_url);return e[4]=n,e}function Hn(l){const e=l.slice(),n=jt(e[0].file_url,e[0].sample_url,e[0].preview_url);return e[4]=n,e}function dt(l){let e,n,t,s;return{c(){e=S("img"),this.h()},l(o){e=I(o,"IMG",{src:!0,alt:!0,title:!0,class:!0}),this.h()},h(){ve(e.src,n=l[4].animated)||h(e,"src",n),h(e,"alt",t="[GIF] post #"+l[0].id),h(e,"title",s="[GIF] post #"+l[0].id),h(e,"class","svelte-1cjgn2p")},m(o,r){T(o,e,r)},p(o,r){r&1&&!ve(e.src,n=o[4].animated)&&h(e,"src",n),r&1&&t!==(t="[GIF] post #"+o[0].id)&&h(e,"alt",t),r&1&&s!==(s="[GIF] post #"+o[0].id)&&h(e,"title",s)},d(o){o&&$(e)}}}function mt(l){let e,n,t,s;return{c(){e=S("video"),this.h()},l(o){e=I(o,"VIDEO",{src:!0,poster:!0,title:!0,preload:!0,class:!0}),O(e).forEach($),this.h()},h(){ve(e.src,n=l[4].animated)||h(e,"src",n),h(e,"poster",t=l[4].static),e.loop=!0,h(e,"title",s="[VIDEO] post #"+l[0].id),e.controls=!0,h(e,"preload","metadata"),e.autoplay=!0,h(e,"class","svelte-1cjgn2p")},m(o,r){T(o,e,r),l[2](e)},p(o,r){r&1&&!ve(e.src,n=o[4].animated)&&h(e,"src",n),r&1&&t!==(t=o[4].static)&&h(e,"poster",t),r&1&&s!==(s="[VIDEO] post #"+o[0].id)&&h(e,"title",s)},d(o){o&&$(e),l[2](null)}}}function Wn(l){let e,n,t,s;return{c(){e=S("img"),this.h()},l(o){e=I(o,"IMG",{src:!0,alt:!0,title:!0,class:!0}),this.h()},h(){ve(e.src,n=l[0].sample_url)||h(e,"src",n),h(e,"alt",t="[IMAGE] post #"+l[0].id),h(e,"title",s="[IMAGE] post #"+l[0].id),h(e,"class","svelte-1cjgn2p")},m(o,r){T(o,e,r)},p(o,r){r&1&&!ve(e.src,n=o[0].sample_url)&&h(e,"src",n),r&1&&t!==(t="[IMAGE] post #"+o[0].id)&&h(e,"alt",t),r&1&&s!==(s="[IMAGE] post #"+o[0].id)&&h(e,"title",s)},d(o){o&&$(e)}}}function Kn(l){let e;function n(r,a){return r[0].type==="image"?Wn:r[0].type==="video"?mt:dt}function t(r,a){return a===mt?Hn(r):a===dt?Un(r):r}let s=n(l),o=s(t(l,s));return{c(){o.c(),e=we()},l(r){o.l(r),e=we()},m(r,a){o.m(r,a),T(r,e,a)},p(r,[a]){s===(s=n(r))&&o?o.p(t(r,s),a):(o.d(1),o=s(t(r,s)),o&&(o.c(),o.m(e.parentNode,e)))},i:Y,o:Y,d(r){r&&$(e),o.d(r)}}}function Yn(l,e,n){let{post:t}=e,s;const o=a=>{t.type==="video"&&s&&(a.key==="ArrowLeft"&&(a.preventDefault(),a.stopPropagation(),n(1,s.currentTime=Math.max(0,s.currentTime-5),s)),a.key==="ArrowRight"&&(a.preventDefault(),a.stopPropagation(),n(1,s.currentTime=Math.min(s.duration,s.currentTime+5),s)))};xe(()=>{s&&(Be==null||Be.observe(s)),document.addEventListener("keydown",o)}),et(()=>{s&&(Be==null||Be.unobserve(s)),document.removeEventListener("keydown",o)});function r(a){Se[a?"unshift":"push"](()=>{s=a,n(1,s)})}return l.$$set=a=>{"post"in a&&n(0,t=a.post)},[t,s,r]}class Zn extends de{constructor(e){super(),me(this,e,Yn,Kn,_e,{post:0})}}function Jn(l){let e,n,t;return{c(){e=S("img"),this.h()},l(s){e=I(s,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){ve(e.src,n=l[2])||h(e,"src",n),h(e,"alt",t="post #"+l[0].id),h(e,"class","svelte-itxz72"),Oe(e,"top",l[1])},m(s,o){T(s,e,o)},p(s,[o]){o&4&&!ve(e.src,n=s[2])&&h(e,"src",n),o&1&&t!==(t="post #"+s[0].id)&&h(e,"alt",t),o&2&&Oe(e,"top",s[1])},i:Y,o:Y,d(s){s&&$(e)}}}function Qn(l,e,n){let t,{post:s}=e,{offset:o}=e;return l.$$set=r=>{"post"in r&&n(0,s=r.post),"offset"in r&&n(1,o=r.offset)},l.$$.update=()=>{l.$$.dirty&1&&n(2,t=on(s.sample_url)?s.preview_url:s.sample_url)},[s,o,t]}class Wt extends de{constructor(e){super(),me(this,e,Qn,Jn,_e,{post:0,offset:1})}}function gt(l,e,n){const t=l.slice();return t[3]=e[n],t}function ht(l,e,n){const t=l.slice();return t[6]=e[n][0],t[7]=e[n][1],t}function $t(l){let e,n="•",t,s,o;return s=new zt({props:{source:l[0].source}}),{c(){e=S("span"),e.textContent=n,t=P(),V(s.$$.fragment)},l(r){e=I(r,"SPAN",{"data-svelte-h":!0}),fe(e)!=="svelte-7hh8jk"&&(e.textContent=n),t=N(r),A(s.$$.fragment,r)},m(r,a){T(r,e,a),T(r,t,a),R(s,r,a),o=!0},p(r,a){const i={};a&1&&(i.source=r[0].source),s.$set(i)},i(r){o||(b(s.$$.fragment,r),o=!0)},o(r){C(s.$$.fragment,r),o=!1},d(r){r&&($(e),$(t)),F(s,r)}}}function vt(l){let e,n=l[6]+"",t,s,o,r;return o=new pn({props:{tags:l[7]}}),{c(){e=S("h3"),t=oe(n),s=P(),V(o.$$.fragment),this.h()},l(a){e=I(a,"H3",{class:!0});var i=O(e);t=ie(i,n),i.forEach($),s=N(a),A(o.$$.fragment,a),this.h()},h(){h(e,"class","svelte-1kekodt")},m(a,i){T(a,e,i),m(e,t),T(a,s,i),R(o,a,i),r=!0},p(a,i){(!r||i&2)&&n!==(n=a[6]+"")&&Ve(t,n);const u={};i&2&&(u.tags=a[7]),o.$set(u)},i(a){r||(b(o.$$.fragment,a),r=!0)},o(a){C(o.$$.fragment,a),r=!1},d(a){a&&($(e),$(s)),F(o,a)}}}function Xn(l){return{c:Y,l:Y,m:Y,p:Y,i:Y,o:Y,d:Y}}function xn(l){let e,n,t,s;const o=[ts,es],r=[];function a(i,u){return i[2].length>0?0:1}return e=a(l),n=r[e]=o[e](l),{c(){n.c(),t=we()},l(i){n.l(i),t=we()},m(i,u){r[e].m(i,u),T(i,t,u),s=!0},p(i,u){let c=e;e=a(i),e===c?r[e].p(i,u):(ae(),C(r[c],1,1,()=>{r[c]=null}),ce(),n=r[e],n?n.p(i,u):(n=r[e]=o[e](i),n.c()),b(n,1),n.m(t.parentNode,t))},i(i){s||(b(n),s=!0)},o(i){C(n),s=!1},d(i){i&&$(t),r[e].d(i)}}}function es(l){let e,n="Comments for this post are not available";return{c(){e=S("span"),e.textContent=n,this.h()},l(t){e=I(t,"SPAN",{class:!0,"data-svelte-h":!0}),fe(e)!=="svelte-4t2lxe"&&(e.textContent=n),this.h()},h(){h(e,"class","no-comments svelte-1kekodt")},m(t,s){T(t,e,s)},p:Y,i:Y,o:Y,d(t){t&&$(e)}}}function ts(l){let e,n,t=ye(l[2]),s=[];for(let r=0;r<t.length;r+=1)s[r]=bt(gt(l,t,r));const o=r=>C(s[r],1,1,()=>{s[r]=null});return{c(){e=S("ul");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){e=I(r,"UL",{class:!0});var a=O(e);for(let i=0;i<s.length;i+=1)s[i].l(a);a.forEach($),this.h()},h(){h(e,"class","comments svelte-1kekodt")},m(r,a){T(r,e,a);for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(e,null);n=!0},p(r,a){if(a&1){t=ye(r[2]);let i;for(i=0;i<t.length;i+=1){const u=gt(r,t,i);s[i]?(s[i].p(u,a),b(s[i],1)):(s[i]=bt(u),s[i].c(),b(s[i],1),s[i].m(e,null))}for(ae(),i=t.length;i<s.length;i+=1)o(i);ce()}},i(r){if(!n){for(let a=0;a<t.length;a+=1)b(s[a]);n=!0}},o(r){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)C(s[a]);n=!1},d(r){r&&$(e),qe(s,r)}}}function bt(l){let e,n;return e=new _n({props:{comment:l[3]}}),{c(){V(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,s){R(e,t,s),n=!0},p(t,s){const o={};s&1&&(o.comment=t[3]),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){F(e,t)}}}function ns(l){let e,n;return e=new Ut({}),{c(){V(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,s){R(e,t,s),n=!0},p:Y,i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){F(e,t)}}}function ss(l){let e,n,t,s,o,r,a,i,u=l[0].id+"",c,_,g,y,w,E,k="•",d,p,f=l[0].type.toUpperCase()+"",v,Z,H,X="•",J,se,te,D,x="•",ne,U,q,le,L,B,Q,W="•",pe,ge,Ie,De,Pe,Ue,Ce,Ne,He="Comments",We,Re,j;y=new an({props:{value:l[0].rating}}),se=new cn({props:{value:l[0].score}}),U=new un({props:{value:l[0].change}}),L=new zt({props:{source:"https://rule34.xxx/index.php?page=post&s=view&id="+l[0].id}}),ge=new fn({props:{url:l[0].file_url}});let G=l[0].source&&$t(l),he=ye(Object.entries(l[1])),K=[];for(let z=0;z<he.length;z+=1)K[z]=vt(ht(l,he,z));const Te=z=>C(K[z],1,1,()=>{K[z]=null});let ee={ctx:l,current:null,token:null,hasCatch:!1,pending:ns,then:xn,catch:Xn,value:2,blocks:[,,,]};return ct(Re=it(l[0].id),ee),{c(){e=S("div"),n=S("img"),s=P(),o=S("h1"),r=oe("Post "),a=S("b"),i=oe("#"),c=oe(u),_=P(),g=S("div"),V(y.$$.fragment),w=P(),E=S("span"),E.textContent=k,d=P(),p=S("span"),v=oe(f),Z=P(),H=S("span"),H.textContent=X,J=P(),V(se.$$.fragment),te=P(),D=S("span"),D.textContent=x,ne=P(),V(U.$$.fragment),q=P(),le=S("div"),V(L.$$.fragment),B=P(),Q=S("span"),Q.textContent=W,pe=P(),V(ge.$$.fragment),Ie=P(),G&&G.c(),De=P(),Pe=S("div");for(let z=0;z<K.length;z+=1)K[z].c();Ue=P(),Ce=S("div"),Ne=S("h3"),Ne.textContent=He,We=P(),ee.block.c(),this.h()},l(z){e=I(z,"DIV",{class:!0});var M=O(e);n=I(M,"IMG",{class:!0,src:!0,alt:!0}),s=N(M),o=I(M,"H1",{class:!0});var be=O(o);r=ie(be,"Post "),a=I(be,"B",{});var Le=O(a);i=ie(Le,"#"),c=ie(Le,u),Le.forEach($),be.forEach($),_=N(M),g=I(M,"DIV",{class:!0});var ue=O(g);A(y.$$.fragment,ue),w=N(ue),E=I(ue,"SPAN",{"data-svelte-h":!0}),fe(E)!=="svelte-7hh8jk"&&(E.textContent=k),d=N(ue),p=I(ue,"SPAN",{});var Ke=O(p);v=ie(Ke,f),Ke.forEach($),Z=N(ue),H=I(ue,"SPAN",{"data-svelte-h":!0}),fe(H)!=="svelte-7hh8jk"&&(H.textContent=X),J=N(ue),A(se.$$.fragment,ue),te=N(ue),D=I(ue,"SPAN",{"data-svelte-h":!0}),fe(D)!=="svelte-7hh8jk"&&(D.textContent=x),ne=N(ue),A(U.$$.fragment,ue),ue.forEach($),q=N(M),le=I(M,"DIV",{class:!0});var Ee=O(le);A(L.$$.fragment,Ee),B=N(Ee),Q=I(Ee,"SPAN",{"data-svelte-h":!0}),fe(Q)!=="svelte-7hh8jk"&&(Q.textContent=W),pe=N(Ee),A(ge.$$.fragment,Ee),Ie=N(Ee),G&&G.l(Ee),Ee.forEach($),De=N(M),Pe=I(M,"DIV",{});var re=O(Pe);for(let rt=0;rt<K.length;rt+=1)K[rt].l(re);re.forEach($),Ue=N(M),Ce=I(M,"DIV",{});var Fe=O(Ce);Ne=I(Fe,"H3",{class:!0,"data-svelte-h":!0}),fe(Ne)!=="svelte-kc6sae"&&(Ne.textContent=He),We=N(Fe),ee.block.l(Fe),Fe.forEach($),M.forEach($),this.h()},h(){h(n,"class","preview svelte-1kekodt"),ve(n.src,t=l[0].sample_url)||h(n,"src",t),h(n,"alt","preview"),h(o,"class","svelte-1kekodt"),h(g,"class","flex-row svelte-1kekodt"),h(le,"class","flex-row svelte-1kekodt"),h(Ne,"class","svelte-1kekodt"),h(e,"class","details svelte-1kekodt")},m(z,M){T(z,e,M),m(e,n),m(e,s),m(e,o),m(o,r),m(o,a),m(a,i),m(a,c),m(e,_),m(e,g),R(y,g,null),m(g,w),m(g,E),m(g,d),m(g,p),m(p,v),m(g,Z),m(g,H),m(g,J),R(se,g,null),m(g,te),m(g,D),m(g,ne),R(U,g,null),m(e,q),m(e,le),R(L,le,null),m(le,B),m(le,Q),m(le,pe),R(ge,le,null),m(le,Ie),G&&G.m(le,null),m(e,De),m(e,Pe);for(let be=0;be<K.length;be+=1)K[be]&&K[be].m(Pe,null);m(e,Ue),m(e,Ce),m(Ce,Ne),m(Ce,We),ee.block.m(Ce,ee.anchor=null),ee.mount=()=>Ce,ee.anchor=null,j=!0},p(z,[M]){l=z,(!j||M&1&&!ve(n.src,t=l[0].sample_url))&&h(n,"src",t),(!j||M&1)&&u!==(u=l[0].id+"")&&Ve(c,u);const be={};M&1&&(be.value=l[0].rating),y.$set(be),(!j||M&1)&&f!==(f=l[0].type.toUpperCase()+"")&&Ve(v,f);const Le={};M&1&&(Le.value=l[0].score),se.$set(Le);const ue={};M&1&&(ue.value=l[0].change),U.$set(ue);const Ke={};M&1&&(Ke.source="https://rule34.xxx/index.php?page=post&s=view&id="+l[0].id),L.$set(Ke);const Ee={};if(M&1&&(Ee.url=l[0].file_url),ge.$set(Ee),l[0].source?G?(G.p(l,M),M&1&&b(G,1)):(G=$t(l),G.c(),b(G,1),G.m(le,null)):G&&(ae(),C(G,1,1,()=>{G=null}),ce()),M&2){he=ye(Object.entries(l[1]));let re;for(re=0;re<he.length;re+=1){const Fe=ht(l,he,re);K[re]?(K[re].p(Fe,M),b(K[re],1)):(K[re]=vt(Fe),K[re].c(),b(K[re],1),K[re].m(Pe,null))}for(ae(),re=he.length;re<K.length;re+=1)Te(re);ce()}ee.ctx=l,M&1&&Re!==(Re=it(l[0].id))&&ct(Re,ee)||$n(ee,l,M)},i(z){if(!j){b(y.$$.fragment,z),b(se.$$.fragment,z),b(U.$$.fragment,z),b(L.$$.fragment,z),b(ge.$$.fragment,z),b(G);for(let M=0;M<he.length;M+=1)b(K[M]);b(ee.block),j=!0}},o(z){C(y.$$.fragment,z),C(se.$$.fragment,z),C(U.$$.fragment,z),C(L.$$.fragment,z),C(ge.$$.fragment,z),C(G),K=K.filter(Boolean);for(let M=0;M<K.length;M+=1)C(K[M]);for(let M=0;M<3;M+=1){const be=ee.blocks[M];C(be)}j=!1},d(z){z&&$(e),F(y),F(se),F(U),F(L),F(ge),G&&G.d(),qe(K,z),ee.block.d(),ee.token=null,ee=null}}}function ls(l,e,n){let t,{post:s}=e;return l.$$set=o=>{"post"in o&&n(0,s=o.post)},l.$$.update=()=>{l.$$.dirty&1&&n(1,t=s.tags.reduce((o,r)=>(o[r.type]===void 0&&(o[r.type]=[]),o[r.type].push(r),o),{}))},[s,t]}class rs extends de{constructor(e){super(),me(this,e,ls,ss,_e,{post:0})}}function kt(l,e,n){const t=l.slice();return t[17]=e[n],t[19]=n,t}function wt(l){let e,n;return e=new Wt({props:{post:l[3],offset:l[6]}}),{c(){V(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,s){R(e,t,s),n=!0},p(t,s){const o={};s&8&&(o.post=t[3]),s&64&&(o.offset=t[6]),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){F(e,t)}}}function yt(l){let e,n;return e=new Wt({props:{post:l[4],offset:l[7]}}),{c(){V(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,s){R(e,t,s),n=!0},p(t,s){const o={};s&16&&(o.post=t[4]),s&128&&(o.offset=t[7]),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){F(e,t)}}}function Ct(l){let e,n=`${l[19]*100}vh`;return{c(){e=S("div"),this.h()},l(t){e=I(t,"DIV",{class:!0}),O(e).forEach($),this.h()},h(){h(e,"class","pseudo snap-item svelte-3khu3"),Oe(e,"top",n)},m(t,s){T(t,e,s)},p:Y,d(t){t&&$(e)}}}function os(l){let e,n,t,s,o,r,a,i,u,c,_,g,y,w=l[3]&&wt(l);s=new Zn({props:{post:l[2]}}),r=new rs({props:{post:l[2]}});let E=l[4]&&yt(l),k=ye({length:l[8].posts.length}),d=[];for(let p=0;p<k.length;p+=1)d[p]=Ct(kt(l,k,p));return c=new Ht({props:{rootMargin:window.innerHeight*2+"px"}}),c.$on("intersection",l[13]),{c(){e=S("div"),w&&w.c(),n=P(),t=S("div"),V(s.$$.fragment),o=P(),V(r.$$.fragment),a=P(),E&&E.c(),i=P();for(let p=0;p<d.length;p+=1)d[p].c();u=P(),V(c.$$.fragment),this.h()},l(p){e=I(p,"DIV",{class:!0});var f=O(e);w&&w.l(f),n=N(f),t=I(f,"DIV",{class:!0});var v=O(t);A(s.$$.fragment,v),o=N(v),A(r.$$.fragment,v),v.forEach($),a=N(f),E&&E.l(f),i=N(f);for(let Z=0;Z<d.length;Z+=1)d[Z].l(f);u=N(f),A(c.$$.fragment,f),f.forEach($),this.h()},h(){h(t,"class","screen snap-container horizontal current svelte-3khu3"),Oe(t,"top",l[5]),h(e,"class","root screen snap-container svelte-3khu3")},m(p,f){T(p,e,f),w&&w.m(e,null),m(e,n),m(e,t),R(s,t,null),m(t,o),R(r,t,null),l[12](t),m(e,a),E&&E.m(e,null),m(e,i);for(let v=0;v<d.length;v+=1)d[v]&&d[v].m(e,null);m(e,u),R(c,e,null),l[14](e),_=!0,g||(y=ke(e,"scroll",l[10]),g=!0)},p(p,[f]){p[3]?w?(w.p(p,f),f&8&&b(w,1)):(w=wt(p),w.c(),b(w,1),w.m(e,n)):w&&(ae(),C(w,1,1,()=>{w=null}),ce());const v={};f&4&&(v.post=p[2]),s.$set(v);const Z={};if(f&4&&(Z.post=p[2]),r.$set(Z),f&32&&Oe(t,"top",p[5]),p[4]?E?(E.p(p,f),f&16&&b(E,1)):(E=yt(p),E.c(),b(E,1),E.m(e,i)):E&&(ae(),C(E,1,1,()=>{E=null}),ce()),f&256){k=ye({length:p[8].posts.length});let H;for(H=0;H<k.length;H+=1){const X=kt(p,k,H);d[H]?d[H].p(X,f):(d[H]=Ct(X),d[H].c(),d[H].m(e,u))}for(;H<d.length;H+=1)d[H].d(1);d.length=k.length}},i(p){_||(b(w),b(s.$$.fragment,p),b(r.$$.fragment,p),b(E),b(c.$$.fragment,p),_=!0)},o(p){C(w),C(s.$$.fragment,p),C(r.$$.fragment,p),C(E),C(c.$$.fragment,p),_=!1},d(p){p&&$(e),w&&w.d(),F(s),F(r),l[12](null),E&&E.d(),qe(d,p),F(c),l[14](null),g=!1,y()}}}function is(l,e,n){let t;$e(l,je,v=>n(8,t=v));let{index:s}=e,o,r,a=t.posts[s],i=s>0?t.posts[s-1]:void 0,u=s<t.posts.length-1?t.posts[s+1]:void 0,c=`${s*100}vh`,_=`${(s-1)*100}vh`,g=`${(s+1)*100}vh`;const y=Ae(),w=()=>{r&&(r.scrollIntoView(),n(1,r.scrollLeft=0,r))},E=v=>{const Z=v.target,H=Z.getBoundingClientRect().height,X=Z.scrollTop/H,J=Math.round(X);J!=s&&requestAnimationFrame(()=>{n(11,s=J),n(2,a=t.posts[s]),n(3,i=s>0?t.posts[s-1]:void 0),n(4,u=s<t.posts.length-1?t.posts[s+1]:void 0),n(5,c=`${s*100}vh`),n(6,_=`${(s-1)*100}vh`),n(7,g=`${(s+1)*100}vh`),r&&n(1,r.scrollLeft=0,r)})},k=v=>{v.key==="d"&&(v.preventDefault(),v.stopPropagation(),r.scrollLeft===0?r.scrollBy({left:o.clientWidth,top:0,behavior:"smooth"}):r.scrollBy({left:-o.clientWidth,top:0,behavior:"smooth"})),v.key==="ArrowUp"&&(v.preventDefault(),v.stopPropagation(),o.scrollTo({left:0,top:o.clientHeight*(s-1),behavior:"smooth"})),v.key==="ArrowDown"&&(v.preventDefault(),v.stopPropagation(),o.scrollTo({left:0,top:o.clientHeight*(s+1),behavior:"smooth"}))};xe(()=>{document.addEventListener("keydown",k),w()}),et(()=>{console.log("scroller destroy"),document.removeEventListener("keydown",k)});function d(v){Se[v?"unshift":"push"](()=>{r=v,n(1,r)})}const p=()=>y("endreached");function f(v){Se[v?"unshift":"push"](()=>{o=v,n(0,o)})}return l.$$set=v=>{"index"in v&&n(11,s=v.index)},l.$$.update=()=>{l.$$.dirty&2048&&console.log("scroll index",s)},[o,r,a,i,u,c,_,g,t,y,E,s,d,p,f]}class as extends de{constructor(e){super(),me(this,e,is,os,_e,{index:11})}}function cs(l){let e;return{c(){e=S("i"),this.h()},l(n){e=I(n,"I",{class:!0}),O(e).forEach($),this.h()},h(){h(e,"class","codicon codicon-close")},m(n,t){T(n,e,t)},p:Y,d(n){n&&$(e)}}}function us(l){let e,n,t,s,o;function r(i){l[2](i)}let a={};return l[0]!==void 0&&(a.index=l[0]),e=new as({props:a}),Se.push(()=>Ze(e,"index",r)),e.$on("endreached",l[3]),s=new Gt({props:{class:"button-close",$$slots:{default:[cs]},$$scope:{ctx:l}}}),s.$on("click",l[1]),{c(){V(e.$$.fragment),t=P(),V(s.$$.fragment)},l(i){A(e.$$.fragment,i),t=N(i),A(s.$$.fragment,i)},m(i,u){R(e,i,u),T(i,t,u),R(s,i,u),o=!0},p(i,u){const c={};!n&&u&1&&(n=!0,c.index=i[0],Ye(()=>n=!1)),e.$set(c);const _={};u&128&&(_.$$scope={dirty:u,ctx:i}),s.$set(_)},i(i){o||(b(e.$$.fragment,i),b(s.$$.fragment,i),o=!0)},o(i){C(e.$$.fragment,i),C(s.$$.fragment,i),o=!1},d(i){i&&$(t),F(e,i),F(s,i)}}}function fs(l){let e,n;return e=new jn({props:{$$slots:{default:[us]},$$scope:{ctx:l}}}),e.$on("close",l[1]),{c(){V(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,s){R(e,t,s),n=!0},p(t,[s]){const o={};s&129&&(o.$$scope={dirty:s,ctx:t}),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){F(e,t)}}}function ps(l,e,n){let{index:t}=e;const s=Ae(),o=()=>{console.log("close dispatch"),s("close",t)},r=c=>{c.key==="f"&&(console.log("key close"),c.preventDefault(),c.stopPropagation(),o())},a=()=>{location.hash===""&&(console.log("hash close"),o())};xe(()=>{console.log("fs mount"),window.addEventListener("hashchange",a),document.addEventListener("keydown",r)}),et(()=>{console.log("fs destroy"),window.removeEventListener("hashchange",a),document.removeEventListener("keydown",r)});function i(c){t=c,n(0,t)}function u(c){nt.call(this,l,c)}return l.$$set=c=>{"index"in c&&n(0,t=c.index)},l.$$.update=()=>{l.$$.dirty&1&&console.log("post index:",t)},[t,o,i,u]}class _s extends de{constructor(e){super(),me(this,e,ps,fs,_e,{index:0})}}function Et(l){let e,n=l[0].type==="video"?"▶":"GIF",t;return{c(){e=S("span"),t=oe(n),this.h()},l(s){e=I(s,"SPAN",{class:!0});var o=O(e);t=ie(o,n),o.forEach($),this.h()},h(){h(e,"class","type svelte-1213alg")},m(s,o){T(s,e,o),m(e,t)},p(s,o){o&1&&n!==(n=s[0].type==="video"?"▶":"GIF")&&Ve(t,n)},d(s){s&&$(e)}}}function ds(l){let e,n,t,s,o,r=Qe(l[0].score)+"",a,i,u,c,_,g=l[0].type!=="image"&&Et(l);return{c(){e=S("div"),n=S("img"),s=P(),o=S("span"),a=oe(r),i=P(),g&&g.c(),this.h()},l(y){e=I(y,"DIV",{id:!0,class:!0,style:!0});var w=O(e);n=I(w,"IMG",{src:!0,alt:!0,class:!0,tabindex:!0,loading:!0}),s=N(w),o=I(w,"SPAN",{class:!0});var E=O(o);a=ie(E,r),E.forEach($),i=N(w),g&&g.l(w),w.forEach($),this.h()},h(){ve(n.src,t=l[1])||h(n,"src",t),h(n,"alt","post"),h(n,"class","post-media svelte-1213alg"),h(n,"tabindex","-1"),h(n,"loading","lazy"),h(o,"class","score svelte-1213alg"),h(e,"id",u=Xe(l[0].id)),h(e,"class","post svelte-1213alg"),Oe(e,"grid-row","span "+l[2]),st(e,"open",open)},m(y,w){T(y,e,w),m(e,n),m(e,s),m(e,o),m(o,a),m(e,i),g&&g.m(e,null),c||(_=[ke(e,"click",l[3]),ke(e,"keydown",l[4])],c=!0)},p(y,[w]){w&2&&!ve(n.src,t=y[1])&&h(n,"src",t),w&1&&r!==(r=Qe(y[0].score)+"")&&Ve(a,r),y[0].type!=="image"?g?g.p(y,w):(g=Et(y),g.c(),g.m(e,null)):g&&(g.d(1),g=null),w&1&&u!==(u=Xe(y[0].id))&&h(e,"id",u),w&0&&st(e,"open",open)},i:Y,o:Y,d(y){y&&$(e),g&&g.d(),c=!1,lt(_)}}}let St=3;function ms(l,e,n){let t,{post:s}=e,o=Math.min(Math.round(s.height/s.width)*St,St*3);const r=u=>u.endsWith(".jpg")||u.endsWith(".jpeg")||u.endsWith(".png")||u.endsWith(".webp");function a(u){nt.call(this,l,u)}const i=u=>{var c;(qt(u)||u.key==="f")&&((c=u.target)==null||c.click())};return l.$$set=u=>{"post"in u&&n(0,s=u.post)},l.$$.update=()=>{l.$$.dirty&1&&n(1,t=r(s.sample_url)?s.sample_url:s.preview_url)},[s,t,o,a,i]}class gs extends de{constructor(e){super(),me(this,e,ms,ds,_e,{post:0})}}function hs(l){const e=l.slice(),n=jt(e[1].file_url,e[1].sample_url,e[1].preview_url);return e[7]=n,e}function $s(l){let e,n;return e=new mn({props:{post:l[1]}}),e.$on("click",l[4]),{c(){V(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,s){R(e,t,s),n=!0},p(t,s){const o={};s&2&&(o.post=t[1]),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){F(e,t)}}}function vs(l){let e,n;return e=new gn({props:{src:l[7].animated,poster:l[7].static,width:l[1].width,height:l[1].height,loop:l[2]||at(l[1].tags)}}),e.$on("click",l[4]),{c(){V(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,s){R(e,t,s),n=!0},p(t,s){const o={};s&2&&(o.src=t[7].animated),s&2&&(o.poster=t[7].static),s&2&&(o.width=t[1].width),s&2&&(o.height=t[1].height),s&6&&(o.loop=t[2]||at(t[1].tags)),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){F(e,t)}}}function bs(l){let e,n;return e=new hn({props:{post:l[1],open:l[0]}}),e.$on("click",l[4]),{c(){V(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,s){R(e,t,s),n=!0},p(t,s){const o={};s&2&&(o.post=t[1]),s&1&&(o.open=t[0]),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){F(e,t)}}}function ks(l){let e;return{c(){e=S("i"),this.h()},l(n){e=I(n,"I",{class:!0}),O(e).forEach($),this.h()},h(){h(e,"class","codicon codicon-screen-full")},m(n,t){T(n,e,t)},p:Y,d(n){n&&$(e)}}}function It(l){let e,n;return e=new dn({props:{post:l[1]}}),{c(){V(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,s){R(e,t,s),n=!0},p(t,s){const o={};s&2&&(o.post=t[1]),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){F(e,t)}}}function ws(l){let e,n,t,s,o,r,a,i,u,c;const _=[bs,vs,$s],g=[];function y(k,d){return k[1].type==="image"?0:k[1].type==="video"?1:2}function w(k,d){return d===1?hs(k):k}n=y(l),t=g[n]=_[n](w(l,n)),o=new Gt({props:{class:"button-fullscreen","aria-label":"Enter Fullscreen mode",$$slots:{default:[ks]},$$scope:{ctx:l}}}),o.$on("click",l[5]);let E=l[0]&&It(l);return{c(){e=S("div"),t.c(),s=P(),V(o.$$.fragment),r=P(),E&&E.c(),this.h()},l(k){e=I(k,"DIV",{id:!0,class:!0});var d=O(e);t.l(d),s=N(d),A(o.$$.fragment,d),r=N(d),E&&E.l(d),d.forEach($),this.h()},h(){h(e,"id",a=Xe(l[1].id)),h(e,"class","post svelte-pwgq1f"),st(e,"open",l[0])},m(k,d){T(k,e,d),g[n].m(e,null),m(e,s),R(o,e,null),m(e,r),E&&E.m(e,null),i=!0,u||(c=ke(e,"keydown",l[6]),u=!0)},p(k,[d]){let p=n;n=y(k),n===p?g[n].p(w(k,n),d):(ae(),C(g[p],1,1,()=>{g[p]=null}),ce(),t=g[n],t?t.p(w(k,n),d):(t=g[n]=_[n](w(k,n)),t.c()),b(t,1),t.m(e,s));const f={};d&256&&(f.$$scope={dirty:d,ctx:k}),o.$set(f),k[0]?E?(E.p(k,d),d&1&&b(E,1)):(E=It(k),E.c(),b(E,1),E.m(e,null)):E&&(ae(),C(E,1,1,()=>{E=null}),ce()),(!i||d&2&&a!==(a=Xe(k[1].id)))&&h(e,"id",a),(!i||d&1)&&st(e,"open",k[0])},i(k){i||(b(t),b(o.$$.fragment,k),b(E),i=!0)},o(k){C(t),C(o.$$.fragment,k),C(E),i=!1},d(k){k&&$(e),g[n].d(),F(o),E&&E.d(),u=!1,c()}}}function ys(l,e,n){let t;$e(l,vn,c=>n(2,t=c));const s=Ae(),o=()=>n(0,a=!a);let{post:r}=e,{open:a=!1}=e;const i=()=>s("fullscreen"),u=c=>{c.key==="f"&&s("fullscreen")};return l.$$set=c=>{"post"in c&&n(1,r=c.post),"open"in c&&n(0,a=c.open)},[a,r,t,s,o,i,u]}class Cs extends de{constructor(e){super(),me(this,e,ys,ws,_e,{post:1,open:0})}}function Dt(l){let e,n;return e=new Mt({props:{$$slots:{default:[Is]},$$scope:{ctx:l}}}),e.$on("close",l[7]),{c(){V(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,s){R(e,t,s),n=!0},p(t,s){const o={};s&65543&&(o.$$scope={dirty:s,ctx:t}),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){F(e,t)}}}function Es(l){let e;return{c(){e=oe("Done")},l(n){e=ie(n,"Done")},m(n,t){T(n,e,t)},d(n){n&&$(e)}}}function Ss(l){let e;return{c(){e=oe("Reset")},l(n){e=ie(n,"Reset")},m(n,t){T(n,e,t)},d(n){n&&$(e)}}}function Is(l){let e,n,t="Sorting and Filtering",s,o,r,a="Sorting",i,u,c,_,g,y,w,E,k,d,p="Filtering by Score",f,v,Z,H,X,J,se,te,D,x="Filtering by Rating",ne,U,q,le,L,B,Q,W,pe,ge,Ie;function De(j){l[10](j)}let Pe={options:Ns};l[1].direction!==void 0&&(Pe.value=l[1].direction),c=new ln({props:Pe}),Se.push(()=>Ze(c,"value",De));function Ue(j){l[11](j)}let Ce={options:Ps};l[1].property!==void 0&&(Ce.value=l[1].property),y=new ut({props:Ce}),Se.push(()=>Ze(y,"value",Ue));function Ne(j){l[12](j)}let He={options:Ts};l[2].scoreComparator!==void 0&&(He.value=l[2].scoreComparator),Z=new bn({props:He}),Se.push(()=>Ze(Z,"value",Ne));function We(j){l[14](j)}let Re={options:Kt};return l[2].rating!==void 0&&(Re.value=l[2].rating),q=new ut({props:Re}),Se.push(()=>Ze(q,"value",We)),B=new Je({props:{title:"Return to searching.",$$slots:{default:[Es]},$$scope:{ctx:l}}}),B.$on("click",l[7]),W=new Je({props:{title:"Reset sort and filter.",type:"secondary",$$slots:{default:[Ss]},$$scope:{ctx:l}}}),W.$on("click",l[9]),{c(){e=S("div"),n=S("h3"),n.textContent=t,s=P(),o=S("div"),r=S("b"),r.textContent=a,i=P(),u=S("div"),V(c.$$.fragment),g=P(),V(y.$$.fragment),E=P(),k=S("div"),d=S("b"),d.textContent=p,f=P(),v=S("div"),V(Z.$$.fragment),X=P(),J=S("input"),se=P(),te=S("div"),D=S("b"),D.textContent=x,ne=P(),U=S("div"),V(q.$$.fragment),L=P(),V(B.$$.fragment),Q=P(),V(W.$$.fragment),this.h()},l(j){e=I(j,"DIV",{class:!0});var G=O(e);n=I(G,"H3",{"data-svelte-h":!0}),fe(n)!=="svelte-15zouq3"&&(n.textContent=t),s=N(G),o=I(G,"DIV",{});var he=O(o);r=I(he,"B",{class:!0,"data-svelte-h":!0}),fe(r)!=="svelte-ekzpgg"&&(r.textContent=a),i=N(he),u=I(he,"DIV",{class:!0});var K=O(u);A(c.$$.fragment,K),g=N(K),A(y.$$.fragment,K),K.forEach($),he.forEach($),E=N(G),k=I(G,"DIV",{});var Te=O(k);d=I(Te,"B",{class:!0,"data-svelte-h":!0}),fe(d)!=="svelte-1flca3"&&(d.textContent=p),f=N(Te),v=I(Te,"DIV",{class:!0});var ee=O(v);A(Z.$$.fragment,ee),X=N(ee),J=I(ee,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),ee.forEach($),Te.forEach($),se=N(G),te=I(G,"DIV",{});var z=O(te);D=I(z,"B",{class:!0,"data-svelte-h":!0}),fe(D)!=="svelte-1evbw58"&&(D.textContent=x),ne=N(z),U=I(z,"DIV",{class:!0});var M=O(U);A(q.$$.fragment,M),M.forEach($),z.forEach($),L=N(G),A(B.$$.fragment,G),Q=N(G),A(W.$$.fragment,G),G.forEach($),this.h()},h(){h(r,"class","svelte-4dh9db"),h(u,"class","row svelte-4dh9db"),h(d,"class","svelte-4dh9db"),h(J,"type","number"),h(J,"min",0),h(J,"max",1e5),h(J,"step",1),h(J,"class","svelte-4dh9db"),h(v,"class","row svelte-4dh9db"),h(D,"class","svelte-4dh9db"),h(U,"class","row svelte-4dh9db"),h(e,"class","container svelte-4dh9db")},m(j,G){T(j,e,G),m(e,n),m(e,s),m(e,o),m(o,r),m(o,i),m(o,u),R(c,u,null),m(u,g),R(y,u,null),m(e,E),m(e,k),m(k,d),m(k,f),m(k,v),R(Z,v,null),m(v,X),m(v,J),Ge(J,l[0]),m(e,se),m(e,te),m(te,D),m(te,ne),m(te,U),R(q,U,null),m(e,L),R(B,e,null),m(e,Q),R(W,e,null),pe=!0,ge||(Ie=[ke(J,"input",l[13]),ke(J,"keyup",l[8])],ge=!0)},p(j,G){const he={};!_&&G&2&&(_=!0,he.value=j[1].direction,Ye(()=>_=!1)),c.$set(he);const K={};!w&&G&2&&(w=!0,K.value=j[1].property,Ye(()=>w=!1)),y.$set(K);const Te={};!H&&G&4&&(H=!0,Te.value=j[2].scoreComparator,Ye(()=>H=!1)),Z.$set(Te),G&1&&Ft(J.value)!==j[0]&&Ge(J,j[0]);const ee={};!le&&G&4&&(le=!0,ee.value=j[2].rating,Ye(()=>le=!1)),q.$set(ee);const z={};G&65536&&(z.$$scope={dirty:G,ctx:j}),B.$set(z);const M={};G&65536&&(M.$$scope={dirty:G,ctx:j}),W.$set(M)},i(j){pe||(b(c.$$.fragment,j),b(y.$$.fragment,j),b(Z.$$.fragment,j),b(q.$$.fragment,j),b(B.$$.fragment,j),b(W.$$.fragment,j),pe=!0)},o(j){C(c.$$.fragment,j),C(y.$$.fragment,j),C(Z.$$.fragment,j),C(q.$$.fragment,j),C(B.$$.fragment,j),C(W.$$.fragment,j),pe=!1},d(j){j&&$(e),F(c),F(y),F(Z),F(q),F(B),F(W),ge=!1,lt(Ie)}}}function Ds(l){let e,n,t,s,o,r,a,i,u,c,_,g,y,w,E,k=l[3]&&Dt(l);return{c(){e=S("button"),n=S("i"),t=P(),s=S("span"),o=oe(l[5]),r=P(),a=S("i"),i=P(),u=S("span"),c=oe(l[4]),_=P(),k&&k.c(),g=we(),this.h()},l(d){e=I(d,"BUTTON",{class:!0});var p=O(e);n=I(p,"I",{class:!0}),O(n).forEach($),t=N(p),s=I(p,"SPAN",{});var f=O(s);o=ie(f,l[5]),f.forEach($),r=N(p),a=I(p,"I",{class:!0}),O(a).forEach($),i=N(p),u=I(p,"SPAN",{});var v=O(u);c=ie(v,l[4]),v.forEach($),p.forEach($),_=N(d),k&&k.l(d),g=we(),this.h()},h(){h(n,"class","codicon codicon-filter svelte-4dh9db"),h(a,"class","codicon codicon-arrow-swap svelte-4dh9db"),h(e,"class","svelte-4dh9db")},m(d,p){T(d,e,p),m(e,n),m(e,t),m(e,s),m(s,o),m(e,r),m(e,a),m(e,i),m(e,u),m(u,c),T(d,_,p),k&&k.m(d,p),T(d,g,p),y=!0,w||(E=ke(e,"click",l[6]),w=!0)},p(d,[p]){(!y||p&32)&&Ve(o,d[5]),(!y||p&16)&&Ve(c,d[4]),d[3]?k?(k.p(d,p),p&8&&b(k,1)):(k=Dt(d),k.c(),b(k,1),k.m(g.parentNode,g)):k&&(ae(),C(k,1,1,()=>{k=null}),ce())},i(d){y||(b(k),y=!0)},o(d){C(k),y=!1},d(d){d&&($(e),$(_),$(g)),k&&k.d(d),w=!1,E()}}}const Ps=Object.freeze({id:"Uploaded",score:"Score",updated:"Updated",random:"Random"}),Ns=Object.freeze({desc:"codicon codicon-arrow-down",asc:"codicon codicon-arrow-up"}),Ts=Object.freeze({">=":"≥","<=":"≤"}),Kt=Object.freeze({all:"All",safe:"Safe",questionable:"Questionable",explicit:"Explicit"}),Os=Object.freeze({id:{asc:"Oldest",desc:"Newest"},score:{asc:"Worst",desc:"Best"},updated:{asc:"Inactive",desc:"Active"},random:{asc:"Random",desc:"Random"}}),Vs=(l,e,n)=>{let t=l==="all"?void 0:Kt[l],s=e===0&&n===">="?void 0:`Score${n}${Qe(e)}`;return[t,s].filter(o=>o!==void 0).join(",")||"All"};function As(l,e,n){let t,s,o,r;$e(l,ze,f=>n(1,o=f)),$e(l,Me,f=>n(2,r=f));const a=Ae();let i=!1;const u=()=>n(3,i=!0),c=()=>{n(3,i=!1),a("sortfilterupdate")},_=f=>{var v;return qt(f)&&((v=f.target)==null?void 0:v.blur())},g=()=>{ze.reset(),Me.reset(),n(0,y=r.scoreValue)};let y;function w(f){l.$$.not_equal(o.direction,f)&&(o.direction=f,ze.set(o))}function E(f){l.$$.not_equal(o.property,f)&&(o.property=f,ze.set(o))}function k(f){l.$$.not_equal(r.scoreComparator,f)&&(r.scoreComparator=f,Me.set(r))}function d(){y=Ft(this.value),n(0,y),n(2,r)}function p(f){l.$$.not_equal(r.rating,f)&&(r.rating=f,Me.set(r))}return l.$$.update=()=>{if(l.$$.dirty&5){y===void 0&&n(0,y=r.scoreValue);let f=Number(y);isNaN(f)||xt(Me,r.scoreValue=f,r)}l.$$.dirty&4&&n(5,t=Vs(r.rating,r.scoreValue,r.scoreComparator)),l.$$.dirty&2&&n(4,s=Os[o.property][o.direction])},[y,o,r,i,s,t,u,c,_,g,w,E,k,d,p]}class Rs extends de{constructor(e){super(),me(this,e,As,Ds,_e,{})}}function Pt(l,e,n){const t=l.slice();return t[8]=e[n],t[10]=n,t}function Nt(l,e,n){const t=l.slice();return t[8]=e[n],t[10]=n,t}function Fs(l){let e,n,t=ye(l[1].posts),s=[];for(let r=0;r<t.length;r+=1)s[r]=Tt(Pt(l,t,r));const o=r=>C(s[r],1,1,()=>{s[r]=null});return{c(){e=S("section");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){e=I(r,"SECTION",{class:!0,style:!0});var a=O(e);for(let i=0;i<s.length;i+=1)s[i].l(a);a.forEach($),this.h()},h(){h(e,"class","multi-column svelte-wypqh"),Oe(e,"grid-template-columns","repeat("+l[2]+", 1fr)")},m(r,a){T(r,e,a);for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(e,null);n=!0},p(r,a){if(a&3){t=ye(r[1].posts);let i;for(i=0;i<t.length;i+=1){const u=Pt(r,t,i);s[i]?(s[i].p(u,a),b(s[i],1)):(s[i]=Tt(u),s[i].c(),b(s[i],1),s[i].m(e,null))}for(ae(),i=t.length;i<s.length;i+=1)o(i);ce()}(!n||a&4)&&Oe(e,"grid-template-columns","repeat("+r[2]+", 1fr)")},i(r){if(!n){for(let a=0;a<t.length;a+=1)b(s[a]);n=!0}},o(r){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)C(s[a]);n=!1},d(r){r&&$(e),qe(s,r)}}}function Ms(l){let e,n,t=ye(l[1].posts),s=[];for(let r=0;r<t.length;r+=1)s[r]=Ot(Nt(l,t,r));const o=r=>C(s[r],1,1,()=>{s[r]=null});return{c(){e=S("section");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){e=I(r,"SECTION",{class:!0});var a=O(e);for(let i=0;i<s.length;i+=1)s[i].l(a);a.forEach($),this.h()},h(){h(e,"class","single-column svelte-wypqh")},m(r,a){T(r,e,a);for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(e,null);n=!0},p(r,a){if(a&3){t=ye(r[1].posts);let i;for(i=0;i<t.length;i+=1){const u=Nt(r,t,i);s[i]?(s[i].p(u,a),b(s[i],1)):(s[i]=Ot(u),s[i].c(),b(s[i],1),s[i].m(e,null))}for(ae(),i=t.length;i<s.length;i+=1)o(i);ce()}},i(r){if(!n){for(let a=0;a<t.length;a+=1)b(s[a]);n=!0}},o(r){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)C(s[a]);n=!1},d(r){r&&$(e),qe(s,r)}}}function Tt(l){let e,n;function t(){return l[6](l[10])}return e=new gs({props:{post:l[8]}}),e.$on("click",t),{c(){V(e.$$.fragment)},l(s){A(e.$$.fragment,s)},m(s,o){R(e,s,o),n=!0},p(s,o){l=s;const r={};o&2&&(r.post=l[8]),e.$set(r)},i(s){n||(b(e.$$.fragment,s),n=!0)},o(s){C(e.$$.fragment,s),n=!1},d(s){F(e,s)}}}function Ot(l){let e,n;function t(){return l[5](l[10])}return e=new Cs({props:{post:l[8]}}),e.$on("fullscreen",t),{c(){V(e.$$.fragment)},l(s){A(e.$$.fragment,s)},m(s,o){R(e,s,o),n=!0},p(s,o){l=s;const r={};o&2&&(r.post=l[8]),e.$set(r)},i(s){n||(b(e.$$.fragment,s),n=!0)},o(s){C(e.$$.fragment,s),n=!1},d(s){F(e,s)}}}function Vt(l){let e,n;return e=new _s({props:{index:l[0]}}),e.$on("close",l[3]),e.$on("endreached",l[7]),{c(){V(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,s){R(e,t,s),n=!0},p(t,s){const o={};s&1&&(o.index=t[0]),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){F(e,t)}}}function Ls(l){let e,n,t=Qe(l[1].postCount)+"",s,o,r,a,i,u,c,_,g,y;a=new Rs({}),a.$on("sortfilterupdate",l[4]);const w=[Ms,Fs],E=[];function k(p,f){return p[2]==="1"?0:1}u=k(l),c=E[u]=w[u](l);let d=l[0]!==void 0&&l[0]!==null&&Vt(l);return{c(){e=S("div"),n=S("span"),s=oe(t),o=oe(" posts"),r=P(),V(a.$$.fragment),i=P(),c.c(),_=P(),d&&d.c(),g=we(),this.h()},l(p){e=I(p,"DIV",{class:!0});var f=O(e);n=I(f,"SPAN",{});var v=O(n);s=ie(v,t),o=ie(v," posts"),v.forEach($),r=N(f),A(a.$$.fragment,f),f.forEach($),i=N(p),c.l(p),_=N(p),d&&d.l(p),g=we(),this.h()},h(){h(e,"class","svelte-wypqh")},m(p,f){T(p,e,f),m(e,n),m(n,s),m(n,o),m(e,r),R(a,e,null),T(p,i,f),E[u].m(p,f),T(p,_,f),d&&d.m(p,f),T(p,g,f),y=!0},p(p,[f]){(!y||f&2)&&t!==(t=Qe(p[1].postCount)+"")&&Ve(s,t);let v=u;u=k(p),u===v?E[u].p(p,f):(ae(),C(E[v],1,1,()=>{E[v]=null}),ce(),c=E[u],c?c.p(p,f):(c=E[u]=w[u](p),c.c()),b(c,1),c.m(_.parentNode,_)),p[0]!==void 0&&p[0]!==null?d?(d.p(p,f),f&1&&b(d,1)):(d=Vt(p),d.c(),b(d,1),d.m(g.parentNode,g)):d&&(ae(),C(d,1,1,()=>{d=null}),ce())},i(p){y||(b(a.$$.fragment,p),b(c),b(d),y=!0)},o(p){C(a.$$.fragment,p),C(c),C(d),y=!1},d(p){p&&($(e),$(i),$(_),$(g)),F(a),E[u].d(p),d&&d.d(p)}}}function Bs(l,e,n){let t,s;$e(l,je,_=>n(1,t=_)),$e(l,Lt,_=>n(2,s=_));let o;const r=_=>{var w;console.log("exit");const g=t.posts[_.detail],y=Xe(g.id);(w=document.getElementById(y))==null||w.scrollIntoView(),n(0,o=void 0)};function a(_){nt.call(this,l,_)}const i=_=>{console.log("index",_),n(0,o=_)},u=_=>{n(0,o=_)};function c(_){nt.call(this,l,_)}return l.$$.update=()=>{l.$$.dirty&1&&(o!==void 0?location.hash="fullscreen":location.hash=""),l.$$.dirty&1&&console.log("fs index:",o)},[o,t,s,r,a,i,u,c]}class Gs extends de{constructor(e){super(),me(this,e,Bs,Ls,_e,{})}}function js(l){let e;return{c(){e=oe("Reset Filter")},l(n){e=ie(n,"Reset Filter")},m(n,t){T(n,e,t)},d(n){n&&$(e)}}}function zs(l){let e,n,t,s,o="We couldn't find any posts matching your tags. Sorry...",r,a,i;return a=new Je({props:{title:"In case your filter caused all posts to vanish. Reset it.",$$slots:{default:[js]},$$scope:{ctx:l}}}),a.$on("click",l[1]),{c(){e=S("img"),t=P(),s=S("p"),s.textContent=o,r=P(),V(a.$$.fragment),this.h()},l(u){e=I(u,"IMG",{src:!0,alt:!0,class:!0}),t=N(u),s=I(u,"P",{"data-svelte-h":!0}),fe(s)!=="svelte-1utxj3w"&&(s.textContent=o),r=N(u),A(a.$$.fragment,u),this.h()},h(){ve(e.src,n=Bt+"/assets/shironeko-confused.png")||h(e,"src",n),h(e,"alt","Nothing here..."),h(e,"class","svelte-1bb5e7g")},m(u,c){T(u,e,c),T(u,t,c),T(u,s,c),T(u,r,c),R(a,u,c),i=!0},p(u,[c]){const _={};c&4&&(_.$$scope={dirty:c,ctx:u}),a.$set(_)},i(u){i||(b(a.$$.fragment,u),i=!0)},o(u){C(a.$$.fragment,u),i=!1},d(u){u&&($(e),$(t),$(s),$(r)),F(a,u)}}}function qs(l){const e=Ae();return[e,()=>{ze.reset(),Me.reset(),e("sortfilterupdate")}]}class Us extends de{constructor(e){super(),me(this,e,qs,zs,_e,{})}}function Hs(l){let e;return{c(){e=oe("Search")},l(n){e=ie(n,"Search")},m(n,t){T(n,e,t)},d(n){n&&$(e)}}}function Ws(l){let e,n,t,s,o,r;const a=[Js,Zs],i=[];function u(c,_){return c[3].postCount===0?0:1}return n=u(l),t=i[n]=a[n](l),o=new yn({}),{c(){e=S("section"),t.c(),s=P(),V(o.$$.fragment),this.h()},l(c){e=I(c,"SECTION",{class:!0});var _=O(e);t.l(_),_.forEach($),s=N(c),A(o.$$.fragment,c),this.h()},h(){h(e,"class","svelte-1muglpt")},m(c,_){T(c,e,_),i[n].m(e,null),T(c,s,_),R(o,c,_),r=!0},p(c,_){let g=n;n=u(c),n===g?i[n].p(c,_):(ae(),C(i[g],1,1,()=>{i[g]=null}),ce(),t=i[n],t?t.p(c,_):(t=i[n]=a[n](c),t.c()),b(t,1),t.m(e,null))},i(c){r||(b(t),b(o.$$.fragment,c),r=!0)},o(c){C(t),C(o.$$.fragment,c),r=!1},d(c){c&&($(e),$(s)),i[n].d(),F(o,c)}}}function Ks(l){let e,n;return e=new Rn({props:{error:l[1]}}),{c(){V(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,s){R(e,t,s),n=!0},p(t,s){const o={};s&2&&(o.error=t[1]),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){F(e,t)}}}function Ys(l){let e,n;return e=new Ut({}),{c(){V(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,s){R(e,t,s),n=!0},p:Y,i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){F(e,t)}}}function Zs(l){let e,n,t,s,o,r;e=new Gs({}),e.$on("sortfilterupdate",l[9]),e.$on("endreached",l[10]);const a=[Xs,Qs],i=[];function u(c,_){return c[3].posts.length===c[3].postCount?0:1}return t=u(l),s=i[t]=a[t](l),{c(){V(e.$$.fragment),n=P(),s.c(),o=we()},l(c){A(e.$$.fragment,c),n=N(c),s.l(c),o=we()},m(c,_){R(e,c,_),T(c,n,_),i[t].m(c,_),T(c,o,_),r=!0},p(c,_){let g=t;t=u(c),t===g?i[t].p(c,_):(ae(),C(i[g],1,1,()=>{i[g]=null}),ce(),s=i[t],s?s.p(c,_):(s=i[t]=a[t](c),s.c()),b(s,1),s.m(o.parentNode,o))},i(c){r||(b(e.$$.fragment,c),b(s),r=!0)},o(c){C(e.$$.fragment,c),C(s),r=!1},d(c){c&&($(n),$(o)),F(e,c),i[t].d(c)}}}function Js(l){let e,n;return e=new Us({}),e.$on("sortfilterupdate",l[9]),{c(){V(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,s){R(e,t,s),n=!0},p:Y,i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){F(e,t)}}}function Qs(l){let e,n;return e=new Ht({props:{rootMargin:1e3/Number(l[7])+"px"}}),e.$on("intersection",l[10]),{c(){V(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,s){R(e,t,s),n=!0},p(t,s){const o={};s&128&&(o.rootMargin=1e3/Number(t[7])+"px"),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){F(e,t)}}}function Xs(l){let e,n;return e=new Mn({}),{c(){V(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,s){R(e,t,s),n=!0},p:Y,i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){F(e,t)}}}function At(l){let e,n;return e=new On({props:{tags:l[5]}}),e.$on("close",l[15]),e.$on("submit",l[16]),{c(){V(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,s){R(e,t,s),n=!0},p(t,s){const o={};s&32&&(o.tags=t[5]),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){F(e,t)}}}function xs(l){let e,n,t,s,o,r,a,i,u,c,_,g,y,w;n=new tn({}),s=new kn({props:{placeholder:"Search for tags",fetchSuggestions:l[8]}}),s.$on("pick",l[11]),r=new Je({props:{title:"Search with the tags above",$$slots:{default:[Hs]},$$scope:{ctx:l}}}),r.$on("click",l[9]),i=new nn({props:{tags:[...l[5],...l[4]]}}),i.$on("click",l[12]),i.$on("contextmenu",l[13]),i.$on("createSupertag",l[14]);const E=[Ys,Ks,Ws],k=[];function d(f,v){return f[0]?0:f[1]?1:f[3].requested?2:-1}~(c=d(l))&&(_=k[c]=E[c](l));let p=l[2]&&At(l);return{c(){e=S("section"),V(n.$$.fragment),t=P(),V(s.$$.fragment),o=P(),V(r.$$.fragment),a=P(),V(i.$$.fragment),u=P(),_&&_.c(),g=P(),p&&p.c(),y=we(),this.h()},l(f){e=I(f,"SECTION",{id:!0,class:!0});var v=O(e);A(n.$$.fragment,v),t=N(v),A(s.$$.fragment,v),o=N(v),A(r.$$.fragment,v),a=N(v),A(i.$$.fragment,v),v.forEach($),u=N(f),_&&_.l(f),g=N(f),p&&p.l(f),y=we(),this.h()},h(){h(e,"id","search"),h(e,"class","svelte-1muglpt")},m(f,v){T(f,e,v),R(n,e,null),m(e,t),R(s,e,null),m(e,o),R(r,e,null),m(e,a),R(i,e,null),T(f,u,v),~c&&k[c].m(f,v),T(f,g,v),p&&p.m(f,v),T(f,y,v),w=!0},p(f,[v]){const Z={};v&16777216&&(Z.$$scope={dirty:v,ctx:f}),r.$set(Z);const H={};v&48&&(H.tags=[...f[5],...f[4]]),i.$set(H);let X=c;c=d(f),c===X?~c&&k[c].p(f,v):(_&&(ae(),C(k[X],1,1,()=>{k[X]=null}),ce()),~c?(_=k[c],_?_.p(f,v):(_=k[c]=E[c](f),_.c()),b(_,1),_.m(g.parentNode,g)):_=null),f[2]?p?(p.p(f,v),v&4&&b(p,1)):(p=At(f),p.c(),b(p,1),p.m(y.parentNode,y)):p&&(ae(),C(p,1,1,()=>{p=null}),ce())},i(f){w||(b(n.$$.fragment,f),b(s.$$.fragment,f),b(r.$$.fragment,f),b(i.$$.fragment,f),b(_),b(p),w=!0)},o(f){C(n.$$.fragment,f),C(s.$$.fragment,f),C(r.$$.fragment,f),C(i.$$.fragment,f),C(_),C(p),w=!1},d(f){f&&($(e),$(u),$(g),$(y)),F(n),F(s),F(r),F(i),~c&&k[c].d(f),p&&p.d(f)}}}function el(l,e,n){let t,s,o,r,a,i,u,c;$e(l,je,D=>n(3,t=D)),$e(l,ot,D=>n(4,s=D)),$e(l,Me,D=>n(18,o=D)),$e(l,ze,D=>n(19,r=D)),$e(l,In,D=>n(20,a=D)),$e(l,tt,D=>n(5,i=D)),$e(l,ft,D=>n(6,u=D)),$e(l,Lt,D=>n(7,c=D));let _=!1,g,y=!1,w=0;const E=async D=>{const x=await Cn(D);return[...u.items.filter(({name:U})=>U.toLowerCase().includes(D.toLowerCase())).map(U=>({label:U.name,count:U.tags.length,type:"supertag"})),...x]},k=()=>new sn().withPid(t.pageCount).withTags(i).withBlockedContent(a).withSortProperty(r.property).withSortDirection(r.direction).withScoreValue(o.scoreValue).withScoreComparator(o.scoreComparator).withRating(o.rating).withSupertags(s),d=async D=>{if(!_){n(1,g=void 0),n(0,_=!0);try{const x=t.pageCount;await D(),Sn(x).catch(()=>{})}catch(x){n(1,g=x),console.warn(x)}finally{n(0,_=!1)}}},p=async()=>{je.reset(),w=0,d(async()=>{const[D,x]=await k().getPageAndCount();je.addPage(D,x)})},f=async()=>{d(async()=>{const D=await k().getPage();je.addPage(D)})},v=D=>{var x,ne;if((D.key==="/"||D.key==="s")&&(!document.activeElement||document.activeElement===document.body)&&((x=document.getElementById("searchbar"))==null||x.focus(),D.preventDefault(),D.stopPropagation()),D.ctrlKey&&D.key==="Enter"&&(D.preventDefault(),D.stopPropagation(),p()),D.ctrlKey&&D.key==="m"&&((ne=document.getElementById("select-modifier"))==null||ne.click()),D.ctrlKey&&D.key==="ArrowDown"){const U=document.getElementsByClassName("post-media");U[w].focus(),w=Math.min(w+1,Math.max(0,U.length-1))}D.ctrlKey&&D.key==="ArrowUp"&&(document.getElementsByClassName("post-media")[w].focus(),w=Math.max(w-1,0))};return xe(async()=>{document.addEventListener("keydown",v)}),et(()=>{document.removeEventListener("keydown",v)}),[_,g,y,t,s,i,u,c,E,p,f,async D=>{const x=D.detail;if(x.type==="supertag"){const ne=u.items.find(U=>U.name===x.label);if(!ne){console.warn("Supertag not present.");return}ot.addOrReplace(ne)}else{const ne=await En(D.detail.label);tt.addOrReplace({name:D.detail.label,modifier:D.detail.modifier,count:D.detail.count,type:(ne==null?void 0:ne.type)??"tag"})}},D=>"description"in D.detail?ot.removeByName(D.detail.name):tt.removeByName(D.detail.name),D=>{"description"in D.detail||(D.detail.modifier=wn(D.detail.modifier),tt.addOrReplace(D.detail))},()=>n(2,y=!0),()=>n(2,y=!1),D=>ft.add(D.detail)]}class Cl extends de{constructor(e){super(),me(this,e,el,xs,_e,{})}}export{Cl as component};
