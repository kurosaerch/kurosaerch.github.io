import{s as ae,p as me,F as Pe,G as Be,f as S,a as P,g as C,h as V,x as pe,c as L,d,j as _,i as F,u as m,H as He,I as ee,J as Qe,K as ze,l as oe,m as ie,r as on,v as Y,L as Ee,M as ut,o as tt,N as nt,A as an,C as cn,D as un,E as fn,n as Ie,O as et,P as Fe,Q as pn,R as _n,e as Oe,y as fe,S as dn,k as Ne,B as ye,z as gn,T as mn,w as hn}from"../chunks/scheduler.1035f4ff.js";import{S as ce,i as ue,f as Le,b as O,d as B,m as M,a as k,t as y,e as q,g as _e,c as de}from"../chunks/index.3951bfda.js";import{g as $n}from"../chunks/globals.7f7f1b26.js";import{L as vn}from"../chunks/LynxMain.4d965acc.js";import{e as Se}from"../chunks/each.e59479a4.js";import{D as Ut,r as Ht,a as Gt}from"../chunks/result-columns-store.028c9b31.js";import{T as Je}from"../chunks/TextButton.e25370de.js";import{D as bn}from"../chunks/DetailedTag.7b8b5301.js";import{K as kn,A as wn}from"../chunks/ActiveTagList.c01701f3.js";import{b as Wt}from"../chunks/paths.2bb44eaa.js";import{r as We,a as ft}from"../chunks/active-supertags-store.c3bb4335.js";import{I as Kt,R as yn}from"../chunks/ModifierSelect.d69460e6.js";import{R as En,S as Jt,a as Qt,E as Yt,b as Sn,C as Zt,P as Xt,g as xt,r as Cn,c as In,i as Dn,d as Tn,G as Pn,V as Ln,e as gt,I as Nn}from"../chunks/Gif.17bce3ef.js";import{h as mt,u as Fn}from"../chunks/await_block.6f145430.js";import{a as en,b as Rn,o as jn,N as An}from"../chunks/NumberInput.d8b7cfc4.js";import{L as _t}from"../chunks/LoadingAnimation.b232475b.js";import{h as Vn,i as On,a as Bn}from"../chunks/always-loop-store.e8e34688.js";import{p as Mn,S as qn,b as zn,a as Un}from"../chunks/store-keys.11aeb373.js";import{f as Ve}from"../chunks/format-tag.7e313273.js";import{i as Hn,g as Gn,a as Wn}from"../chunks/tags.49324235.js";import{s as Ke,f as Ue,S as Kn}from"../chunks/search-builder.f8de6a08.js";import{a as it}from"../chunks/active-tags-store.2960ef0a.js";import{S as Jn}from"../chunks/Searchbar.82af68e9.js";import{S as Qn}from"../chunks/ScrollUpButton.932fa20e.js";import{l as Yn}from"../chunks/analytics.b280da65.js";import{n as Zn,s as ht}from"../chunks/supertags-store.07ff45b9.js";import{b as Xn}from"../chunks/blocked-content-store.a612fab3.js";import{S as xn}from"../chunks/Select.9dc7031d.js";import{R as el}from"../chunks/RotatingTextSelect.60ab88d1.js";function $t(l,e,n){const t=l.slice();return t[11]=e[n],t}function vt(l){let e,n;return e=new bn({props:{tag:l[11]}}),{c(){O(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p(t,s){const o={};s&8&&(o.tag=t[11]),e.$set(o)},i(t){n||(k(e.$$.fragment,t),n=!0)},o(t){y(e.$$.fragment,t),n=!1},d(t){q(e,t)}}}function tl(l){let e;return{c(){e=oe("Create supertag")},l(n){e=ie(n,"Create supertag")},m(n,t){F(n,e,t)},d(n){n&&d(e)}}}function nl(l){let e,n,t="Create Supertag",s,o,r,a,i,u="Name",c,f,p,h,g,v="Description",$,I,R,N,w,z="Tags",A,H,b,D,j,E,Z,T,U=Se(l[3]),W=[];for(let J=0;J<U.length;J+=1)W[J]=vt($t(l,U,J));const re=J=>y(W[J],1,1,()=>{W[J]=null});return j=new Je({props:{title:l[4]?"Click to create supertag":"Enter a valid name to continue",disabled:!l[4],$$slots:{default:[tl]},$$scope:{ctx:l}}}),j.$on("click",l[9]),{c(){e=S("section"),n=S("h3"),n.textContent=t,s=P(),o=S("button"),r=P(),a=S("div"),i=S("label"),i.textContent=u,c=P(),f=S("input"),p=P(),h=S("div"),g=S("label"),g.textContent=v,$=P(),I=S("input"),R=P(),N=S("div"),w=S("span"),w.textContent=z,A=P(),H=S("ol");for(let J=0;J<W.length;J+=1)W[J].c();b=P(),D=S("div"),O(j.$$.fragment),this.h()},l(J){e=C(J,"SECTION",{class:!0});var K=V(e);n=C(K,"H3",{"data-svelte-h":!0}),pe(n)!=="svelte-ho1cwx"&&(n.textContent=t),s=L(K),o=C(K,"BUTTON",{type:!0,class:!0}),V(o).forEach(d),r=L(K),a=C(K,"DIV",{class:!0});var te=V(a);i=C(te,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),pe(i)!=="svelte-10k8a68"&&(i.textContent=u),c=L(te),f=C(te,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),te.forEach(d),p=L(K),h=C(K,"DIV",{class:!0});var x=V(h);g=C(x,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),pe(g)!=="svelte-14n9kp6"&&(g.textContent=v),$=L(x),I=C(x,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),x.forEach(d),R=L(K),N=C(K,"DIV",{class:!0});var he=V(N);w=C(he,"SPAN",{class:!0,"data-svelte-h":!0}),pe(w)!=="svelte-7hjyox"&&(w.textContent=z),A=L(he),H=C(he,"OL",{class:!0});var Ce=V(H);for(let De=0;De<W.length;De+=1)W[De].l(Ce);Ce.forEach(d),he.forEach(d),b=L(K),D=C(K,"DIV",{class:!0});var Me=V(D);B(j.$$.fragment,Me),Me.forEach(d),K.forEach(d),this.h()},h(){_(o,"type","button"),_(o,"class","codicon codicon-close svelte-1x6vc81"),_(i,"for","supertag-name"),_(i,"class","svelte-1x6vc81"),_(f,"type","text"),_(f,"placeholder","Descriptive name"),_(f,"id","supertag-name"),_(f,"class","svelte-1x6vc81"),_(a,"class","svelte-1x6vc81"),_(g,"for","supertag-description"),_(g,"class","svelte-1x6vc81"),_(I,"type","text"),_(I,"placeholder","Short description"),_(I,"id","supertag-description"),_(I,"class","svelte-1x6vc81"),_(h,"class","svelte-1x6vc81"),_(w,"class","svelte-1x6vc81"),_(H,"class","svelte-1x6vc81"),_(N,"class","svelte-1x6vc81"),_(D,"class","last svelte-1x6vc81"),_(e,"class","svelte-1x6vc81")},m(J,K){F(J,e,K),m(e,n),m(e,s),m(e,o),m(e,r),m(e,a),m(a,i),m(a,c),m(a,f),He(f,l[0]),m(e,p),m(e,h),m(h,g),m(h,$),m(h,I),He(I,l[2]),m(e,R),m(e,N),m(N,w),m(N,A),m(N,H);for(let te=0;te<W.length;te+=1)W[te]&&W[te].m(H,null);m(e,b),m(e,D),M(j,D,null),E=!0,Z||(T=[ee(o,"click",l[6]),ee(f,"input",l[7]),ee(I,"input",l[8])],Z=!0)},p(J,K){if(K&1&&f.value!==J[0]&&He(f,J[0]),K&4&&I.value!==J[2]&&He(I,J[2]),K&8){U=Se(J[3]);let x;for(x=0;x<U.length;x+=1){const he=$t(J,U,x);W[x]?(W[x].p(he,K),k(W[x],1)):(W[x]=vt(he),W[x].c(),k(W[x],1),W[x].m(H,null))}for(_e(),x=U.length;x<W.length;x+=1)re(x);de()}const te={};K&16&&(te.title=J[4]?"Click to create supertag":"Enter a valid name to continue"),K&16&&(te.disabled=!J[4]),K&16384&&(te.$$scope={dirty:K,ctx:J}),j.$set(te)},i(J){if(!E){for(let K=0;K<U.length;K+=1)k(W[K]);k(j.$$.fragment,J),E=!0}},o(J){W=W.filter(Boolean);for(let K=0;K<W.length;K+=1)y(W[K]);y(j.$$.fragment,J),E=!1},d(J){J&&d(e),Qe(W,J),q(j),Z=!1,ze(T)}}}function ll(l){let e,n,t;function s(r){l[10](r)}let o={$$slots:{default:[nl]},$$scope:{ctx:l}};return l[1]!==void 0&&(o.dialog=l[1]),e=new Ut({props:o}),me.push(()=>Le(e,"dialog",s)),e.$on("close",l[6]),{c(){O(e.$$.fragment)},l(r){B(e.$$.fragment,r)},m(r,a){M(e,r,a),t=!0},p(r,[a]){const i={};a&16413&&(i.$$scope={dirty:a,ctx:r}),!n&&a&2&&(n=!0,i.dialog=r[1],Pe(()=>n=!1)),e.$set(i)},i(r){t||(k(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){q(e,r)}}}function sl(l,e,n){let t,{dialog:s}=e,{name:o=""}=e,{description:r=""}=e,{tags:a}=e;const i=Be(),u=()=>s.close();function c(){o=this.value,n(0,o)}function f(){r=this.value,n(2,r)}const p=()=>{i("submit",{name:o,description:r,tags:a.map(({modifier:g,name:v})=>({modifier:g,name:v}))}),u()};function h(g){s=g,n(1,s)}return l.$$set=g=>{"dialog"in g&&n(1,s=g.dialog),"name"in g&&n(0,o=g.name),"description"in g&&n(2,r=g.description),"tags"in g&&n(3,a=g.tags)},l.$$.update=()=>{l.$$.dirty&9&&n(4,t=typeof o=="string"&&o!==""&&a.length>1)},[o,s,r,a,t,i,u,c,f,p,h]}class rl extends ce{constructor(e){super(),ue(this,e,sl,ll,ae,{dialog:1,name:0,description:2,tags:3})}}function ol(l){let e,n,t,s,o,r,a,i,u,c;return{c(){e=S("div"),n=S("div"),t=S("i"),s=P(),o=S("div"),r=S("h3"),a=oe(l[0]),i=P(),u=S("span"),c=oe(l[2]),this.h()},l(f){e=C(f,"DIV",{class:!0});var p=V(e);n=C(p,"DIV",{class:!0});var h=V(n);t=C(h,"I",{class:!0}),V(t).forEach(d),h.forEach(d),s=L(p),o=C(p,"DIV",{});var g=V(o);r=C(g,"H3",{class:!0});var v=V(r);a=ie(v,l[0]),v.forEach(d),i=L(g),u=C(g,"SPAN",{});var $=V(u);c=ie($,l[2]),$.forEach(d),g.forEach(d),p.forEach(d),this.h()},h(){_(t,"class",on(l[1])+" svelte-1yohziu"),_(n,"class","icon svelte-1yohziu"),_(r,"class","svelte-1yohziu"),_(e,"class","error svelte-1yohziu")},m(f,p){F(f,e,p),m(e,n),m(n,t),m(e,s),m(e,o),m(o,r),m(r,a),m(o,i),m(o,u),m(u,c)},p:Y,i:Y,o:Y,d(f){f&&d(e)}}}function il(l,e,n){let{error:t}=e,s=t.message==="Failed to fetch"?"Connection Error":"Application Error",o=t.message==="Failed to fetch"?"codicon codicon-debug-disconnect":"codicon codicon-error",r=t.message==="Failed to fetch"?"Failed to connect to the server. Make sure you have a stable internet connection.":t.message;return l.$$set=a=>{"error"in a&&n(3,t=a.error)},[s,o,r,t]}class al extends ce{constructor(e){super(),ue(this,e,il,ol,ae,{error:3})}}function cl(l){let e,n,t,s,o="You have seen everything there is to see...";return{c(){e=S("img"),t=P(),s=S("p"),s.textContent=o,this.h()},l(r){e=C(r,"IMG",{src:!0,alt:!0,class:!0}),t=L(r),s=C(r,"P",{"data-svelte-h":!0}),pe(s)!=="svelte-1i75mtf"&&(s.textContent=o),this.h()},h(){Ee(e.src,n=Wt+"/assets/shironeko-x.png")||_(e,"src",n),_(e,"alt","No more results to load"),_(e,"class","svelte-1pkma0d")},m(r,a){F(r,e,a),F(r,t,a),F(r,s,a)},p:Y,i:Y,o:Y,d(r){r&&(d(e),d(t),d(s))}}}class ul extends ce{constructor(e){super(),ue(this,e,null,cl,ae,{})}}const at=l=>`post_${l}`;function bt(l){let e;const n=l[4].default,t=an(n,l,l[3],null);return{c(){t&&t.c()},l(s){t&&t.l(s)},m(s,o){t&&t.m(s,o),e=!0},p(s,o){t&&t.p&&(!e||o&8)&&cn(t,n,s,s[3],e?fn(n,s[3],o,null):un(s[3]),null)},i(s){e||(k(t,s),e=!0)},o(s){y(t,s),e=!1},d(s){t&&t.d(s)}}}function fl(l){let e,n,t,s,o=l[1]&&bt(l);return{c(){e=S("div"),o&&o.c(),this.h()},l(r){e=C(r,"DIV",{role:!0,tabindex:!0,class:!0});var a=V(e);o&&o.l(a),a.forEach(d),this.h()},h(){_(e,"role","none"),_(e,"tabindex","-1"),_(e,"class","svelte-6sy8qz")},m(r,a){F(r,e,a),o&&o.m(e,null),l[5](e),n=!0,t||(s=[ee(e,"click",ut(pl)),ee(e,"keydown",l[2])],t=!0)},p(r,[a]){r[1]?o?(o.p(r,a),a&2&&k(o,1)):(o=bt(r),o.c(),k(o,1),o.m(e,null)):o&&(_e(),y(o,1,1,()=>{o=null}),de())},i(r){n||(k(o),n=!0)},o(r){y(o),n=!1},d(r){r&&d(e),o&&o.d(),l[5](null),t=!1,ze(s)}}}const pl=()=>{};function _l(l,e,n){let{$$slots:t={},$$scope:s}=e;const o=Be(),r=()=>o("close"),a=p=>{p.key==="Escape"&&r()},i=()=>{document.fullscreenElement||r()};let u,c=!1;tt(async()=>{u.focus(),document.addEventListener("fullscreenchange",i);try{await u.requestFullscreen()}catch{}n(1,c=!0)}),nt(async()=>{document.removeEventListener("fullscreenchange",i);try{await document.exitFullscreen()}catch{}});function f(p){me[p?"unshift":"push"](()=>{u=p,n(0,u)})}return l.$$set=p=>{"$$scope"in p&&n(3,s=p.$$scope)},[u,c,a,s,t,f]}class dl extends ce{constructor(e){super(),ue(this,e,_l,fl,ae,{})}}function gl(l){let e,n;return{c(){e=S("div"),this.h()},l(t){e=C(t,"DIV",{style:!0}),V(e).forEach(d),this.h()},h(){_(e,"style",n=l[0]?`position:absolute;top:${l[0]};`:void 0)},m(t,s){F(t,e,s),l[3](e)},p(t,[s]){s&1&&n!==(n=t[0]?`position:absolute;top:${t[0]};`:void 0)&&_(e,"style",n)},i:Y,o:Y,d(t){t&&d(e),l[3](null)}}}function ml(l,e,n){let{rootMargin:t}=e,{absoluteTop:s}=e;const o=Be(),r=new IntersectionObserver(u=>{u[0].isIntersecting&&o("intersection")},{rootMargin:t});let a;function i(u){me[u?"unshift":"push"](()=>{a=u,n(1,a)})}return l.$$set=u=>{"rootMargin"in u&&n(2,t=u.rootMargin),"absoluteTop"in u&&n(0,s=u.absoluteTop)},l.$$.update=()=>{l.$$.dirty&2&&(r.disconnect(),a&&r.observe(a))},[s,a,t,i]}class tn extends ce{constructor(e){super(),ue(this,e,ml,gl,ae,{rootMargin:2,absoluteTop:0})}}function hl(l){let e,n;return{c(){e=S("a"),n=oe("Open"),this.h()},l(t){e=C(t,"A",{href:!0,target:!0,class:!0});var s=V(e);n=ie(s,"Open"),s.forEach(d),this.h()},h(){_(e,"href",l[0]),_(e,"target","_newtab"),_(e,"class","codicon codicon-link-external svelte-10flxu9")},m(t,s){F(t,e,s),m(e,n)},p(t,[s]){s&1&&_(e,"href",t[0])},i:Y,o:Y,d(t){t&&d(e)}}}function $l(l,e,n){let{url:t}=e;return l.$$set=s=>{"url"in s&&n(0,t=s.url)},[t]}class vl extends ce{constructor(e){super(),ue(this,e,$l,hl,ae,{url:0})}}function kt(l,e,n){const t=l.slice();return t[4]=e[n][0],t[5]=e[n][1],t}function wt(l){let e,n="•",t,s,o;return s=new Yt({props:{source:l[0].source}}),{c(){e=S("span"),e.textContent=n,t=P(),O(s.$$.fragment)},l(r){e=C(r,"SPAN",{"data-svelte-h":!0}),pe(e)!=="svelte-7hh8jk"&&(e.textContent=n),t=L(r),B(s.$$.fragment,r)},m(r,a){F(r,e,a),F(r,t,a),M(s,r,a),o=!0},p(r,a){const i={};a&1&&(i.source=r[0].source),s.$set(i)},i(r){o||(k(s.$$.fragment,r),o=!0)},o(r){y(s.$$.fragment,r),o=!1},d(r){r&&(d(e),d(t)),q(s,r)}}}function yt(l){let e,n=l[4]+"",t,s,o,r;return o=new Xt({props:{tags:l[5]}}),{c(){e=S("h3"),t=oe(n),s=P(),O(o.$$.fragment),this.h()},l(a){e=C(a,"H3",{class:!0});var i=V(e);t=ie(i,n),i.forEach(d),s=L(a),B(o.$$.fragment,a),this.h()},h(){_(e,"class","svelte-1tsjp7g")},m(a,i){F(a,e,i),m(e,t),F(a,s,i),M(o,a,i),r=!0},p(a,i){(!r||i&2)&&n!==(n=a[4]+"")&&Ie(t,n);const u={};i&2&&(u.tags=a[5]),o.$set(u)},i(a){r||(k(o.$$.fragment,a),r=!0)},o(a){y(o.$$.fragment,a),r=!1},d(a){a&&(d(e),d(s)),q(o,a)}}}function bl(l){let e,n,t,s,o,r,a,i,u=l[0].id+"",c,f,p,h,g,v,$="•",I,R,N=l[0].type.toUpperCase()+"",w,z,A,H="•",b,D,j,E,Z="•",T,U,W,re,J,K,te,x="•",he,Ce,Me,De,lt="•",st,Re,rt,Ye,Te,Ge,Q,le="Comments",je,$e,ve;h=new En({props:{value:l[0].rating}}),D=new Jt({props:{value:l[0].score}}),U=new Qt({props:{value:l[0].change}}),J=new vl({props:{url:"/post?id="+l[0].id+"&src="+encodeURIComponent(l[3])}}),Ce=new Yt({props:{source:"https://rule34.xxx/index.php?page=post&s=view&id="+l[0].id}}),Re=new Sn({props:{url:l[3]}});let ne=l[0].source&&wt(l),be=Se(Object.entries(l[1])),se=[];for(let G=0;G<be.length;G+=1)se[G]=yt(kt(l,be,G));const ct=G=>y(se[G],1,1,()=>{se[G]=null});return $e=new Zt({props:{post:l[0]}}),{c(){e=S("div"),n=S("img"),s=P(),o=S("h1"),r=oe("Post "),a=S("b"),i=oe("#"),c=oe(u),f=P(),p=S("div"),O(h.$$.fragment),g=P(),v=S("span"),v.textContent=$,I=P(),R=S("span"),w=oe(N),z=P(),A=S("span"),A.textContent=H,b=P(),O(D.$$.fragment),j=P(),E=S("span"),E.textContent=Z,T=P(),O(U.$$.fragment),W=P(),re=S("div"),O(J.$$.fragment),K=P(),te=S("span"),te.textContent=x,he=P(),O(Ce.$$.fragment),Me=P(),De=S("span"),De.textContent=lt,st=P(),O(Re.$$.fragment),rt=P(),ne&&ne.c(),Ye=P(),Te=S("div");for(let G=0;G<se.length;G+=1)se[G].c();Ge=P(),Q=S("h3"),Q.textContent=le,je=P(),O($e.$$.fragment),this.h()},l(G){e=C(G,"DIV",{class:!0});var X=V(e);n=C(X,"IMG",{class:!0,src:!0,alt:!0}),s=L(X),o=C(X,"H1",{class:!0});var Ae=V(o);r=ie(Ae,"Post "),a=C(Ae,"B",{});var Ze=V(a);i=ie(Ze,"#"),c=ie(Ze,u),Ze.forEach(d),Ae.forEach(d),f=L(X),p=C(X,"DIV",{class:!0});var ge=V(p);B(h.$$.fragment,ge),g=L(ge),v=C(ge,"SPAN",{"data-svelte-h":!0}),pe(v)!=="svelte-7hh8jk"&&(v.textContent=$),I=L(ge),R=C(ge,"SPAN",{});var ot=V(R);w=ie(ot,N),ot.forEach(d),z=L(ge),A=C(ge,"SPAN",{"data-svelte-h":!0}),pe(A)!=="svelte-7hh8jk"&&(A.textContent=H),b=L(ge),B(D.$$.fragment,ge),j=L(ge),E=C(ge,"SPAN",{"data-svelte-h":!0}),pe(E)!=="svelte-7hh8jk"&&(E.textContent=Z),T=L(ge),B(U.$$.fragment,ge),ge.forEach(d),W=L(X),re=C(X,"DIV",{class:!0});var ke=V(re);B(J.$$.fragment,ke),K=L(ke),te=C(ke,"SPAN",{"data-svelte-h":!0}),pe(te)!=="svelte-7hh8jk"&&(te.textContent=x),he=L(ke),B(Ce.$$.fragment,ke),Me=L(ke),De=C(ke,"SPAN",{"data-svelte-h":!0}),pe(De)!=="svelte-7hh8jk"&&(De.textContent=lt),st=L(ke),B(Re.$$.fragment,ke),rt=L(ke),ne&&ne.l(ke),ke.forEach(d),Ye=L(X),Te=C(X,"DIV",{});var qe=V(Te);for(let Xe=0;Xe<se.length;Xe+=1)se[Xe].l(qe);Ge=L(qe),Q=C(qe,"H3",{class:!0,"data-svelte-h":!0}),pe(Q)!=="svelte-kc6sae"&&(Q.textContent=le),je=L(qe),B($e.$$.fragment,qe),qe.forEach(d),X.forEach(d),this.h()},h(){_(n,"class","preview svelte-1tsjp7g"),Ee(n.src,t=l[2])||_(n,"src",t),_(n,"alt","preview"),_(o,"class","svelte-1tsjp7g"),_(p,"class","flex-row svelte-1tsjp7g"),_(re,"class","flex-row svelte-1tsjp7g"),_(Q,"class","svelte-1tsjp7g"),_(e,"class","details svelte-1tsjp7g")},m(G,X){F(G,e,X),m(e,n),m(e,s),m(e,o),m(o,r),m(o,a),m(a,i),m(a,c),m(e,f),m(e,p),M(h,p,null),m(p,g),m(p,v),m(p,I),m(p,R),m(R,w),m(p,z),m(p,A),m(p,b),M(D,p,null),m(p,j),m(p,E),m(p,T),M(U,p,null),m(e,W),m(e,re),M(J,re,null),m(re,K),m(re,te),m(re,he),M(Ce,re,null),m(re,Me),m(re,De),m(re,st),M(Re,re,null),m(re,rt),ne&&ne.m(re,null),m(e,Ye),m(e,Te);for(let Ae=0;Ae<se.length;Ae+=1)se[Ae]&&se[Ae].m(Te,null);m(Te,Ge),m(Te,Q),m(Te,je),M($e,Te,null),ve=!0},p(G,[X]){(!ve||X&4&&!Ee(n.src,t=G[2]))&&_(n,"src",t),(!ve||X&1)&&u!==(u=G[0].id+"")&&Ie(c,u);const Ae={};X&1&&(Ae.value=G[0].rating),h.$set(Ae),(!ve||X&1)&&N!==(N=G[0].type.toUpperCase()+"")&&Ie(w,N);const Ze={};X&1&&(Ze.value=G[0].score),D.$set(Ze);const ge={};X&1&&(ge.value=G[0].change),U.$set(ge);const ot={};X&9&&(ot.url="/post?id="+G[0].id+"&src="+encodeURIComponent(G[3])),J.$set(ot);const ke={};X&1&&(ke.source="https://rule34.xxx/index.php?page=post&s=view&id="+G[0].id),Ce.$set(ke);const qe={};if(X&8&&(qe.url=G[3]),Re.$set(qe),G[0].source?ne?(ne.p(G,X),X&1&&k(ne,1)):(ne=wt(G),ne.c(),k(ne,1),ne.m(re,null)):ne&&(_e(),y(ne,1,1,()=>{ne=null}),de()),X&2){be=Se(Object.entries(G[1]));let we;for(we=0;we<be.length;we+=1){const dt=kt(G,be,we);se[we]?(se[we].p(dt,X),k(se[we],1)):(se[we]=yt(dt),se[we].c(),k(se[we],1),se[we].m(Te,Ge))}for(_e(),we=be.length;we<se.length;we+=1)ct(we);de()}const Xe={};X&1&&(Xe.post=G[0]),$e.$set(Xe)},i(G){if(!ve){k(h.$$.fragment,G),k(D.$$.fragment,G),k(U.$$.fragment,G),k(J.$$.fragment,G),k(Ce.$$.fragment,G),k(Re.$$.fragment,G),k(ne);for(let X=0;X<be.length;X+=1)k(se[X]);k($e.$$.fragment,G),ve=!0}},o(G){y(h.$$.fragment,G),y(D.$$.fragment,G),y(U.$$.fragment,G),y(J.$$.fragment,G),y(Ce.$$.fragment,G),y(Re.$$.fragment,G),y(ne),se=se.filter(Boolean);for(let X=0;X<se.length;X+=1)y(se[X]);y($e.$$.fragment,G),ve=!1},d(G){G&&d(e),q(h),q(D),q(U),q(J),q(Ce),q(Re),ne&&ne.d(),Qe(se,G),q($e)}}}function kl(l,e,n){let t,s,o,{post:r}=e;return l.$$set=a=>{"post"in a&&n(0,r=a.post)},l.$$.update=()=>{l.$$.dirty&1&&n(3,t=r.file_url),l.$$.dirty&1&&n(2,s=r.sample_url),l.$$.dirty&1&&n(1,o=r.tags.reduce((a,i)=>(a[i.type]===void 0&&(a[i.type]=[]),a[i.type].push(i),a),{}))},[r,o,s,t]}class wl extends ce{constructor(e){super(),ue(this,e,kl,bl,ae,{post:0})}}const xe=new IntersectionObserver(l=>{for(const e of l)if(e.target){const n=e.target;e.isIntersecting&&n.autoplay&&n.paused&&n.play(),!e.isIntersecting&&!n.paused&&n.pause()}},{rootMargin:"-1px",threshold:.001});function yl(l){let e,n,t,s;return{c(){e=S("div"),n=S("input"),this.h()},l(o){e=C(o,"DIV",{class:!0});var r=V(e);n=C(r,"INPUT",{type:!0,step:!0,max:!0,class:!0}),r.forEach(d),this.h()},h(){_(n,"type","range"),_(n,"step","0.001"),_(n,"max",l[1]),_(n,"class","svelte-dfxj87"),_(e,"class","svelte-dfxj87")},m(o,r){F(o,e,r),m(e,n),He(n,l[0]),t||(s=[ee(n,"change",l[5]),ee(n,"input",l[5]),ee(n,"scroll",ut(et(l[4]))),ee(e,"click",ut(et(l[2]))),ee(e,"scroll",ut(et(l[3])))],t=!0)},p(o,[r]){r&2&&_(n,"max",o[1]),r&1&&He(n,o[0])},i:Y,o:Y,d(o){o&&d(e),t=!1,ze(s)}}}function El(l,e,n){let{value:t}=e,{max:s}=e;function o(u){Fe.call(this,l,u)}function r(u){Fe.call(this,l,u)}function a(u){Fe.call(this,l,u)}function i(){t=pn(this.value),n(0,t)}return l.$$set=u=>{"value"in u&&n(0,t=u.value),"max"in u&&n(1,s=u.max)},[t,s,o,r,a,i]}class nn extends ce{constructor(e){super(),ue(this,e,El,yl,ae,{value:0,max:1})}}function Sl(l){let e,n,t,s=!1,o,r=!0,a,i,u,c,f,p;function h(){cancelAnimationFrame(o),e.paused||(o=Cn(h),s=!0),l[10].call(e)}function g($){l[13]($)}let v={max:l[4]};return l[2]!==void 0&&(v.value=l[2]),i=new nn({props:v}),me.push(()=>Le(i,"value",g)),{c(){e=S("video"),a=P(),O(i.$$.fragment),this.h()},l($){e=C($,"VIDEO",{src:!0,poster:!0,title:!0,preload:!0,class:!0}),V(e).forEach(d),a=L($),B(i.$$.fragment,$),this.h()},h(){Ee(e.src,n=l[6])||_(e,"src",n),_(e,"poster",l[5]),_(e,"title",t="[VIDEO] post #"+l[0].id),_(e,"preload","metadata"),e.autoplay=!0,_(e,"class","svelte-uwd1jt"),l[4]===void 0&&_n(()=>l[12].call(e))},m($,I){F($,e,I),l[9](e),F($,a,I),M(i,$,I),c=!0,f||(p=[ee(e,"timeupdate",h),ee(e,"play",l[11]),ee(e,"pause",l[11]),ee(e,"durationchange",l[12]),ee(e,"click",Cl),ee(e,"ended",l[8]),ee(e,"contextmenu",et(Il))],f=!0)},p($,[I]){(!c||I&64&&!Ee(e.src,n=$[6]))&&_(e,"src",n),(!c||I&32)&&_(e,"poster",$[5]),(!c||I&1&&t!==(t="[VIDEO] post #"+$[0].id))&&_(e,"title",t),!s&&I&4&&!isNaN($[2])&&(e.currentTime=$[2]),s=!1,I&8&&r!==(r=$[3])&&e[r?"pause":"play"]();const R={};I&16&&(R.max=$[4]),!u&&I&4&&(u=!0,R.value=$[2],Pe(()=>u=!1)),i.$set(R)},i($){c||(k(i.$$.fragment,$),c=!0)},o($){y(i.$$.fragment,$),c=!1},d($){$&&(d(e),d(a)),l[9](null),q(i,$),f=!1,ze(p)}}}const Cl=l=>l.target.paused?l.target.play():l.target.pause(),Il=()=>{};function Dl(l,e,n){let t,s,o,{post:r}=e,a,i=0,u=!1,c;const f=R=>{a&&(R.key==="ArrowLeft"&&(R.preventDefault(),R.stopPropagation(),n(1,a.currentTime=Math.max(0,a.currentTime-5),a)),R.key==="ArrowRight"&&(R.preventDefault(),R.stopPropagation(),n(1,a.currentTime=Math.min(a.duration,a.currentTime+5),a)),R.key==="Space"&&(R.preventDefault(),R.stopPropagation(),n(3,u=!u)))};tt(()=>{a&&(xe==null||xe.observe(a)),document.addEventListener("keydown",f)}),nt(()=>{a&&(xe==null||xe.unobserve(a)),document.removeEventListener("keydown",f)});function p(R){Fe.call(this,l,R)}function h(R){me[R?"unshift":"push"](()=>{a=R,n(1,a)})}function g(){i=this.currentTime,n(2,i)}function v(){u=this.paused,n(3,u)}function $(){c=this.duration,n(4,c)}function I(R){i=R,n(2,i)}return l.$$set=R=>{"post"in R&&n(0,r=R.post)},l.$$.update=()=>{l.$$.dirty&1&&n(7,t=xt(r.file_url,r.sample_url,r.preview_url)),l.$$.dirty&128&&n(6,s=t.animated),l.$$.dirty&128&&n(5,o=t.static)},[r,a,i,u,c,o,s,t,p,h,g,v,$,I]}class Tl extends ce{constructor(e){super(),ue(this,e,Dl,Sl,ae,{post:0})}}function Pl(l){return{c:Y,l:Y,m:Y,p:Y,i:Y,o:Y,d:Y}}function Ll(l){let e,n,t,s,o,r;return{c(){e=S("img"),this.h()},l(a){e=C(a,"IMG",{src:!0,alt:!0,title:!0,class:!0}),this.h()},h(){Ee(e.src,n=l[2])||_(e,"src",n),_(e,"alt",t="["+l[0].type+"] post #"+l[0].id),_(e,"title",s="["+l[0].type+"] post #"+l[0].id),_(e,"class","svelte-jlq3re")},m(a,i){F(a,e,i),o||(r=[ee(e,"contextmenu",et(jl)),ee(e,"click",l[6]),dn(l[7].call(null,e))],o=!0)},p(a,i){i&4&&!Ee(e.src,n=a[2])&&_(e,"src",n),i&1&&t!==(t="["+a[0].type+"] post #"+a[0].id)&&_(e,"alt",t),i&1&&s!==(s="["+a[0].type+"] post #"+a[0].id)&&_(e,"title",s)},i:Y,o:Y,d(a){a&&d(e),o=!1,ze(r)}}}function Nl(l){let e,n,t,s,o,r,a,i,u,c;return a=new _t({}),{c(){e=S("img"),o=P(),r=S("div"),O(a.$$.fragment),this.h()},l(f){e=C(f,"IMG",{src:!0,alt:!0,title:!0,class:!0}),o=L(f),r=C(f,"DIV",{class:!0});var p=V(r);B(a.$$.fragment,p),p.forEach(d),this.h()},h(){Ee(e.src,n=l[3])||_(e,"src",n),_(e,"alt",t="["+l[0].type+"] post #"+l[0].id),_(e,"title",s="["+l[0].type+"] post #"+l[0].id),_(e,"class","svelte-jlq3re"),_(r,"class","svelte-jlq3re")},m(f,p){F(f,e,p),F(f,o,p),F(f,r,p),M(a,r,null),i=!0,u||(c=[ee(e,"contextmenu",et(Rl)),ee(e,"click",l[6])],u=!0)},p(f,p){(!i||p&8&&!Ee(e.src,n=f[3]))&&_(e,"src",n),(!i||p&1&&t!==(t="["+f[0].type+"] post #"+f[0].id))&&_(e,"alt",t),(!i||p&1&&s!==(s="["+f[0].type+"] post #"+f[0].id))&&_(e,"title",s)},i(f){i||(k(a.$$.fragment,f),i=!0)},o(f){y(a.$$.fragment,f),i=!1},d(f){f&&(d(e),d(o),d(r)),q(a),u=!1,ze(c)}}}function Et(l){let e,n,t;function s(r){l[10](r)}let o={max:l[5]};return l[1]!==void 0&&(o.value=l[1]),e=new nn({props:o}),me.push(()=>Le(e,"value",s)),{c(){O(e.$$.fragment)},l(r){B(e.$$.fragment,r)},m(r,a){M(e,r,a),t=!0},p(r,a){const i={};a&32&&(i.max=r[5]),!n&&a&2&&(n=!0,i.value=r[1],Pe(()=>n=!1)),e.$set(i)},i(r){t||(k(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){q(e,r)}}}function Fl(l){let e,n,t,s,o={ctx:l,current:null,token:null,hasCatch:!1,pending:Nl,then:Ll,catch:Pl,value:21,blocks:[,,,]};mt(e=l[8](l[2]),o);let r=l[4]&&Et(l);return{c(){o.block.c(),n=P(),r&&r.c(),t=Oe()},l(a){o.block.l(a),n=L(a),r&&r.l(a),t=Oe()},m(a,i){o.block.m(a,o.anchor=i),o.mount=()=>n.parentNode,o.anchor=n,F(a,n,i),r&&r.m(a,i),F(a,t,i),s=!0},p(a,[i]){l=a,o.ctx=l,i&4&&e!==(e=l[8](l[2]))&&mt(e,o)||Fn(o,l,i),l[4]?r?(r.p(l,i),i&16&&k(r,1)):(r=Et(l),r.c(),k(r,1),r.m(t.parentNode,t)):r&&(_e(),y(r,1,1,()=>{r=null}),de())},i(a){s||(k(o.block),k(r),s=!0)},o(a){for(let i=0;i<3;i+=1){const u=o.blocks[i];y(u)}y(r),s=!1},d(a){a&&(d(n),d(t)),o.block.d(a),o.token=null,o=null,r&&r.d(a)}}}const Rl=()=>{},jl=()=>{};function Al(l,e,n){let t,s,o,r;fe(l,en,b=>n(4,o=b)),fe(l,Rn,b=>n(5,r=b));const a=Be();let{post:i}=e,{postId:u=-1}=e;const c=(b,D,j,E)=>{if(b==="gif"){const Z=In(D,j,E);return[Z.static,Z.animated]}return Vn?[j,D]:[E,j]};let f=0,p=Date.now(),h=Date.now(),g,v=!0,$;const I=()=>{h=Date.now(),g=h-p,p=h,v||n(1,f+=g/1e3),f>=r&&(a("ended"),n(1,f=0)),$=requestAnimationFrame(I)},R=()=>{v=!v},N=b=>{(b.code==="Space"||b.key==="k")&&(b.preventDefault(),b.stopPropagation(),v=!v)},w=new IntersectionObserver(b=>{for(const D of b)D.target&&(v=!D.isIntersecting)},{rootMargin:"0px",threshold:.5}),z=b=>(w==null||w.observe(b),{destroy(){w==null||w.unobserve(b)}});tt(()=>{o&&($=requestAnimationFrame(I),document.addEventListener("keydown",N))}),nt(()=>{cancelAnimationFrame($),document.removeEventListener("keydown",N)});const A=b=>new Promise(D=>{v=!0;let j=new Image;j.onload=E=>{D(E),v=!1},j.src=b});function H(b){f=b,n(1,f),n(0,i),n(9,u)}return l.$$set=b=>{"post"in b&&n(0,i=b.post),"postId"in b&&n(9,u=b.postId)},l.$$.update=()=>{l.$$.dirty&1&&n(3,[t,s]=c(i.type,i.file_url,i.sample_url,i.preview_url),t,(n(2,s),n(0,i))),l.$$.dirty&513&&i.id!==u&&(n(9,u=i.id),n(1,f=0))},[i,f,s,t,o,r,R,z,A,u,H]}class Vl extends ce{constructor(e){super(),ue(this,e,Al,Fl,ae,{post:0,postId:9})}}function Ol(l){let e,n;return e=new Vl({props:{post:l[0]}}),e.$on("ended",l[2]),{c(){O(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p(t,s){const o={};s&1&&(o.post=t[0]),e.$set(o)},i(t){n||(k(e.$$.fragment,t),n=!0)},o(t){y(e.$$.fragment,t),n=!1},d(t){q(e,t)}}}function Bl(l){let e,n;return e=new Tl({props:{post:l[0]}}),e.$on("ended",l[1]),{c(){O(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p(t,s){const o={};s&1&&(o.post=t[0]),e.$set(o)},i(t){n||(k(e.$$.fragment,t),n=!0)},o(t){y(e.$$.fragment,t),n=!1},d(t){q(e,t)}}}function Ml(l){let e,n,t,s;const o=[Bl,Ol],r=[];function a(i,u){return i[0].type==="video"?0:1}return n=a(l),t=r[n]=o[n](l),{c(){e=S("div"),t.c(),this.h()},l(i){e=C(i,"DIV",{class:!0});var u=V(e);t.l(u),u.forEach(d),this.h()},h(){_(e,"class","svelte-acjk3s")},m(i,u){F(i,e,u),r[n].m(e,null),s=!0},p(i,[u]){let c=n;n=a(i),n===c?r[n].p(i,u):(_e(),y(r[c],1,1,()=>{r[c]=null}),de(),t=r[n],t?t.p(i,u):(t=r[n]=o[n](i),t.c()),k(t,1),t.m(e,null))},i(i){s||(k(t),s=!0)},o(i){y(t),s=!1},d(i){i&&d(e),r[n].d()}}}function ql(l,e,n){let{post:t}=e;function s(r){Fe.call(this,l,r)}function o(r){Fe.call(this,l,r)}return l.$$set=r=>{"post"in r&&n(0,t=r.post)},[t,s,o]}class zl extends ce{constructor(e){super(),ue(this,e,ql,Ml,ae,{post:0})}}function Ul(l){let e,n,t;return{c(){e=S("img"),this.h()},l(s){e=C(s,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){Ee(e.src,n=l[2])||_(e,"src",n),_(e,"alt",t="post #"+l[0].id),_(e,"class","svelte-itxz72"),Ne(e,"top",l[1])},m(s,o){F(s,e,o)},p(s,[o]){o&4&&!Ee(e.src,n=s[2])&&_(e,"src",n),o&1&&t!==(t="post #"+s[0].id)&&_(e,"alt",t),o&2&&Ne(e,"top",s[1])},i:Y,o:Y,d(s){s&&d(e)}}}function Hl(l,e,n){let t,{post:s}=e,{offset:o}=e;return l.$$set=r=>{"post"in r&&n(0,s=r.post),"offset"in r&&n(1,o=r.offset)},l.$$.update=()=>{l.$$.dirty&1&&n(2,t=Dn(s.sample_url)?s.preview_url:s.sample_url)},[s,o,t]}class ln extends ce{constructor(e){super(),ue(this,e,Hl,Ul,ae,{post:0,offset:1})}}const Gl=()=>{const{subscribe:e,set:n}=Mn(qn.FullscreenHintDone,!1,Un,zn);return{subscribe:e,set:n,reset:()=>n(!1)}},St=Gl();function Ct(l,e,n){const t=l.slice();return t[22]=e[n],t[24]=n,t}function It(l){let e,n;return e=new ln({props:{post:l[7],offset:l[4]}}),{c(){O(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p(t,s){const o={};s&128&&(o.post=t[7]),s&16&&(o.offset=t[4]),e.$set(o)},i(t){n||(k(e.$$.fragment,t),n=!0)},o(t){y(e.$$.fragment,t),n=!1},d(t){q(e,t)}}}function Wl(l){let e;return{c(){e=S("i"),this.h()},l(n){e=C(n,"I",{class:!0}),V(e).forEach(d),this.h()},h(){_(e,"class","codicon codicon-tag")},m(n,t){F(n,e,t)},p:Y,d(n){n&&d(e)}}}function Dt(l){let e,n;return e=new ln({props:{post:l[6],offset:l[3]}}),{c(){O(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p(t,s){const o={};s&64&&(o.post=t[6]),s&8&&(o.offset=t[3]),e.$set(o)},i(t){n||(k(e.$$.fragment,t),n=!0)},o(t){y(e.$$.fragment,t),n=!1},d(t){q(e,t)}}}function Tt(l){let e,n=`${l[24]*100}vh`;return{c(){e=S("div"),this.h()},l(t){e=C(t,"DIV",{class:!0}),V(e).forEach(d),this.h()},h(){_(e,"class","pseudo snap-item svelte-2epggd"),Ne(e,"top",n)},m(t,s){F(t,e,s)},p:Y,d(t){t&&d(e)}}}function Kl(l){let e,n,t,s,o,r,a,i,u,c,f,p,h,g,v,$=l[7]&&It(l);s=new zl({props:{post:l[8]}}),s.$on("ended",l[11]),r=new wl({props:{post:l[8]}}),i=new Kt({props:{class:"details-button",$$slots:{default:[Wl]},$$scope:{ctx:l}}}),i.$on("click",l[14]);let I=l[6]&&Dt(l),R=Se({length:l[0].posts.length}),N=[];for(let w=0;w<R.length;w+=1)N[w]=Tt(Ct(l,R,w));return p=new tn({props:{absoluteTop:l[0].posts.length*100+"vh",rootMargin:window.innerHeight*3+"px"}}),p.$on("intersection",l[16]),{c(){e=S("div"),$&&$.c(),n=P(),t=S("div"),O(s.$$.fragment),o=P(),O(r.$$.fragment),a=P(),O(i.$$.fragment),u=P(),I&&I.c(),c=P();for(let w=0;w<N.length;w+=1)N[w].c();f=P(),O(p.$$.fragment),this.h()},l(w){e=C(w,"DIV",{class:!0});var z=V(e);$&&$.l(z),n=L(z),t=C(z,"DIV",{class:!0});var A=V(t);B(s.$$.fragment,A),o=L(A),B(r.$$.fragment,A),a=L(A),B(i.$$.fragment,A),A.forEach(d),u=L(z),I&&I.l(z),c=L(z);for(let H=0;H<N.length;H+=1)N[H].l(z);f=L(z),B(p.$$.fragment,z),z.forEach(d),this.h()},h(){_(t,"class","screen snap-container horizontal current svelte-2epggd"),ye(t,"hint",!l[9]),Ne(t,"top",l[5]),_(e,"class","root screen snap-container svelte-2epggd")},m(w,z){F(w,e,z),$&&$.m(e,null),m(e,n),m(e,t),M(s,t,null),m(t,o),M(r,t,null),m(t,a),M(i,t,null),l[15](t),m(e,u),I&&I.m(e,null),m(e,c);for(let A=0;A<N.length;A+=1)N[A]&&N[A].m(e,null);m(e,f),M(p,e,null),l[17](e),h=!0,g||(v=ee(e,"scroll",l[12]),g=!0)},p(w,[z]){w[7]?$?($.p(w,z),z&128&&k($,1)):($=It(w),$.c(),k($,1),$.m(e,n)):$&&(_e(),y($,1,1,()=>{$=null}),de());const A={};z&256&&(A.post=w[8]),s.$set(A);const H={};z&256&&(H.post=w[8]),r.$set(H);const b={};if(z&33554432&&(b.$$scope={dirty:z,ctx:w}),i.$set(b),(!h||z&512)&&ye(t,"hint",!w[9]),z&32&&Ne(t,"top",w[5]),w[6]?I?(I.p(w,z),z&64&&k(I,1)):(I=Dt(w),I.c(),k(I,1),I.m(e,c)):I&&(_e(),y(I,1,1,()=>{I=null}),de()),z&1){R=Se({length:w[0].posts.length});let j;for(j=0;j<R.length;j+=1){const E=Ct(w,R,j);N[j]?N[j].p(E,z):(N[j]=Tt(E),N[j].c(),N[j].m(e,f))}for(;j<N.length;j+=1)N[j].d(1);N.length=R.length}const D={};z&1&&(D.absoluteTop=w[0].posts.length*100+"vh"),p.$set(D)},i(w){h||(k($),k(s.$$.fragment,w),k(r.$$.fragment,w),k(i.$$.fragment,w),k(I),k(p.$$.fragment,w),h=!0)},o(w){y($),y(s.$$.fragment,w),y(r.$$.fragment,w),y(i.$$.fragment,w),y(I),y(p.$$.fragment,w),h=!1},d(w){w&&d(e),$&&$.d(),q(s),q(r),q(i),l[15](null),I&&I.d(),Qe(N,w),q(p),l[17](null),g=!1,v()}}}function Jl(l,e,n){let t,s,o,r,a,i,u,c,f;fe(l,St,D=>n(9,u=D)),fe(l,en,D=>n(18,c=D)),fe(l,We,D=>n(0,f=D));const p=Be();let{index:h}=e,g,v;const $=()=>{g.scrollTo({left:0,top:g.clientHeight*(h-1),behavior:"smooth"})},I=()=>{g.scrollTo({left:0,top:g.clientHeight*(h+1),behavior:"smooth"})},R=()=>{c&&I()},N=D=>{requestAnimationFrame(()=>{const j=D.target,E=j.getBoundingClientRect().height,Z=j.scrollTop/E,T=Math.round(Z);T!=h&&(n(13,h=T),v&&n(2,v.scrollLeft=0,v))})},w=D=>{D.key==="d"&&(D.preventDefault(),D.stopPropagation(),v.scrollLeft===0?v.scrollBy({left:g.clientWidth,top:0,behavior:"smooth"}):v.scrollBy({left:-g.clientWidth,top:0,behavior:"smooth"})),D.key==="ArrowUp"&&(D.preventDefault(),D.stopPropagation(),$()),D.key==="ArrowDown"&&(D.preventDefault(),D.stopPropagation(),I())};tt(()=>{v&&(v.scrollIntoView(!0),n(2,v.scrollLeft=0,v)),document.addEventListener("keydown",w)}),nt(()=>{gn(St,u=!0,u),document.removeEventListener("keydown",w)});const z=()=>v.scrollBy({left:g.clientWidth,top:0,behavior:"smooth"});function A(D){me[D?"unshift":"push"](()=>{v=D,n(2,v)})}const H=()=>p("endreached");function b(D){me[D?"unshift":"push"](()=>{g=D,n(1,g)})}return l.$$set=D=>{"index"in D&&n(13,h=D.index)},l.$$.update=()=>{l.$$.dirty&8193&&n(8,t=f.posts[h]),l.$$.dirty&8193&&n(7,s=h>0?f.posts[h-1]:void 0),l.$$.dirty&8193&&n(6,o=h<f.posts.length-1?f.posts[h+1]:void 0),l.$$.dirty&8192&&n(5,r=`${h*100}vh`),l.$$.dirty&8192&&n(4,a=`${(h-1)*100}vh`),l.$$.dirty&8192&&n(3,i=`${(h+1)*100}vh`)},[f,g,v,i,a,r,o,s,t,u,p,R,N,h,z,A,H,b]}class Ql extends ce{constructor(e){super(),ue(this,e,Jl,Kl,ae,{index:13})}}function Yl(l){let e;return{c(){e=S("i"),this.h()},l(n){e=C(n,"I",{class:!0}),V(e).forEach(d),this.h()},h(){_(e,"class","codicon codicon-close")},m(n,t){F(n,e,t)},p:Y,d(n){n&&d(e)}}}function Zl(l){let e,n,t,s,o;function r(i){l[2](i)}let a={};return l[0]!==void 0&&(a.index=l[0]),e=new Ql({props:a}),me.push(()=>Le(e,"index",r)),e.$on("endreached",l[3]),s=new Kt({props:{class:"button-close",$$slots:{default:[Yl]},$$scope:{ctx:l}}}),s.$on("click",l[1]),{c(){O(e.$$.fragment),t=P(),O(s.$$.fragment)},l(i){B(e.$$.fragment,i),t=L(i),B(s.$$.fragment,i)},m(i,u){M(e,i,u),F(i,t,u),M(s,i,u),o=!0},p(i,u){const c={};!n&&u&1&&(n=!0,c.index=i[0],Pe(()=>n=!1)),e.$set(c);const f={};u&128&&(f.$$scope={dirty:u,ctx:i}),s.$set(f)},i(i){o||(k(e.$$.fragment,i),k(s.$$.fragment,i),o=!0)},o(i){y(e.$$.fragment,i),y(s.$$.fragment,i),o=!1},d(i){i&&d(t),q(e,i),q(s,i)}}}function Xl(l){let e,n;return e=new dl({props:{$$slots:{default:[Zl]},$$scope:{ctx:l}}}),e.$on("close",l[1]),{c(){O(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p(t,[s]){const o={};s&129&&(o.$$scope={dirty:s,ctx:t}),e.$set(o)},i(t){n||(k(e.$$.fragment,t),n=!0)},o(t){y(e.$$.fragment,t),n=!1},d(t){q(e,t)}}}function xl(l,e,n){let{index:t}=e;const s=Be(),o=()=>{s("close",t)},r=c=>{c.key==="f"&&(c.preventDefault(),c.stopPropagation(),o())},a=()=>{var c,f;(((c=history.state)==null?void 0:c.fullscreen)===void 0||((f=history.state)==null?void 0:f.fullscreen)===!1)&&o()};tt(()=>{window.addEventListener("popstate",a),document.addEventListener("keydown",r)}),nt(()=>{window.removeEventListener("popstate",a),document.removeEventListener("keydown",r)});function i(c){t=c,n(0,t)}function u(c){Fe.call(this,l,c)}return l.$$set=c=>{"index"in c&&n(0,t=c.index)},[t,o,i,u]}class es extends ce{constructor(e){super(),ue(this,e,xl,Xl,ae,{index:0})}}function Pt(l){let e,n=l[0].type==="video"?"▶":"GIF",t;return{c(){e=S("span"),t=oe(n),this.h()},l(s){e=C(s,"SPAN",{class:!0});var o=V(e);t=ie(o,n),o.forEach(d),this.h()},h(){_(e,"class","type svelte-rfj0jo")},m(s,o){F(s,e,o),m(e,t)},p(s,o){o&1&&n!==(n=s[0].type==="video"?"▶":"GIF")&&Ie(t,n)},d(s){s&&d(e)}}}function ts(l){let e,n,t,s,o,r,a=Ve(l[0].score)+"",i,u,c,f,p=l[0].type!=="image"&&Pt(l);return{c(){e=S("div"),n=S("img"),s=P(),p&&p.c(),o=P(),r=S("span"),i=oe(a),this.h()},l(h){e=C(h,"DIV",{id:!0,class:!0,style:!0});var g=V(e);n=C(g,"IMG",{src:!0,alt:!0,class:!0,tabindex:!0,loading:!0}),s=L(g),p&&p.l(g),o=L(g),r=C(g,"SPAN",{class:!0});var v=V(r);i=ie(v,a),v.forEach(d),g.forEach(d),this.h()},h(){Ee(n.src,t=l[1])||_(n,"src",t),_(n,"alt","post"),_(n,"class","post-media svelte-rfj0jo"),_(n,"tabindex","-1"),_(n,"loading","lazy"),_(r,"class","score svelte-rfj0jo"),_(e,"id",u=at(l[0].id)),_(e,"class","post svelte-rfj0jo"),Ne(e,"grid-row","span "+l[2]),ye(e,"open",open)},m(h,g){F(h,e,g),m(e,n),m(e,s),p&&p.m(e,null),m(e,o),m(e,r),m(r,i),c||(f=[ee(e,"click",l[3]),ee(e,"keydown",l[4])],c=!0)},p(h,[g]){g&2&&!Ee(n.src,t=h[1])&&_(n,"src",t),h[0].type!=="image"?p?p.p(h,g):(p=Pt(h),p.c(),p.m(e,o)):p&&(p.d(1),p=null),g&1&&a!==(a=Ve(h[0].score)+"")&&Ie(i,a),g&1&&u!==(u=at(h[0].id))&&_(e,"id",u),g&0&&ye(e,"open",open)},i:Y,o:Y,d(h){h&&d(e),p&&p.d(),c=!1,ze(f)}}}let Lt=5;function ns(l,e,n){let t,{post:s}=e,o=1/3,r=Tn(s.width,s.height),a=Math.max(Math.min(Math.round(Lt/r),Lt/o),2);const i=f=>f.endsWith(".jpg")||f.endsWith(".jpeg")||f.endsWith(".png")||f.endsWith(".webp");function u(f){Fe.call(this,l,f)}const c=f=>{var p;(On(f)||f.key==="f")&&((p=f.target)==null||p.click())};return l.$$set=f=>{"post"in f&&n(0,s=f.post)},l.$$.update=()=>{l.$$.dirty&1&&n(1,t=i(s.sample_url)?s.sample_url:s.preview_url)},[s,t,a,u,c]}class ls extends ce{constructor(e){super(),ue(this,e,ns,ts,ae,{post:0})}}function Nt(l,e,n){const t=l.slice();t[2]=e[n];const s=t[2].host.replace("www.","");t[3]=s;const o=t[1][t[3]]??t[1].default;t[4]=o[0],t[5]=o[1];const r=t[3].includes("api-cdn")?"File":t[3];return t[6]=r,t}function Ft(l){let e,n,t=l[6]+"",s,o,r,a;return{c(){e=S("li"),n=S("a"),s=oe(t),a=P(),this.h()},l(i){e=C(i,"LI",{});var u=V(e);n=C(u,"A",{href:!0,class:!0,style:!0});var c=V(n);s=ie(c,t),c.forEach(d),a=L(u),u.forEach(d),this.h()},h(){_(n,"href",o=l[2].toString()),_(n,"class",r="codicon codicon-link-external "+l[5]+" svelte-f59j30"),Ne(n,"background-color",l[4]),Ne(n,"color",l[5])},m(i,u){F(i,e,u),m(e,n),m(n,s),m(e,a)},p(i,u){u&1&&t!==(t=i[6]+"")&&Ie(s,t),u&1&&o!==(o=i[2].toString())&&_(n,"href",o),u&1&&r!==(r="codicon codicon-link-external "+i[5]+" svelte-f59j30")&&_(n,"class",r),u&1&&Ne(n,"background-color",i[4]),u&1&&Ne(n,"color",i[5])},d(i){i&&d(e)}}}function ss(l){let e,n=Se(l[0]),t=[];for(let s=0;s<n.length;s+=1)t[s]=Ft(Nt(l,n,s));return{c(){e=S("ol");for(let s=0;s<t.length;s+=1)t[s].c();this.h()},l(s){e=C(s,"OL",{class:!0});var o=V(e);for(let r=0;r<t.length;r+=1)t[r].l(o);o.forEach(d),this.h()},h(){_(e,"class","svelte-f59j30")},m(s,o){F(s,e,o);for(let r=0;r<t.length;r+=1)t[r]&&t[r].m(e,null)},p(s,[o]){if(o&3){n=Se(s[0]);let r;for(r=0;r<n.length;r+=1){const a=Nt(s,n,r);t[r]?t[r].p(a,o):(t[r]=Ft(a),t[r].c(),t[r].m(e,null))}for(;r<t.length;r+=1)t[r].d(1);t.length=n.length}},i:Y,o:Y,d(s){s&&d(e),Qe(t,s)}}}function rs(l,e,n){let{links:t}=e;const s={"kurosearch.com":["crimson","white"],"rule34.xxx":["#aae5a4","black"],"newgrounds.com":["#fda238","black"],"twitter.com":["rgb(29, 155, 240)","white"],"x.com":["rgb(29, 155, 240)","white"],"pornhub.com":["#f90","black"],"zone-archive.com":["#59396A","white"],"subscribestar.adult":["#ff4081","white"],"redgifs.com":["#E5194D","white"],"deviantart.com":["#00c787","black"],default:["var(--background-2)","white"]};return l.$$set=o=>{"links"in o&&n(0,t=o.links)},[t,s]}class os extends ce{constructor(e){super(),ue(this,e,rs,ss,ae,{links:0})}}function Rt(l){let e,n=Ve(l[0].comment_count)+"",t,s,o;return{c(){e=S("button"),t=oe(n),this.h()},l(r){e=C(r,"BUTTON",{type:!0,class:!0});var a=V(e);t=ie(a,n),a.forEach(d),this.h()},h(){_(e,"type","button"),_(e,"class","codicon codicon-comment svelte-nhpj3u"),ye(e,"active",l[1]==="comments")},m(r,a){F(r,e,a),m(e,t),s||(o=ee(e,"click",l[5]),s=!0)},p(r,a){a&1&&n!==(n=Ve(r[0].comment_count)+"")&&Ie(t,n),a&2&&ye(e,"active",r[1]==="comments")},d(r){r&&d(e),s=!1,o()}}}function is(l){let e,n,t,s,o="•",r,a,i,u,c,f,p=Ve(l[2])+"",h,g,v,$,I=Ve(l[0].tags.length)+"",R,N,w,z;n=new Qt({props:{value:l[0].change}}),a=new Jt({props:{value:l[0].score}});let A=l[0].comment_count&&Rt(l);return{c(){e=S("div"),O(n.$$.fragment),t=P(),s=S("span"),s.textContent=o,r=P(),O(a.$$.fragment),i=P(),u=S("span"),c=P(),f=S("button"),h=oe(p),g=P(),A&&A.c(),v=P(),$=S("button"),R=oe(I),this.h()},l(H){e=C(H,"DIV",{class:!0});var b=V(e);B(n.$$.fragment,b),t=L(b),s=C(b,"SPAN",{"data-svelte-h":!0}),pe(s)!=="svelte-7hh8jk"&&(s.textContent=o),r=L(b),B(a.$$.fragment,b),i=L(b),u=C(b,"SPAN",{class:!0}),V(u).forEach(d),c=L(b),f=C(b,"BUTTON",{type:!0,class:!0});var D=V(f);h=ie(D,p),D.forEach(d),g=L(b),A&&A.l(b),v=L(b),$=C(b,"BUTTON",{type:!0,class:!0});var j=V($);R=ie(j,I),j.forEach(d),b.forEach(d),this.h()},h(){_(u,"class","divider svelte-nhpj3u"),_(f,"type","button"),_(f,"class","codicon codicon-link svelte-nhpj3u"),ye(f,"active",l[1]==="links"),_($,"type","button"),_($,"class","codicon codicon-tag svelte-nhpj3u"),ye($,"active",l[1]==="tags"),_(e,"class","summary svelte-nhpj3u")},m(H,b){F(H,e,b),M(n,e,null),m(e,t),m(e,s),m(e,r),M(a,e,null),m(e,i),m(e,u),m(e,c),m(e,f),m(f,h),m(e,g),A&&A.m(e,null),m(e,v),m(e,$),m($,R),N=!0,w||(z=[ee(f,"click",l[4]),ee($,"click",l[6])],w=!0)},p(H,[b]){const D={};b&1&&(D.value=H[0].change),n.$set(D);const j={};b&1&&(j.value=H[0].score),a.$set(j),(!N||b&4)&&p!==(p=Ve(H[2])+"")&&Ie(h,p),(!N||b&2)&&ye(f,"active",H[1]==="links"),H[0].comment_count?A?A.p(H,b):(A=Rt(H),A.c(),A.m(e,v)):A&&(A.d(1),A=null),(!N||b&1)&&I!==(I=Ve(H[0].tags.length)+"")&&Ie(R,I),(!N||b&2)&&ye($,"active",H[1]==="tags")},i(H){N||(k(n.$$.fragment,H),k(a.$$.fragment,H),N=!0)},o(H){y(n.$$.fragment,H),y(a.$$.fragment,H),N=!1},d(H){H&&d(e),q(n),q(a),A&&A.d(),w=!1,ze(z)}}}function as(l,e,n){const t=Be();let{post:s}=e,{active:o}=e,{links:r}=e;const a=()=>t("links"),i=()=>t("comments"),u=()=>t("tags");return l.$$set=c=>{"post"in c&&n(0,s=c.post),"active"in c&&n(1,o=c.active),"links"in c&&n(2,r=c.links)},[s,o,r,t,a,i,u]}class cs extends ce{constructor(e){super(),ue(this,e,as,is,ae,{post:0,active:1,links:2})}}function us(l){let e,n='<i class="codicon codicon-screen-full"></i>',t,s;return{c(){e=S("button"),e.innerHTML=n,this.h()},l(o){e=C(o,"BUTTON",{type:!0,title:!0,class:!0,"data-svelte-h":!0}),pe(e)!=="svelte-hnv5zq"&&(e.innerHTML=n),this.h()},h(){_(e,"type","button"),_(e,"title","Enter Fullscreen mode"),_(e,"class","svelte-txn4jo")},m(o,r){F(o,e,r),t||(s=ee(e,"click",l[0]),t=!0)},p:Y,i:Y,o:Y,d(o){o&&d(e),t=!1,s()}}}function fs(l){function e(n){Fe.call(this,l,n)}return[e]}class ps extends ce{constructor(e){super(),ue(this,e,fs,us,ae,{})}}function _s(l){const e=l.slice(),n=xt(e[1].file_url,e[1].sample_url,e[1].preview_url);return e[13]=n,e}function ds(l){let e,n;return e=new Pn({props:{post:l[1]}}),{c(){O(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p(t,s){const o={};s&2&&(o.post=t[1]),e.$set(o)},i(t){n||(k(e.$$.fragment,t),n=!0)},o(t){y(e.$$.fragment,t),n=!1},d(t){q(e,t)}}}function gs(l){let e,n;return e=new Ln({props:{src:l[13].animated,poster:l[13].static,width:l[1].width,height:l[1].height,loop:l[3]||gt(l[1].tags)}}),{c(){O(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p(t,s){const o={};s&2&&(o.src=t[13].animated),s&2&&(o.poster=t[13].static),s&2&&(o.width=t[1].width),s&2&&(o.height=t[1].height),s&10&&(o.loop=t[3]||gt(t[1].tags)),e.$set(o)},i(t){n||(k(e.$$.fragment,t),n=!0)},o(t){y(e.$$.fragment,t),n=!1},d(t){q(e,t)}}}function ms(l){let e,n;return e=new Nn({props:{post:l[1]}}),{c(){O(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p(t,s){const o={};s&2&&(o.post=t[1]),e.$set(o)},i(t){n||(k(e.$$.fragment,t),n=!0)},o(t){y(e.$$.fragment,t),n=!1},d(t){q(e,t)}}}function hs(l){let e,n;return e=new os({props:{links:l[6]}}),{c(){O(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p:Y,i(t){n||(k(e.$$.fragment,t),n=!0)},o(t){y(e.$$.fragment,t),n=!1},d(t){q(e,t)}}}function $s(l){let e,n;return e=new Zt({props:{post:l[1]}}),{c(){O(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p(t,s){const o={};s&2&&(o.post=t[1]),e.$set(o)},i(t){n||(k(e.$$.fragment,t),n=!0)},o(t){y(e.$$.fragment,t),n=!1},d(t){q(e,t)}}}function vs(l){let e,n;return e=new Xt({props:{tags:l[1].tags}}),{c(){O(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p(t,s){const o={};s&2&&(o.tags=t[1].tags),e.$set(o)},i(t){n||(k(e.$$.fragment,t),n=!0)},o(t){y(e.$$.fragment,t),n=!1},d(t){q(e,t)}}}function bs(l){let e,n,t,s,o,r,a,i,u,c,f,p,h,g,v,$;const I=[ms,gs,ds],R=[];function N(b,D){return b[1].type==="image"?0:b[1].type==="video"?1:2}function w(b,D){return D===1?_s(b):b}t=N(l),s=R[t]=I[t](w(l,t)),r=new ps({}),r.$on("click",l[7]),u=new cs({props:{active:l[0],post:l[1],links:l[6].length}}),u.$on("tags",l[8]),u.$on("comments",l[9]),u.$on("links",l[10]);const z=[vs,$s,hs],A=[];function H(b,D){return b[0]==="tags"?0:b[0]==="comments"?1:b[0]==="links"?2:-1}return~(f=H(l))&&(p=A[f]=z[f](l)),{c(){e=S("li"),n=S("div"),s.c(),o=P(),O(r.$$.fragment),a=P(),i=S("div"),O(u.$$.fragment),c=P(),p&&p.c(),this.h()},l(b){e=C(b,"LI",{id:!0,class:!0});var D=V(e);n=C(D,"DIV",{});var j=V(n);s.l(j),j.forEach(d),o=L(D),B(r.$$.fragment,D),a=L(D),i=C(D,"DIV",{class:!0});var E=V(i);B(u.$$.fragment,E),c=L(E),p&&p.l(E),E.forEach(d),D.forEach(d),this.h()},h(){_(i,"class","details svelte-162qa8v"),_(e,"id",h=at(l[1].id)),_(e,"class","post svelte-162qa8v"),ye(e,"openTab",l[0])},m(b,D){F(b,e,D),m(e,n),R[t].m(n,null),m(e,o),M(r,e,null),m(e,a),m(e,i),M(u,i,null),m(i,c),~f&&A[f].m(i,null),g=!0,v||($=[ee(e,"keydown",l[11]),ee(e,"click",l[12])],v=!0)},p(b,[D]){let j=t;t=N(b),t===j?R[t].p(w(b,t),D):(_e(),y(R[j],1,1,()=>{R[j]=null}),de(),s=R[t],s?s.p(w(b,t),D):(s=R[t]=I[t](w(b,t)),s.c()),k(s,1),s.m(n,null));const E={};D&1&&(E.active=b[0]),D&2&&(E.post=b[1]),u.$set(E);let Z=f;f=H(b),f===Z?~f&&A[f].p(b,D):(p&&(_e(),y(A[Z],1,1,()=>{A[Z]=null}),de()),~f?(p=A[f],p?p.p(b,D):(p=A[f]=z[f](b),p.c()),k(p,1),p.m(i,null)):p=null),(!g||D&2&&h!==(h=at(b[1].id)))&&_(e,"id",h),(!g||D&1)&&ye(e,"openTab",b[0])},i(b){g||(k(s),k(r.$$.fragment,b),k(u.$$.fragment,b),k(p),g=!0)},o(b){y(s),y(r.$$.fragment,b),y(u.$$.fragment,b),y(p),g=!1},d(b){b&&d(e),R[t].d(),q(r),q(u),~f&&A[f].d(),v=!1,ze($)}}}function ks(l,e,n){let t,s;fe(l,jn,$=>n(2,t=$)),fe(l,Bn,$=>n(3,s=$));const o=Be();let{post:r}=e,{openTab:a=void 0}=e;const i=$=>{n(0,a=a===$?void 0:$)},u=[new URL(`https://kurosearch.com/post?id=${r.id}&src=${encodeURIComponent(r.file_url)}`),new URL(`https://rule34.xxx/index.php?page=post&s=view&id=${r.id}`),new URL(r.file_url),...r.source?r.source.split(" ").filter($=>Hn($)).map($=>new URL($)):[]],c=()=>o("fullscreen"),f=()=>i("tags"),p=()=>i("comments"),h=()=>i("links"),g=$=>{$.key==="f"&&o("fullscreen")},v=()=>{t&&i("tags")};return l.$$set=$=>{"post"in $&&n(1,r=$.post),"openTab"in $&&n(0,a=$.openTab)},[a,r,t,s,o,i,u,c,f,p,h,g,v]}class ws extends ce{constructor(e){super(),ue(this,e,ks,bs,ae,{post:1,openTab:0})}}function jt(l,e,n){const t=l.slice();return t[7]=e[n],t[9]=n,t}function At(l,e,n){const t=l.slice();return t[7]=e[n],t[9]=n,t}function ys(l){let e,n,t=Se(l[1].posts),s=[];for(let r=0;r<t.length;r+=1)s[r]=Vt(jt(l,t,r));const o=r=>y(s[r],1,1,()=>{s[r]=null});return{c(){e=S("ol");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){e=C(r,"OL",{class:!0,style:!0});var a=V(e);for(let i=0;i<s.length;i+=1)s[i].l(a);a.forEach(d),this.h()},h(){_(e,"class","multi-column svelte-1nfzeed"),Ne(e,"--nr-columns",l[2])},m(r,a){F(r,e,a);for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(e,null);n=!0},p(r,a){if(a&3){t=Se(r[1].posts);let i;for(i=0;i<t.length;i+=1){const u=jt(r,t,i);s[i]?(s[i].p(u,a),k(s[i],1)):(s[i]=Vt(u),s[i].c(),k(s[i],1),s[i].m(e,null))}for(_e(),i=t.length;i<s.length;i+=1)o(i);de()}(!n||a&4)&&Ne(e,"--nr-columns",r[2])},i(r){if(!n){for(let a=0;a<t.length;a+=1)k(s[a]);n=!0}},o(r){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)y(s[a]);n=!1},d(r){r&&d(e),Qe(s,r)}}}function Es(l){let e,n,t=Se(l[1].posts),s=[];for(let r=0;r<t.length;r+=1)s[r]=Ot(At(l,t,r));const o=r=>y(s[r],1,1,()=>{s[r]=null});return{c(){e=S("ol");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){e=C(r,"OL",{class:!0});var a=V(e);for(let i=0;i<s.length;i+=1)s[i].l(a);a.forEach(d),this.h()},h(){_(e,"class","single-column svelte-1nfzeed")},m(r,a){F(r,e,a);for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(e,null);n=!0},p(r,a){if(a&3){t=Se(r[1].posts);let i;for(i=0;i<t.length;i+=1){const u=At(r,t,i);s[i]?(s[i].p(u,a),k(s[i],1)):(s[i]=Ot(u),s[i].c(),k(s[i],1),s[i].m(e,null))}for(_e(),i=t.length;i<s.length;i+=1)o(i);de()}},i(r){if(!n){for(let a=0;a<t.length;a+=1)k(s[a]);n=!0}},o(r){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)y(s[a]);n=!1},d(r){r&&d(e),Qe(s,r)}}}function Vt(l){let e,n;function t(){return l[5](l[9])}return e=new ls({props:{post:l[7]}}),e.$on("click",t),{c(){O(e.$$.fragment)},l(s){B(e.$$.fragment,s)},m(s,o){M(e,s,o),n=!0},p(s,o){l=s;const r={};o&2&&(r.post=l[7]),e.$set(r)},i(s){n||(k(e.$$.fragment,s),n=!0)},o(s){y(e.$$.fragment,s),n=!1},d(s){q(e,s)}}}function Ot(l){let e,n;function t(){return l[4](l[9])}return e=new ws({props:{post:l[7]}}),e.$on("fullscreen",t),{c(){O(e.$$.fragment)},l(s){B(e.$$.fragment,s)},m(s,o){M(e,s,o),n=!0},p(s,o){l=s;const r={};o&2&&(r.post=l[7]),e.$set(r)},i(s){n||(k(e.$$.fragment,s),n=!0)},o(s){y(e.$$.fragment,s),n=!1},d(s){q(e,s)}}}function Bt(l){let e,n;return e=new es({props:{index:l[0]}}),e.$on("close",l[3]),e.$on("endreached",l[6]),{c(){O(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p(t,s){const o={};s&1&&(o.index=t[0]),e.$set(o)},i(t){n||(k(e.$$.fragment,t),n=!0)},o(t){y(e.$$.fragment,t),n=!1},d(t){q(e,t)}}}function Ss(l){let e,n,t,s,o;const r=[Es,ys],a=[];function i(c,f){return c[2]==="1"?0:1}e=i(l),n=a[e]=r[e](l);let u=l[0]!==void 0&&Bt(l);return{c(){n.c(),t=P(),u&&u.c(),s=Oe()},l(c){n.l(c),t=L(c),u&&u.l(c),s=Oe()},m(c,f){a[e].m(c,f),F(c,t,f),u&&u.m(c,f),F(c,s,f),o=!0},p(c,[f]){let p=e;e=i(c),e===p?a[e].p(c,f):(_e(),y(a[p],1,1,()=>{a[p]=null}),de(),n=a[e],n?n.p(c,f):(n=a[e]=r[e](c),n.c()),k(n,1),n.m(t.parentNode,t)),c[0]!==void 0?u?(u.p(c,f),f&1&&k(u,1)):(u=Bt(c),u.c(),k(u,1),u.m(s.parentNode,s)):u&&(_e(),y(u,1,1,()=>{u=null}),de())},i(c){o||(k(n),k(u),o=!0)},o(c){y(n),y(u),o=!1},d(c){c&&(d(t),d(s)),a[e].d(c),u&&u.d(c)}}}function Cs(l,e,n){let t,s;fe(l,We,c=>n(1,t=c)),fe(l,Ht,c=>n(2,s=c));let o;const r=c=>{var h;const f=t.posts[c.detail],p=at(f.id);(h=document.getElementById(p))==null||h.scrollIntoView(),n(0,o=void 0)},a=c=>{n(0,o=c)},i=c=>{n(0,o=c)};function u(c){Fe.call(this,l,c)}return l.$$.update=()=>{var c;l.$$.dirty&1&&(o!==void 0?history.pushState({...history.state,fullscreen:!0},""):(c=history.state)!=null&&c.fullscreen&&history.back())},[o,t,s,r,a,i,u]}class Is extends ce{constructor(e){super(),ue(this,e,Cs,Ss,ae,{})}}function Ds(l){let e;return{c(){e=oe("Reset Filter")},l(n){e=ie(n,"Reset Filter")},m(n,t){F(n,e,t)},d(n){n&&d(e)}}}function Ts(l){let e;return{c(){e=oe("Reset Tags")},l(n){e=ie(n,"Reset Tags")},m(n,t){F(n,e,t)},d(n){n&&d(e)}}}function Ps(l){let e,n,t,s,o="We couldn't find any posts matching your tags. Sorry...",r,a,i,u,c,f;return i=new Je({props:{title:"In case your filter caused all posts to vanish. Reset it.",$$slots:{default:[Ds]},$$scope:{ctx:l}}}),i.$on("click",l[1]),c=new Je({props:{title:"Tag combinations that are too specific will not yield results.",$$slots:{default:[Ts]},$$scope:{ctx:l}}}),c.$on("click",l[2]),{c(){e=S("img"),t=P(),s=S("p"),s.textContent=o,r=P(),a=S("div"),O(i.$$.fragment),u=P(),O(c.$$.fragment),this.h()},l(p){e=C(p,"IMG",{src:!0,alt:!0,class:!0}),t=L(p),s=C(p,"P",{"data-svelte-h":!0}),pe(s)!=="svelte-1utxj3w"&&(s.textContent=o),r=L(p),a=C(p,"DIV",{class:!0});var h=V(a);B(i.$$.fragment,h),u=L(h),B(c.$$.fragment,h),h.forEach(d),this.h()},h(){Ee(e.src,n=Wt+"/assets/shironeko-confused.png")||_(e,"src",n),_(e,"alt","Nothing here..."),_(e,"class","svelte-1oxspdj"),_(a,"class","svelte-1oxspdj")},m(p,h){F(p,e,h),F(p,t,h),F(p,s,h),F(p,r,h),F(p,a,h),M(i,a,null),m(a,u),M(c,a,null),f=!0},p(p,[h]){const g={};h&8&&(g.$$scope={dirty:h,ctx:p}),i.$set(g);const v={};h&8&&(v.$$scope={dirty:h,ctx:p}),c.$set(v)},i(p){f||(k(i.$$.fragment,p),k(c.$$.fragment,p),f=!0)},o(p){y(i.$$.fragment,p),y(c.$$.fragment,p),f=!1},d(p){p&&(d(e),d(t),d(s),d(r),d(a)),q(i),q(c)}}}function Ls(l){const e=Be();return[e,()=>{Ke.reset(),Ue.reset(),e("sortfilterupdate")},()=>{it.reset(),ft.reset()}]}class Ns extends ce{constructor(e){super(),ue(this,e,Ls,Ps,ae,{})}}function Mt(l,e,n){const t=l.slice();return t[5]=e[n][0],t[6]=e[n][1],t}function qt(l){let e,n,t,s=!1,o,r,a,i=l[6]+"",u,c,f,p,h;return f=mn(l[4][0]),{c(){e=S("input"),r=P(),a=S("label"),u=oe(i),this.h()},l(g){e=C(g,"INPUT",{type:!0,name:!0,id:!0,class:!0}),r=L(g),a=C(g,"LABEL",{for:!0,class:!0});var v=V(a);u=ie(v,i),v.forEach(d),this.h()},h(){_(e,"type","radio"),_(e,"name",n="group-"+l[1]),e.__value=t=l[5],He(e,e.__value),_(e,"id",o=l[1]+"-"+l[5]),_(e,"class","svelte-16oxivo"),_(a,"for",c=l[1]+"-"+l[5]),_(a,"class","svelte-16oxivo"),f.p(e)},m(g,v){F(g,e,v),e.checked=e.__value===l[0],F(g,r,v),F(g,a,v),m(a,u),p||(h=ee(e,"change",l[3]),p=!0)},p(g,v){v&2&&n!==(n="group-"+g[1])&&_(e,"name",n),v&4&&t!==(t=g[5])&&(e.__value=t,He(e,e.__value),s=!0),v&6&&o!==(o=g[1]+"-"+g[5])&&_(e,"id",o),(s||v&5)&&(e.checked=e.__value===g[0]),v&4&&i!==(i=g[6]+"")&&Ie(u,i),v&6&&c!==(c=g[1]+"-"+g[5])&&_(a,"for",c)},d(g){g&&(d(e),d(r),d(a)),f.r(),p=!1,h()}}}function Fs(l){let e,n,t=Se(Object.entries(l[2])),s=[];for(let o=0;o<t.length;o+=1)s[o]=qt(Mt(l,t,o));return{c(){e=S("div");for(let o=0;o<s.length;o+=1)s[o].c();this.h()},l(o){e=C(o,"DIV",{id:!0,role:!0,class:!0});var r=V(e);for(let a=0;a<s.length;a+=1)s[a].l(r);r.forEach(d),this.h()},h(){_(e,"id",n="group-"+l[1]),_(e,"role","radiogroup"),_(e,"class","svelte-16oxivo")},m(o,r){F(o,e,r);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null)},p(o,[r]){if(r&7){t=Se(Object.entries(o[2]));let a;for(a=0;a<t.length;a+=1){const i=Mt(o,t,a);s[a]?s[a].p(i,r):(s[a]=qt(i),s[a].c(),s[a].m(e,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}r&2&&n!==(n="group-"+o[1])&&_(e,"id",n)},i:Y,o:Y,d(o){o&&d(e),Qe(s,o)}}}function Rs(l,e,n){let{name:t}=e,{value:s}=e,{options:o}=e;const r=[[]];function a(){s=this.__value,n(0,s)}return l.$$set=i=>{"name"in i&&n(1,t=i.name),"value"in i&&n(0,s=i.value),"options"in i&&n(2,o=i.options)},[s,t,o,a,r]}class js extends ce{constructor(e){super(),ue(this,e,Rs,Fs,ae,{name:1,value:0,options:2})}}const As=Object.freeze({id:{asc:"Oldest",desc:"Newest"},score:{asc:"Worst",desc:"Best"},updated:{asc:"Inactive",desc:"Active"},random:{asc:"Random",desc:"Random"}}),sn=Object.freeze({">=":"≥","<=":"≤"}),rn=Object.freeze({all:"All",safe:"Safe",questionable:"Questionable",explicit:"Explicit"}),Vs=Object.freeze({id:"Uploaded",score:"Score",updated:"Updated",random:"Random"}),Os=Object.freeze({desc:"codicon codicon-arrow-down",asc:"codicon codicon-arrow-up"}),Bs=(l,e)=>l===0&&e===">="?void 0:`Score ${sn[e]} ${Ve(l)}`,Ms=l=>l==="all"?void 0:rn[l],qs=(l,e,n)=>{let t=Ms(l),s=Bs(e,n);return[t,s].filter(o=>o!==void 0).join(",")||"All"},zs=(l,e)=>As[l][e];function Us(l){let e;return{c(){e=oe("Done")},l(n){e=ie(n,"Done")},m(n,t){F(n,e,t)},d(n){n&&d(e)}}}function Hs(l){let e;return{c(){e=oe("Reset")},l(n){e=ie(n,"Reset")},m(n,t){F(n,e,t)},d(n){n&&d(e)}}}function Gs(l){let e,n,t="Sorting and Filtering",s,o,r,a="Sorting",i,u,c,f,p,h,g,v,$,I,R="Filtering by Score",N,w,z,A,H,b,D,j,E,Z,T="Rating",U,W,re,J,K,te,x,he;function Ce(Q){l[4](Q)}let Me={options:Os};l[1].direction!==void 0&&(Me.value=l[1].direction),c=new yn({props:Me}),me.push(()=>Le(c,"value",Ce));function De(Q){l[5](Q)}let lt={options:Vs};l[1].property!==void 0&&(lt.value=l[1].property),h=new xn({props:lt}),me.push(()=>Le(h,"value",De));function st(Q){l[6](Q)}let Re={options:sn};l[2].scoreComparator!==void 0&&(Re.value=l[2].scoreComparator),z=new el({props:Re}),me.push(()=>Le(z,"value",st));function rt(Q){l[7](Q)}let Ye={min:0,max:1e4,step:1};l[2].scoreValue!==void 0&&(Ye.value=l[2].scoreValue),b=new An({props:Ye}),me.push(()=>Le(b,"value",rt));function Te(Q){l[8](Q)}let Ge={name:"rating",options:rn};return l[2].rating!==void 0&&(Ge.value=l[2].rating),W=new js({props:Ge}),me.push(()=>Le(W,"value",Te)),K=new Je({props:{title:"Return to searching",$$slots:{default:[Us]},$$scope:{ctx:l}}}),K.$on("click",l[9]),x=new Je({props:{title:"Reset sort and filter",type:"secondary",$$slots:{default:[Hs]},$$scope:{ctx:l}}}),x.$on("click",l[3]),{c(){e=S("div"),n=S("h3"),n.textContent=t,s=P(),o=S("div"),r=S("b"),r.textContent=a,i=P(),u=S("div"),O(c.$$.fragment),p=P(),O(h.$$.fragment),v=P(),$=S("div"),I=S("b"),I.textContent=R,N=P(),w=S("div"),O(z.$$.fragment),H=P(),O(b.$$.fragment),j=P(),E=S("div"),Z=S("b"),Z.textContent=T,U=P(),O(W.$$.fragment),J=P(),O(K.$$.fragment),te=P(),O(x.$$.fragment),this.h()},l(Q){e=C(Q,"DIV",{class:!0});var le=V(e);n=C(le,"H3",{"data-svelte-h":!0}),pe(n)!=="svelte-15zouq3"&&(n.textContent=t),s=L(le),o=C(le,"DIV",{});var je=V(o);r=C(je,"B",{class:!0,"data-svelte-h":!0}),pe(r)!=="svelte-ekzpgg"&&(r.textContent=a),i=L(je),u=C(je,"DIV",{class:!0});var $e=V(u);B(c.$$.fragment,$e),p=L($e),B(h.$$.fragment,$e),$e.forEach(d),je.forEach(d),v=L(le),$=C(le,"DIV",{});var ve=V($);I=C(ve,"B",{class:!0,"data-svelte-h":!0}),pe(I)!=="svelte-1flca3"&&(I.textContent=R),N=L(ve),w=C(ve,"DIV",{class:!0});var ne=V(w);B(z.$$.fragment,ne),H=L(ne),B(b.$$.fragment,ne),ne.forEach(d),ve.forEach(d),j=L(le),E=C(le,"DIV",{});var be=V(E);Z=C(be,"B",{class:!0,"data-svelte-h":!0}),pe(Z)!=="svelte-1lwyn2b"&&(Z.textContent=T),U=L(be),B(W.$$.fragment,be),be.forEach(d),J=L(le),B(K.$$.fragment,le),te=L(le),B(x.$$.fragment,le),le.forEach(d),this.h()},h(){_(r,"class","svelte-fm5hcv"),_(u,"class","row svelte-fm5hcv"),_(I,"class","svelte-fm5hcv"),_(w,"class","row svelte-fm5hcv"),_(Z,"class","svelte-fm5hcv"),_(e,"class","container svelte-fm5hcv")},m(Q,le){F(Q,e,le),m(e,n),m(e,s),m(e,o),m(o,r),m(o,i),m(o,u),M(c,u,null),m(u,p),M(h,u,null),m(e,v),m(e,$),m($,I),m($,N),m($,w),M(z,w,null),m(w,H),M(b,w,null),m(e,j),m(e,E),m(E,Z),m(E,U),M(W,E,null),m(e,J),M(K,e,null),m(e,te),M(x,e,null),he=!0},p(Q,le){const je={};!f&&le&2&&(f=!0,je.value=Q[1].direction,Pe(()=>f=!1)),c.$set(je);const $e={};!g&&le&2&&(g=!0,$e.value=Q[1].property,Pe(()=>g=!1)),h.$set($e);const ve={};!A&&le&4&&(A=!0,ve.value=Q[2].scoreComparator,Pe(()=>A=!1)),z.$set(ve);const ne={};!D&&le&4&&(D=!0,ne.value=Q[2].scoreValue,Pe(()=>D=!1)),b.$set(ne);const be={};!re&&le&4&&(re=!0,be.value=Q[2].rating,Pe(()=>re=!1)),W.$set(be);const se={};le&4096&&(se.$$scope={dirty:le,ctx:Q}),K.$set(se);const ct={};le&4096&&(ct.$$scope={dirty:le,ctx:Q}),x.$set(ct)},i(Q){he||(k(c.$$.fragment,Q),k(h.$$.fragment,Q),k(z.$$.fragment,Q),k(b.$$.fragment,Q),k(W.$$.fragment,Q),k(K.$$.fragment,Q),k(x.$$.fragment,Q),he=!0)},o(Q){y(c.$$.fragment,Q),y(h.$$.fragment,Q),y(z.$$.fragment,Q),y(b.$$.fragment,Q),y(W.$$.fragment,Q),y(K.$$.fragment,Q),y(x.$$.fragment,Q),he=!1},d(Q){Q&&d(e),q(c),q(h),q(z),q(b),q(W),q(K),q(x)}}}function Ws(l){let e,n,t;function s(r){l[10](r)}let o={$$slots:{default:[Gs]},$$scope:{ctx:l}};return l[0]!==void 0&&(o.dialog=l[0]),e=new Ut({props:o}),me.push(()=>Le(e,"dialog",s)),e.$on("close",l[11]),{c(){O(e.$$.fragment)},l(r){B(e.$$.fragment,r)},m(r,a){M(e,r,a),t=!0},p(r,[a]){const i={};a&4103&&(i.$$scope={dirty:a,ctx:r}),!n&&a&1&&(n=!0,i.dialog=r[0],Pe(()=>n=!1)),e.$set(i)},i(r){t||(k(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){q(e,r)}}}function Ks(l,e,n){let t,s;fe(l,Ke,v=>n(1,t=v)),fe(l,Ue,v=>n(2,s=v));let{dialog:o}=e;const r=()=>{Ke.reset(),Ue.reset()};function a(v){l.$$.not_equal(t.direction,v)&&(t.direction=v,Ke.set(t))}function i(v){l.$$.not_equal(t.property,v)&&(t.property=v,Ke.set(t))}function u(v){l.$$.not_equal(s.scoreComparator,v)&&(s.scoreComparator=v,Ue.set(s))}function c(v){l.$$.not_equal(s.scoreValue,v)&&(s.scoreValue=v,Ue.set(s))}function f(v){l.$$.not_equal(s.rating,v)&&(s.rating=v,Ue.set(s))}const p=()=>o.close();function h(v){o=v,n(0,o)}function g(v){Fe.call(this,l,v)}return l.$$set=v=>{"dialog"in v&&n(0,o=v.dialog)},[o,t,s,r,a,i,u,c,f,p,h,g]}class Js extends ce{constructor(e){super(),ue(this,e,Ks,Ws,ae,{dialog:0})}}function Qs(l){let e,n,t,s,o,r,a,i,u,c,f,p,h,g,v,$;function I(N){l[9](N)}let R={};return l[2]!==void 0&&(R.dialog=l[2]),p=new Js({props:R}),me.push(()=>Le(p,"dialog",I)),p.$on("close",l[10]),{c(){e=S("button"),n=S("i"),t=P(),s=S("span"),o=oe(l[5]),r=P(),a=S("i"),i=P(),u=S("span"),c=oe(l[4]),f=P(),O(p.$$.fragment),this.h()},l(N){e=C(N,"BUTTON",{type:!0,class:!0});var w=V(e);n=C(w,"I",{class:!0}),V(n).forEach(d),t=L(w),s=C(w,"SPAN",{class:!0});var z=V(s);o=ie(z,l[5]),z.forEach(d),r=L(w),a=C(w,"I",{class:!0}),V(a).forEach(d),i=L(w),u=C(w,"SPAN",{class:!0});var A=V(u);c=ie(A,l[4]),A.forEach(d),w.forEach(d),f=L(N),B(p.$$.fragment,N),this.h()},h(){_(n,"class","codicon codicon-filter svelte-3ooqm6"),_(s,"class","svelte-3ooqm6"),_(a,"class","codicon codicon-arrow-swap svelte-3ooqm6"),_(u,"class","svelte-3ooqm6"),_(e,"type","button"),_(e,"class","svelte-3ooqm6")},m(N,w){F(N,e,w),m(e,n),m(e,t),m(e,s),m(s,o),m(e,r),m(e,a),m(e,i),m(e,u),m(u,c),F(N,f,w),M(p,N,w),g=!0,v||($=ee(e,"click",l[8]),v=!0)},p(N,[w]){(!g||w&32)&&Ie(o,N[5]),(!g||w&16)&&Ie(c,N[4]);const z={};!h&&w&4&&(h=!0,z.dialog=N[2],Pe(()=>h=!1)),p.$set(z)},i(N){g||(k(p.$$.fragment,N),g=!0)},o(N){y(p.$$.fragment,N),g=!1},d(N){N&&(d(e),d(f)),q(p,N),v=!1,$()}}}function Ys(l,e,n){let t,s,o,r;fe(l,Ke,g=>n(0,o=g)),fe(l,Ue,g=>n(1,r=g));const a=Be(),i=(g,v)=>JSON.stringify(Object.assign({},g,v));let u,c="";const f=()=>{n(3,c=i(o,r)),u.showModal(),Gt("dialog")};function p(g){u=g,n(2,u)}const h=()=>{i(o,r)!==c&&a("sortfilterupdate")};return l.$$.update=()=>{l.$$.dirty&2&&n(5,t=qs(r.rating,r.scoreValue,r.scoreComparator)),l.$$.dirty&1&&n(4,s=zs(o.property,o.direction))},[o,r,u,c,s,t,a,i,f,p,h]}class Zs extends ce{constructor(e){super(),ue(this,e,Ys,Qs,ae,{})}}function Xs(l){let e,n,t=Ve(l[1].postCount)+"",s,o,r,a,i;return a=new Zs({}),a.$on("sortfilterupdate",l[2]),{c(){e=S("div"),n=S("span"),s=oe(t),o=oe(" posts"),r=P(),O(a.$$.fragment),this.h()},l(u){e=C(u,"DIV",{class:!0});var c=V(e);n=C(c,"SPAN",{class:!0});var f=V(n);s=ie(f,t),o=ie(f," posts"),f.forEach(d),r=L(c),B(a.$$.fragment,c),c.forEach(d),this.h()},h(){_(n,"class","svelte-1f1ky2c"),ye(n,"loading",l[0]),_(e,"class","svelte-1f1ky2c")},m(u,c){F(u,e,c),m(e,n),m(n,s),m(n,o),m(e,r),M(a,e,null),i=!0},p(u,[c]){(!i||c&2)&&t!==(t=Ve(u[1].postCount)+"")&&Ie(s,t),(!i||c&1)&&ye(n,"loading",u[0])},i(u){i||(k(a.$$.fragment,u),i=!0)},o(u){y(a.$$.fragment,u),i=!1},d(u){u&&d(e),q(a)}}}function xs(l,e,n){let t;fe(l,We,r=>n(1,t=r));let{loading:s}=e;function o(r){Fe.call(this,l,r)}return l.$$set=r=>{"loading"in r&&n(0,s=r.loading)},[s,t,o]}class er extends ce{constructor(e){super(),ue(this,e,xs,Xs,ae,{loading:0})}}const{document:pt}=$n;function tr(l){let e;return{c(){e=oe("Search")},l(n){e=ie(n,"Search")},m(n,t){F(n,e,t)},i:Y,o:Y,d(n){n&&d(e)}}}function nr(l){let e,n;return e=new _t({}),{c(){O(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},i(t){n||(k(e.$$.fragment,t),n=!0)},o(t){y(e.$$.fragment,t),n=!1},d(t){q(e,t)}}}function lr(l){let e,n,t,s;const o=[nr,tr],r=[];function a(i,u){return i[0]?0:1}return e=a(l),n=r[e]=o[e](l),{c(){n.c(),t=Oe()},l(i){n.l(i),t=Oe()},m(i,u){r[e].m(i,u),F(i,t,u),s=!0},p(i,u){let c=e;e=a(i),e!==c&&(_e(),y(r[c],1,1,()=>{r[c]=null}),de(),n=r[e],n||(n=r[e]=o[e](i),n.c()),k(n,1),n.m(t.parentNode,t))},i(i){s||(k(n),s=!0)},o(i){y(n),s=!1},d(i){i&&d(t),r[e].d(i)}}}function sr(l){let e,n,t,s,o,r;const a=[ir,or],i=[];function u(c,f){return c[3].postCount===0?0:1}return n=u(l),t=i[n]=a[n](l),o=new Qn({}),{c(){e=S("section"),t.c(),s=P(),O(o.$$.fragment),this.h()},l(c){e=C(c,"SECTION",{class:!0});var f=V(e);t.l(f),f.forEach(d),s=L(c),B(o.$$.fragment,c),this.h()},h(){_(e,"class","svelte-1lt7uko")},m(c,f){F(c,e,f),i[n].m(e,null),F(c,s,f),M(o,c,f),r=!0},p(c,f){let p=n;n=u(c),n===p?i[n].p(c,f):(_e(),y(i[p],1,1,()=>{i[p]=null}),de(),t=i[n],t?t.p(c,f):(t=i[n]=a[n](c),t.c()),k(t,1),t.m(e,null))},i(c){r||(k(t),k(o.$$.fragment,c),r=!0)},o(c){y(t),y(o.$$.fragment,c),r=!1},d(c){c&&(d(e),d(s)),i[n].d(),q(o,c)}}}function rr(l){let e,n;return e=new al({props:{error:l[1]}}),{c(){O(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p(t,s){const o={};s&2&&(o.error=t[1]),e.$set(o)},i(t){n||(k(e.$$.fragment,t),n=!0)},o(t){y(e.$$.fragment,t),n=!1},d(t){q(e,t)}}}function or(l){let e,n,t,s,o,r;e=new Is({}),e.$on("sortfilterupdate",l[9]),e.$on("endreached",l[10]);const a=[cr,ar],i=[];function u(c,f){return c[3].posts.length===c[3].postCount?0:1}return t=u(l),s=i[t]=a[t](l),{c(){O(e.$$.fragment),n=P(),s.c(),o=Oe()},l(c){B(e.$$.fragment,c),n=L(c),s.l(c),o=Oe()},m(c,f){M(e,c,f),F(c,n,f),i[t].m(c,f),F(c,o,f),r=!0},p(c,f){let p=t;t=u(c),t===p?i[t].p(c,f):(_e(),y(i[p],1,1,()=>{i[p]=null}),de(),s=i[t],s?s.p(c,f):(s=i[t]=a[t](c),s.c()),k(s,1),s.m(o.parentNode,o))},i(c){r||(k(e.$$.fragment,c),k(s),r=!0)},o(c){y(e.$$.fragment,c),y(s),r=!1},d(c){c&&(d(n),d(o)),q(e,c),i[t].d(c)}}}function ir(l){let e,n;return e=new Ns({}),e.$on("sortfilterupdate",l[9]),{c(){O(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p:Y,i(t){n||(k(e.$$.fragment,t),n=!0)},o(t){y(e.$$.fragment,t),n=!1},d(t){q(e,t)}}}function ar(l){let e,n,t,s;return e=new tn({props:{absoluteTop:void 0,rootMargin:1e3/Number(l[7])+"px"}}),e.$on("intersection",l[10]),t=new Je({props:{title:"Load more posts",$$slots:{default:[pr]},$$scope:{ctx:l}}}),t.$on("click",l[10]),{c(){O(e.$$.fragment),n=P(),O(t.$$.fragment)},l(o){B(e.$$.fragment,o),n=L(o),B(t.$$.fragment,o)},m(o,r){M(e,o,r),F(o,n,r),M(t,o,r),s=!0},p(o,r){const a={};r&128&&(a.rootMargin=1e3/Number(o[7])+"px"),e.$set(a);const i={};r&16777217&&(i.$$scope={dirty:r,ctx:o}),t.$set(i)},i(o){s||(k(e.$$.fragment,o),k(t.$$.fragment,o),s=!0)},o(o){y(e.$$.fragment,o),y(t.$$.fragment,o),s=!1},d(o){o&&d(n),q(e,o),q(t,o)}}}function cr(l){let e,n;return e=new ul({}),{c(){O(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p:Y,i(t){n||(k(e.$$.fragment,t),n=!0)},o(t){y(e.$$.fragment,t),n=!1},d(t){q(e,t)}}}function ur(l){let e;return{c(){e=oe("Load more")},l(n){e=ie(n,"Load more")},m(n,t){F(n,e,t)},i:Y,o:Y,d(n){n&&d(e)}}}function fr(l){let e,n;return e=new _t({}),{c(){O(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},i(t){n||(k(e.$$.fragment,t),n=!0)},o(t){y(e.$$.fragment,t),n=!1},d(t){q(e,t)}}}function pr(l){let e,n,t,s;const o=[fr,ur],r=[];function a(i,u){return i[0]?0:1}return e=a(l),n=r[e]=o[e](l),{c(){n.c(),t=Oe()},l(i){n.l(i),t=Oe()},m(i,u){r[e].m(i,u),F(i,t,u),s=!0},p(i,u){let c=e;e=a(i),e!==c&&(_e(),y(r[c],1,1,()=>{r[c]=null}),de(),n=r[e],n||(n=r[e]=o[e](i),n.c()),k(n,1),n.m(t.parentNode,t))},i(i){s||(k(n),s=!0)},o(i){y(n),s=!1},d(i){i&&d(t),r[e].d(i)}}}function zt(l){let e;return{c(){e=S("div"),this.h()},l(n){e=C(n,"DIV",{class:!0}),V(e).forEach(d),this.h()},h(){_(e,"class","svelte-1lt7uko")},m(n,t){F(n,e,t)},d(n){n&&d(e)}}}function _r(l){let e,n,t,s,o,r,a,i,u,c,f,p,h,g,v,$,I,R,N,w,z,A;t=new vn({}),r=new kn({}),i=new Jn({props:{placeholder:"Search for tags",fetchSuggestions:l[8]}}),i.$on("pick",l[11]),c=new Je({props:{id:"btn-search",title:"Search with the tags above",$$slots:{default:[lr]},$$scope:{ctx:l}}}),c.$on("click",l[9]),p=new wn({props:{tags:[...l[5],...l[4]]}}),p.$on("click",l[12]),p.$on("contextmenu",l[13]),p.$on("createSupertag",l[14]),g=new er({props:{loading:l[0]}}),g.$on("sortfilterupdate",l[9]);const H=[rr,sr],b=[];function D(T,U){return T[1]?0:T[3].requested?1:-1}~($=D(l))&&(I=b[$]=H[$](l));let j=l[0]&&zt();function E(T){l[15](T)}let Z={tags:l[5]};return l[2]!==void 0&&(Z.dialog=l[2]),w=new rl({props:Z}),me.push(()=>Le(w,"dialog",E)),w.$on("submit",l[16]),{c(){e=S("meta"),n=P(),O(t.$$.fragment),s=P(),o=S("section"),O(r.$$.fragment),a=P(),O(i.$$.fragment),u=P(),O(c.$$.fragment),f=P(),O(p.$$.fragment),h=P(),O(g.$$.fragment),v=P(),I&&I.c(),R=P(),j&&j.c(),N=P(),O(w.$$.fragment),this.h()},l(T){const U=hn("svelte-7jdp3v",pt.head);e=C(U,"META",{name:!0,content:!0}),U.forEach(d),n=L(T),B(t.$$.fragment,T),s=L(T),o=C(T,"SECTION",{id:!0,class:!0});var W=V(o);B(r.$$.fragment,W),a=L(W),B(i.$$.fragment,W),u=L(W),B(c.$$.fragment,W),f=L(W),B(p.$$.fragment,W),W.forEach(d),h=L(T),B(g.$$.fragment,T),v=L(T),I&&I.l(T),R=L(T),j&&j.l(T),N=L(T),B(w.$$.fragment,T),this.h()},h(){pt.title="kurosearch - Rule34 Hentai",_(e,"name","description"),_(e,"content","Simple and powerful Rule34 browsing site with a focus on simplicity and user experience."),_(o,"id","search"),_(o,"class","svelte-1lt7uko")},m(T,U){m(pt.head,e),F(T,n,U),M(t,T,U),F(T,s,U),F(T,o,U),M(r,o,null),m(o,a),M(i,o,null),m(o,u),M(c,o,null),m(o,f),M(p,o,null),F(T,h,U),M(g,T,U),F(T,v,U),~$&&b[$].m(T,U),F(T,R,U),j&&j.m(T,U),F(T,N,U),M(w,T,U),A=!0},p(T,[U]){const W={};U&16777217&&(W.$$scope={dirty:U,ctx:T}),c.$set(W);const re={};U&48&&(re.tags=[...T[5],...T[4]]),p.$set(re);const J={};U&1&&(J.loading=T[0]),g.$set(J);let K=$;$=D(T),$===K?~$&&b[$].p(T,U):(I&&(_e(),y(b[K],1,1,()=>{b[K]=null}),de()),~$?(I=b[$],I?I.p(T,U):(I=b[$]=H[$](T),I.c()),k(I,1),I.m(R.parentNode,R)):I=null),T[0]?j||(j=zt(),j.c(),j.m(N.parentNode,N)):j&&(j.d(1),j=null);const te={};U&32&&(te.tags=T[5]),!z&&U&4&&(z=!0,te.dialog=T[2],Pe(()=>z=!1)),w.$set(te)},i(T){A||(k(t.$$.fragment,T),k(r.$$.fragment,T),k(i.$$.fragment,T),k(c.$$.fragment,T),k(p.$$.fragment,T),k(g.$$.fragment,T),k(I),k(w.$$.fragment,T),A=!0)},o(T){y(t.$$.fragment,T),y(r.$$.fragment,T),y(i.$$.fragment,T),y(c.$$.fragment,T),y(p.$$.fragment,T),y(g.$$.fragment,T),y(I),y(w.$$.fragment,T),A=!1},d(T){T&&(d(n),d(s),d(o),d(h),d(v),d(R),d(N)),d(e),q(t,T),q(r),q(i),q(c),q(p),q(g,T),~$&&b[$].d(T),j&&j.d(T),q(w,T)}}}function dr(l,e,n){let t,s,o,r,a,i,u,c;fe(l,We,E=>n(3,t=E)),fe(l,ft,E=>n(4,s=E)),fe(l,Ue,E=>n(18,o=E)),fe(l,Ke,E=>n(19,r=E)),fe(l,Xn,E=>n(20,a=E)),fe(l,it,E=>n(5,i=E)),fe(l,ht,E=>n(6,u=E)),fe(l,Ht,E=>n(7,c=E)),console.log(`%ckurosearch
%cHi, if you are reading this because you are debugging or reverse-engineering, feel free to send me a DM on Discord :)`,"color:crimson;font-size:32px;","color:unset;font-size:auto;");let f=!1,p,h,g=0;const v=async E=>{const Z=await Gn(E);return[...u.items.filter(({name:U})=>U.toLowerCase().includes(E.toLowerCase())).map(U=>({label:U.name,count:U.tags.length,type:"supertag"})),...Z]},$=()=>new Kn().withPid(t.pageCount).withTags(i).withBlockedContent(a).withSortProperty(r.property).withSortDirection(r.direction).withScoreValue(o.scoreValue).withScoreComparator(o.scoreComparator).withRating(o.rating).withSupertags(s),I=async E=>{if(!f){n(1,p=void 0),n(0,f=!0);try{const Z=t.pageCount;await E(),Yn(Z).catch(()=>{})}catch(Z){n(1,p=Z),console.warn(Z)}finally{n(0,f=!1)}}},R=async()=>{We.reset(),g=0,I(async()=>{const[E,Z]=await $().getPageAndCount();We.addPage(E,Z)})},N=async()=>{I(async()=>{const E=await $().getPage();We.addPage(E)})},w=E=>{var Z,T;if((E.key==="/"||E.key==="s")&&(!document.activeElement||document.activeElement===document.body)&&((Z=document.getElementById("searchbar"))==null||Z.focus(),E.preventDefault(),E.stopPropagation()),E.ctrlKey&&E.key==="Enter"&&(E.preventDefault(),E.stopPropagation(),R()),E.ctrlKey&&E.key==="m"&&((T=document.getElementById("select-modifier"))==null||T.click()),E.ctrlKey&&E.key==="ArrowDown"){const U=document.getElementsByClassName("post-media");U[g].focus(),g=Math.min(g+1,Math.max(0,U.length-1))}E.ctrlKey&&E.key==="ArrowUp"&&(document.getElementsByClassName("post-media")[g].focus(),g=Math.max(g-1,0))};tt(async()=>{document.addEventListener("keydown",w),t.postCount===0&&R()}),nt(()=>{document.removeEventListener("keydown",w)});const z=async E=>{const Z=E.detail;if(Z.type==="supertag"){const T=u.items.find(U=>U.name===Z.label);if(!T){console.warn("Supertag not present.");return}ft.addOrReplace(T)}else{const T=await Wn(E.detail.label);it.addOrReplace({name:E.detail.label,modifier:E.detail.modifier,count:E.detail.count,type:(T==null?void 0:T.type)??"tag"})}},A=E=>"description"in E.detail?ft.removeByName(E.detail.name):it.removeByName(E.detail.name),H=E=>{"description"in E.detail||(E.detail.modifier=Zn(E.detail.modifier),it.addOrReplace(E.detail))},b=()=>{h.showModal(),Gt("dialog")};function D(E){h=E,n(2,h)}return[f,p,h,t,s,i,u,c,v,R,N,z,A,H,b,D,E=>ht.add(E.detail)]}class Hr extends ce{constructor(e){super(),ue(this,e,dr,_r,ae,{})}}export{Hr as component};
