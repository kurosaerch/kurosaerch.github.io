import{s as X,D as ge,f as C,a as N,g as I,h as O,y as fe,c as P,d as v,j as h,r as dt,i as T,u as k,E as Ee,F as ae,G as Ge,H as qe,l as re,m as oe,v as W,I as ce,e as _e,n as Ve,C as le,J as Dt,p as pe,K as Te,L as mt,M as Be,k as de,N as Re,w as Nt,O as Pt,z as Tt,A as Ot,B as Vt,o as Le,P as Ae}from"../chunks/scheduler.0a29c992.js";import{S as x,i as ee,b as R,d as F,m as M,a as w,t as S,e as L,g as ne,c as se,f as Oe}from"../chunks/index.6d8df040.js";import{e as me}from"../chunks/each.e59479a4.js";import{D as gt,r as Rt}from"../chunks/result-columns-store.7454cbad.js";import{T as Fe}from"../chunks/TextButton.f6017ea8.js";import{D as Ft}from"../chunks/DetailedTag.6129a1d8.js";import{K as Mt,A as Lt}from"../chunks/ActiveTagList.0ac41c7b.js";import{b as ht}from"../chunks/paths.d6b2fd94.js";import{s as Se,f as we,r as Ce,a as ze,S as At}from"../chunks/active-supertags-store.11df592d.js";import{i as $t,D as vt,g as bt,G as jt,V as Bt,a as Ye,I as Gt,b as qt,c as zt}from"../chunks/Details.a353112a.js";import{f as Me}from"../chunks/format-tag.7e313273.js";import{R as Ut,I as kt}from"../chunks/ModifierSelect.51f2ca82.js";import{S as Ze}from"../chunks/Select.0781c4e2.js";import{R as Ht}from"../chunks/RotatingTextSelect.f25d5f18.js";import{a as Kt}from"../chunks/always-loop-store.ec22e8f2.js";import{S as Wt,n as Yt,s as Je}from"../chunks/supertags-store.ef0243e2.js";import{S as Zt}from"../chunks/ScrollUpButton.be9a5994.js";import{g as Jt,a as Qt}from"../chunks/tags.49324235.js";import{l as Xt}from"../chunks/analytics.eca95ce1.js";import{a as je}from"../chunks/active-tags-store.a60398a6.js";import{b as xt}from"../chunks/blocked-content-store.2a43e35e.js";function Qe(l,e,n){const t=l.slice();return t[9]=e[n],t}function Xe(l){let e,n;return e=new Ft({props:{tag:l[9]}}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p(t,s){const r={};s&4&&(r.tag=t[9]),e.$set(r)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){S(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function en(l){let e;return{c(){e=re("Create supertag")},l(n){e=oe(n,"Create supertag")},m(n,t){T(n,e,t)},d(n){n&&v(e)}}}function tn(l){let e,n,t="Create Supertag",s,r,o,a,i,f="Name",c,p,m,b,D,y="Description",d,$,_,u,g,q="Tags",Y,B,H,ue,E,U,J,Q,te=me(l[2]),G=[];for(let A=0;A<te.length;A+=1)G[A]=Xe(Qe(l,te,A));const Ie=A=>S(G[A],1,1,()=>{G[A]=null});return E=new Fe({props:{title:l[3]?"Click to create supertag":"Enter a valid name to continue",disabled:!l[3],$$slots:{default:[en]},$$scope:{ctx:l}}}),E.$on("click",l[8]),{c(){e=C("section"),n=C("h3"),n.textContent=t,s=N(),r=C("button"),o=N(),a=C("div"),i=C("label"),i.textContent=f,c=N(),p=C("input"),m=N(),b=C("div"),D=C("label"),D.textContent=y,d=N(),$=C("input"),_=N(),u=C("div"),g=C("span"),g.textContent=q,Y=N(),B=C("ol");for(let A=0;A<G.length;A+=1)G[A].c();H=N(),ue=C("div"),R(E.$$.fragment),this.h()},l(A){e=I(A,"SECTION",{class:!0});var V=O(e);n=I(V,"H3",{"data-svelte-h":!0}),fe(n)!=="svelte-ho1cwx"&&(n.textContent=t),s=P(V),r=I(V,"BUTTON",{class:!0}),O(r).forEach(v),o=P(V),a=I(V,"DIV",{class:!0});var Z=O(a);i=I(Z,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),fe(i)!=="svelte-10k8a68"&&(i.textContent=f),c=P(Z),p=I(Z,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),Z.forEach(v),m=P(V),b=I(V,"DIV",{class:!0});var z=O(b);D=I(z,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),fe(D)!=="svelte-14n9kp6"&&(D.textContent=y),d=P(z),$=I(z,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),z.forEach(v),_=P(V),u=I(V,"DIV",{class:!0});var ie=O(u);g=I(ie,"SPAN",{class:!0,"data-svelte-h":!0}),fe(g)!=="svelte-7hjyox"&&(g.textContent=q),Y=P(ie),B=I(ie,"OL",{class:!0});var ye=O(B);for(let Ne=0;Ne<G.length;Ne+=1)G[Ne].l(ye);ye.forEach(v),ie.forEach(v),H=P(V),ue=I(V,"DIV",{class:!0});var De=O(ue);F(E.$$.fragment,De),De.forEach(v),V.forEach(v),this.h()},h(){h(r,"class",dt("codicon codicon-close")+" svelte-xkjm86"),h(i,"for","supertag-name"),h(i,"class","svelte-xkjm86"),h(p,"type","text"),h(p,"placeholder","Descriptive name"),h(p,"id","supertag-name"),h(p,"class","svelte-xkjm86"),h(a,"class","svelte-xkjm86"),h(D,"for","supertag-description"),h(D,"class","svelte-xkjm86"),h($,"type","text"),h($,"placeholder","Short description"),h($,"id","supertag-description"),h($,"class","svelte-xkjm86"),h(b,"class","svelte-xkjm86"),h(g,"class","svelte-xkjm86"),h(B,"class","svelte-xkjm86"),h(u,"class","svelte-xkjm86"),h(ue,"class","last svelte-xkjm86"),h(e,"class","svelte-xkjm86")},m(A,V){T(A,e,V),k(e,n),k(e,s),k(e,r),k(e,o),k(e,a),k(a,i),k(a,c),k(a,p),Ee(p,l[0]),k(e,m),k(e,b),k(b,D),k(b,d),k(b,$),Ee($,l[1]),k(e,_),k(e,u),k(u,g),k(u,Y),k(u,B);for(let Z=0;Z<G.length;Z+=1)G[Z]&&G[Z].m(B,null);k(e,H),k(e,ue),M(E,ue,null),U=!0,J||(Q=[ae(r,"click",l[5]),ae(p,"input",l[6]),ae($,"input",l[7])],J=!0)},p(A,V){if(V&1&&p.value!==A[0]&&Ee(p,A[0]),V&2&&$.value!==A[1]&&Ee($,A[1]),V&4){te=me(A[2]);let z;for(z=0;z<te.length;z+=1){const ie=Qe(A,te,z);G[z]?(G[z].p(ie,V),w(G[z],1)):(G[z]=Xe(ie),G[z].c(),w(G[z],1),G[z].m(B,null))}for(ne(),z=te.length;z<G.length;z+=1)Ie(z);se()}const Z={};V&8&&(Z.title=A[3]?"Click to create supertag":"Enter a valid name to continue"),V&8&&(Z.disabled=!A[3]),V&4096&&(Z.$$scope={dirty:V,ctx:A}),E.$set(Z)},i(A){if(!U){for(let V=0;V<te.length;V+=1)w(G[V]);w(E.$$.fragment,A),U=!0}},o(A){G=G.filter(Boolean);for(let V=0;V<G.length;V+=1)S(G[V]);S(E.$$.fragment,A),U=!1},d(A){A&&v(e),Ge(G,A),L(E),J=!1,qe(Q)}}}function nn(l){let e,n;return e=new gt({props:{$$slots:{default:[tn]},$$scope:{ctx:l}}}),e.$on("close",l[5]),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p(t,[s]){const r={};s&4111&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){S(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function sn(l,e,n){let t,{name:s=""}=e,{description:r=""}=e,{tags:o}=e;const a=ge(),i=()=>a("close");function f(){s=this.value,n(0,s)}function c(){r=this.value,n(1,r)}const p=()=>{a("submit",{name:s,description:r,tags:o.map(({modifier:m,name:b})=>({modifier:m,name:b}))}),i()};return l.$$set=m=>{"name"in m&&n(0,s=m.name),"description"in m&&n(1,r=m.description),"tags"in m&&n(2,o=m.tags)},l.$$.update=()=>{l.$$.dirty&5&&n(3,t=typeof s=="string"&&s!==""&&o.length>1)},[s,r,o,t,a,i,f,c,p]}class ln extends x{constructor(e){super(),ee(this,e,sn,nn,X,{name:0,description:1,tags:2})}}function rn(l){let e,n,t,s,r,o,a,i,f,c;return{c(){e=C("div"),n=C("div"),t=C("i"),s=N(),r=C("div"),o=C("h3"),a=re(l[0]),i=N(),f=C("span"),c=re(l[2]),this.h()},l(p){e=I(p,"DIV",{class:!0});var m=O(e);n=I(m,"DIV",{class:!0});var b=O(n);t=I(b,"I",{class:!0}),O(t).forEach(v),b.forEach(v),s=P(m),r=I(m,"DIV",{});var D=O(r);o=I(D,"H3",{class:!0});var y=O(o);a=oe(y,l[0]),y.forEach(v),i=P(D),f=I(D,"SPAN",{});var d=O(f);c=oe(d,l[2]),d.forEach(v),D.forEach(v),m.forEach(v),this.h()},h(){h(t,"class",dt(l[1])+" svelte-1tvgln1"),h(n,"class","icon svelte-1tvgln1"),h(o,"class","svelte-1tvgln1"),h(e,"class","error svelte-1tvgln1")},m(p,m){T(p,e,m),k(e,n),k(n,t),k(e,s),k(e,r),k(r,o),k(o,a),k(r,i),k(r,f),k(f,c)},p:W,i:W,o:W,d(p){p&&v(e)}}}function on(l,e,n){let{error:t}=e,s=t.message==="Failed to fetch"?"Connection Error":"Application Error",r=t.message==="Failed to fetch"?"codicon codicon-debug-disconnect":"codicon codicon-error",o=t.message==="Failed to fetch"?"Failed to connect to the server. Make sure you have a stable internet connection.":t.message;return l.$$set=a=>{"error"in a&&n(3,t=a.error)},[s,r,o,t]}class an extends x{constructor(e){super(),ee(this,e,on,rn,X,{error:3})}}function cn(l){let e,n,t,s,r="You have seen everything there is to see...";return{c(){e=C("img"),t=N(),s=C("p"),s.textContent=r,this.h()},l(o){e=I(o,"IMG",{src:!0,alt:!0,class:!0}),t=P(o),s=I(o,"P",{"data-svelte-h":!0}),fe(s)!=="svelte-1i75mtf"&&(s.textContent=r),this.h()},h(){ce(e.src,n=ht+"/assets/shironeko-x.png")||h(e,"src",n),h(e,"alt","No more results to load"),h(e,"class","svelte-1pkma0d")},m(o,a){T(o,e,a),T(o,t,a),T(o,s,a)},p:W,i:W,o:W,d(o){o&&(v(e),v(t),v(s))}}}class un extends x{constructor(e){super(),ee(this,e,null,cn,X,{})}}function xe(l){let e,n;return e=new gt({props:{$$slots:{default:[_n]},$$scope:{ctx:l}}}),e.$on("close",l[7]),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p(t,s){const r={};s&65543&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){S(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function fn(l){let e;return{c(){e=re("Done")},l(n){e=oe(n,"Done")},m(n,t){T(n,e,t)},d(n){n&&v(e)}}}function pn(l){let e;return{c(){e=re("Reset")},l(n){e=oe(n,"Reset")},m(n,t){T(n,e,t)},d(n){n&&v(e)}}}function _n(l){let e,n,t="Sorting and Filtering",s,r,o,a="Sorting",i,f,c,p,m,b,D,y,d,$,_="Filtering by Score",u,g,q,Y,B,H,ue,E,U,J="Filtering by Rating",Q,te,G,Ie,A,V,Z,z,ie,ye,De;function Ne(j){l[10](j)}let Ue={options:gn};l[1].direction!==void 0&&(Ue.value=l[1].direction),c=new Ut({props:Ue}),pe.push(()=>Oe(c,"value",Ne));function St(j){l[11](j)}let He={options:mn};l[1].property!==void 0&&(He.value=l[1].property),b=new Ze({props:He}),pe.push(()=>Oe(b,"value",St));function Ct(j){l[12](j)}let Ke={options:hn};l[2].scoreComparator!==void 0&&(Ke.value=l[2].scoreComparator),q=new Ht({props:Ke}),pe.push(()=>Oe(q,"value",Ct));function It(j){l[14](j)}let We={options:wt};return l[2].rating!==void 0&&(We.value=l[2].rating),G=new Ze({props:We}),pe.push(()=>Oe(G,"value",It)),V=new Fe({props:{title:"Return to searching.",$$slots:{default:[fn]},$$scope:{ctx:l}}}),V.$on("click",l[7]),z=new Fe({props:{title:"Reset sort and filter.",type:"secondary",$$slots:{default:[pn]},$$scope:{ctx:l}}}),z.$on("click",l[9]),{c(){e=C("div"),n=C("h3"),n.textContent=t,s=N(),r=C("div"),o=C("b"),o.textContent=a,i=N(),f=C("div"),R(c.$$.fragment),m=N(),R(b.$$.fragment),y=N(),d=C("div"),$=C("b"),$.textContent=_,u=N(),g=C("div"),R(q.$$.fragment),B=N(),H=C("input"),ue=N(),E=C("div"),U=C("b"),U.textContent=J,Q=N(),te=C("div"),R(G.$$.fragment),A=N(),R(V.$$.fragment),Z=N(),R(z.$$.fragment),this.h()},l(j){e=I(j,"DIV",{class:!0});var K=O(e);n=I(K,"H3",{"data-svelte-h":!0}),fe(n)!=="svelte-15zouq3"&&(n.textContent=t),s=P(K),r=I(K,"DIV",{});var he=O(r);o=I(he,"B",{class:!0,"data-svelte-h":!0}),fe(o)!=="svelte-ekzpgg"&&(o.textContent=a),i=P(he),f=I(he,"DIV",{class:!0});var $e=O(f);F(c.$$.fragment,$e),m=P($e),F(b.$$.fragment,$e),$e.forEach(v),he.forEach(v),y=P(K),d=I(K,"DIV",{});var ve=O(d);$=I(ve,"B",{class:!0,"data-svelte-h":!0}),fe($)!=="svelte-1flca3"&&($.textContent=_),u=P(ve),g=I(ve,"DIV",{class:!0});var be=O(g);F(q.$$.fragment,be),B=P(be),H=I(be,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),be.forEach(v),ve.forEach(v),ue=P(K),E=I(K,"DIV",{});var ke=O(E);U=I(ke,"B",{class:!0,"data-svelte-h":!0}),fe(U)!=="svelte-1evbw58"&&(U.textContent=J),Q=P(ke),te=I(ke,"DIV",{class:!0});var Pe=O(te);F(G.$$.fragment,Pe),Pe.forEach(v),ke.forEach(v),A=P(K),F(V.$$.fragment,K),Z=P(K),F(z.$$.fragment,K),K.forEach(v),this.h()},h(){h(o,"class","svelte-gf4ubn"),h(f,"class","row svelte-gf4ubn"),h($,"class","svelte-gf4ubn"),h(H,"type","number"),h(H,"min",0),h(H,"max",1e5),h(H,"step",1),h(H,"class","svelte-gf4ubn"),h(g,"class","row svelte-gf4ubn"),h(U,"class","svelte-gf4ubn"),h(te,"class","row svelte-gf4ubn"),h(e,"class","container svelte-gf4ubn")},m(j,K){T(j,e,K),k(e,n),k(e,s),k(e,r),k(r,o),k(r,i),k(r,f),M(c,f,null),k(f,m),M(b,f,null),k(e,y),k(e,d),k(d,$),k(d,u),k(d,g),M(q,g,null),k(g,B),k(g,H),Ee(H,l[0]),k(e,ue),k(e,E),k(E,U),k(E,Q),k(E,te),M(G,te,null),k(e,A),M(V,e,null),k(e,Z),M(z,e,null),ie=!0,ye||(De=[ae(H,"input",l[13]),ae(H,"keyup",l[8])],ye=!0)},p(j,K){const he={};!p&&K&2&&(p=!0,he.value=j[1].direction,Te(()=>p=!1)),c.$set(he);const $e={};!D&&K&2&&(D=!0,$e.value=j[1].property,Te(()=>D=!1)),b.$set($e);const ve={};!Y&&K&4&&(Y=!0,ve.value=j[2].scoreComparator,Te(()=>Y=!1)),q.$set(ve),K&1&&mt(H.value)!==j[0]&&Ee(H,j[0]);const be={};!Ie&&K&4&&(Ie=!0,be.value=j[2].rating,Te(()=>Ie=!1)),G.$set(be);const ke={};K&65536&&(ke.$$scope={dirty:K,ctx:j}),V.$set(ke);const Pe={};K&65536&&(Pe.$$scope={dirty:K,ctx:j}),z.$set(Pe)},i(j){ie||(w(c.$$.fragment,j),w(b.$$.fragment,j),w(q.$$.fragment,j),w(G.$$.fragment,j),w(V.$$.fragment,j),w(z.$$.fragment,j),ie=!0)},o(j){S(c.$$.fragment,j),S(b.$$.fragment,j),S(q.$$.fragment,j),S(G.$$.fragment,j),S(V.$$.fragment,j),S(z.$$.fragment,j),ie=!1},d(j){j&&v(e),L(c),L(b),L(q),L(G),L(V),L(z),ye=!1,qe(De)}}}function dn(l){let e,n,t,s,r,o,a,i,f,c,p,m,b,D,y,d=l[3]&&xe(l);return{c(){e=C("button"),n=C("i"),t=N(),s=C("span"),r=re(l[5]),o=N(),a=C("i"),i=N(),f=C("span"),c=re(l[4]),p=N(),d&&d.c(),m=_e(),this.h()},l($){e=I($,"BUTTON",{class:!0});var _=O(e);n=I(_,"I",{class:!0}),O(n).forEach(v),t=P(_),s=I(_,"SPAN",{});var u=O(s);r=oe(u,l[5]),u.forEach(v),o=P(_),a=I(_,"I",{class:!0}),O(a).forEach(v),i=P(_),f=I(_,"SPAN",{});var g=O(f);c=oe(g,l[4]),g.forEach(v),_.forEach(v),p=P($),d&&d.l($),m=_e(),this.h()},h(){h(n,"class","codicon codicon-filter svelte-gf4ubn"),h(a,"class","codicon codicon-arrow-swap svelte-gf4ubn"),h(e,"class","svelte-gf4ubn")},m($,_){T($,e,_),k(e,n),k(e,t),k(e,s),k(s,r),k(e,o),k(e,a),k(e,i),k(e,f),k(f,c),T($,p,_),d&&d.m($,_),T($,m,_),b=!0,D||(y=ae(e,"click",l[6]),D=!0)},p($,[_]){(!b||_&32)&&Ve(r,$[5]),(!b||_&16)&&Ve(c,$[4]),$[3]?d?(d.p($,_),_&8&&w(d,1)):(d=xe($),d.c(),w(d,1),d.m(m.parentNode,m)):d&&(ne(),S(d,1,1,()=>{d=null}),se())},i($){b||(w(d),b=!0)},o($){S(d),b=!1},d($){$&&(v(e),v(p),v(m)),d&&d.d($),D=!1,y()}}}const mn=Object.freeze({id:"Uploaded",score:"Score",updated:"Updated",random:"Random"}),gn=Object.freeze({desc:"codicon codicon-arrow-down",asc:"codicon codicon-arrow-up"}),hn=Object.freeze({">=":"≥","<=":"≤"}),wt=Object.freeze({all:"All",safe:"Safe",questionable:"Questionable",explicit:"Explicit"}),$n=Object.freeze({id:{asc:"Oldest",desc:"Newest"},score:{asc:"Worst",desc:"Best"},updated:{asc:"Inactive",desc:"Active"},random:{asc:"Random",desc:"Random"}}),vn=(l,e,n)=>{let t=l==="all"?void 0:wt[l],s=e===0&&n===">="?void 0:`Score${n}${Me(e)}`;return[t,s].filter(r=>r!==void 0).join(",")||"All"};function bn(l,e,n){let t,s,r,o;le(l,Se,u=>n(1,r=u)),le(l,we,u=>n(2,o=u));const a=ge();let i=!1;const f=()=>n(3,i=!0),c=()=>{n(3,i=!1),a("sortfilterupdate")},p=u=>{var g;return $t(u)&&((g=u.target)==null?void 0:g.blur())},m=()=>{Se.reset(),we.reset(),n(0,b=o.scoreValue)};let b;function D(u){l.$$.not_equal(r.direction,u)&&(r.direction=u,Se.set(r))}function y(u){l.$$.not_equal(r.property,u)&&(r.property=u,Se.set(r))}function d(u){l.$$.not_equal(o.scoreComparator,u)&&(o.scoreComparator=u,we.set(o))}function $(){b=mt(this.value),n(0,b),n(2,o)}function _(u){l.$$.not_equal(o.rating,u)&&(o.rating=u,we.set(o))}return l.$$.update=()=>{if(l.$$.dirty&5){b===void 0&&n(0,b=o.scoreValue);let u=Number(b);isNaN(u)||Dt(we,o.scoreValue=u,o)}l.$$.dirty&4&&n(5,t=vn(o.rating,o.scoreValue,o.scoreComparator)),l.$$.dirty&2&&n(4,s=$n[r.property][r.direction])},[b,r,o,i,s,t,f,c,p,m,D,y,d,$,_]}class kn extends x{constructor(e){super(),ee(this,e,bn,dn,X,{})}}function wn(l){const e=l.slice(),n=bt(e[1].file_url,e[1].sample_url,e[1].preview_url);return e[7]=n,e}function yn(l){let e,n;return e=new jt({props:{post:l[1]}}),e.$on("click",l[4]),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p(t,s){const r={};s&2&&(r.post=t[1]),e.$set(r)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){S(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function En(l){let e,n;return e=new Bt({props:{src:l[7].animated,poster:l[7].static,width:l[1].width,height:l[1].height,loop:l[2]||Ye(l[1].tags)}}),e.$on("click",l[4]),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p(t,s){const r={};s&2&&(r.src=t[7].animated),s&2&&(r.poster=t[7].static),s&2&&(r.width=t[1].width),s&2&&(r.height=t[1].height),s&6&&(r.loop=t[2]||Ye(t[1].tags)),e.$set(r)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){S(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function Sn(l){let e,n;return e=new Gt({props:{post:l[1],open:l[0]}}),e.$on("click",l[4]),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p(t,s){const r={};s&2&&(r.post=t[1]),s&1&&(r.open=t[0]),e.$set(r)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){S(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function Cn(l){let e;return{c(){e=C("i"),this.h()},l(n){e=I(n,"I",{class:!0}),O(e).forEach(v),this.h()},h(){h(e,"class","codicon codicon-screen-full")},m(n,t){T(n,e,t)},p:W,d(n){n&&v(e)}}}function et(l){let e,n;return e=new vt({props:{post:l[1]}}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p(t,s){const r={};s&2&&(r.post=t[1]),e.$set(r)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){S(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function In(l){let e,n,t,s,r,o,a,i,f,c;const p=[Sn,En,yn],m=[];function b(d,$){return d[1].type==="image"?0:d[1].type==="video"?1:2}function D(d,$){return $===1?wn(d):d}n=b(l),t=m[n]=p[n](D(l,n)),r=new kt({props:{class:"button-fullscreen","aria-label":"Enter Fullscreen mode",$$slots:{default:[Cn]},$$scope:{ctx:l}}}),r.$on("click",l[5]);let y=l[0]&&et(l);return{c(){e=C("div"),t.c(),s=N(),R(r.$$.fragment),o=N(),y&&y.c(),this.h()},l(d){e=I(d,"DIV",{id:!0,class:!0});var $=O(e);t.l($),s=P($),F(r.$$.fragment,$),o=P($),y&&y.l($),$.forEach(v),this.h()},h(){h(e,"id",a="post_"+l[1].id),h(e,"class","post svelte-pwgq1f"),Be(e,"open",l[0])},m(d,$){T(d,e,$),m[n].m(e,null),k(e,s),M(r,e,null),k(e,o),y&&y.m(e,null),i=!0,f||(c=ae(e,"keydown",l[6]),f=!0)},p(d,[$]){let _=n;n=b(d),n===_?m[n].p(D(d,n),$):(ne(),S(m[_],1,1,()=>{m[_]=null}),se(),t=m[n],t?t.p(D(d,n),$):(t=m[n]=p[n](D(d,n)),t.c()),w(t,1),t.m(e,s));const u={};$&256&&(u.$$scope={dirty:$,ctx:d}),r.$set(u),d[0]?y?(y.p(d,$),$&1&&w(y,1)):(y=et(d),y.c(),w(y,1),y.m(e,null)):y&&(ne(),S(y,1,1,()=>{y=null}),se()),(!i||$&2&&a!==(a="post_"+d[1].id))&&h(e,"id",a),(!i||$&1)&&Be(e,"open",d[0])},i(d){i||(w(t),w(r.$$.fragment,d),w(y),i=!0)},o(d){S(t),S(r.$$.fragment,d),S(y),i=!1},d(d){d&&v(e),m[n].d(),L(r),y&&y.d(),f=!1,c()}}}function Dn(l,e,n){let t;le(l,Kt,c=>n(2,t=c));const s=ge(),r=()=>n(0,a=!a);let{post:o}=e,{open:a=!1}=e;const i=()=>s("fullscreen"),f=c=>{c.key==="f"&&s("fullscreen")};return l.$$set=c=>{"post"in c&&n(1,o=c.post),"open"in c&&n(0,a=c.open)},[a,o,t,s,r,i,f]}class Nn extends x{constructor(e){super(),ee(this,e,Dn,In,X,{post:1,open:0})}}function tt(l){let e,n=l[0].type==="video"?"▶":"GIF",t;return{c(){e=C("span"),t=re(n),this.h()},l(s){e=I(s,"SPAN",{class:!0});var r=O(e);t=oe(r,n),r.forEach(v),this.h()},h(){h(e,"class","type svelte-14imjnt")},m(s,r){T(s,e,r),k(e,t)},p(s,r){r&1&&n!==(n=s[0].type==="video"?"▶":"GIF")&&Ve(t,n)},d(s){s&&v(e)}}}function Pn(l){let e,n,t,s,r,o=Me(l[0].score)+"",a,i,f,c,p,m=l[0].type!=="image"&&tt(l);return{c(){e=C("div"),n=C("img"),s=N(),r=C("span"),a=re(o),i=N(),m&&m.c(),this.h()},l(b){e=I(b,"DIV",{id:!0,class:!0,style:!0});var D=O(e);n=I(D,"IMG",{src:!0,alt:!0,class:!0,tabindex:!0,loading:!0}),s=P(D),r=I(D,"SPAN",{class:!0});var y=O(r);a=oe(y,o),y.forEach(v),i=P(D),m&&m.l(D),D.forEach(v),this.h()},h(){ce(n.src,t=l[1])||h(n,"src",t),h(n,"alt","post"),h(n,"class","post-media svelte-14imjnt"),h(n,"tabindex","-1"),h(n,"loading","lazy"),h(r,"class","score svelte-14imjnt"),h(e,"id",f="post_"+l[0].id),h(e,"class","post svelte-14imjnt"),de(e,"grid-row","span "+l[2]),Be(e,"open",open)},m(b,D){T(b,e,D),k(e,n),k(e,s),k(e,r),k(r,a),k(e,i),m&&m.m(e,null),c||(p=[ae(e,"click",l[3]),ae(e,"keydown",l[4])],c=!0)},p(b,[D]){D&2&&!ce(n.src,t=b[1])&&h(n,"src",t),D&1&&o!==(o=Me(b[0].score)+"")&&Ve(a,o),b[0].type!=="image"?m?m.p(b,D):(m=tt(b),m.c(),m.m(e,null)):m&&(m.d(1),m=null),D&1&&f!==(f="post_"+b[0].id)&&h(e,"id",f),D&0&&Be(e,"open",open)},i:W,o:W,d(b){b&&v(e),m&&m.d(),c=!1,qe(p)}}}function Tn(l,e,n){let t,{post:s}=e,r=Math.min(Math.round(s.height/s.width*5),15);const o=f=>f.endsWith(".jpg")||f.endsWith(".jpeg")||f.endsWith(".png")||f.endsWith(".webp");function a(f){Re.call(this,l,f)}const i=f=>{var c;($t(f)||f.key==="f")&&((c=f.target)==null||c.click())};return l.$$set=f=>{"post"in f&&n(0,s=f.post)},l.$$.update=()=>{l.$$.dirty&1&&n(1,t=o(s.sample_url)?s.sample_url:s.preview_url)},[s,t,r,a,i]}class On extends x{constructor(e){super(),ee(this,e,Tn,Pn,X,{post:0})}}function Vn(l){let e,n,t,s;const r=l[3].default,o=Nt(r,l,l[2],null);return{c(){e=C("div"),o&&o.c(),this.h()},l(a){e=I(a,"DIV",{role:!0,tabindex:!0,class:!0});var i=O(e);o&&o.l(i),i.forEach(v),this.h()},h(){h(e,"role","none"),h(e,"tabindex","-1"),h(e,"class","dialog fullscreen svelte-1gmivor")},m(a,i){T(a,e,i),o&&o.m(e,null),l[5](e),n=!0,t||(s=[ae(e,"keydown",l[4]),ae(e,"click",Pt(Rn))],t=!0)},p(a,[i]){o&&o.p&&(!n||i&4)&&Tt(o,r,a,a[2],n?Vt(r,a[2],i,null):Ot(a[2]),null)},i(a){n||(w(o,a),n=!0)},o(a){S(o,a),n=!1},d(a){a&&v(e),o&&o.d(a),l[5](null),t=!1,qe(s)}}}const Rn=()=>{};function Fn(l,e,n){let{$$slots:t={},$$scope:s}=e;const r=ge(),o=()=>r("close"),a=m=>{m.key==="Escape"&&o()};let i=()=>{document.fullscreenElement||o()},f;Le(async()=>{f.focus(),document.addEventListener("keydown",a),document.addEventListener("fullscreenchange",i)}),Ae(async()=>{document.removeEventListener("keydown",a),document.removeEventListener("fullscreenchange",i)});const c=m=>{m.code==="Escape"&&o()};function p(m){pe[m?"unshift":"push"](()=>{f=m,n(0,f)})}return l.$$set=m=>{"$$scope"in m&&n(2,s=m.$$scope)},[f,o,s,t,c,p]}class Mn extends x{constructor(e){super(),ee(this,e,Fn,Vn,X,{})}}function Ln(l){let e;return{c(){e=C("div")},l(n){e=I(n,"DIV",{}),O(e).forEach(v)},m(n,t){T(n,e,t),l[2](e)},p:W,i:W,o:W,d(n){n&&v(e),l[2](null)}}}function An(l,e,n){let{rootMargin:t}=e;const s=ge(),r=new IntersectionObserver(i=>{i[0].isIntersecting&&s("intersection")},{rootMargin:t});let o;function a(i){pe[i?"unshift":"push"](()=>{o=i,n(0,o)})}return l.$$set=i=>{"rootMargin"in i&&n(1,t=i.rootMargin)},l.$$.update=()=>{l.$$.dirty&1&&(r.disconnect(),o&&r.observe(o))},[o,t,a]}class yt extends x{constructor(e){super(),ee(this,e,An,Ln,X,{rootMargin:1})}}function jn(l){const e=l.slice(),n=qt(e[0].file_url,e[0].sample_url,e[0].preview_url);return e[4]=n,e}function Bn(l){const e=l.slice(),n=bt(e[0].file_url,e[0].sample_url,e[0].preview_url);return e[4]=n,e}function nt(l){let e,n,t,s;return{c(){e=C("img"),this.h()},l(r){e=I(r,"IMG",{src:!0,alt:!0,title:!0,class:!0}),this.h()},h(){ce(e.src,n=l[4].animated)||h(e,"src",n),h(e,"alt",t="[GIF] post #"+l[0].id),h(e,"title",s="[GIF] post #"+l[0].id),h(e,"class","svelte-1cjgn2p")},m(r,o){T(r,e,o)},p(r,o){o&1&&!ce(e.src,n=r[4].animated)&&h(e,"src",n),o&1&&t!==(t="[GIF] post #"+r[0].id)&&h(e,"alt",t),o&1&&s!==(s="[GIF] post #"+r[0].id)&&h(e,"title",s)},d(r){r&&v(e)}}}function st(l){let e,n,t,s;return{c(){e=C("video"),this.h()},l(r){e=I(r,"VIDEO",{src:!0,poster:!0,title:!0,preload:!0,class:!0}),O(e).forEach(v),this.h()},h(){ce(e.src,n=l[4].animated)||h(e,"src",n),h(e,"poster",t=l[4].static),e.loop=!0,h(e,"title",s="[VIDEO] post #"+l[0].id),e.controls=!0,h(e,"preload","metadata"),e.autoplay=!0,h(e,"class","svelte-1cjgn2p")},m(r,o){T(r,e,o),l[2](e)},p(r,o){o&1&&!ce(e.src,n=r[4].animated)&&h(e,"src",n),o&1&&t!==(t=r[4].static)&&h(e,"poster",t),o&1&&s!==(s="[VIDEO] post #"+r[0].id)&&h(e,"title",s)},d(r){r&&v(e),l[2](null)}}}function Gn(l){let e,n,t,s;return{c(){e=C("img"),this.h()},l(r){e=I(r,"IMG",{src:!0,alt:!0,title:!0,class:!0}),this.h()},h(){ce(e.src,n=l[0].sample_url)||h(e,"src",n),h(e,"alt",t="[IMAGE] post #"+l[0].id),h(e,"title",s="[IMAGE] post #"+l[0].id),h(e,"class","svelte-1cjgn2p")},m(r,o){T(r,e,o)},p(r,o){o&1&&!ce(e.src,n=r[0].sample_url)&&h(e,"src",n),o&1&&t!==(t="[IMAGE] post #"+r[0].id)&&h(e,"alt",t),o&1&&s!==(s="[IMAGE] post #"+r[0].id)&&h(e,"title",s)},d(r){r&&v(e)}}}function qn(l){let e;function n(o,a){return o[0].type==="image"?Gn:o[0].type==="video"?st:nt}function t(o,a){return a===st?Bn(o):a===nt?jn(o):o}let s=n(l),r=s(t(l,s));return{c(){r.c(),e=_e()},l(o){r.l(o),e=_e()},m(o,a){r.m(o,a),T(o,e,a)},p(o,[a]){s===(s=n(o))&&r?r.p(t(o,s),a):(r.d(1),r=s(t(o,s)),r&&(r.c(),r.m(e.parentNode,e)))},i:W,o:W,d(o){o&&v(e),r.d(o)}}}function zn(l,e,n){let{post:t}=e,s;const r=a=>{t.type==="video"&&s&&(a.key==="ArrowLeft"&&(a.preventDefault(),a.stopPropagation(),n(1,s.currentTime=Math.max(0,s.currentTime-5),s)),a.key==="ArrowRight"&&(a.preventDefault(),a.stopPropagation(),n(1,s.currentTime=Math.min(s.duration,s.currentTime+5),s)))};Le(()=>document.addEventListener("keydown",r)),Ae(()=>document.removeEventListener("keydown",r));function o(a){pe[a?"unshift":"push"](()=>{s=a,n(1,s)})}return l.$$set=a=>{"post"in a&&n(0,t=a.post)},[t,s,o]}class Un extends x{constructor(e){super(),ee(this,e,zn,qn,X,{post:0})}}function Hn(l){let e,n,t;return{c(){e=C("img"),this.h()},l(s){e=I(s,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){ce(e.src,n=l[2])||h(e,"src",n),h(e,"alt",t="post #"+l[0].id),h(e,"class","svelte-itxz72"),de(e,"top",l[1])},m(s,r){T(s,e,r)},p(s,[r]){r&4&&!ce(e.src,n=s[2])&&h(e,"src",n),r&1&&t!==(t="post #"+s[0].id)&&h(e,"alt",t),r&2&&de(e,"top",s[1])},i:W,o:W,d(s){s&&v(e)}}}function Kn(l,e,n){let t,{post:s}=e,{offset:r}=e;return l.$$set=o=>{"post"in o&&n(0,s=o.post),"offset"in o&&n(1,r=o.offset)},l.$$.update=()=>{l.$$.dirty&1&&n(2,t=zt(s.sample_url)?s.preview_url:s.sample_url)},[s,r,t]}class Et extends x{constructor(e){super(),ee(this,e,Kn,Hn,X,{post:0,offset:1})}}function lt(l,e,n){const t=l.slice();return t[17]=e[n],t[19]=n,t}function rt(l){let e,n;return e=new Et({props:{post:l[3],offset:l[6]}}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p(t,s){const r={};s&8&&(r.post=t[3]),s&64&&(r.offset=t[6]),e.$set(r)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){S(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function ot(l){let e,n;return e=new Et({props:{post:l[4],offset:l[7]}}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p(t,s){const r={};s&16&&(r.post=t[4]),s&128&&(r.offset=t[7]),e.$set(r)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){S(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function it(l){let e,n=`${l[19]*100}vh`;return{c(){e=C("div"),this.h()},l(t){e=I(t,"DIV",{class:!0}),O(e).forEach(v),this.h()},h(){h(e,"class","pseudo snap-item svelte-ybbm3p"),de(e,"top",n)},m(t,s){T(t,e,s)},p:W,d(t){t&&v(e)}}}function Wn(l){let e,n,t,s,r,o,a,i,f,c,p,m,b,D,y=l[3]&&rt(l);s=new Un({props:{post:l[2]}}),a=new vt({props:{post:l[2]}});let d=l[4]&&ot(l),$=me({length:l[8].posts.length}),_=[];for(let u=0;u<$.length;u+=1)_[u]=it(lt(l,$,u));return p=new yt({props:{rootMargin:window.innerHeight*2+"px"}}),p.$on("intersection",l[13]),{c(){e=C("div"),y&&y.c(),n=N(),t=C("div"),R(s.$$.fragment),r=N(),o=C("div"),R(a.$$.fragment),i=N(),d&&d.c(),f=N();for(let u=0;u<_.length;u+=1)_[u].c();c=N(),R(p.$$.fragment),this.h()},l(u){e=I(u,"DIV",{class:!0});var g=O(e);y&&y.l(g),n=P(g),t=I(g,"DIV",{class:!0});var q=O(t);F(s.$$.fragment,q),r=P(q),o=I(q,"DIV",{class:!0});var Y=O(o);F(a.$$.fragment,Y),Y.forEach(v),q.forEach(v),i=P(g),d&&d.l(g),f=P(g);for(let B=0;B<_.length;B+=1)_[B].l(g);c=P(g),F(p.$$.fragment,g),g.forEach(v),this.h()},h(){h(o,"class","details snap-item svelte-ybbm3p"),h(t,"class","screen snap-container horizontal current svelte-ybbm3p"),de(t,"top",l[5]),h(e,"class","root screen snap-container svelte-ybbm3p")},m(u,g){T(u,e,g),y&&y.m(e,null),k(e,n),k(e,t),M(s,t,null),k(t,r),k(t,o),M(a,o,null),l[12](t),k(e,i),d&&d.m(e,null),k(e,f);for(let q=0;q<_.length;q+=1)_[q]&&_[q].m(e,null);k(e,c),M(p,e,null),l[14](e),m=!0,b||(D=ae(e,"scroll",l[10]),b=!0)},p(u,[g]){u[3]?y?(y.p(u,g),g&8&&w(y,1)):(y=rt(u),y.c(),w(y,1),y.m(e,n)):y&&(ne(),S(y,1,1,()=>{y=null}),se());const q={};g&4&&(q.post=u[2]),s.$set(q);const Y={};if(g&4&&(Y.post=u[2]),a.$set(Y),g&32&&de(t,"top",u[5]),u[4]?d?(d.p(u,g),g&16&&w(d,1)):(d=ot(u),d.c(),w(d,1),d.m(e,f)):d&&(ne(),S(d,1,1,()=>{d=null}),se()),g&256){$=me({length:u[8].posts.length});let B;for(B=0;B<$.length;B+=1){const H=lt(u,$,B);_[B]?_[B].p(H,g):(_[B]=it(H),_[B].c(),_[B].m(e,c))}for(;B<_.length;B+=1)_[B].d(1);_.length=$.length}},i(u){m||(w(y),w(s.$$.fragment,u),w(a.$$.fragment,u),w(d),w(p.$$.fragment,u),m=!0)},o(u){S(y),S(s.$$.fragment,u),S(a.$$.fragment,u),S(d),S(p.$$.fragment,u),m=!1},d(u){u&&v(e),y&&y.d(),L(s),L(a),l[12](null),d&&d.d(),Ge(_,u),L(p),l[14](null),b=!1,D()}}}function Yn(l,e,n){let t;le(l,Ce,g=>n(8,t=g));let{index:s}=e,r,o,a=t.posts[s],i=s>0?t.posts[s-1]:void 0,f=s<t.posts.length-1?t.posts[s+1]:void 0,c=`${s*100}vh`,p=`${(s-1)*100}vh`,m=`${(s+1)*100}vh`;const b=ge(),D=()=>{o&&(o.scrollIntoView(),n(1,o.scrollLeft=0,o))},y=g=>{const q=g.target,Y=q.getBoundingClientRect().height,B=q.scrollTop/Y,H=Math.round(B);H!=s&&(console.log("New index: ",H),requestAnimationFrame(()=>{n(11,s=H),n(2,a=t.posts[s]),n(3,i=s>0?t.posts[s-1]:void 0),n(4,f=s<t.posts.length-1?t.posts[s+1]:void 0),n(5,c=`${s*100}vh`),n(6,p=`${(s-1)*100}vh`),n(7,m=`${(s+1)*100}vh`)}))},d=g=>{g.key==="d"&&(g.preventDefault(),g.stopPropagation(),o.scrollLeft==0?(console.log("details"),o.scrollBy({left:r.clientWidth,top:0,behavior:"smooth"})):(console.log("back"),o.scrollBy({left:-r.clientWidth,top:0,behavior:"smooth"}))),g.key==="ArrowUp"&&(g.preventDefault(),g.stopPropagation(),r.scrollTo({left:0,top:r.clientHeight*(s-1),behavior:"smooth"})),g.key==="ArrowDown"&&(g.preventDefault(),g.stopPropagation(),r.scrollTo({left:0,top:r.clientHeight*(s+1),behavior:"smooth"}))};Le(()=>{document.addEventListener("keydown",d),D()}),Ae(()=>document.removeEventListener("keydown",d));function $(g){pe[g?"unshift":"push"](()=>{o=g,n(1,o)})}const _=()=>b("endreached");function u(g){pe[g?"unshift":"push"](()=>{r=g,n(0,r)})}return l.$$set=g=>{"index"in g&&n(11,s=g.index)},[r,o,a,i,f,c,p,m,t,b,y,s,$,_,u]}class Zn extends x{constructor(e){super(),ee(this,e,Yn,Wn,X,{index:11})}}function Jn(l){let e;return{c(){e=C("i"),this.h()},l(n){e=I(n,"I",{class:!0}),O(e).forEach(v),this.h()},h(){h(e,"class","codicon codicon-close")},m(n,t){T(n,e,t)},p:W,d(n){n&&v(e)}}}function Qn(l){let e,n,t,s,r;function o(i){l[2](i)}let a={};return l[0]!==void 0&&(a.index=l[0]),e=new Zn({props:a}),pe.push(()=>Oe(e,"index",o)),e.$on("endreached",l[3]),s=new kt({props:{class:"button-close",$$slots:{default:[Jn]},$$scope:{ctx:l}}}),s.$on("click",l[4]),{c(){R(e.$$.fragment),t=N(),R(s.$$.fragment)},l(i){F(e.$$.fragment,i),t=P(i),F(s.$$.fragment,i)},m(i,f){M(e,i,f),T(i,t,f),M(s,i,f),r=!0},p(i,f){const c={};!n&&f&1&&(n=!0,c.index=i[0],Te(()=>n=!1)),e.$set(c);const p={};f&128&&(p.$$scope={dirty:f,ctx:i}),s.$set(p)},i(i){r||(w(e.$$.fragment,i),w(s.$$.fragment,i),r=!0)},o(i){S(e.$$.fragment,i),S(s.$$.fragment,i),r=!1},d(i){i&&v(t),L(e,i),L(s,i)}}}function Xn(l){let e,n;return e=new Mn({props:{$$slots:{default:[Qn]},$$scope:{ctx:l}}}),e.$on("close",l[5]),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p(t,[s]){const r={};s&129&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){S(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function xn(l,e,n){let{index:t}=e;const s=ge(),r=c=>{c.key==="f"&&(c.preventDefault(),c.stopPropagation(),s("close"))};Le(()=>document.addEventListener("keydown",r)),Ae(()=>document.removeEventListener("keydown",r));function o(c){t=c,n(0,t)}function a(c){Re.call(this,l,c)}const i=()=>s("close");function f(c){Re.call(this,l,c)}return l.$$set=c=>{"index"in c&&n(0,t=c.index)},[t,s,o,a,i,f]}class es extends x{constructor(e){super(),ee(this,e,xn,Xn,X,{index:0})}}function at(l,e,n){const t=l.slice();return t[8]=e[n],t[10]=n,t}function ct(l,e,n){const t=l.slice();return t[8]=e[n],t[10]=n,t}function ts(l){let e,n,t=me(l[1].posts),s=[];for(let o=0;o<t.length;o+=1)s[o]=ut(at(l,t,o));const r=o=>S(s[o],1,1,()=>{s[o]=null});return{c(){e=C("section");for(let o=0;o<s.length;o+=1)s[o].c();this.h()},l(o){e=I(o,"SECTION",{class:!0,style:!0});var a=O(e);for(let i=0;i<s.length;i+=1)s[i].l(a);a.forEach(v),this.h()},h(){h(e,"class","multi-column svelte-pioq3k"),de(e,"grid-template-columns","repeat("+l[2]+", 1fr)")},m(o,a){T(o,e,a);for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(e,null);n=!0},p(o,a){if(a&3){t=me(o[1].posts);let i;for(i=0;i<t.length;i+=1){const f=at(o,t,i);s[i]?(s[i].p(f,a),w(s[i],1)):(s[i]=ut(f),s[i].c(),w(s[i],1),s[i].m(e,null))}for(ne(),i=t.length;i<s.length;i+=1)r(i);se()}(!n||a&4)&&de(e,"grid-template-columns","repeat("+o[2]+", 1fr)")},i(o){if(!n){for(let a=0;a<t.length;a+=1)w(s[a]);n=!0}},o(o){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)S(s[a]);n=!1},d(o){o&&v(e),Ge(s,o)}}}function ns(l){let e,n,t=me(l[1].posts),s=[];for(let o=0;o<t.length;o+=1)s[o]=ft(ct(l,t,o));const r=o=>S(s[o],1,1,()=>{s[o]=null});return{c(){e=C("section");for(let o=0;o<s.length;o+=1)s[o].c();this.h()},l(o){e=I(o,"SECTION",{class:!0});var a=O(e);for(let i=0;i<s.length;i+=1)s[i].l(a);a.forEach(v),this.h()},h(){h(e,"class","single-column svelte-pioq3k")},m(o,a){T(o,e,a);for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(e,null);n=!0},p(o,a){if(a&3){t=me(o[1].posts);let i;for(i=0;i<t.length;i+=1){const f=ct(o,t,i);s[i]?(s[i].p(f,a),w(s[i],1)):(s[i]=ft(f),s[i].c(),w(s[i],1),s[i].m(e,null))}for(ne(),i=t.length;i<s.length;i+=1)r(i);se()}},i(o){if(!n){for(let a=0;a<t.length;a+=1)w(s[a]);n=!0}},o(o){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)S(s[a]);n=!1},d(o){o&&v(e),Ge(s,o)}}}function ut(l){let e,n;function t(){return l[5](l[10])}return e=new On({props:{post:l[8]}}),e.$on("click",t),{c(){R(e.$$.fragment)},l(s){F(e.$$.fragment,s)},m(s,r){M(e,s,r),n=!0},p(s,r){l=s;const o={};r&2&&(o.post=l[8]),e.$set(o)},i(s){n||(w(e.$$.fragment,s),n=!0)},o(s){S(e.$$.fragment,s),n=!1},d(s){L(e,s)}}}function ft(l){let e,n;function t(){return l[4](l[10])}return e=new Nn({props:{post:l[8]}}),e.$on("fullscreen",t),{c(){R(e.$$.fragment)},l(s){F(e.$$.fragment,s)},m(s,r){M(e,s,r),n=!0},p(s,r){l=s;const o={};r&2&&(o.post=l[8]),e.$set(o)},i(s){n||(w(e.$$.fragment,s),n=!0)},o(s){S(e.$$.fragment,s),n=!1},d(s){L(e,s)}}}function pt(l){let e,n;return e=new es({props:{index:l[0]}}),e.$on("close",l[6]),e.$on("endreached",l[7]),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p(t,s){const r={};s&1&&(r.index=t[0]),e.$set(r)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){S(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function ss(l){let e,n,t=Me(l[1].postCount)+"",s,r,o,a,i,f,c,p,m,b;a=new kn({}),a.$on("sortfilterupdate",l[3]);const D=[ns,ts],y=[];function d(_,u){return _[2]==="1"?0:1}f=d(l),c=y[f]=D[f](l);let $=l[0]!==void 0&&pt(l);return{c(){e=C("div"),n=C("span"),s=re(t),r=re(" posts"),o=N(),R(a.$$.fragment),i=N(),c.c(),p=N(),$&&$.c(),m=_e(),this.h()},l(_){e=I(_,"DIV",{class:!0});var u=O(e);n=I(u,"SPAN",{});var g=O(n);s=oe(g,t),r=oe(g," posts"),g.forEach(v),o=P(u),F(a.$$.fragment,u),u.forEach(v),i=P(_),c.l(_),p=P(_),$&&$.l(_),m=_e(),this.h()},h(){h(e,"class","svelte-pioq3k")},m(_,u){T(_,e,u),k(e,n),k(n,s),k(n,r),k(e,o),M(a,e,null),T(_,i,u),y[f].m(_,u),T(_,p,u),$&&$.m(_,u),T(_,m,u),b=!0},p(_,[u]){(!b||u&2)&&t!==(t=Me(_[1].postCount)+"")&&Ve(s,t);let g=f;f=d(_),f===g?y[f].p(_,u):(ne(),S(y[g],1,1,()=>{y[g]=null}),se(),c=y[f],c?c.p(_,u):(c=y[f]=D[f](_),c.c()),w(c,1),c.m(p.parentNode,p)),_[0]!==void 0?$?($.p(_,u),u&1&&w($,1)):($=pt(_),$.c(),w($,1),$.m(m.parentNode,m)):$&&(ne(),S($,1,1,()=>{$=null}),se())},i(_){b||(w(a.$$.fragment,_),w(c),w($),b=!0)},o(_){S(a.$$.fragment,_),S(c),S($),b=!1},d(_){_&&(v(e),v(i),v(p),v(m)),L(a),y[f].d(_),$&&$.d(_)}}}function ls(l,e,n){let t,s;le(l,Ce,p=>n(1,t=p)),le(l,Rt,p=>n(2,s=p));let r;function o(p){Re.call(this,l,p)}const a=p=>{console.log("Viewing index: "+p),n(0,r=p)},i=p=>{console.log("Viewing index: "+p),n(0,r=p)},f=()=>{n(0,r=void 0)};function c(p){Re.call(this,l,p)}return[r,t,s,o,a,i,f,c]}class rs extends x{constructor(e){super(),ee(this,e,ls,ss,X,{})}}function os(l){let e;return{c(){e=re("Reset Filter")},l(n){e=oe(n,"Reset Filter")},m(n,t){T(n,e,t)},d(n){n&&v(e)}}}function is(l){let e,n,t,s,r="We couldn't find any posts matching your tags. Sorry...",o,a,i;return a=new Fe({props:{title:"In case your filter caused all posts to vanish. Reset it.",$$slots:{default:[os]},$$scope:{ctx:l}}}),a.$on("click",l[1]),{c(){e=C("img"),t=N(),s=C("p"),s.textContent=r,o=N(),R(a.$$.fragment),this.h()},l(f){e=I(f,"IMG",{src:!0,alt:!0,class:!0}),t=P(f),s=I(f,"P",{"data-svelte-h":!0}),fe(s)!=="svelte-1utxj3w"&&(s.textContent=r),o=P(f),F(a.$$.fragment,f),this.h()},h(){ce(e.src,n=ht+"/assets/shironeko-confused.png")||h(e,"src",n),h(e,"alt","Nothing here..."),h(e,"class","svelte-1bb5e7g")},m(f,c){T(f,e,c),T(f,t,c),T(f,s,c),T(f,o,c),M(a,f,c),i=!0},p(f,[c]){const p={};c&4&&(p.$$scope={dirty:c,ctx:f}),a.$set(p)},i(f){i||(w(a.$$.fragment,f),i=!0)},o(f){S(a.$$.fragment,f),i=!1},d(f){f&&(v(e),v(t),v(s),v(o)),L(a,f)}}}function as(l){const e=ge();return[e,()=>{Se.reset(),we.reset(),e("sortfilterupdate")}]}class cs extends x{constructor(e){super(),ee(this,e,as,is,X,{})}}function us(l){let e;return{c(){e=re("Search")},l(n){e=oe(n,"Search")},m(n,t){T(n,e,t)},d(n){n&&v(e)}}}function fs(l){let e,n,t,s,r,o;const a=[ds,_s],i=[];function f(c,p){return c[2].postCount===0?0:1}return n=f(l),t=i[n]=a[n](l),r=new Zt({}),{c(){e=C("section"),t.c(),s=N(),R(r.$$.fragment),this.h()},l(c){e=I(c,"SECTION",{class:!0});var p=O(e);t.l(p),p.forEach(v),s=P(c),F(r.$$.fragment,c),this.h()},h(){h(e,"class","svelte-rk0y4a")},m(c,p){T(c,e,p),i[n].m(e,null),T(c,s,p),M(r,c,p),o=!0},p(c,p){let m=n;n=f(c),n===m?i[n].p(c,p):(ne(),S(i[m],1,1,()=>{i[m]=null}),se(),t=i[n],t?t.p(c,p):(t=i[n]=a[n](c),t.c()),w(t,1),t.m(e,null))},i(c){o||(w(t),w(r.$$.fragment,c),o=!0)},o(c){S(t),S(r.$$.fragment,c),o=!1},d(c){c&&(v(e),v(s)),i[n].d(),L(r,c)}}}function ps(l){let e,n;return e=new an({props:{error:l[0]}}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p(t,s){const r={};s&1&&(r.error=t[0]),e.$set(r)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){S(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function _s(l){let e,n,t,s,r,o;e=new rs({}),e.$on("sortfilterupdate",l[7]),e.$on("endreached",l[8]);const a=[gs,ms],i=[];function f(c,p){return c[2].posts.length===c[2].postCount?0:1}return t=f(l),s=i[t]=a[t](l),{c(){R(e.$$.fragment),n=N(),s.c(),r=_e()},l(c){F(e.$$.fragment,c),n=P(c),s.l(c),r=_e()},m(c,p){M(e,c,p),T(c,n,p),i[t].m(c,p),T(c,r,p),o=!0},p(c,p){let m=t;t=f(c),t===m?i[t].p(c,p):(ne(),S(i[m],1,1,()=>{i[m]=null}),se(),s=i[t],s?s.p(c,p):(s=i[t]=a[t](c),s.c()),w(s,1),s.m(r.parentNode,r))},i(c){o||(w(e.$$.fragment,c),w(s),o=!0)},o(c){S(e.$$.fragment,c),S(s),o=!1},d(c){c&&(v(n),v(r)),L(e,c),i[t].d(c)}}}function ds(l){let e,n;return e=new cs({}),e.$on("sortfilterupdate",l[7]),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p:W,i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){S(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function ms(l){let e,n;return e=new yt({props:{rootMargin:"1000px"}}),e.$on("intersection",l[8]),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p:W,i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){S(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function gs(l){let e,n;return e=new un({}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p:W,i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){S(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function _t(l){let e,n;return e=new ln({props:{tags:l[4]}}),e.$on("close",l[13]),e.$on("submit",l[14]),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p(t,s){const r={};s&16&&(r.tags=t[4]),e.$set(r)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){S(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function hs(l){let e,n,t,s,r,o,a,i,f,c,p,m,b,D;n=new Mt({}),s=new Wt({props:{placeholder:"Search for tags",fetchSuggestions:l[6]}}),s.$on("pick",l[9]),o=new Fe({props:{title:"Search with the tags above",$$slots:{default:[us]},$$scope:{ctx:l}}}),o.$on("click",l[7]),i=new Lt({props:{tags:[...l[4],...l[3]]}}),i.$on("click",l[10]),i.$on("contextmenu",l[11]),i.$on("createSupertag",l[12]);const y=[ps,fs],d=[];function $(u,g){return u[0]?0:u[2].requested?1:-1}~(c=$(l))&&(p=d[c]=y[c](l));let _=l[1]&&_t(l);return{c(){e=C("section"),R(n.$$.fragment),t=N(),R(s.$$.fragment),r=N(),R(o.$$.fragment),a=N(),R(i.$$.fragment),f=N(),p&&p.c(),m=N(),_&&_.c(),b=_e(),this.h()},l(u){e=I(u,"SECTION",{id:!0,class:!0});var g=O(e);F(n.$$.fragment,g),t=P(g),F(s.$$.fragment,g),r=P(g),F(o.$$.fragment,g),a=P(g),F(i.$$.fragment,g),g.forEach(v),f=P(u),p&&p.l(u),m=P(u),_&&_.l(u),b=_e(),this.h()},h(){h(e,"id","search"),h(e,"class","svelte-rk0y4a")},m(u,g){T(u,e,g),M(n,e,null),k(e,t),M(s,e,null),k(e,r),M(o,e,null),k(e,a),M(i,e,null),T(u,f,g),~c&&d[c].m(u,g),T(u,m,g),_&&_.m(u,g),T(u,b,g),D=!0},p(u,[g]){const q={};g&8388608&&(q.$$scope={dirty:g,ctx:u}),o.$set(q);const Y={};g&24&&(Y.tags=[...u[4],...u[3]]),i.$set(Y);let B=c;c=$(u),c===B?~c&&d[c].p(u,g):(p&&(ne(),S(d[B],1,1,()=>{d[B]=null}),se()),~c?(p=d[c],p?p.p(u,g):(p=d[c]=y[c](u),p.c()),w(p,1),p.m(m.parentNode,m)):p=null),u[1]?_?(_.p(u,g),g&2&&w(_,1)):(_=_t(u),_.c(),w(_,1),_.m(b.parentNode,b)):_&&(ne(),S(_,1,1,()=>{_=null}),se())},i(u){D||(w(n.$$.fragment,u),w(s.$$.fragment,u),w(o.$$.fragment,u),w(i.$$.fragment,u),w(p),w(_),D=!0)},o(u){S(n.$$.fragment,u),S(s.$$.fragment,u),S(o.$$.fragment,u),S(i.$$.fragment,u),S(p),S(_),D=!1},d(u){u&&(v(e),v(f),v(m),v(b)),L(n),L(s),L(o),L(i),~c&&d[c].d(u),_&&_.d(u)}}}function $s(l,e,n){let t,s,r,o,a,i,f;le(l,Ce,E=>n(2,t=E)),le(l,ze,E=>n(3,s=E)),le(l,we,E=>n(17,r=E)),le(l,Se,E=>n(18,o=E)),le(l,xt,E=>n(19,a=E)),le(l,je,E=>n(4,i=E)),le(l,Je,E=>n(5,f=E));let c=!1,p,m=!1,b=0;const D=async E=>{const U=await Jt(E);return[...f.items.filter(({name:Q})=>Q.toLowerCase().includes(E.toLowerCase())).map(Q=>({label:Q.name,count:Q.tags.length,type:"supertag"})),...U]},y=()=>new At().withPid(t.pageCount).withTags(i).withBlockedContent(a).withSortProperty(o.property).withSortDirection(o.direction).withScoreValue(r.scoreValue).withScoreComparator(r.scoreComparator).withRating(r.rating).withSupertags(s),d=async E=>{if(!c){n(0,p=void 0),c=!0;try{const U=t.pageCount;await E(),Xt(U).catch(()=>{})}catch(U){n(0,p=U),console.warn(U)}finally{c=!1}}},$=async()=>{Ce.reset(),b=0,d(async()=>{const[E,U]=await y().getPageAndCount();Ce.addPage(E,U)})},_=async()=>{d(async()=>{const E=await y().getPage();Ce.addPage(E)})},u=E=>{var U,J;if((E.key==="/"||E.key==="s")&&(!document.activeElement||document.activeElement===document.body)&&((U=document.getElementById("searchbar"))==null||U.focus(),E.preventDefault(),E.stopPropagation()),E.ctrlKey&&E.key==="Enter"&&(E.preventDefault(),E.stopPropagation(),$()),E.ctrlKey&&E.key==="m"&&((J=document.getElementById("select-modifier"))==null||J.click()),E.ctrlKey&&E.key==="ArrowDown"){const Q=document.getElementsByClassName("post-media");Q[b].focus(),b=Math.min(b+1,Math.max(0,Q.length-1))}E.ctrlKey&&E.key==="ArrowUp"&&(document.getElementsByClassName("post-media")[b].focus(),b=Math.max(b-1,0))};return Le(async()=>{document.addEventListener("keydown",u)}),Ae(()=>{document.removeEventListener("keydown",u)}),[p,m,t,s,i,f,D,$,_,async E=>{const U=E.detail;if(U.type==="supertag"){const J=f.items.find(Q=>Q.name===U.label);if(!J){console.warn("Supertag not present.");return}ze.addOrReplace(J)}else{const J=await Qt(E.detail.label);je.addOrReplace({name:E.detail.label,modifier:E.detail.modifier,count:E.detail.count,type:(J==null?void 0:J.type)??"tag"})}},E=>"description"in E.detail?ze.removeByName(E.detail.name):je.removeByName(E.detail.name),E=>{"description"in E.detail||(E.detail.modifier=Yt(E.detail.modifier),je.addOrReplace(E.detail))},()=>n(1,m=!0),()=>n(1,m=!1),E=>Je.add(E.detail)]}class Bs extends x{constructor(e){super(),ee(this,e,$s,hs,X,{})}}export{Bs as component};
