import{s as ne,e as C,a as P,t as X,c as I,b as F,f as $,g as N,d as x,o as _,C as pn,i as R,h as v,n as K,p as ce,x as Ie,q as Ze,ad as dn,I as We,y as Q,j as be,U as he,V as Ne,k as ee,F as Fe,W as Oe,A as ve,ac as xe,E as Qe,z as tt,B as nt,J as _n,K as gn,L as mn,M as hn,D as at,aa as $n,N as vn,l as Ae,$ as bn,Y as Re,ab as kn,m as wn}from"../chunks/scheduler.9ddb58b7.js";import{S as se,i as le,c as A,b as V,m as O,t as w,a as T,d as B,f as je,g as _e,e as ge}from"../chunks/index.ea5578de.js";import{g as yn}from"../chunks/globals.7f7f1b26.js";import{b as Wt}from"../chunks/paths.6753c126.js";import{T as He}from"../chunks/TextButton.db0c5876.js";import{a as et,r as Ye}from"../chunks/results-store.db609e32.js";import{a as Je,B as En}from"../chunks/blocking-group-data.358160cd.js";import{b as Ve}from"../chunks/format-tag.9687384a.js";import{s as Xe,f as Ke,S as Sn}from"../chunks/search-builder.1f09dd7e.js";import{N as Cn,a as Yt,b as In,o as Tn}from"../chunks/tags-shortcut-store.b7ab74f6.js";import{e as ke}from"../chunks/each.e59479a4.js";import{D as Jt,a as Zt,r as Qt}from"../chunks/result-columns-store.5bab8a28.js";import{R as Dn,I as Xt}from"../chunks/ModifierSelect.a9a7b68c.js";import{S as Ln}from"../chunks/Select.f65d8aa6.js";import{R as Pn}from"../chunks/RotatingTextSelect.6b90059c.js";import{R as Nn,S as xt,a as en,E as tn,b as jn,C as nn,P as sn,g as ln,f as pt,r as Rn,d as Fn,e as An,h as Vn,G as On,V as Bn,i as mt,c as Mn}from"../chunks/PreviewedImage.93175e93.js";import{h as ht,u as zn}from"../chunks/await_block.bc50228e.js";import{L as _t}from"../chunks/LoadingAnimation.9c99af81.js";import{h as qn,i as Un,a as Hn}from"../chunks/always-loop-store.33c93ae3.js";import{p as Gn,S as Kn,b as Wn,c as Yn}from"../chunks/store-keys.22403613.js";import{i as Jn,g as Zn,a as Qn}from"../chunks/tags.49324235.js";import{b as rn}from"../chunks/blocked-content-store.5328bd93.js";import{S as Xn}from"../chunks/ScrollUpButton.ee38808d.js";import{b as xn}from"../chunks/analytics.e0f1cddf.js";import{L as es}from"../chunks/LynxMain.84d1342b.js";import{S as ts}from"../chunks/Searchbar.17afebe2.js";import{A as ns,K as ss}from"../chunks/KurosearchTitle.86a5f3ea.js";import{s as $t,n as ls}from"../chunks/supertags-store.a61cddbd.js";import{D as rs}from"../chunks/DetailedTag.dcaa45b8.js";function os(s){let e,n,t,l,o,r,a,i,c,u;return{c(){e=C("div"),n=C("div"),t=C("i"),l=P(),o=C("div"),r=C("h3"),a=X(s[0]),i=P(),c=C("span"),u=X(s[2]),this.h()},l(f){e=I(f,"DIV",{class:!0});var p=F(e);n=I(p,"DIV",{class:!0});var m=F(n);t=I(m,"I",{class:!0}),F(t).forEach($),m.forEach($),l=N(p),o=I(p,"DIV",{});var d=F(o);r=I(d,"H3",{class:!0});var g=F(r);a=x(g,s[0]),g.forEach($),i=N(d),c=I(d,"SPAN",{});var D=F(c);u=x(D,s[2]),D.forEach($),d.forEach($),p.forEach($),this.h()},h(){_(t,"class",pn(s[1])+" svelte-1yohziu"),_(n,"class","icon svelte-1yohziu"),_(r,"class","svelte-1yohziu"),_(e,"class","error svelte-1yohziu")},m(f,p){R(f,e,p),v(e,n),v(n,t),v(e,l),v(e,o),v(o,r),v(r,a),v(o,i),v(o,c),v(c,u)},p:K,i:K,o:K,d(f){f&&$(e)}}}function is(s,e,n){let{error:t}=e,l=t.message==="Failed to fetch"?"Connection Error":"Application Error",o=t.message==="Failed to fetch"?"codicon codicon-debug-disconnect":"codicon codicon-error",r=t.message==="Failed to fetch"?"Failed to connect to the server. Make sure you have a stable internet connection.":t.message;return s.$$set=a=>{"error"in a&&n(3,t=a.error)},[l,o,r,t]}class as extends se{constructor(e){super(),le(this,e,is,os,ne,{error:3})}}function cs(s){let e;return{c(){e=X("Back to Top")},l(n){e=x(n,"Back to Top")},m(n,t){R(n,e,t)},d(n){n&&$(e)}}}function us(s){let e;return{c(){e=X("Reset Tags")},l(n){e=x(n,"Reset Tags")},m(n,t){R(n,e,t)},d(n){n&&$(e)}}}function fs(s){let e,n,t,l,o,r="You have seen everything there is to see...",a,i,c,u,f,p;return c=new He({props:{type:"secondary",title:"Scroll back up.",$$slots:{default:[cs]},$$scope:{ctx:s}}}),c.$on("click",s[0]),f=new He({props:{type:"secondary",title:"Reset tags.",$$slots:{default:[us]},$$scope:{ctx:s}}}),f.$on("click",s[1]),{c(){e=C("section"),n=C("img"),l=P(),o=C("p"),o.textContent=r,a=P(),i=C("div"),A(c.$$.fragment),u=P(),A(f.$$.fragment),this.h()},l(m){e=I(m,"SECTION",{class:!0});var d=F(e);n=I(d,"IMG",{src:!0,alt:!0,width:!0,height:!0,class:!0}),l=N(d),o=I(d,"P",{"data-svelte-h":!0}),ce(o)!=="svelte-1i75mtf"&&(o.textContent=r),a=N(d),i=I(d,"DIV",{class:!0});var g=F(i);V(c.$$.fragment,g),u=N(g),V(f.$$.fragment,g),g.forEach($),d.forEach($),this.h()},h(){Ie(n.src,t=Wt+"/assets/lynxy-chibi-not-found.webp")||_(n,"src",t),_(n,"alt","No more results to load"),_(n,"width","1231"),_(n,"height","864"),_(n,"class","svelte-1b36daw"),_(i,"class","svelte-1b36daw"),_(e,"class","svelte-1b36daw")},m(m,d){R(m,e,d),v(e,n),v(e,l),v(e,o),v(e,a),v(e,i),O(c,i,null),v(i,u),O(f,i,null),p=!0},p(m,[d]){const g={};d&4&&(g.$$scope={dirty:d,ctx:m}),c.$set(g);const D={};d&4&&(D.$$scope={dirty:d,ctx:m}),f.$set(D)},i(m){p||(w(c.$$.fragment,m),w(f.$$.fragment,m),p=!0)},o(m){T(c.$$.fragment,m),T(f.$$.fragment,m),p=!1},d(m){m&&$(e),B(c),B(f)}}}function ps(s){return[()=>{window.scrollTo({top:0})},()=>{Je.reset(),et.reset()}]}class ds extends se{constructor(e){super(),le(this,e,ps,fs,ne,{})}}function vt(s,e,n){const t=s.slice();return t[5]=e[n][0],t[6]=e[n][1],t}function bt(s){let e,n,t,l=!1,o,r,a,i=s[6]+"",c,u,f,p,m;return f=dn(s[4][0]),{c(){e=C("input"),r=P(),a=C("label"),c=X(i),this.h()},l(d){e=I(d,"INPUT",{type:!0,name:!0,id:!0,class:!0}),r=N(d),a=I(d,"LABEL",{for:!0,class:!0});var g=F(a);c=x(g,i),g.forEach($),this.h()},h(){_(e,"type","radio"),_(e,"name",n="group-"+s[1]),e.__value=t=s[5],We(e,e.__value),_(e,"id",o=s[1]+"-"+s[5]),_(e,"class","svelte-16oxivo"),_(a,"for",u=s[1]+"-"+s[5]),_(a,"class","svelte-16oxivo"),f.p(e)},m(d,g){R(d,e,g),e.checked=e.__value===s[0],R(d,r,g),R(d,a,g),v(a,c),p||(m=Q(e,"change",s[3]),p=!0)},p(d,g){g&2&&n!==(n="group-"+d[1])&&_(e,"name",n),g&4&&t!==(t=d[5])&&(e.__value=t,We(e,e.__value),l=!0),g&6&&o!==(o=d[1]+"-"+d[5])&&_(e,"id",o),(l||g&5)&&(e.checked=e.__value===d[0]),g&4&&i!==(i=d[6]+"")&&be(c,i),g&6&&u!==(u=d[1]+"-"+d[5])&&_(a,"for",u)},d(d){d&&($(e),$(r),$(a)),f.r(),p=!1,m()}}}function _s(s){let e,n,t=ke(Object.entries(s[2])),l=[];for(let o=0;o<t.length;o+=1)l[o]=bt(vt(s,t,o));return{c(){e=C("div");for(let o=0;o<l.length;o+=1)l[o].c();this.h()},l(o){e=I(o,"DIV",{id:!0,role:!0,class:!0});var r=F(e);for(let a=0;a<l.length;a+=1)l[a].l(r);r.forEach($),this.h()},h(){_(e,"id",n="group-"+s[1]),_(e,"role","radiogroup"),_(e,"class","svelte-16oxivo")},m(o,r){R(o,e,r);for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(e,null)},p(o,[r]){if(r&7){t=ke(Object.entries(o[2]));let a;for(a=0;a<t.length;a+=1){const i=vt(o,t,a);l[a]?l[a].p(i,r):(l[a]=bt(i),l[a].c(),l[a].m(e,null))}for(;a<l.length;a+=1)l[a].d(1);l.length=t.length}r&2&&n!==(n="group-"+o[1])&&_(e,"id",n)},i:K,o:K,d(o){o&&$(e),Ze(l,o)}}}function gs(s,e,n){let{name:t}=e,{value:l}=e,{options:o}=e;const r=[[]];function a(){l=this.__value,n(0,l)}return s.$$set=i=>{"name"in i&&n(1,t=i.name),"value"in i&&n(0,l=i.value),"options"in i&&n(2,o=i.options)},[l,t,o,a,r]}class ms extends se{constructor(e){super(),le(this,e,gs,_s,ne,{name:1,value:0,options:2})}}const hs=Object.freeze({id:{asc:"Oldest",desc:"Newest"},score:{asc:"Worst",desc:"Best"},updated:{asc:"Inactive",desc:"Active"},random:{asc:"Random",desc:"Random"}}),on=Object.freeze({">=":"≥","<=":"≤"}),an=Object.freeze({all:"All",safe:"Safe",questionable:"Questionable",explicit:"Explicit"}),$s=Object.freeze({id:"Uploaded",score:"Score",updated:"Updated",random:"Random"}),vs=Object.freeze({desc:"codicon codicon-arrow-down",asc:"codicon codicon-arrow-up"}),bs=(s,e)=>s===0&&e===">="?void 0:`Score ${on[e]} ${Ve(s)}`,ks=s=>s==="all"?void 0:an[s],ws=(s,e,n)=>{let t=ks(s),l=bs(e,n);return[t,l].filter(o=>o!==void 0).join(",")||"All"},ys=(s,e)=>hs[s][e];function Es(s){let e;return{c(){e=X("Done")},l(n){e=x(n,"Done")},m(n,t){R(n,e,t)},d(n){n&&$(e)}}}function Ss(s){let e;return{c(){e=X("Reset")},l(n){e=x(n,"Reset")},m(n,t){R(n,e,t)},d(n){n&&$(e)}}}function Cs(s){let e,n,t,l="Sorting and Filtering",o,r,a,i,c,u,f,p="Sorting",m,d,g,D,S,b,k,h,j,y,M="Filtering by Score",E,L,U,Y,fe,pe,ue,Z,te,H,W="Rating",oe,J,we,ye,$e,Se,Le,Ge,Pe,st;function ct(z){s[5](z)}let Te={options:vs};s[1].direction!==void 0&&(Te.value=s[1].direction),g=new Dn({props:Te}),he.push(()=>je(g,"value",ct));function lt(z){s[6](z)}let Be={options:$s};s[1].property!==void 0&&(Be.value=s[1].property),b=new Ln({props:Be}),he.push(()=>je(b,"value",lt));function ft(z){s[7](z)}let rt={options:on};s[2].scoreComparator!==void 0&&(rt.value=s[2].scoreComparator),U=new Pn({props:rt}),he.push(()=>je(U,"value",ft));function Me(z){s[8](z)}let ze={min:0,max:1e4,step:1};s[2].scoreValue!==void 0&&(ze.value=s[2].scoreValue),pe=new Cn({props:ze}),he.push(()=>je(pe,"value",Me));function ae(z){s[9](z)}let qe={name:"rating",options:an};return s[2].rating!==void 0&&(qe.value=s[2].rating),J=new ms({props:qe}),he.push(()=>je(J,"value",ae)),$e=new He({props:{title:"Return to searching",$$slots:{default:[Es]},$$scope:{ctx:s}}}),$e.$on("click",s[3]),Le=new He({props:{title:"Reset sort and filter",type:"secondary",$$slots:{default:[Ss]},$$scope:{ctx:s}}}),Le.$on("click",s[4]),{c(){e=C("div"),n=C("div"),t=C("h3"),t.textContent=l,o=P(),r=C("div"),a=P(),i=C("button"),c=P(),u=C("div"),f=C("b"),f.textContent=p,m=P(),d=C("div"),A(g.$$.fragment),S=P(),A(b.$$.fragment),h=P(),j=C("div"),y=C("b"),y.textContent=M,E=P(),L=C("div"),A(U.$$.fragment),fe=P(),A(pe.$$.fragment),Z=P(),te=C("div"),H=C("b"),H.textContent=W,oe=P(),A(J.$$.fragment),ye=P(),A($e.$$.fragment),Se=P(),A(Le.$$.fragment),this.h()},l(z){e=I(z,"DIV",{class:!0});var re=F(e);n=I(re,"DIV",{class:!0});var q=F(n);t=I(q,"H3",{"data-svelte-h":!0}),ce(t)!=="svelte-15zouq3"&&(t.textContent=l),o=N(q),r=I(q,"DIV",{class:!0}),F(r).forEach($),a=N(q),i=I(q,"BUTTON",{type:!0,class:!0}),F(i).forEach($),q.forEach($),c=N(re),u=I(re,"DIV",{});var G=F(u);f=I(G,"B",{class:!0,"data-svelte-h":!0}),ce(f)!=="svelte-ekzpgg"&&(f.textContent=p),m=N(G),d=I(G,"DIV",{class:!0});var de=F(d);V(g.$$.fragment,de),S=N(de),V(b.$$.fragment,de),de.forEach($),G.forEach($),h=N(re),j=I(re,"DIV",{});var Ce=F(j);y=I(Ce,"B",{class:!0,"data-svelte-h":!0}),ce(y)!=="svelte-1flca3"&&(y.textContent=M),E=N(Ce),L=I(Ce,"DIV",{class:!0});var ie=F(L);V(U.$$.fragment,ie),fe=N(ie),V(pe.$$.fragment,ie),ie.forEach($),Ce.forEach($),Z=N(re),te=I(re,"DIV",{});var De=F(te);H=I(De,"B",{class:!0,"data-svelte-h":!0}),ce(H)!=="svelte-1lwyn2b"&&(H.textContent=W),oe=N(De),V(J.$$.fragment,De),De.forEach($),ye=N(re),V($e.$$.fragment,re),Se=N(re),V(Le.$$.fragment,re),re.forEach($),this.h()},h(){_(r,"class","spacer svelte-nizkv3"),_(i,"type","button"),_(i,"class","codicon codicon-close svelte-nizkv3"),_(n,"class","row svelte-nizkv3"),_(f,"class","svelte-nizkv3"),_(d,"class","row svelte-nizkv3"),_(y,"class","svelte-nizkv3"),_(L,"class","row svelte-nizkv3"),_(H,"class","svelte-nizkv3"),_(e,"class","container svelte-nizkv3")},m(z,re){R(z,e,re),v(e,n),v(n,t),v(n,o),v(n,r),v(n,a),v(n,i),v(e,c),v(e,u),v(u,f),v(u,m),v(u,d),O(g,d,null),v(d,S),O(b,d,null),v(e,h),v(e,j),v(j,y),v(j,E),v(j,L),O(U,L,null),v(L,fe),O(pe,L,null),v(e,Z),v(e,te),v(te,H),v(te,oe),O(J,te,null),v(e,ye),O($e,e,null),v(e,Se),O(Le,e,null),Ge=!0,Pe||(st=Q(i,"click",s[3]),Pe=!0)},p(z,re){const q={};!D&&re&2&&(D=!0,q.value=z[1].direction,Ne(()=>D=!1)),g.$set(q);const G={};!k&&re&2&&(k=!0,G.value=z[1].property,Ne(()=>k=!1)),b.$set(G);const de={};!Y&&re&4&&(Y=!0,de.value=z[2].scoreComparator,Ne(()=>Y=!1)),U.$set(de);const Ce={};!ue&&re&4&&(ue=!0,Ce.value=z[2].scoreValue,Ne(()=>ue=!1)),pe.$set(Ce);const ie={};!we&&re&4&&(we=!0,ie.value=z[2].rating,Ne(()=>we=!1)),J.$set(ie);const De={};re&4096&&(De.$$scope={dirty:re,ctx:z}),$e.$set(De);const me={};re&4096&&(me.$$scope={dirty:re,ctx:z}),Le.$set(me)},i(z){Ge||(w(g.$$.fragment,z),w(b.$$.fragment,z),w(U.$$.fragment,z),w(pe.$$.fragment,z),w(J.$$.fragment,z),w($e.$$.fragment,z),w(Le.$$.fragment,z),Ge=!0)},o(z){T(g.$$.fragment,z),T(b.$$.fragment,z),T(U.$$.fragment,z),T(pe.$$.fragment,z),T(J.$$.fragment,z),T($e.$$.fragment,z),T(Le.$$.fragment,z),Ge=!1},d(z){z&&$(e),B(g),B(b),B(U),B(pe),B(J),B($e),B(Le),Pe=!1,st()}}}function Is(s){let e,n,t;function l(r){s[10](r)}let o={$$slots:{default:[Cs]},$$scope:{ctx:s}};return s[0]!==void 0&&(o.dialog=s[0]),e=new Jt({props:o}),he.push(()=>je(e,"dialog",l)),e.$on("close",s[11]),{c(){A(e.$$.fragment)},l(r){V(e.$$.fragment,r)},m(r,a){O(e,r,a),t=!0},p(r,[a]){const i={};a&4102&&(i.$$scope={dirty:a,ctx:r}),!n&&a&1&&(n=!0,i.dialog=r[0],Ne(()=>n=!1)),e.$set(i)},i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){T(e.$$.fragment,r),t=!1},d(r){B(e,r)}}}function Ts(s,e,n){let t,l;ee(s,Xe,g=>n(1,t=g)),ee(s,Ke,g=>n(2,l=g));let{dialog:o}=e;const r=()=>o.close(),a=()=>{Xe.reset(),Ke.reset()};function i(g){s.$$.not_equal(t.direction,g)&&(t.direction=g,Xe.set(t))}function c(g){s.$$.not_equal(t.property,g)&&(t.property=g,Xe.set(t))}function u(g){s.$$.not_equal(l.scoreComparator,g)&&(l.scoreComparator=g,Ke.set(l))}function f(g){s.$$.not_equal(l.scoreValue,g)&&(l.scoreValue=g,Ke.set(l))}function p(g){s.$$.not_equal(l.rating,g)&&(l.rating=g,Ke.set(l))}function m(g){o=g,n(0,o)}function d(g){Fe.call(this,s,g)}return s.$$set=g=>{"dialog"in g&&n(0,o=g.dialog)},[o,t,l,r,a,i,c,u,f,p,m,d]}class Ds extends se{constructor(e){super(),le(this,e,Ts,Is,ne,{dialog:0})}}function Ls(s){let e,n,t,l,o,r,a,i,c,u,f,p,m,d,g,D;function S(k){s[9](k)}let b={};return s[2]!==void 0&&(b.dialog=s[2]),p=new Ds({props:b}),he.push(()=>je(p,"dialog",S)),p.$on("close",s[10]),{c(){e=C("button"),n=C("i"),t=P(),l=C("span"),o=X(s[5]),r=P(),a=C("i"),i=P(),c=C("span"),u=X(s[4]),f=P(),A(p.$$.fragment),this.h()},l(k){e=I(k,"BUTTON",{type:!0,class:!0});var h=F(e);n=I(h,"I",{class:!0}),F(n).forEach($),t=N(h),l=I(h,"SPAN",{class:!0});var j=F(l);o=x(j,s[5]),j.forEach($),r=N(h),a=I(h,"I",{class:!0}),F(a).forEach($),i=N(h),c=I(h,"SPAN",{class:!0});var y=F(c);u=x(y,s[4]),y.forEach($),h.forEach($),f=N(k),V(p.$$.fragment,k),this.h()},h(){_(n,"class","codicon codicon-filter svelte-3ooqm6"),_(l,"class","svelte-3ooqm6"),_(a,"class","codicon codicon-arrow-swap svelte-3ooqm6"),_(c,"class","svelte-3ooqm6"),_(e,"type","button"),_(e,"class","svelte-3ooqm6")},m(k,h){R(k,e,h),v(e,n),v(e,t),v(e,l),v(l,o),v(e,r),v(e,a),v(e,i),v(e,c),v(c,u),R(k,f,h),O(p,k,h),d=!0,g||(D=Q(e,"click",s[8]),g=!0)},p(k,[h]){(!d||h&32)&&be(o,k[5]),(!d||h&16)&&be(u,k[4]);const j={};!m&&h&4&&(m=!0,j.dialog=k[2],Ne(()=>m=!1)),p.$set(j)},i(k){d||(w(p.$$.fragment,k),d=!0)},o(k){T(p.$$.fragment,k),d=!1},d(k){k&&($(e),$(f)),B(p,k),g=!1,D()}}}function Ps(s,e,n){let t,l,o,r;ee(s,Xe,d=>n(0,o=d)),ee(s,Ke,d=>n(1,r=d));const a=Oe(),i=(d,g)=>JSON.stringify(Object.assign({},d,g));let c,u="";const f=()=>{n(3,u=i(o,r)),c.showModal(),Zt("dialog")};function p(d){c=d,n(2,c)}const m=()=>{i(o,r)!==u&&a("sortfilterupdate")};return s.$$.update=()=>{s.$$.dirty&2&&n(5,t=ws(r.rating,r.scoreValue,r.scoreComparator)),s.$$.dirty&1&&n(4,l=ys(o.property,o.direction))},[o,r,c,u,l,t,a,i,f,p,m]}class Ns extends se{constructor(e){super(),le(this,e,Ps,Ls,ne,{})}}function js(s){let e,n,t=Ve(s[1].postCount)+"",l,o,r,a,i;return a=new Ns({}),a.$on("sortfilterupdate",s[2]),{c(){e=C("div"),n=C("span"),l=X(t),o=X(" posts"),r=P(),A(a.$$.fragment),this.h()},l(c){e=I(c,"DIV",{class:!0});var u=F(e);n=I(u,"SPAN",{class:!0});var f=F(n);l=x(f,t),o=x(f," posts"),f.forEach($),r=N(u),V(a.$$.fragment,u),u.forEach($),this.h()},h(){_(n,"class","svelte-1f1ky2c"),ve(n,"loading",s[0]),_(e,"class","svelte-1f1ky2c")},m(c,u){R(c,e,u),v(e,n),v(n,l),v(n,o),v(e,r),O(a,e,null),i=!0},p(c,[u]){(!i||u&2)&&t!==(t=Ve(c[1].postCount)+"")&&be(l,t),(!i||u&1)&&ve(n,"loading",c[0])},i(c){i||(w(a.$$.fragment,c),i=!0)},o(c){T(a.$$.fragment,c),i=!1},d(c){c&&$(e),B(a)}}}function Rs(s,e,n){let t;ee(s,Ye,r=>n(1,t=r));let{loading:l}=e;function o(r){Fe.call(this,s,r)}return s.$$set=r=>{"loading"in r&&n(0,l=r.loading)},[l,t,o]}class Fs extends se{constructor(e){super(),le(this,e,Rs,js,ne,{loading:0})}}const ut=s=>`post_${s}`;function kt(s){let e;const n=s[4].default,t=_n(n,s,s[3],null);return{c(){t&&t.c()},l(l){t&&t.l(l)},m(l,o){t&&t.m(l,o),e=!0},p(l,o){t&&t.p&&(!e||o&8)&&gn(t,n,l,l[3],e?hn(n,l[3],o,null):mn(l[3]),null)},i(l){e||(w(t,l),e=!0)},o(l){T(t,l),e=!1},d(l){t&&t.d(l)}}}function As(s){let e,n,t,l,o=s[1]&&kt(s);return{c(){e=C("div"),o&&o.c(),this.h()},l(r){e=I(r,"DIV",{role:!0,tabindex:!0,class:!0});var a=F(e);o&&o.l(a),a.forEach($),this.h()},h(){_(e,"role","none"),_(e,"tabindex","-1"),_(e,"class","svelte-6sy8qz")},m(r,a){R(r,e,a),o&&o.m(e,null),s[5](e),n=!0,t||(l=[Q(e,"click",xe(Vs)),Q(e,"keydown",s[2])],t=!0)},p(r,[a]){r[1]?o?(o.p(r,a),a&2&&w(o,1)):(o=kt(r),o.c(),w(o,1),o.m(e,null)):o&&(_e(),T(o,1,1,()=>{o=null}),ge())},i(r){n||(w(o),n=!0)},o(r){T(o),n=!1},d(r){r&&$(e),o&&o.d(),s[5](null),t=!1,Qe(l)}}}const Vs=()=>{};function Os(s,e,n){let{$$slots:t={},$$scope:l}=e;const o=Oe(),r=()=>o("close"),a=p=>{p.key==="Escape"&&r()},i=()=>{document.fullscreenElement||r()};let c,u=!1;tt(async()=>{c.focus(),document.addEventListener("fullscreenchange",i);try{await c.requestFullscreen()}catch{}n(1,u=!0)}),nt(async()=>{document.removeEventListener("fullscreenchange",i);try{await document.exitFullscreen()}catch{}});function f(p){he[p?"unshift":"push"](()=>{c=p,n(0,c)})}return s.$$set=p=>{"$$scope"in p&&n(3,l=p.$$scope)},[c,u,a,l,t,f]}class Bs extends se{constructor(e){super(),le(this,e,Os,As,ne,{})}}function Ms(s){let e,n;return{c(){e=C("div"),this.h()},l(t){e=I(t,"DIV",{style:!0}),F(e).forEach($),this.h()},h(){_(e,"style",n=s[0]?`position:absolute;top:${s[0]};`:void 0)},m(t,l){R(t,e,l),s[3](e)},p(t,[l]){l&1&&n!==(n=t[0]?`position:absolute;top:${t[0]};`:void 0)&&_(e,"style",n)},i:K,o:K,d(t){t&&$(e),s[3](null)}}}function zs(s,e,n){let{rootMargin:t}=e,{absoluteTop:l}=e;const o=Oe(),r=new IntersectionObserver(c=>{c[0].isIntersecting&&o("intersection")},{rootMargin:t});let a;function i(c){he[c?"unshift":"push"](()=>{a=c,n(1,a)})}return s.$$set=c=>{"rootMargin"in c&&n(2,t=c.rootMargin),"absoluteTop"in c&&n(0,l=c.absoluteTop)},s.$$.update=()=>{s.$$.dirty&2&&(r.disconnect(),a&&r.observe(a))},[l,a,t,i]}class cn extends se{constructor(e){super(),le(this,e,zs,Ms,ne,{rootMargin:2,absoluteTop:0})}}function qs(s){let e,n;return{c(){e=C("a"),n=X("Open"),this.h()},l(t){e=I(t,"A",{href:!0,target:!0,class:!0});var l=F(e);n=x(l,"Open"),l.forEach($),this.h()},h(){_(e,"href",s[0]),_(e,"target","_newtab"),_(e,"class","codicon codicon-link-external svelte-10flxu9")},m(t,l){R(t,e,l),v(e,n)},p(t,[l]){l&1&&_(e,"href",t[0])},i:K,o:K,d(t){t&&$(e)}}}function Us(s,e,n){let{url:t}=e;return s.$$set=l=>{"url"in l&&n(0,t=l.url)},[t]}class Hs extends se{constructor(e){super(),le(this,e,Us,qs,ne,{url:0})}}function wt(s,e,n){const t=s.slice();return t[4]=e[n][0],t[5]=e[n][1],t}function yt(s){let e,n="•",t,l,o;return l=new tn({props:{source:s[0].source}}),{c(){e=C("span"),e.textContent=n,t=P(),A(l.$$.fragment)},l(r){e=I(r,"SPAN",{"data-svelte-h":!0}),ce(e)!=="svelte-7hh8jk"&&(e.textContent=n),t=N(r),V(l.$$.fragment,r)},m(r,a){R(r,e,a),R(r,t,a),O(l,r,a),o=!0},p(r,a){const i={};a&1&&(i.source=r[0].source),l.$set(i)},i(r){o||(w(l.$$.fragment,r),o=!0)},o(r){T(l.$$.fragment,r),o=!1},d(r){r&&($(e),$(t)),B(l,r)}}}function Et(s){let e,n=s[4]+"",t,l,o,r;return o=new sn({props:{tags:s[5]}}),{c(){e=C("h3"),t=X(n),l=P(),A(o.$$.fragment),this.h()},l(a){e=I(a,"H3",{class:!0});var i=F(e);t=x(i,n),i.forEach($),l=N(a),V(o.$$.fragment,a),this.h()},h(){_(e,"class","svelte-1tsjp7g")},m(a,i){R(a,e,i),v(e,t),R(a,l,i),O(o,a,i),r=!0},p(a,i){(!r||i&2)&&n!==(n=a[4]+"")&&be(t,n);const c={};i&2&&(c.tags=a[5]),o.$set(c)},i(a){r||(w(o.$$.fragment,a),r=!0)},o(a){T(o.$$.fragment,a),r=!1},d(a){a&&($(e),$(l)),B(o,a)}}}function Gs(s){let e,n,t,l,o,r,a,i,c=s[0].id+"",u,f,p,m,d,g,D="•",S,b,k=s[0].type.toUpperCase()+"",h,j,y,M="•",E,L,U,Y,fe="•",pe,ue,Z,te,H,W,oe,J="•",we,ye,$e,Se,Le="•",Ge,Pe,st,ct,Te,lt,Be,ft="Comments",rt,Me,ze;m=new Nn({props:{value:s[0].rating}}),L=new xt({props:{value:s[0].score}}),ue=new en({props:{value:s[0].change}}),H=new Hs({props:{url:"/post?id="+s[0].id+"&src="+encodeURIComponent(s[3])}}),ye=new tn({props:{source:"https://rule34.xxx/index.php?page=post&s=view&id="+s[0].id}}),Pe=new jn({props:{url:s[3]}});let ae=s[0].source&&yt(s),qe=ke(Object.entries(s[1])),z=[];for(let q=0;q<qe.length;q+=1)z[q]=Et(wt(s,qe,q));const re=q=>T(z[q],1,1,()=>{z[q]=null});return Me=new nn({props:{post:s[0]}}),{c(){e=C("div"),n=C("img"),l=P(),o=C("h1"),r=X("Post "),a=C("b"),i=X("#"),u=X(c),f=P(),p=C("div"),A(m.$$.fragment),d=P(),g=C("span"),g.textContent=D,S=P(),b=C("span"),h=X(k),j=P(),y=C("span"),y.textContent=M,E=P(),A(L.$$.fragment),U=P(),Y=C("span"),Y.textContent=fe,pe=P(),A(ue.$$.fragment),Z=P(),te=C("div"),A(H.$$.fragment),W=P(),oe=C("span"),oe.textContent=J,we=P(),A(ye.$$.fragment),$e=P(),Se=C("span"),Se.textContent=Le,Ge=P(),A(Pe.$$.fragment),st=P(),ae&&ae.c(),ct=P(),Te=C("div");for(let q=0;q<z.length;q+=1)z[q].c();lt=P(),Be=C("h3"),Be.textContent=ft,rt=P(),A(Me.$$.fragment),this.h()},l(q){e=I(q,"DIV",{class:!0});var G=F(e);n=I(G,"IMG",{class:!0,src:!0,alt:!0}),l=N(G),o=I(G,"H1",{class:!0});var de=F(o);r=x(de,"Post "),a=I(de,"B",{});var Ce=F(a);i=x(Ce,"#"),u=x(Ce,c),Ce.forEach($),de.forEach($),f=N(G),p=I(G,"DIV",{class:!0});var ie=F(p);V(m.$$.fragment,ie),d=N(ie),g=I(ie,"SPAN",{"data-svelte-h":!0}),ce(g)!=="svelte-7hh8jk"&&(g.textContent=D),S=N(ie),b=I(ie,"SPAN",{});var De=F(b);h=x(De,k),De.forEach($),j=N(ie),y=I(ie,"SPAN",{"data-svelte-h":!0}),ce(y)!=="svelte-7hh8jk"&&(y.textContent=M),E=N(ie),V(L.$$.fragment,ie),U=N(ie),Y=I(ie,"SPAN",{"data-svelte-h":!0}),ce(Y)!=="svelte-7hh8jk"&&(Y.textContent=fe),pe=N(ie),V(ue.$$.fragment,ie),ie.forEach($),Z=N(G),te=I(G,"DIV",{class:!0});var me=F(te);V(H.$$.fragment,me),W=N(me),oe=I(me,"SPAN",{"data-svelte-h":!0}),ce(oe)!=="svelte-7hh8jk"&&(oe.textContent=J),we=N(me),V(ye.$$.fragment,me),$e=N(me),Se=I(me,"SPAN",{"data-svelte-h":!0}),ce(Se)!=="svelte-7hh8jk"&&(Se.textContent=Le),Ge=N(me),V(Pe.$$.fragment,me),st=N(me),ae&&ae.l(me),me.forEach($),ct=N(G),Te=I(G,"DIV",{});var Ue=F(Te);for(let ot=0;ot<z.length;ot+=1)z[ot].l(Ue);lt=N(Ue),Be=I(Ue,"H3",{class:!0,"data-svelte-h":!0}),ce(Be)!=="svelte-kc6sae"&&(Be.textContent=ft),rt=N(Ue),V(Me.$$.fragment,Ue),Ue.forEach($),G.forEach($),this.h()},h(){_(n,"class","preview svelte-1tsjp7g"),Ie(n.src,t=s[2])||_(n,"src",t),_(n,"alt","preview"),_(o,"class","svelte-1tsjp7g"),_(p,"class","flex-row svelte-1tsjp7g"),_(te,"class","flex-row svelte-1tsjp7g"),_(Be,"class","svelte-1tsjp7g"),_(e,"class","details svelte-1tsjp7g")},m(q,G){R(q,e,G),v(e,n),v(e,l),v(e,o),v(o,r),v(o,a),v(a,i),v(a,u),v(e,f),v(e,p),O(m,p,null),v(p,d),v(p,g),v(p,S),v(p,b),v(b,h),v(p,j),v(p,y),v(p,E),O(L,p,null),v(p,U),v(p,Y),v(p,pe),O(ue,p,null),v(e,Z),v(e,te),O(H,te,null),v(te,W),v(te,oe),v(te,we),O(ye,te,null),v(te,$e),v(te,Se),v(te,Ge),O(Pe,te,null),v(te,st),ae&&ae.m(te,null),v(e,ct),v(e,Te);for(let de=0;de<z.length;de+=1)z[de]&&z[de].m(Te,null);v(Te,lt),v(Te,Be),v(Te,rt),O(Me,Te,null),ze=!0},p(q,[G]){(!ze||G&4&&!Ie(n.src,t=q[2]))&&_(n,"src",t),(!ze||G&1)&&c!==(c=q[0].id+"")&&be(u,c);const de={};G&1&&(de.value=q[0].rating),m.$set(de),(!ze||G&1)&&k!==(k=q[0].type.toUpperCase()+"")&&be(h,k);const Ce={};G&1&&(Ce.value=q[0].score),L.$set(Ce);const ie={};G&1&&(ie.value=q[0].change),ue.$set(ie);const De={};G&9&&(De.url="/post?id="+q[0].id+"&src="+encodeURIComponent(q[3])),H.$set(De);const me={};G&1&&(me.source="https://rule34.xxx/index.php?page=post&s=view&id="+q[0].id),ye.$set(me);const Ue={};if(G&8&&(Ue.url=q[3]),Pe.$set(Ue),q[0].source?ae?(ae.p(q,G),G&1&&w(ae,1)):(ae=yt(q),ae.c(),w(ae,1),ae.m(te,null)):ae&&(_e(),T(ae,1,1,()=>{ae=null}),ge()),G&2){qe=ke(Object.entries(q[1]));let Ee;for(Ee=0;Ee<qe.length;Ee+=1){const gt=wt(q,qe,Ee);z[Ee]?(z[Ee].p(gt,G),w(z[Ee],1)):(z[Ee]=Et(gt),z[Ee].c(),w(z[Ee],1),z[Ee].m(Te,lt))}for(_e(),Ee=qe.length;Ee<z.length;Ee+=1)re(Ee);ge()}const ot={};G&1&&(ot.post=q[0]),Me.$set(ot)},i(q){if(!ze){w(m.$$.fragment,q),w(L.$$.fragment,q),w(ue.$$.fragment,q),w(H.$$.fragment,q),w(ye.$$.fragment,q),w(Pe.$$.fragment,q),w(ae);for(let G=0;G<qe.length;G+=1)w(z[G]);w(Me.$$.fragment,q),ze=!0}},o(q){T(m.$$.fragment,q),T(L.$$.fragment,q),T(ue.$$.fragment,q),T(H.$$.fragment,q),T(ye.$$.fragment,q),T(Pe.$$.fragment,q),T(ae),z=z.filter(Boolean);for(let G=0;G<z.length;G+=1)T(z[G]);T(Me.$$.fragment,q),ze=!1},d(q){q&&$(e),B(m),B(L),B(ue),B(H),B(ye),B(Pe),ae&&ae.d(),Ze(z,q),B(Me)}}}function Ks(s,e,n){let t,l,o,{post:r}=e;return s.$$set=a=>{"post"in a&&n(0,r=a.post)},s.$$.update=()=>{s.$$.dirty&1&&n(3,t=r.file_url),s.$$.dirty&1&&n(2,l=r.sample_url),s.$$.dirty&1&&n(1,o=r.tags.reduce((a,i)=>(a[i.type]===void 0&&(a[i.type]=[]),a[i.type].push(i),a),{}))},[r,o,l,t]}class Ws extends se{constructor(e){super(),le(this,e,Ks,Gs,ne,{post:0})}}const it=new IntersectionObserver(s=>{for(const e of s)if(e.target){const n=e.target;e.isIntersecting&&n.autoplay&&n.paused&&n.play(),!e.isIntersecting&&!n.paused&&n.pause()}},{rootMargin:"-1px",threshold:.001});function Ys(s){let e,n,t,l;return{c(){e=C("div"),n=C("input"),this.h()},l(o){e=I(o,"DIV",{class:!0});var r=F(e);n=I(r,"INPUT",{type:!0,step:!0,max:!0,class:!0}),r.forEach($),this.h()},h(){_(n,"type","range"),_(n,"step","0.001"),_(n,"max",s[1]),_(n,"class","svelte-dfxj87"),_(e,"class","svelte-dfxj87")},m(o,r){R(o,e,r),v(e,n),We(n,s[0]),t||(l=[Q(n,"change",s[5]),Q(n,"input",s[5]),Q(n,"scroll",xe(at(s[4]))),Q(e,"click",xe(at(s[2]))),Q(e,"scroll",xe(at(s[3])))],t=!0)},p(o,[r]){r&2&&_(n,"max",o[1]),r&1&&We(n,o[0])},i:K,o:K,d(o){o&&$(e),t=!1,Qe(l)}}}function Js(s,e,n){let{value:t}=e,{max:l}=e;function o(c){Fe.call(this,s,c)}function r(c){Fe.call(this,s,c)}function a(c){Fe.call(this,s,c)}function i(){t=$n(this.value),n(0,t)}return s.$$set=c=>{"value"in c&&n(0,t=c.value),"max"in c&&n(1,l=c.max)},[t,l,o,r,a,i]}class un extends se{constructor(e){super(),le(this,e,Js,Ys,ne,{value:0,max:1})}}function St(s){let e,n=pt(s[2])+"",t,l,o=pt(s[4])+"",r;return{c(){e=C("span"),t=X(n),l=X(" / "),r=X(o),this.h()},l(a){e=I(a,"SPAN",{class:!0});var i=F(e);t=x(i,n),l=x(i," / "),r=x(i,o),i.forEach($),this.h()},h(){_(e,"class","svelte-r1orid")},m(a,i){R(a,e,i),v(e,t),v(e,l),v(e,r)},p(a,i){i&4&&n!==(n=pt(a[2])+"")&&be(t,n),i&16&&o!==(o=pt(a[4])+"")&&be(r,o)},d(a){a&&$(e)}}}function Zs(s){let e,n,t,l=!1,o,r=!0,a,i,c,u,f,p,m;function d(){cancelAnimationFrame(o),e.paused||(o=Rn(d),l=!0),s[10].call(e)}let g=s[2]!==void 0&&s[4]!==void 0&&St(s);function D(b){s[13](b)}let S={max:s[4]};return s[2]!==void 0&&(S.value=s[2]),c=new un({props:S}),he.push(()=>je(c,"value",D)),{c(){e=C("video"),a=P(),g&&g.c(),i=P(),A(c.$$.fragment),this.h()},l(b){e=I(b,"VIDEO",{src:!0,poster:!0,title:!0,preload:!0,class:!0}),F(e).forEach($),a=N(b),g&&g.l(b),i=N(b),V(c.$$.fragment,b),this.h()},h(){Ie(e.src,n=s[6])||_(e,"src",n),_(e,"poster",s[5]),_(e,"title",t="[VIDEO] post #"+s[0].id),_(e,"preload","metadata"),e.autoplay=!0,_(e,"class","svelte-r1orid"),s[4]===void 0&&vn(()=>s[12].call(e))},m(b,k){R(b,e,k),s[9](e),R(b,a,k),g&&g.m(b,k),R(b,i,k),O(c,b,k),f=!0,p||(m=[Q(e,"timeupdate",d),Q(e,"play",s[11]),Q(e,"pause",s[11]),Q(e,"durationchange",s[12]),Q(e,"click",Qs),Q(e,"ended",s[8]),Q(e,"contextmenu",at(Xs))],p=!0)},p(b,[k]){(!f||k&64&&!Ie(e.src,n=b[6]))&&_(e,"src",n),(!f||k&32)&&_(e,"poster",b[5]),(!f||k&1&&t!==(t="[VIDEO] post #"+b[0].id))&&_(e,"title",t),!l&&k&4&&!isNaN(b[2])&&(e.currentTime=b[2]),l=!1,k&8&&r!==(r=b[3])&&e[r?"pause":"play"](),b[2]!==void 0&&b[4]!==void 0?g?g.p(b,k):(g=St(b),g.c(),g.m(i.parentNode,i)):g&&(g.d(1),g=null);const h={};k&16&&(h.max=b[4]),!u&&k&4&&(u=!0,h.value=b[2],Ne(()=>u=!1)),c.$set(h)},i(b){f||(w(c.$$.fragment,b),f=!0)},o(b){T(c.$$.fragment,b),f=!1},d(b){b&&($(e),$(a),$(i)),s[9](null),g&&g.d(b),B(c,b),p=!1,Qe(m)}}}const Qs=s=>s.target.paused?s.target.play():s.target.pause(),Xs=()=>{};function xs(s,e,n){let t,l,o,{post:r}=e,a,i=0,c=!1,u;const f=b=>{a&&(b.key==="ArrowLeft"&&(b.preventDefault(),b.stopPropagation(),n(1,a.currentTime=Math.max(0,a.currentTime-5),a)),b.key==="ArrowRight"&&(b.preventDefault(),b.stopPropagation(),n(1,a.currentTime=Math.min(a.duration,a.currentTime+5),a)),b.key==="Space"&&(b.preventDefault(),b.stopPropagation(),n(3,c=!c)))};tt(()=>{a&&(it==null||it.observe(a)),document.addEventListener("keydown",f)}),nt(()=>{a&&(it==null||it.unobserve(a)),document.removeEventListener("keydown",f)});function p(b){Fe.call(this,s,b)}function m(b){he[b?"unshift":"push"](()=>{a=b,n(1,a)})}function d(){i=this.currentTime,n(2,i)}function g(){c=this.paused,n(3,c)}function D(){u=this.duration,n(4,u)}function S(b){i=b,n(2,i)}return s.$$set=b=>{"post"in b&&n(0,r=b.post)},s.$$.update=()=>{s.$$.dirty&1&&n(7,t=ln(r.file_url,r.sample_url,r.preview_url)),s.$$.dirty&128&&n(6,l=t.animated),s.$$.dirty&128&&n(5,o=t.static)},[r,a,i,c,u,o,l,t,p,m,d,g,D,S]}class el extends se{constructor(e){super(),le(this,e,xs,Zs,ne,{post:0})}}function tl(s){return{c:K,l:K,m:K,p:K,i:K,o:K,d:K}}function nl(s){let e,n,t,l,o,r;return{c(){e=C("img"),this.h()},l(a){e=I(a,"IMG",{src:!0,alt:!0,title:!0,class:!0}),this.h()},h(){Ie(e.src,n=s[2])||_(e,"src",n),_(e,"alt",t="["+s[0].type+"] post #"+s[0].id),_(e,"title",l="["+s[0].type+"] post #"+s[0].id),_(e,"class","svelte-jlq3re")},m(a,i){R(a,e,i),o||(r=[Q(e,"contextmenu",at(ol)),Q(e,"click",s[6]),bn(s[7].call(null,e))],o=!0)},p(a,i){i&4&&!Ie(e.src,n=a[2])&&_(e,"src",n),i&1&&t!==(t="["+a[0].type+"] post #"+a[0].id)&&_(e,"alt",t),i&1&&l!==(l="["+a[0].type+"] post #"+a[0].id)&&_(e,"title",l)},i:K,o:K,d(a){a&&$(e),o=!1,Qe(r)}}}function sl(s){let e,n,t,l,o,r,a,i,c,u;return a=new _t({}),{c(){e=C("img"),o=P(),r=C("div"),A(a.$$.fragment),this.h()},l(f){e=I(f,"IMG",{src:!0,alt:!0,title:!0,class:!0}),o=N(f),r=I(f,"DIV",{class:!0});var p=F(r);V(a.$$.fragment,p),p.forEach($),this.h()},h(){Ie(e.src,n=s[3])||_(e,"src",n),_(e,"alt",t="["+s[0].type+"] post #"+s[0].id),_(e,"title",l="["+s[0].type+"] post #"+s[0].id),_(e,"class","svelte-jlq3re"),_(r,"class","svelte-jlq3re")},m(f,p){R(f,e,p),R(f,o,p),R(f,r,p),O(a,r,null),i=!0,c||(u=[Q(e,"contextmenu",at(rl)),Q(e,"click",s[6])],c=!0)},p(f,p){(!i||p&8&&!Ie(e.src,n=f[3]))&&_(e,"src",n),(!i||p&1&&t!==(t="["+f[0].type+"] post #"+f[0].id))&&_(e,"alt",t),(!i||p&1&&l!==(l="["+f[0].type+"] post #"+f[0].id))&&_(e,"title",l)},i(f){i||(w(a.$$.fragment,f),i=!0)},o(f){T(a.$$.fragment,f),i=!1},d(f){f&&($(e),$(o),$(r)),B(a),c=!1,Qe(u)}}}function Ct(s){let e,n,t;function l(r){s[10](r)}let o={max:s[5]};return s[1]!==void 0&&(o.value=s[1]),e=new un({props:o}),he.push(()=>je(e,"value",l)),{c(){A(e.$$.fragment)},l(r){V(e.$$.fragment,r)},m(r,a){O(e,r,a),t=!0},p(r,a){const i={};a&32&&(i.max=r[5]),!n&&a&2&&(n=!0,i.value=r[1],Ne(()=>n=!1)),e.$set(i)},i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){T(e.$$.fragment,r),t=!1},d(r){B(e,r)}}}function ll(s){let e,n,t,l,o={ctx:s,current:null,token:null,hasCatch:!1,pending:sl,then:nl,catch:tl,value:21,blocks:[,,,]};ht(e=s[8](s[2]),o);let r=s[4]&&Ct(s);return{c(){o.block.c(),n=P(),r&&r.c(),t=Ae()},l(a){o.block.l(a),n=N(a),r&&r.l(a),t=Ae()},m(a,i){o.block.m(a,o.anchor=i),o.mount=()=>n.parentNode,o.anchor=n,R(a,n,i),r&&r.m(a,i),R(a,t,i),l=!0},p(a,[i]){s=a,o.ctx=s,i&4&&e!==(e=s[8](s[2]))&&ht(e,o)||zn(o,s,i),s[4]?r?(r.p(s,i),i&16&&w(r,1)):(r=Ct(s),r.c(),w(r,1),r.m(t.parentNode,t)):r&&(_e(),T(r,1,1,()=>{r=null}),ge())},i(a){l||(w(o.block),w(r),l=!0)},o(a){for(let i=0;i<3;i+=1){const c=o.blocks[i];T(c)}T(r),l=!1},d(a){a&&($(n),$(t)),o.block.d(a),o.token=null,o=null,r&&r.d(a)}}}const rl=()=>{},ol=()=>{};function il(s,e,n){let t,l,o,r;ee(s,Yt,E=>n(4,o=E)),ee(s,In,E=>n(5,r=E));const a=Oe();let{post:i}=e,{postId:c=-1}=e;const u=(E,L,U,Y)=>{if(E==="gif"){const fe=Fn(L,U,Y);return[fe.static,fe.animated]}return qn?[U,L]:[Y,U]};let f=0,p=Date.now(),m=Date.now(),d,g=!0,D;const S=()=>{m=Date.now(),d=m-p,p=m,g||n(1,f+=d/1e3),f>=r&&(a("ended"),n(1,f=0)),D=requestAnimationFrame(S)},b=()=>{g=!g},k=E=>{(E.code==="Space"||E.key==="k")&&(E.preventDefault(),E.stopPropagation(),g=!g)},h=new IntersectionObserver(E=>{for(const L of E)L.target&&(g=!L.isIntersecting)},{rootMargin:"0px",threshold:.5}),j=E=>(h==null||h.observe(E),{destroy(){h==null||h.unobserve(E)}});tt(()=>{o&&(D=requestAnimationFrame(S),document.addEventListener("keydown",k))}),nt(()=>{cancelAnimationFrame(D),document.removeEventListener("keydown",k)});const y=E=>new Promise(L=>{g=!0;let U=new Image;U.onload=Y=>{L(Y),g=!1},U.src=E});function M(E){f=E,n(1,f),n(0,i),n(9,c)}return s.$$set=E=>{"post"in E&&n(0,i=E.post),"postId"in E&&n(9,c=E.postId)},s.$$.update=()=>{s.$$.dirty&1&&n(3,[t,l]=u(i.type,i.file_url,i.sample_url,i.preview_url),t,(n(2,l),n(0,i))),s.$$.dirty&513&&i.id!==c&&(n(9,c=i.id),n(1,f=0))},[i,f,l,t,o,r,b,j,y,c,M]}class al extends se{constructor(e){super(),le(this,e,il,ll,ne,{post:0,postId:9})}}function cl(s){let e,n;return e=new al({props:{post:s[0]}}),e.$on("ended",s[2]),{c(){A(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,l){O(e,t,l),n=!0},p(t,l){const o={};l&1&&(o.post=t[0]),e.$set(o)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){B(e,t)}}}function ul(s){let e,n;return e=new el({props:{post:s[0]}}),e.$on("ended",s[1]),{c(){A(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,l){O(e,t,l),n=!0},p(t,l){const o={};l&1&&(o.post=t[0]),e.$set(o)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){B(e,t)}}}function fl(s){let e,n,t,l;const o=[ul,cl],r=[];function a(i,c){return i[0].type==="video"?0:1}return n=a(s),t=r[n]=o[n](s),{c(){e=C("div"),t.c(),this.h()},l(i){e=I(i,"DIV",{class:!0});var c=F(e);t.l(c),c.forEach($),this.h()},h(){_(e,"class","svelte-acjk3s")},m(i,c){R(i,e,c),r[n].m(e,null),l=!0},p(i,[c]){let u=n;n=a(i),n===u?r[n].p(i,c):(_e(),T(r[u],1,1,()=>{r[u]=null}),ge(),t=r[n],t?t.p(i,c):(t=r[n]=o[n](i),t.c()),w(t,1),t.m(e,null))},i(i){l||(w(t),l=!0)},o(i){T(t),l=!1},d(i){i&&$(e),r[n].d()}}}function pl(s,e,n){let{post:t}=e;function l(r){Fe.call(this,s,r)}function o(r){Fe.call(this,s,r)}return s.$$set=r=>{"post"in r&&n(0,t=r.post)},[t,l,o]}class dl extends se{constructor(e){super(),le(this,e,pl,fl,ne,{post:0})}}function _l(s){let e,n,t;return{c(){e=C("img"),this.h()},l(l){e=I(l,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){Ie(e.src,n=s[2])||_(e,"src",n),_(e,"alt",t="post #"+s[0].id),_(e,"class","svelte-itxz72"),Re(e,"top",s[1])},m(l,o){R(l,e,o)},p(l,[o]){o&4&&!Ie(e.src,n=l[2])&&_(e,"src",n),o&1&&t!==(t="post #"+l[0].id)&&_(e,"alt",t),o&2&&Re(e,"top",l[1])},i:K,o:K,d(l){l&&$(e)}}}function gl(s,e,n){let t,{post:l}=e,{offset:o}=e;return s.$$set=r=>{"post"in r&&n(0,l=r.post),"offset"in r&&n(1,o=r.offset)},s.$$.update=()=>{s.$$.dirty&1&&n(2,t=An(l.sample_url)?l.preview_url:l.sample_url)},[l,o,t]}class fn extends se{constructor(e){super(),le(this,e,gl,_l,ne,{post:0,offset:1})}}const ml=()=>{const{subscribe:e,set:n}=Gn(Kn.FullscreenHintDone,!1,Yn,Wn);return{subscribe:e,set:n,reset:()=>n(!1)}},It=ml();function Tt(s,e,n){const t=s.slice();return t[22]=e[n],t[24]=n,t}function Dt(s){let e,n;return e=new fn({props:{post:s[7],offset:s[4]}}),{c(){A(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,l){O(e,t,l),n=!0},p(t,l){const o={};l&128&&(o.post=t[7]),l&16&&(o.offset=t[4]),e.$set(o)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){B(e,t)}}}function hl(s){let e;return{c(){e=C("i"),this.h()},l(n){e=I(n,"I",{class:!0}),F(e).forEach($),this.h()},h(){_(e,"class","codicon codicon-tag")},m(n,t){R(n,e,t)},p:K,d(n){n&&$(e)}}}function Lt(s){let e,n;return e=new fn({props:{post:s[6],offset:s[3]}}),{c(){A(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,l){O(e,t,l),n=!0},p(t,l){const o={};l&64&&(o.post=t[6]),l&8&&(o.offset=t[3]),e.$set(o)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){B(e,t)}}}function Pt(s){let e,n=`${s[24]*100}vh`;return{c(){e=C("div"),this.h()},l(t){e=I(t,"DIV",{class:!0}),F(e).forEach($),this.h()},h(){_(e,"class","pseudo snap-item svelte-2epggd"),Re(e,"top",n)},m(t,l){R(t,e,l)},p:K,d(t){t&&$(e)}}}function $l(s){let e,n,t,l,o,r,a,i,c,u,f,p,m,d,g,D=s[7]&&Dt(s);l=new dl({props:{post:s[8]}}),l.$on("ended",s[11]),r=new Ws({props:{post:s[8]}}),i=new Xt({props:{class:"details-button",$$slots:{default:[hl]},$$scope:{ctx:s}}}),i.$on("click",s[14]);let S=s[6]&&Lt(s),b=ke({length:s[0].posts.length}),k=[];for(let h=0;h<b.length;h+=1)k[h]=Pt(Tt(s,b,h));return p=new cn({props:{absoluteTop:s[0].posts.length*100+"vh",rootMargin:window.innerHeight*3+"px"}}),p.$on("intersection",s[16]),{c(){e=C("div"),D&&D.c(),n=P(),t=C("div"),A(l.$$.fragment),o=P(),A(r.$$.fragment),a=P(),A(i.$$.fragment),c=P(),S&&S.c(),u=P();for(let h=0;h<k.length;h+=1)k[h].c();f=P(),A(p.$$.fragment),this.h()},l(h){e=I(h,"DIV",{class:!0});var j=F(e);D&&D.l(j),n=N(j),t=I(j,"DIV",{class:!0});var y=F(t);V(l.$$.fragment,y),o=N(y),V(r.$$.fragment,y),a=N(y),V(i.$$.fragment,y),y.forEach($),c=N(j),S&&S.l(j),u=N(j);for(let M=0;M<k.length;M+=1)k[M].l(j);f=N(j),V(p.$$.fragment,j),j.forEach($),this.h()},h(){_(t,"class","screen snap-container horizontal current svelte-2epggd"),ve(t,"hint",!s[9]),Re(t,"top",s[5]),_(e,"class","root screen snap-container svelte-2epggd")},m(h,j){R(h,e,j),D&&D.m(e,null),v(e,n),v(e,t),O(l,t,null),v(t,o),O(r,t,null),v(t,a),O(i,t,null),s[15](t),v(e,c),S&&S.m(e,null),v(e,u);for(let y=0;y<k.length;y+=1)k[y]&&k[y].m(e,null);v(e,f),O(p,e,null),s[17](e),m=!0,d||(g=Q(e,"scroll",s[12]),d=!0)},p(h,[j]){h[7]?D?(D.p(h,j),j&128&&w(D,1)):(D=Dt(h),D.c(),w(D,1),D.m(e,n)):D&&(_e(),T(D,1,1,()=>{D=null}),ge());const y={};j&256&&(y.post=h[8]),l.$set(y);const M={};j&256&&(M.post=h[8]),r.$set(M);const E={};if(j&33554432&&(E.$$scope={dirty:j,ctx:h}),i.$set(E),(!m||j&512)&&ve(t,"hint",!h[9]),j&32&&Re(t,"top",h[5]),h[6]?S?(S.p(h,j),j&64&&w(S,1)):(S=Lt(h),S.c(),w(S,1),S.m(e,u)):S&&(_e(),T(S,1,1,()=>{S=null}),ge()),j&1){b=ke({length:h[0].posts.length});let U;for(U=0;U<b.length;U+=1){const Y=Tt(h,b,U);k[U]?k[U].p(Y,j):(k[U]=Pt(Y),k[U].c(),k[U].m(e,f))}for(;U<k.length;U+=1)k[U].d(1);k.length=b.length}const L={};j&1&&(L.absoluteTop=h[0].posts.length*100+"vh"),p.$set(L)},i(h){m||(w(D),w(l.$$.fragment,h),w(r.$$.fragment,h),w(i.$$.fragment,h),w(S),w(p.$$.fragment,h),m=!0)},o(h){T(D),T(l.$$.fragment,h),T(r.$$.fragment,h),T(i.$$.fragment,h),T(S),T(p.$$.fragment,h),m=!1},d(h){h&&$(e),D&&D.d(),B(l),B(r),B(i),s[15](null),S&&S.d(),Ze(k,h),B(p),s[17](null),d=!1,g()}}}function vl(s,e,n){let t,l,o,r,a,i,c,u,f;ee(s,It,L=>n(9,c=L)),ee(s,Yt,L=>n(18,u=L)),ee(s,Ye,L=>n(0,f=L));const p=Oe();let{index:m}=e,d,g;const D=()=>{d.scrollTo({left:0,top:d.clientHeight*(m-1),behavior:"smooth"})},S=()=>{d.scrollTo({left:0,top:d.clientHeight*(m+1),behavior:"smooth"})},b=()=>{u&&S()},k=L=>{requestAnimationFrame(()=>{const U=L.target,Y=U.getBoundingClientRect().height,fe=U.scrollTop/Y,pe=Math.round(fe);pe!=m&&(n(13,m=pe),g&&n(2,g.scrollLeft=0,g))})},h=L=>{L.key==="d"&&(L.preventDefault(),L.stopPropagation(),g.scrollLeft===0?g.scrollBy({left:d.clientWidth,top:0,behavior:"smooth"}):g.scrollBy({left:-d.clientWidth,top:0,behavior:"smooth"})),L.key==="ArrowUp"&&(L.preventDefault(),L.stopPropagation(),D()),L.key==="ArrowDown"&&(L.preventDefault(),L.stopPropagation(),S())};tt(()=>{g&&(g.scrollIntoView(!0),n(2,g.scrollLeft=0,g)),document.addEventListener("keydown",h)}),nt(()=>{kn(It,c=!0,c),document.removeEventListener("keydown",h)});const j=()=>g.scrollBy({left:d.clientWidth,top:0,behavior:"smooth"});function y(L){he[L?"unshift":"push"](()=>{g=L,n(2,g)})}const M=()=>p("endreached");function E(L){he[L?"unshift":"push"](()=>{d=L,n(1,d)})}return s.$$set=L=>{"index"in L&&n(13,m=L.index)},s.$$.update=()=>{s.$$.dirty&8193&&n(8,t=f.posts[m]),s.$$.dirty&8193&&n(7,l=m>0?f.posts[m-1]:void 0),s.$$.dirty&8193&&n(6,o=m<f.posts.length-1?f.posts[m+1]:void 0),s.$$.dirty&8192&&n(5,r=`${m*100}vh`),s.$$.dirty&8192&&n(4,a=`${(m-1)*100}vh`),s.$$.dirty&8192&&n(3,i=`${(m+1)*100}vh`)},[f,d,g,i,a,r,o,l,t,c,p,b,k,m,j,y,M,E]}class bl extends se{constructor(e){super(),le(this,e,vl,$l,ne,{index:13})}}function kl(s){let e;return{c(){e=C("i"),this.h()},l(n){e=I(n,"I",{class:!0}),F(e).forEach($),this.h()},h(){_(e,"class","codicon codicon-close")},m(n,t){R(n,e,t)},p:K,d(n){n&&$(e)}}}function wl(s){let e,n,t,l,o;function r(i){s[2](i)}let a={};return s[0]!==void 0&&(a.index=s[0]),e=new bl({props:a}),he.push(()=>je(e,"index",r)),e.$on("endreached",s[3]),l=new Xt({props:{class:"button-close",$$slots:{default:[kl]},$$scope:{ctx:s}}}),l.$on("click",s[1]),{c(){A(e.$$.fragment),t=P(),A(l.$$.fragment)},l(i){V(e.$$.fragment,i),t=N(i),V(l.$$.fragment,i)},m(i,c){O(e,i,c),R(i,t,c),O(l,i,c),o=!0},p(i,c){const u={};!n&&c&1&&(n=!0,u.index=i[0],Ne(()=>n=!1)),e.$set(u);const f={};c&128&&(f.$$scope={dirty:c,ctx:i}),l.$set(f)},i(i){o||(w(e.$$.fragment,i),w(l.$$.fragment,i),o=!0)},o(i){T(e.$$.fragment,i),T(l.$$.fragment,i),o=!1},d(i){i&&$(t),B(e,i),B(l,i)}}}function yl(s){let e,n;return e=new Bs({props:{$$slots:{default:[wl]},$$scope:{ctx:s}}}),e.$on("close",s[1]),{c(){A(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,l){O(e,t,l),n=!0},p(t,[l]){const o={};l&129&&(o.$$scope={dirty:l,ctx:t}),e.$set(o)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){B(e,t)}}}function El(s,e,n){let{index:t}=e;const l=Oe(),o=()=>{l("close",t)},r=u=>{u.key==="f"&&(u.preventDefault(),u.stopPropagation(),o())},a=()=>{var u,f;(((u=history.state)==null?void 0:u.fullscreen)===void 0||((f=history.state)==null?void 0:f.fullscreen)===!1)&&o()};tt(()=>{window.addEventListener("popstate",a),document.addEventListener("keydown",r)}),nt(()=>{window.removeEventListener("popstate",a),document.removeEventListener("keydown",r)});function i(u){t=u,n(0,t)}function c(u){Fe.call(this,s,u)}return s.$$set=u=>{"index"in u&&n(0,t=u.index)},[t,o,i,c]}class Sl extends se{constructor(e){super(),le(this,e,El,yl,ne,{index:0})}}function Nt(s){let e,n=s[0].type==="video"?"▶":"GIF",t;return{c(){e=C("span"),t=X(n),this.h()},l(l){e=I(l,"SPAN",{class:!0});var o=F(e);t=x(o,n),o.forEach($),this.h()},h(){_(e,"class","type svelte-rfj0jo")},m(l,o){R(l,e,o),v(e,t)},p(l,o){o&1&&n!==(n=l[0].type==="video"?"▶":"GIF")&&be(t,n)},d(l){l&&$(e)}}}function Cl(s){let e,n,t,l,o,r,a=Ve(s[0].score)+"",i,c,u,f,p=s[0].type!=="image"&&Nt(s);return{c(){e=C("div"),n=C("img"),l=P(),p&&p.c(),o=P(),r=C("span"),i=X(a),this.h()},l(m){e=I(m,"DIV",{id:!0,class:!0,style:!0});var d=F(e);n=I(d,"IMG",{src:!0,alt:!0,class:!0,tabindex:!0,loading:!0}),l=N(d),p&&p.l(d),o=N(d),r=I(d,"SPAN",{class:!0});var g=F(r);i=x(g,a),g.forEach($),d.forEach($),this.h()},h(){Ie(n.src,t=s[1])||_(n,"src",t),_(n,"alt","post"),_(n,"class","post-media svelte-rfj0jo"),_(n,"tabindex","-1"),_(n,"loading","lazy"),_(r,"class","score svelte-rfj0jo"),_(e,"id",c=ut(s[0].id)),_(e,"class","post svelte-rfj0jo"),Re(e,"grid-row","span "+s[2]),ve(e,"open",open)},m(m,d){R(m,e,d),v(e,n),v(e,l),p&&p.m(e,null),v(e,o),v(e,r),v(r,i),u||(f=[Q(e,"click",s[3]),Q(e,"keydown",s[4])],u=!0)},p(m,[d]){d&2&&!Ie(n.src,t=m[1])&&_(n,"src",t),m[0].type!=="image"?p?p.p(m,d):(p=Nt(m),p.c(),p.m(e,o)):p&&(p.d(1),p=null),d&1&&a!==(a=Ve(m[0].score)+"")&&be(i,a),d&1&&c!==(c=ut(m[0].id))&&_(e,"id",c),d&0&&ve(e,"open",open)},i:K,o:K,d(m){m&&$(e),p&&p.d(),u=!1,Qe(f)}}}let jt=5;function Il(s,e,n){let t,{post:l}=e,o=1/3,r=Vn(l.width,l.height),a=Math.max(Math.min(Math.round(jt/r),jt/o),2);const i=f=>f.endsWith(".jpg")||f.endsWith(".jpeg")||f.endsWith(".png")||f.endsWith(".webp");function c(f){Fe.call(this,s,f)}const u=f=>{var p;(Un(f)||f.key==="f")&&((p=f.target)==null||p.click())};return s.$$set=f=>{"post"in f&&n(0,l=f.post)},s.$$.update=()=>{s.$$.dirty&1&&n(1,t=i(l.sample_url)?l.sample_url:l.preview_url)},[l,t,a,c,u]}class Tl extends se{constructor(e){super(),le(this,e,Il,Cl,ne,{post:0})}}function Rt(s,e,n){const t=s.slice();t[2]=e[n];const l=t[2].host.replace("www.","");t[3]=l;const o=t[1][t[3]]??t[1].default;t[4]=o[0],t[5]=o[1];const r=t[3].includes("api-cdn")?"File":t[3];return t[6]=r,t}function Ft(s){let e,n,t=s[6]+"",l,o,r,a;return{c(){e=C("li"),n=C("a"),l=X(t),a=P(),this.h()},l(i){e=I(i,"LI",{});var c=F(e);n=I(c,"A",{href:!0,class:!0,style:!0});var u=F(n);l=x(u,t),u.forEach($),a=N(c),c.forEach($),this.h()},h(){_(n,"href",o=s[2].toString()),_(n,"class",r="codicon codicon-link-external "+s[5]+" svelte-f59j30"),Re(n,"background-color",s[4]),Re(n,"color",s[5])},m(i,c){R(i,e,c),v(e,n),v(n,l),v(e,a)},p(i,c){c&1&&t!==(t=i[6]+"")&&be(l,t),c&1&&o!==(o=i[2].toString())&&_(n,"href",o),c&1&&r!==(r="codicon codicon-link-external "+i[5]+" svelte-f59j30")&&_(n,"class",r),c&1&&Re(n,"background-color",i[4]),c&1&&Re(n,"color",i[5])},d(i){i&&$(e)}}}function Dl(s){let e,n=ke(s[0]),t=[];for(let l=0;l<n.length;l+=1)t[l]=Ft(Rt(s,n,l));return{c(){e=C("ol");for(let l=0;l<t.length;l+=1)t[l].c();this.h()},l(l){e=I(l,"OL",{class:!0});var o=F(e);for(let r=0;r<t.length;r+=1)t[r].l(o);o.forEach($),this.h()},h(){_(e,"class","svelte-f59j30")},m(l,o){R(l,e,o);for(let r=0;r<t.length;r+=1)t[r]&&t[r].m(e,null)},p(l,[o]){if(o&3){n=ke(l[0]);let r;for(r=0;r<n.length;r+=1){const a=Rt(l,n,r);t[r]?t[r].p(a,o):(t[r]=Ft(a),t[r].c(),t[r].m(e,null))}for(;r<t.length;r+=1)t[r].d(1);t.length=n.length}},i:K,o:K,d(l){l&&$(e),Ze(t,l)}}}function Ll(s,e,n){let{links:t}=e;const l={"kurosearch.com":["crimson","white"],"rule34.xxx":["#aae5a4","black"],"newgrounds.com":["#fda238","black"],"twitter.com":["rgb(29, 155, 240)","white"],"x.com":["rgb(29, 155, 240)","white"],"pornhub.com":["#f90","black"],"zone-archive.com":["#59396A","white"],"subscribestar.adult":["#ff4081","white"],"redgifs.com":["#E5194D","white"],"deviantart.com":["#00c787","black"],default:["var(--background-2)","white"]};return s.$$set=o=>{"links"in o&&n(0,t=o.links)},[t,l]}class Pl extends se{constructor(e){super(),le(this,e,Ll,Dl,ne,{links:0})}}function At(s){let e,n=Ve(s[0].comment_count)+"",t,l,o;return{c(){e=C("button"),t=X(n),this.h()},l(r){e=I(r,"BUTTON",{type:!0,class:!0});var a=F(e);t=x(a,n),a.forEach($),this.h()},h(){_(e,"type","button"),_(e,"class","codicon codicon-comment svelte-nhpj3u"),ve(e,"active",s[1]==="comments")},m(r,a){R(r,e,a),v(e,t),l||(o=Q(e,"click",xe(s[5])),l=!0)},p(r,a){a&1&&n!==(n=Ve(r[0].comment_count)+"")&&be(t,n),a&2&&ve(e,"active",r[1]==="comments")},d(r){r&&$(e),l=!1,o()}}}function Nl(s){let e,n,t,l,o="•",r,a,i,c,u,f,p=Ve(s[2])+"",m,d,g,D,S=Ve(s[0].tags.length)+"",b,k,h,j;n=new en({props:{value:s[0].change}}),a=new xt({props:{value:s[0].score}});let y=s[0].comment_count&&At(s);return{c(){e=C("div"),A(n.$$.fragment),t=P(),l=C("span"),l.textContent=o,r=P(),A(a.$$.fragment),i=P(),c=C("span"),u=P(),f=C("button"),m=X(p),d=P(),y&&y.c(),g=P(),D=C("button"),b=X(S),this.h()},l(M){e=I(M,"DIV",{class:!0});var E=F(e);V(n.$$.fragment,E),t=N(E),l=I(E,"SPAN",{"data-svelte-h":!0}),ce(l)!=="svelte-7hh8jk"&&(l.textContent=o),r=N(E),V(a.$$.fragment,E),i=N(E),c=I(E,"SPAN",{class:!0}),F(c).forEach($),u=N(E),f=I(E,"BUTTON",{type:!0,class:!0});var L=F(f);m=x(L,p),L.forEach($),d=N(E),y&&y.l(E),g=N(E),D=I(E,"BUTTON",{type:!0,class:!0});var U=F(D);b=x(U,S),U.forEach($),E.forEach($),this.h()},h(){_(c,"class","divider svelte-nhpj3u"),_(f,"type","button"),_(f,"class","codicon codicon-link svelte-nhpj3u"),ve(f,"active",s[1]==="links"),_(D,"type","button"),_(D,"class","codicon codicon-tag svelte-nhpj3u"),ve(D,"active",s[1]==="tags"),_(e,"class","summary svelte-nhpj3u")},m(M,E){R(M,e,E),O(n,e,null),v(e,t),v(e,l),v(e,r),O(a,e,null),v(e,i),v(e,c),v(e,u),v(e,f),v(f,m),v(e,d),y&&y.m(e,null),v(e,g),v(e,D),v(D,b),k=!0,h||(j=[Q(f,"click",xe(s[4])),Q(D,"click",xe(s[6]))],h=!0)},p(M,[E]){const L={};E&1&&(L.value=M[0].change),n.$set(L);const U={};E&1&&(U.value=M[0].score),a.$set(U),(!k||E&4)&&p!==(p=Ve(M[2])+"")&&be(m,p),(!k||E&2)&&ve(f,"active",M[1]==="links"),M[0].comment_count?y?y.p(M,E):(y=At(M),y.c(),y.m(e,g)):y&&(y.d(1),y=null),(!k||E&1)&&S!==(S=Ve(M[0].tags.length)+"")&&be(b,S),(!k||E&2)&&ve(D,"active",M[1]==="tags")},i(M){k||(w(n.$$.fragment,M),w(a.$$.fragment,M),k=!0)},o(M){T(n.$$.fragment,M),T(a.$$.fragment,M),k=!1},d(M){M&&$(e),B(n),B(a),y&&y.d(),h=!1,Qe(j)}}}function jl(s,e,n){const t=Oe();let{post:l}=e,{active:o}=e,{links:r}=e;const a=()=>t("links"),i=()=>t("comments"),c=()=>t("tags");return s.$$set=u=>{"post"in u&&n(0,l=u.post),"active"in u&&n(1,o=u.active),"links"in u&&n(2,r=u.links)},[l,o,r,t,a,i,c]}class Rl extends se{constructor(e){super(),le(this,e,jl,Nl,ne,{post:0,active:1,links:2})}}function Fl(s){let e,n='<i class="codicon codicon-screen-full"></i>',t,l;return{c(){e=C("button"),e.innerHTML=n,this.h()},l(o){e=I(o,"BUTTON",{type:!0,title:!0,class:!0,"data-svelte-h":!0}),ce(e)!=="svelte-hnv5zq"&&(e.innerHTML=n),this.h()},h(){_(e,"type","button"),_(e,"title","Enter Fullscreen mode"),_(e,"class","svelte-txn4jo")},m(o,r){R(o,e,r),t||(l=Q(e,"click",s[0]),t=!0)},p:K,i:K,o:K,d(o){o&&$(e),t=!1,l()}}}function Al(s){function e(n){Fe.call(this,s,n)}return[e]}class Vl extends se{constructor(e){super(),le(this,e,Al,Fl,ne,{})}}function Ol(s){const e=s.slice(),n=ln(e[1].file_url,e[1].sample_url,e[1].preview_url);return e[13]=n,e}function Bl(s){let e,n;return e=new On({props:{post:s[1]}}),e.$on("click",s[5]),{c(){A(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,l){O(e,t,l),n=!0},p(t,l){const o={};l&2&&(o.post=t[1]),e.$set(o)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){B(e,t)}}}function Ml(s){let e,n;return e=new Bn({props:{src:s[13].animated,poster:s[13].static,width:s[1].width,height:s[1].height,loop:s[2]||mt(s[1].tags)}}),e.$on("click",s[5]),{c(){A(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,l){O(e,t,l),n=!0},p(t,l){const o={};l&2&&(o.src=t[13].animated),l&2&&(o.poster=t[13].static),l&2&&(o.width=t[1].width),l&2&&(o.height=t[1].height),l&6&&(o.loop=t[2]||mt(t[1].tags)),e.$set(o)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){B(e,t)}}}function zl(s){let e,n;return e=new Mn({props:{post:s[1]}}),e.$on("click",s[5]),{c(){A(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,l){O(e,t,l),n=!0},p(t,l){const o={};l&2&&(o.post=t[1]),e.$set(o)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){B(e,t)}}}function ql(s){let e,n;return e=new Pl({props:{links:s[6]}}),{c(){A(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,l){O(e,t,l),n=!0},p:K,i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){B(e,t)}}}function Ul(s){let e,n;return e=new nn({props:{post:s[1]}}),{c(){A(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,l){O(e,t,l),n=!0},p(t,l){const o={};l&2&&(o.post=t[1]),e.$set(o)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){B(e,t)}}}function Hl(s){let e,n;return e=new sn({props:{tags:s[1].tags}}),{c(){A(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,l){O(e,t,l),n=!0},p(t,l){const o={};l&2&&(o.tags=t[1].tags),e.$set(o)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){B(e,t)}}}function Gl(s){let e,n,t,l,o,r,a,i,c,u,f,p,m,d,g,D;const S=[zl,Ml,Bl],b=[];function k(E,L){return E[1].type==="image"?0:E[1].type==="video"?1:2}function h(E,L){return L===1?Ol(E):E}t=k(s),l=b[t]=S[t](h(s,t)),r=new Vl({}),r.$on("click",s[7]),c=new Rl({props:{active:s[0],post:s[1],links:s[6].length}}),c.$on("tags",s[8]),c.$on("comments",s[9]),c.$on("links",s[10]);const j=[Hl,Ul,ql],y=[];function M(E,L){return E[0]==="tags"?0:E[0]==="comments"?1:E[0]==="links"?2:-1}return~(f=M(s))&&(p=y[f]=j[f](s)),{c(){e=C("li"),n=C("div"),l.c(),o=P(),A(r.$$.fragment),a=P(),i=C("div"),A(c.$$.fragment),u=P(),p&&p.c(),this.h()},l(E){e=I(E,"LI",{id:!0,class:!0});var L=F(e);n=I(L,"DIV",{});var U=F(n);l.l(U),U.forEach($),o=N(L),V(r.$$.fragment,L),a=N(L),i=I(L,"DIV",{class:!0});var Y=F(i);V(c.$$.fragment,Y),u=N(Y),p&&p.l(Y),Y.forEach($),L.forEach($),this.h()},h(){_(i,"class","details svelte-162qa8v"),_(e,"id",m=ut(s[1].id)),_(e,"class","post svelte-162qa8v"),ve(e,"openTab",s[0])},m(E,L){R(E,e,L),v(e,n),b[t].m(n,null),v(e,o),O(r,e,null),v(e,a),v(e,i),O(c,i,null),v(i,u),~f&&y[f].m(i,null),d=!0,g||(D=Q(e,"keydown",s[11]),g=!0)},p(E,[L]){let U=t;t=k(E),t===U?b[t].p(h(E,t),L):(_e(),T(b[U],1,1,()=>{b[U]=null}),ge(),l=b[t],l?l.p(h(E,t),L):(l=b[t]=S[t](h(E,t)),l.c()),w(l,1),l.m(n,null));const Y={};L&1&&(Y.active=E[0]),L&2&&(Y.post=E[1]),c.$set(Y);let fe=f;f=M(E),f===fe?~f&&y[f].p(E,L):(p&&(_e(),T(y[fe],1,1,()=>{y[fe]=null}),ge()),~f?(p=y[f],p?p.p(E,L):(p=y[f]=j[f](E),p.c()),w(p,1),p.m(i,null)):p=null),(!d||L&2&&m!==(m=ut(E[1].id)))&&_(e,"id",m),(!d||L&1)&&ve(e,"openTab",E[0])},i(E){d||(w(l),w(r.$$.fragment,E),w(c.$$.fragment,E),w(p),d=!0)},o(E){T(l),T(r.$$.fragment,E),T(c.$$.fragment,E),T(p),d=!1},d(E){E&&$(e),b[t].d(),B(r),B(c),~f&&y[f].d(),g=!1,D()}}}function Kl(s,e,n){let t,l;ee(s,Tn,D=>n(12,t=D)),ee(s,Hn,D=>n(2,l=D));const o=Oe();let{post:r}=e,{openTab:a=void 0}=e;const i=D=>{n(0,a=a===D?void 0:D)},c=()=>{t&&i("tags")},u=[new URL(`https://kurosearch.com/post?id=${r.id}&src=${encodeURIComponent(r.file_url)}`),new URL(`https://rule34.xxx/index.php?page=post&s=view&id=${r.id}`),new URL(r.file_url),...r.source?r.source.split(" ").filter(D=>Jn(D)).map(D=>new URL(D)):[]],f=()=>o("fullscreen"),p=()=>i("tags"),m=()=>i("comments"),d=()=>i("links"),g=D=>{D.key==="f"&&o("fullscreen")};return s.$$set=D=>{"post"in D&&n(1,r=D.post),"openTab"in D&&n(0,a=D.openTab)},[a,r,l,o,i,c,u,f,p,m,d,g]}class Wl extends se{constructor(e){super(),le(this,e,Kl,Gl,ne,{post:1,openTab:0})}}function Vt(s,e,n){const t=s.slice();return t[7]=e[n],t[9]=n,t}function Ot(s,e,n){const t=s.slice();return t[7]=e[n],t[9]=n,t}function Yl(s){let e,n,t=ke(s[1].posts),l=[];for(let r=0;r<t.length;r+=1)l[r]=Bt(Vt(s,t,r));const o=r=>T(l[r],1,1,()=>{l[r]=null});return{c(){e=C("ol");for(let r=0;r<l.length;r+=1)l[r].c();this.h()},l(r){e=I(r,"OL",{class:!0,style:!0});var a=F(e);for(let i=0;i<l.length;i+=1)l[i].l(a);a.forEach($),this.h()},h(){_(e,"class","multi-column svelte-1nfzeed"),Re(e,"--nr-columns",s[2])},m(r,a){R(r,e,a);for(let i=0;i<l.length;i+=1)l[i]&&l[i].m(e,null);n=!0},p(r,a){if(a&3){t=ke(r[1].posts);let i;for(i=0;i<t.length;i+=1){const c=Vt(r,t,i);l[i]?(l[i].p(c,a),w(l[i],1)):(l[i]=Bt(c),l[i].c(),w(l[i],1),l[i].m(e,null))}for(_e(),i=t.length;i<l.length;i+=1)o(i);ge()}(!n||a&4)&&Re(e,"--nr-columns",r[2])},i(r){if(!n){for(let a=0;a<t.length;a+=1)w(l[a]);n=!0}},o(r){l=l.filter(Boolean);for(let a=0;a<l.length;a+=1)T(l[a]);n=!1},d(r){r&&$(e),Ze(l,r)}}}function Jl(s){let e,n,t=ke(s[1].posts),l=[];for(let r=0;r<t.length;r+=1)l[r]=Mt(Ot(s,t,r));const o=r=>T(l[r],1,1,()=>{l[r]=null});return{c(){e=C("ol");for(let r=0;r<l.length;r+=1)l[r].c();this.h()},l(r){e=I(r,"OL",{class:!0});var a=F(e);for(let i=0;i<l.length;i+=1)l[i].l(a);a.forEach($),this.h()},h(){_(e,"class","single-column svelte-1nfzeed")},m(r,a){R(r,e,a);for(let i=0;i<l.length;i+=1)l[i]&&l[i].m(e,null);n=!0},p(r,a){if(a&3){t=ke(r[1].posts);let i;for(i=0;i<t.length;i+=1){const c=Ot(r,t,i);l[i]?(l[i].p(c,a),w(l[i],1)):(l[i]=Mt(c),l[i].c(),w(l[i],1),l[i].m(e,null))}for(_e(),i=t.length;i<l.length;i+=1)o(i);ge()}},i(r){if(!n){for(let a=0;a<t.length;a+=1)w(l[a]);n=!0}},o(r){l=l.filter(Boolean);for(let a=0;a<l.length;a+=1)T(l[a]);n=!1},d(r){r&&$(e),Ze(l,r)}}}function Bt(s){let e,n;function t(){return s[5](s[9])}return e=new Tl({props:{post:s[7]}}),e.$on("click",t),{c(){A(e.$$.fragment)},l(l){V(e.$$.fragment,l)},m(l,o){O(e,l,o),n=!0},p(l,o){s=l;const r={};o&2&&(r.post=s[7]),e.$set(r)},i(l){n||(w(e.$$.fragment,l),n=!0)},o(l){T(e.$$.fragment,l),n=!1},d(l){B(e,l)}}}function Mt(s){let e,n;function t(){return s[4](s[9])}return e=new Wl({props:{post:s[7]}}),e.$on("fullscreen",t),{c(){A(e.$$.fragment)},l(l){V(e.$$.fragment,l)},m(l,o){O(e,l,o),n=!0},p(l,o){s=l;const r={};o&2&&(r.post=s[7]),e.$set(r)},i(l){n||(w(e.$$.fragment,l),n=!0)},o(l){T(e.$$.fragment,l),n=!1},d(l){B(e,l)}}}function zt(s){let e,n;return e=new Sl({props:{index:s[0]}}),e.$on("close",s[3]),e.$on("endreached",s[6]),{c(){A(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,l){O(e,t,l),n=!0},p(t,l){const o={};l&1&&(o.index=t[0]),e.$set(o)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){B(e,t)}}}function Zl(s){let e,n,t,l,o;const r=[Jl,Yl],a=[];function i(u,f){return u[2]==="1"?0:1}e=i(s),n=a[e]=r[e](s);let c=s[0]!==void 0&&zt(s);return{c(){n.c(),t=P(),c&&c.c(),l=Ae()},l(u){n.l(u),t=N(u),c&&c.l(u),l=Ae()},m(u,f){a[e].m(u,f),R(u,t,f),c&&c.m(u,f),R(u,l,f),o=!0},p(u,[f]){let p=e;e=i(u),e===p?a[e].p(u,f):(_e(),T(a[p],1,1,()=>{a[p]=null}),ge(),n=a[e],n?n.p(u,f):(n=a[e]=r[e](u),n.c()),w(n,1),n.m(t.parentNode,t)),u[0]!==void 0?c?(c.p(u,f),f&1&&w(c,1)):(c=zt(u),c.c(),w(c,1),c.m(l.parentNode,l)):c&&(_e(),T(c,1,1,()=>{c=null}),ge())},i(u){o||(w(n),w(c),o=!0)},o(u){T(n),T(c),o=!1},d(u){u&&($(t),$(l)),a[e].d(u),c&&c.d(u)}}}function Ql(s,e,n){let t,l;ee(s,Ye,u=>n(1,t=u)),ee(s,Qt,u=>n(2,l=u));let o;const r=u=>{var m;const f=t.posts[u.detail],p=ut(f.id);(m=document.getElementById(p))==null||m.scrollIntoView(),n(0,o=void 0)},a=u=>{n(0,o=u)},i=u=>{n(0,o=u)};function c(u){Fe.call(this,s,u)}return s.$$.update=()=>{var u;s.$$.dirty&1&&(o!==void 0?history.pushState({...history.state,fullscreen:!0},""):(u=history.state)!=null&&u.fullscreen&&history.back())},[o,t,l,r,a,i,c]}class Xl extends se{constructor(e){super(),le(this,e,Ql,Zl,ne,{})}}function qt(s,e,n){const t=s.slice();return t[8]=e[n],t}function xl(s){let e,n="We couldn't find any posts matching your tags. Sorry...";return{c(){e=C("p"),e.textContent=n},l(t){e=I(t,"P",{"data-svelte-h":!0}),ce(e)!=="svelte-1utxj3w"&&(e.textContent=n)},m(t,l){R(t,e,l)},p:K,d(t){t&&$(e)}}}function er(s){let e,n='<b class="svelte-zfjaug">⚠</b> <span>Conflicting tags detected</span> <b class="svelte-zfjaug">⚠</b>',t,l,o=ke(s[0]),r=[];for(let a=0;a<o.length;a+=1)r[a]=Ut(qt(s,o,a));return{c(){e=C("h6"),e.innerHTML=n,t=P(),l=C("ul");for(let a=0;a<r.length;a+=1)r[a].c();this.h()},l(a){e=I(a,"H6",{class:!0,"data-svelte-h":!0}),ce(e)!=="svelte-1e4zdfj"&&(e.innerHTML=n),t=N(a),l=I(a,"UL",{class:!0});var i=F(l);for(let c=0;c<r.length;c+=1)r[c].l(i);i.forEach($),this.h()},h(){_(e,"class","svelte-zfjaug"),_(l,"class","svelte-zfjaug")},m(a,i){R(a,e,i),R(a,t,i),R(a,l,i);for(let c=0;c<r.length;c+=1)r[c]&&r[c].m(l,null)},p(a,i){if(i&1){o=ke(a[0]);let c;for(c=0;c<o.length;c+=1){const u=qt(a,o,c);r[c]?r[c].p(u,i):(r[c]=Ut(u),r[c].c(),r[c].m(l,null))}for(;c<r.length;c+=1)r[c].d(1);r.length=o.length}},d(a){a&&($(e),$(t),$(l)),Ze(r,a)}}}function Ut(s){let e,n,t="⚠",l,o,r=s[8]+"",a,i;return{c(){e=C("li"),n=C("b"),n.textContent=t,l=P(),o=C("span"),a=X(r),i=P(),this.h()},l(c){e=I(c,"LI",{class:!0});var u=F(e);n=I(u,"B",{class:!0,"data-svelte-h":!0}),ce(n)!=="svelte-yluixs"&&(n.textContent=t),l=N(u),o=I(u,"SPAN",{});var f=F(o);a=x(f,r),f.forEach($),i=N(u),u.forEach($),this.h()},h(){_(n,"class","svelte-zfjaug"),_(e,"class","svelte-zfjaug")},m(c,u){R(c,e,u),v(e,n),v(e,l),v(e,o),v(o,a),v(e,i)},p(c,u){u&1&&r!==(r=c[8]+"")&&be(a,r)},d(c){c&&$(e)}}}function tr(s){let e;return{c(){e=X("Reset Filter")},l(n){e=x(n,"Reset Filter")},m(n,t){R(n,e,t)},d(n){n&&$(e)}}}function nr(s){let e;return{c(){e=X("Reset Tags")},l(n){e=x(n,"Reset Tags")},m(n,t){R(n,e,t)},d(n){n&&$(e)}}}function sr(s){let e,n,t,l,o,r,a,i,c,u;function f(d,g){return d[0].length?er:xl}let p=f(s),m=p(s);return a=new He({props:{type:"secondary",title:"In case your filter caused all posts to vanish. Reset it.",$$slots:{default:[tr]},$$scope:{ctx:s}}}),a.$on("click",s[5]),c=new He({props:{type:"secondary",title:"Tag combinations that are too specific will not yield results.",$$slots:{default:[nr]},$$scope:{ctx:s}}}),c.$on("click",s[6]),{c(){e=C("section"),n=C("img"),l=P(),m.c(),o=P(),r=C("div"),A(a.$$.fragment),i=P(),A(c.$$.fragment),this.h()},l(d){e=I(d,"SECTION",{class:!0});var g=F(e);n=I(g,"IMG",{src:!0,alt:!0,width:!0,height:!0,class:!0}),l=N(g),m.l(g),o=N(g),r=I(g,"DIV",{class:!0});var D=F(r);V(a.$$.fragment,D),i=N(D),V(c.$$.fragment,D),D.forEach($),g.forEach($),this.h()},h(){Ie(n.src,t=Wt+"/assets/lynxy-chibi-not-found.webp")||_(n,"src",t),_(n,"alt","Nothing here..."),_(n,"width","1231"),_(n,"height","864"),_(n,"class","svelte-zfjaug"),_(r,"class","svelte-zfjaug"),_(e,"class","svelte-zfjaug")},m(d,g){R(d,e,g),v(e,n),v(e,l),m.m(e,null),v(e,o),v(e,r),O(a,r,null),v(r,i),O(c,r,null),u=!0},p(d,[g]){p===(p=f(d))&&m?m.p(d,g):(m.d(1),m=p(d),m&&(m.c(),m.m(e,o)));const D={};g&2048&&(D.$$scope={dirty:g,ctx:d}),a.$set(D);const S={};g&2048&&(S.$$scope={dirty:g,ctx:d}),c.$set(S)},i(d){u||(w(a.$$.fragment,d),w(c.$$.fragment,d),u=!0)},o(d){T(a.$$.fragment,d),T(c.$$.fragment,d),u=!1},d(d){d&&$(e),m.d(),B(a),B(c)}}}function lr(s,e,n){let t,l,o,r;ee(s,et,f=>n(2,l=f)),ee(s,rn,f=>n(3,o=f)),ee(s,Je,f=>n(4,r=f));const a=Oe(),i=(f,p,m)=>{const d=m.flatMap(S=>S.tags.map(b=>({...b,supertag:S.name}))),g=Object.keys(p).filter(S=>p[S]).flatMap(S=>En[S].map(b=>({modifier:"-",name:b,group:S}))),D=[];for(const S of f){const b=g.find(h=>h.name===S.name);S.modifier!=="-"&&b&&D.push(`"${S.name}" is blocked by "${b.group}" in preferences.`);const k=d.find(h=>h.name===S.name);k&&(S.modifier==="-"&&k.modifier!=="-"&&D.push(`"${S.name}" is excluded but required by supertag "${k.supertag}".`),S.modifier!=="-"&&k.modifier==="-"&&D.push(`"${S.name}" is required but excluded by supertag "${k.supertag}".`))}for(const S of d){const b=g.find(h=>h.name===S.name);S.modifier!=="-"&&b&&D.push(`"${S.name}" (of supertag "${S.supertag}") is blocked by "${b.group}" in preferences.`);const k=d.find(h=>h.supertag!==S.supertag&&h.name===S.name);k&&(S.modifier==="-"&&k.modifier!=="-"&&D.push(`"${S.name}" is excluded by "${S.supertag}" but required by supertag "${k.supertag}".`),S.modifier!=="-"&&k.modifier==="-"&&D.push(`"${S.name}" is required by "${S.supertag}" but excluded by supertag "${k.supertag}".`))}return D},c=()=>{Xe.reset(),Ke.reset(),a("sortfilterupdate")},u=()=>{Je.reset(),et.reset()};return s.$$.update=()=>{s.$$.dirty&28&&n(0,t=i(r,o,l))},[t,a,l,o,r,c,u]}class rr extends se{constructor(e){super(),le(this,e,lr,sr,ne,{})}}function Ht(s,e,n){const t=s.slice();return t[11]=e[n],t}function Gt(s){let e,n;return e=new rs({props:{tag:s[11]}}),{c(){A(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,l){O(e,t,l),n=!0},p(t,l){const o={};l&8&&(o.tag=t[11]),e.$set(o)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){B(e,t)}}}function or(s){let e;return{c(){e=X("Create supertag")},l(n){e=x(n,"Create supertag")},m(n,t){R(n,e,t)},d(n){n&&$(e)}}}function ir(s){let e,n,t="Create Supertag",l,o,r,a,i,c="Name",u,f,p,m,d,g="Description",D,S,b,k,h,j="Tags",y,M,E,L,U,Y,fe,pe,ue=ke(s[3]),Z=[];for(let H=0;H<ue.length;H+=1)Z[H]=Gt(Ht(s,ue,H));const te=H=>T(Z[H],1,1,()=>{Z[H]=null});return U=new He({props:{title:s[4]?"Click to create supertag":"Enter a valid name to continue",disabled:!s[4],$$slots:{default:[or]},$$scope:{ctx:s}}}),U.$on("click",s[9]),{c(){e=C("section"),n=C("h3"),n.textContent=t,l=P(),o=C("button"),r=P(),a=C("div"),i=C("label"),i.textContent=c,u=P(),f=C("input"),p=P(),m=C("div"),d=C("label"),d.textContent=g,D=P(),S=C("input"),b=P(),k=C("div"),h=C("span"),h.textContent=j,y=P(),M=C("ol");for(let H=0;H<Z.length;H+=1)Z[H].c();E=P(),L=C("div"),A(U.$$.fragment),this.h()},l(H){e=I(H,"SECTION",{class:!0});var W=F(e);n=I(W,"H3",{"data-svelte-h":!0}),ce(n)!=="svelte-ho1cwx"&&(n.textContent=t),l=N(W),o=I(W,"BUTTON",{type:!0,class:!0}),F(o).forEach($),r=N(W),a=I(W,"DIV",{class:!0});var oe=F(a);i=I(oe,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),ce(i)!=="svelte-10k8a68"&&(i.textContent=c),u=N(oe),f=I(oe,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),oe.forEach($),p=N(W),m=I(W,"DIV",{class:!0});var J=F(m);d=I(J,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),ce(d)!=="svelte-14n9kp6"&&(d.textContent=g),D=N(J),S=I(J,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),J.forEach($),b=N(W),k=I(W,"DIV",{class:!0});var we=F(k);h=I(we,"SPAN",{class:!0,"data-svelte-h":!0}),ce(h)!=="svelte-7hjyox"&&(h.textContent=j),y=N(we),M=I(we,"OL",{class:!0});var ye=F(M);for(let Se=0;Se<Z.length;Se+=1)Z[Se].l(ye);ye.forEach($),we.forEach($),E=N(W),L=I(W,"DIV",{class:!0});var $e=F(L);V(U.$$.fragment,$e),$e.forEach($),W.forEach($),this.h()},h(){_(o,"type","button"),_(o,"class","codicon codicon-close svelte-1x6vc81"),_(i,"for","supertag-name"),_(i,"class","svelte-1x6vc81"),_(f,"type","text"),_(f,"placeholder","Descriptive name"),_(f,"id","supertag-name"),_(f,"class","svelte-1x6vc81"),_(a,"class","svelte-1x6vc81"),_(d,"for","supertag-description"),_(d,"class","svelte-1x6vc81"),_(S,"type","text"),_(S,"placeholder","Short description"),_(S,"id","supertag-description"),_(S,"class","svelte-1x6vc81"),_(m,"class","svelte-1x6vc81"),_(h,"class","svelte-1x6vc81"),_(M,"class","svelte-1x6vc81"),_(k,"class","svelte-1x6vc81"),_(L,"class","last svelte-1x6vc81"),_(e,"class","svelte-1x6vc81")},m(H,W){R(H,e,W),v(e,n),v(e,l),v(e,o),v(e,r),v(e,a),v(a,i),v(a,u),v(a,f),We(f,s[0]),v(e,p),v(e,m),v(m,d),v(m,D),v(m,S),We(S,s[2]),v(e,b),v(e,k),v(k,h),v(k,y),v(k,M);for(let oe=0;oe<Z.length;oe+=1)Z[oe]&&Z[oe].m(M,null);v(e,E),v(e,L),O(U,L,null),Y=!0,fe||(pe=[Q(o,"click",s[6]),Q(f,"input",s[7]),Q(S,"input",s[8])],fe=!0)},p(H,W){if(W&1&&f.value!==H[0]&&We(f,H[0]),W&4&&S.value!==H[2]&&We(S,H[2]),W&8){ue=ke(H[3]);let J;for(J=0;J<ue.length;J+=1){const we=Ht(H,ue,J);Z[J]?(Z[J].p(we,W),w(Z[J],1)):(Z[J]=Gt(we),Z[J].c(),w(Z[J],1),Z[J].m(M,null))}for(_e(),J=ue.length;J<Z.length;J+=1)te(J);ge()}const oe={};W&16&&(oe.title=H[4]?"Click to create supertag":"Enter a valid name to continue"),W&16&&(oe.disabled=!H[4]),W&16384&&(oe.$$scope={dirty:W,ctx:H}),U.$set(oe)},i(H){if(!Y){for(let W=0;W<ue.length;W+=1)w(Z[W]);w(U.$$.fragment,H),Y=!0}},o(H){Z=Z.filter(Boolean);for(let W=0;W<Z.length;W+=1)T(Z[W]);T(U.$$.fragment,H),Y=!1},d(H){H&&$(e),Ze(Z,H),B(U),fe=!1,Qe(pe)}}}function ar(s){let e,n,t;function l(r){s[10](r)}let o={$$slots:{default:[ir]},$$scope:{ctx:s}};return s[1]!==void 0&&(o.dialog=s[1]),e=new Jt({props:o}),he.push(()=>je(e,"dialog",l)),e.$on("close",s[6]),{c(){A(e.$$.fragment)},l(r){V(e.$$.fragment,r)},m(r,a){O(e,r,a),t=!0},p(r,[a]){const i={};a&16413&&(i.$$scope={dirty:a,ctx:r}),!n&&a&2&&(n=!0,i.dialog=r[1],Ne(()=>n=!1)),e.$set(i)},i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){T(e.$$.fragment,r),t=!1},d(r){B(e,r)}}}function cr(s,e,n){let t,{dialog:l}=e,{name:o=""}=e,{description:r=""}=e,{tags:a}=e;const i=Oe(),c=()=>l.close();function u(){o=this.value,n(0,o)}function f(){r=this.value,n(2,r)}const p=()=>{i("submit",{name:o,description:r,tags:a.map(({modifier:d,name:g})=>({modifier:d,name:g}))}),c()};function m(d){l=d,n(1,l)}return s.$$set=d=>{"dialog"in d&&n(1,l=d.dialog),"name"in d&&n(0,o=d.name),"description"in d&&n(2,r=d.description),"tags"in d&&n(3,a=d.tags)},s.$$.update=()=>{s.$$.dirty&9&&n(4,t=typeof o=="string"&&o!==""&&a.length>1)},[o,l,r,a,t,i,c,u,f,p,m]}class ur extends se{constructor(e){super(),le(this,e,cr,ar,ne,{dialog:1,name:0,description:2,tags:3})}}function fr(s){let e;return{c(){e=X("Search")},l(n){e=x(n,"Search")},m(n,t){R(n,e,t)},i:K,o:K,d(n){n&&$(e)}}}function pr(s){let e,n;return e=new _t({}),{c(){A(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,l){O(e,t,l),n=!0},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){B(e,t)}}}function dr(s){let e,n,t,l;const o=[pr,fr],r=[];function a(i,c){return i[0]?0:1}return e=a(s),n=r[e]=o[e](s),{c(){n.c(),t=Ae()},l(i){n.l(i),t=Ae()},m(i,c){r[e].m(i,c),R(i,t,c),l=!0},p(i,c){let u=e;e=a(i),e!==u&&(_e(),T(r[u],1,1,()=>{r[u]=null}),ge(),n=r[e],n||(n=r[e]=o[e](i),n.c()),w(n,1),n.m(t.parentNode,t))},i(i){l||(w(n),l=!0)},o(i){T(n),l=!1},d(i){i&&$(t),r[e].d(i)}}}function _r(s){let e,n,t,l,o,r,a,i,c,u;n=new ts({props:{placeholder:"Search for tags",fetchSuggestions:s[7]}}),n.$on("pick",s[8]),l=new He({props:{id:"btn-search",title:"Search with the tags above",$$slots:{default:[dr]},$$scope:{ctx:s}}}),l.$on("click",s[6]),r=new ns({props:{tags:[...s[4],...s[5]]}}),r.$on("contextmenu",s[9]),r.$on("click",s[10]),r.$on("createSupertag",s[11]);function f(m){s[12](m)}let p={tags:s[4]};return s[2]!==void 0&&(p.dialog=s[2]),i=new ur({props:p}),he.push(()=>je(i,"dialog",f)),i.$on("submit",s[13]),{c(){e=C("section"),A(n.$$.fragment),t=P(),A(l.$$.fragment),o=P(),A(r.$$.fragment),a=P(),A(i.$$.fragment),this.h()},l(m){e=I(m,"SECTION",{id:!0,class:!0});var d=F(e);V(n.$$.fragment,d),t=N(d),V(l.$$.fragment,d),o=N(d),V(r.$$.fragment,d),d.forEach($),a=N(m),V(i.$$.fragment,m),this.h()},h(){_(e,"id","search"),_(e,"class","svelte-i9balv"),ve(e,"hidden",!s[1])},m(m,d){R(m,e,d),O(n,e,null),v(e,t),O(l,e,null),v(e,o),O(r,e,null),R(m,a,d),O(i,m,d),u=!0},p(m,[d]){const g={};d&524289&&(g.$$scope={dirty:d,ctx:m}),l.$set(g);const D={};d&48&&(D.tags=[...m[4],...m[5]]),r.$set(D),(!u||d&2)&&ve(e,"hidden",!m[1]);const S={};d&16&&(S.tags=m[4]),!c&&d&4&&(c=!0,S.dialog=m[2],Ne(()=>c=!1)),i.$set(S)},i(m){u||(w(n.$$.fragment,m),w(l.$$.fragment,m),w(r.$$.fragment,m),w(i.$$.fragment,m),u=!0)},o(m){T(n.$$.fragment,m),T(l.$$.fragment,m),T(r.$$.fragment,m),T(i.$$.fragment,m),u=!1},d(m){m&&($(e),$(a)),B(n),B(l),B(r),B(i,m)}}}const gr=20,mr=100;function hr(s,e,n){let t,l,o,r;ee(s,Ye,y=>n(15,t=y)),ee(s,$t,y=>n(3,l=y)),ee(s,Je,y=>n(4,o=y)),ee(s,et,y=>n(5,r=y));let a=0,i=!0;const c=Oe(),u=()=>c("submit");let{loading:f}=e,p;const m=async y=>{const M=await Zn(y);return[...l.items.filter(({name:L})=>L.toLowerCase().includes(y.toLowerCase())).map(L=>({label:L.name,count:L.tags.length,type:"supertag"})),...M]},d=y=>{var M,E;(y.key==="/"||y.key==="s")&&(!document.activeElement||document.activeElement===document.body)&&(y.preventDefault(),y.stopPropagation(),(M=document.getElementById("searchbar"))==null||M.focus()),y.ctrlKey&&y.key==="Enter"&&(y.preventDefault(),y.stopPropagation(),u()),y.ctrlKey&&y.key==="m"&&(y.preventDefault(),y.stopPropagation(),(E=document.getElementById("select-modifier"))==null||E.click())};tt(async()=>{document.addEventListener("keydown",d),document.addEventListener("scroll",g,{passive:!0}),t.postCount===0&&u()});const g=()=>{const y=window.scrollY,M=y-a;y<500?n(1,i=!0):M>0?n(1,i=i&&M<gr):n(1,i=i||M<-mr),a=y};nt(()=>{document.removeEventListener("keydown",d),document.removeEventListener("scroll",g)});const D=async y=>{const M=y.detail;if(M.type==="supertag"){const E=l.items.find(L=>L.name===M.label);if(!E){console.warn("Supertag not present.");return}et.addOrReplace(E)}else{const E=await Qn(y.detail.label);Je.addOrReplace({name:y.detail.label,modifier:y.detail.modifier,count:y.detail.count,type:(E==null?void 0:E.type)??"tag"})}},S=y=>"description"in y.detail?et.removeByName(y.detail.name):Je.removeByName(y.detail.name),b=y=>{"description"in y.detail||(y.detail.modifier=ls(y.detail.modifier),Je.addOrReplace(y.detail))},k=()=>{p.showModal(),Zt("dialog")};function h(y){p=y,n(2,p)}const j=y=>$t.add(y.detail);return s.$$set=y=>{"loading"in y&&n(0,f=y.loading)},[f,i,p,l,o,r,u,m,D,S,b,k,h,j]}class $r extends se{constructor(e){super(),le(this,e,hr,_r,ne,{loading:0})}}const{document:dt}=yn;function vr(s){let e,n,t,l,o,r;const a=[wr,kr],i=[];function c(u,f){return u[2].postCount===0?0:1}return n=c(s),t=i[n]=a[n](s),o=new Xn({}),{c(){e=C("section"),t.c(),l=P(),A(o.$$.fragment),this.h()},l(u){e=I(u,"SECTION",{class:!0});var f=F(e);t.l(f),f.forEach($),l=N(u),V(o.$$.fragment,u),this.h()},h(){_(e,"class","svelte-1ezwrd1")},m(u,f){R(u,e,f),i[n].m(e,null),R(u,l,f),O(o,u,f),r=!0},p(u,f){let p=n;n=c(u),n===p?i[n].p(u,f):(_e(),T(i[p],1,1,()=>{i[p]=null}),ge(),t=i[n],t?t.p(u,f):(t=i[n]=a[n](u),t.c()),w(t,1),t.m(e,null))},i(u){r||(w(t),w(o.$$.fragment,u),r=!0)},o(u){T(t),T(o.$$.fragment,u),r=!1},d(u){u&&($(e),$(l)),i[n].d(),B(o,u)}}}function br(s){let e,n;return e=new as({props:{error:s[1]}}),{c(){A(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,l){O(e,t,l),n=!0},p(t,l){const o={};l&2&&(o.error=t[1]),e.$set(o)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){B(e,t)}}}function kr(s){let e,n,t,l,o,r;e=new Xl({}),e.$on("sortfilterupdate",s[4]),e.$on("endreached",s[5]);const a=[Er,yr],i=[];function c(u,f){return u[2].posts.length===u[2].postCount?0:1}return t=c(s),l=i[t]=a[t](s),{c(){A(e.$$.fragment),n=P(),l.c(),o=Ae()},l(u){V(e.$$.fragment,u),n=N(u),l.l(u),o=Ae()},m(u,f){O(e,u,f),R(u,n,f),i[t].m(u,f),R(u,o,f),r=!0},p(u,f){let p=t;t=c(u),t===p?i[t].p(u,f):(_e(),T(i[p],1,1,()=>{i[p]=null}),ge(),l=i[t],l?l.p(u,f):(l=i[t]=a[t](u),l.c()),w(l,1),l.m(o.parentNode,o))},i(u){r||(w(e.$$.fragment,u),w(l),r=!0)},o(u){T(e.$$.fragment,u),T(l),r=!1},d(u){u&&($(n),$(o)),B(e,u),i[t].d(u)}}}function wr(s){let e,n;return e=new rr({}),e.$on("sortfilterupdate",s[4]),{c(){A(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,l){O(e,t,l),n=!0},p:K,i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){B(e,t)}}}function yr(s){let e,n,t,l;return e=new cn({props:{absoluteTop:void 0,rootMargin:1e3/Number(s[3])+"px"}}),e.$on("intersection",s[5]),t=new He({props:{title:"Load more posts",$$slots:{default:[Ir]},$$scope:{ctx:s}}}),t.$on("click",s[5]),{c(){A(e.$$.fragment),n=P(),A(t.$$.fragment)},l(o){V(e.$$.fragment,o),n=N(o),V(t.$$.fragment,o)},m(o,r){O(e,o,r),R(o,n,r),O(t,o,r),l=!0},p(o,r){const a={};r&8&&(a.rootMargin=1e3/Number(o[3])+"px"),e.$set(a);const i={};r&32769&&(i.$$scope={dirty:r,ctx:o}),t.$set(i)},i(o){l||(w(e.$$.fragment,o),w(t.$$.fragment,o),l=!0)},o(o){T(e.$$.fragment,o),T(t.$$.fragment,o),l=!1},d(o){o&&$(n),B(e,o),B(t,o)}}}function Er(s){let e,n;return e=new ds({}),{c(){A(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,l){O(e,t,l),n=!0},p:K,i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){B(e,t)}}}function Sr(s){let e;return{c(){e=X("Load more")},l(n){e=x(n,"Load more")},m(n,t){R(n,e,t)},i:K,o:K,d(n){n&&$(e)}}}function Cr(s){let e,n;return e=new _t({}),{c(){A(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,l){O(e,t,l),n=!0},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){T(e.$$.fragment,t),n=!1},d(t){B(e,t)}}}function Ir(s){let e,n,t,l;const o=[Cr,Sr],r=[];function a(i,c){return i[0]?0:1}return e=a(s),n=r[e]=o[e](s),{c(){n.c(),t=Ae()},l(i){n.l(i),t=Ae()},m(i,c){r[e].m(i,c),R(i,t,c),l=!0},p(i,c){let u=e;e=a(i),e!==u&&(_e(),T(r[u],1,1,()=>{r[u]=null}),ge(),n=r[e],n||(n=r[e]=o[e](i),n.c()),w(n,1),n.m(t.parentNode,t))},i(i){l||(w(n),l=!0)},o(i){T(n),l=!1},d(i){i&&$(t),r[e].d(i)}}}function Kt(s){let e;return{c(){e=C("div"),this.h()},l(n){e=I(n,"DIV",{class:!0}),F(e).forEach($),this.h()},h(){_(e,"class","svelte-1ezwrd1")},m(n,t){R(n,e,t)},d(n){n&&$(e)}}}function Tr(s){let e,n,t,l,o,r,a,i,c,u,f,p,m,d,g;t=new es({}),o=new ss({}),a=new $r({props:{loading:s[0]}}),a.$on("submit",s[4]),c=new Fs({props:{loading:s[0]}}),c.$on("sortfilterupdate",s[4]);const D=[br,vr],S=[];function b(h,j){return h[1]?0:h[2].requested?1:-1}~(f=b(s))&&(p=S[f]=D[f](s));let k=s[0]&&Kt();return{c(){e=C("meta"),n=P(),A(t.$$.fragment),l=P(),A(o.$$.fragment),r=P(),A(a.$$.fragment),i=P(),A(c.$$.fragment),u=P(),p&&p.c(),m=P(),k&&k.c(),d=Ae(),this.h()},l(h){const j=wn("svelte-7jdp3v",dt.head);e=I(j,"META",{name:!0,content:!0}),j.forEach($),n=N(h),V(t.$$.fragment,h),l=N(h),V(o.$$.fragment,h),r=N(h),V(a.$$.fragment,h),i=N(h),V(c.$$.fragment,h),u=N(h),p&&p.l(h),m=N(h),k&&k.l(h),d=Ae(),this.h()},h(){dt.title="kurosearch - Rule34 Hentai",_(e,"name","description"),_(e,"content","Simple and powerful Rule34 browsing site with a focus on simplicity and user experience.")},m(h,j){v(dt.head,e),R(h,n,j),O(t,h,j),R(h,l,j),O(o,h,j),R(h,r,j),O(a,h,j),R(h,i,j),O(c,h,j),R(h,u,j),~f&&S[f].m(h,j),R(h,m,j),k&&k.m(h,j),R(h,d,j),g=!0},p(h,[j]){const y={};j&1&&(y.loading=h[0]),a.$set(y);const M={};j&1&&(M.loading=h[0]),c.$set(M);let E=f;f=b(h),f===E?~f&&S[f].p(h,j):(p&&(_e(),T(S[E],1,1,()=>{S[E]=null}),ge()),~f?(p=S[f],p?p.p(h,j):(p=S[f]=D[f](h),p.c()),w(p,1),p.m(m.parentNode,m)):p=null),h[0]?k||(k=Kt(),k.c(),k.m(d.parentNode,d)):k&&(k.d(1),k=null)},i(h){g||(w(t.$$.fragment,h),w(o.$$.fragment,h),w(a.$$.fragment,h),w(c.$$.fragment,h),w(p),g=!0)},o(h){T(t.$$.fragment,h),T(o.$$.fragment,h),T(a.$$.fragment,h),T(c.$$.fragment,h),T(p),g=!1},d(h){h&&($(n),$(l),$(r),$(i),$(u),$(m),$(d)),$(e),B(t,h),B(o,h),B(a,h),B(c,h),~f&&S[f].d(h),k&&k.d(h)}}}function Dr(s,e,n){let t,l,o,r,a,i,c;ee(s,Ye,b=>n(2,t=b)),ee(s,et,b=>n(7,l=b)),ee(s,Ke,b=>n(8,o=b)),ee(s,Xe,b=>n(9,r=b)),ee(s,rn,b=>n(10,a=b)),ee(s,Je,b=>n(11,i=b)),ee(s,Qt,b=>n(3,c=b)),console.log(`%ckurosearch
%cHi, if you are reading this because you are debugging or reverse-engineering, feel free to send me a DM on Discord :)`,"color:crimson;font-size:32px;","color:unset;font-size:auto;");let u=!1,f,p=0;const m=()=>new Sn().withPid(t.pageCount).withTags(i).withBlockedContent(a).withSortProperty(r.property).withSortDirection(r.direction).withScoreValue(o.scoreValue).withScoreComparator(o.scoreComparator).withRating(o.rating).withSupertags(l),d=async b=>{if(!u){n(1,f=void 0),n(0,u=!0);try{const k=t.pageCount;await b(),xn(k).catch(()=>{})}catch(k){n(1,f=k),console.warn(k)}finally{n(0,u=!1)}}},g=async()=>{Ye.reset(),p=0,d(async()=>{const[b,k]=await m().getPageAndCount();Ye.addPage(b,k)})},D=async()=>{d(async()=>{const b=await m().getPage();Ye.addPage(b)})},S=b=>{if(b.ctrlKey&&b.key==="ArrowDown"){const k=document.getElementsByClassName("post-media");k[p].focus(),p=Math.min(p+1,Math.max(0,k.length-1))}b.ctrlKey&&b.key==="ArrowUp"&&(document.getElementsByClassName("post-media")[p].focus(),p=Math.max(p-1,0))};return tt(async()=>{document.addEventListener("keydown",S)}),nt(()=>{document.removeEventListener("keydown",S)}),[u,f,t,c,g,D]}class ro extends se{constructor(e){super(),le(this,e,Dr,Tr,ne,{})}}export{ro as component};
