import{s as ne,f as E,a as P,g as C,c as N,y as ie,D as _e,j as d,i as O,d as _,E as we,l as X,m as x,e as ue,h as R,u as v,F as ce,n as Ne,C as pe,G as $t,p as be,H as ke,I as Re,J as ot,K as je,L as Ae,k as Ve,v as U,M as Fe,w as vt,N as bt,z as kt,A as yt,B as wt,o as Me,O as at,P as qe,r as it}from"../chunks/scheduler.88299003.js";import{S as le,i as re,b as L,d as V,m as F,a as b,t as w,e as M,g as ee,c as te,f as Be}from"../chunks/index.15b414ac.js";import{s as fe,r as Pe,K as St,A as Et,a as Le,S as Ct}from"../chunks/search-builder.1bb73e3b.js";import{S as It,n as Dt,s as He}from"../chunks/supertags-store.42022f66.js";import{T as Oe}from"../chunks/TextButton.2f318c50.js";import{g as Pt,a as Nt}from"../chunks/tags.58927cde.js";import{a as De}from"../chunks/active-tags-store.ee1f6602.js";import{b as ct}from"../chunks/paths.314d3125.js";import{e as ye}from"../chunks/each.e59479a4.js";import{D as ut,r as Ot}from"../chunks/Dialog.f8853b6f.js";import{i as ft,D as pt,G as _t,V as Tt,I as Rt}from"../chunks/Details.0569e5bd.js";import{f as Te}from"../chunks/format-tag.d6c065e3.js";import{R as Bt,I as At}from"../chunks/ModifierSelect.623aacd6.js";import{S as We}from"../chunks/Select.22805bc7.js";import{R as jt}from"../chunks/RotatingTextSelect.7e32facf.js";import{b as Lt}from"../chunks/blocked-content-store.805c4a3d.js";import{D as Vt}from"../chunks/DetailedTag.28ff9b0d.js";import{S as Ft}from"../chunks/ScrollUpButton.cfa21b3f.js";import{l as Mt}from"../chunks/analytics.12ea4383.js";function qt(l){let e;return{c(){e=X("Reset Filter")},l(s){e=x(s,"Reset Filter")},m(s,t){O(s,e,t)},d(s){s&&_(e)}}}function zt(l){let e,s,t,n,r="We couldn't find any posts matching your tags. Sorry...",a,f,i;return f=new Oe({props:{title:"In case your filter caused all posts to vanish. Reset it.",$$slots:{default:[qt]},$$scope:{ctx:l}}}),f.$on("click",l[1]),{c(){e=E("img"),t=P(),n=E("p"),n.textContent=r,a=P(),L(f.$$.fragment),this.h()},l(u){e=C(u,"IMG",{src:!0,alt:!0,class:!0}),t=N(u),n=C(u,"P",{"data-svelte-h":!0}),ie(n)!=="svelte-1utxj3w"&&(n.textContent=r),a=N(u),V(f.$$.fragment,u),this.h()},h(){_e(e.src,s=ct+"/assets/shironeko-confused.png")||d(e,"src",s),d(e,"alt","Nothing here..."),d(e,"class","svelte-1bb5e7g")},m(u,o){O(u,e,o),O(u,t,o),O(u,n,o),O(u,a,o),F(f,u,o),i=!0},p(u,[o]){const c={};o&4&&(c.$$scope={dirty:o,ctx:u}),f.$set(c)},i(u){i||(b(f.$$.fragment,u),i=!0)},o(u){w(f.$$.fragment,u),i=!1},d(u){u&&(_(e),_(t),_(n),_(a)),M(f,u)}}}function Gt(l){const e=we();return[e,()=>{fe.reset(),e("sortfilterupdate")}]}class Ut extends le{constructor(e){super(),re(this,e,Gt,zt,ne,{})}}function Ye(l){let e,s;return e=new ut({props:{$$slots:{default:[Wt]},$$scope:{ctx:l}}}),e.$on("close",l[6]),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,n){F(e,t,n),s=!0},p(t,n){const r={};n&32771&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){s||(b(e.$$.fragment,t),s=!0)},o(t){w(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function Kt(l){let e;return{c(){e=X("Done")},l(s){e=x(s,"Done")},m(s,t){O(s,e,t)},d(s){s&&_(e)}}}function Ht(l){let e;return{c(){e=X("Reset")},l(s){e=x(s,"Reset")},m(s,t){O(s,e,t)},d(s){s&&_(e)}}}function Wt(l){let e,s,t="Sorting and Filtering",n,r,a,f="Sorting",i,u,o,c,p,k,m,D,h,y,g="Filtering by Score",S,I,Y,oe,Z,K,ae,$,z,J="Filtering by Rating",W,Q,j,Se,B,T,H,q,se,ve,Ee;function Ce(A){l[8](A)}let ze={options:Jt};l[1].sortDirection!==void 0&&(ze.value=l[1].sortDirection),o=new Bt({props:ze}),be.push(()=>Be(o,"value",Ce));function gt(A){l[9](A)}let Ge={options:Zt};l[1].sortProperty!==void 0&&(Ge.value=l[1].sortProperty),k=new We({props:Ge}),be.push(()=>Be(k,"value",gt));function dt(A){l[10](A)}let Ue={options:Qt};l[1].scoreComparator!==void 0&&(Ue.value=l[1].scoreComparator),Y=new jt({props:Ue}),be.push(()=>Be(Y,"value",dt));function ht(A){l[13](A)}let Ke={options:mt};return l[1].rating!==void 0&&(Ke.value=l[1].rating),j=new We({props:Ke}),be.push(()=>Be(j,"value",ht)),T=new Oe({props:{title:"Return to searching.",$$slots:{default:[Kt]},$$scope:{ctx:l}}}),T.$on("click",l[6]),q=new Oe({props:{title:"Reset sort and filter.",type:"secondary",$$slots:{default:[Ht]},$$scope:{ctx:l}}}),q.$on("click",l[7]),{c(){e=E("div"),s=E("h3"),s.textContent=t,n=P(),r=E("label"),a=E("b"),a.textContent=f,i=P(),u=E("div"),L(o.$$.fragment),p=P(),L(k.$$.fragment),D=P(),h=E("label"),y=E("b"),y.textContent=g,S=P(),I=E("div"),L(Y.$$.fragment),Z=P(),K=E("input"),ae=P(),$=E("label"),z=E("b"),z.textContent=J,W=P(),Q=E("div"),L(j.$$.fragment),B=P(),L(T.$$.fragment),H=P(),L(q.$$.fragment),this.h()},l(A){e=C(A,"DIV",{class:!0});var G=R(e);s=C(G,"H3",{"data-svelte-h":!0}),ie(s)!=="svelte-15zouq3"&&(s.textContent=t),n=N(G),r=C(G,"LABEL",{class:!0});var me=R(r);a=C(me,"B",{"data-svelte-h":!0}),ie(a)!=="svelte-ekzpgg"&&(a.textContent=f),i=N(me),u=C(me,"DIV",{class:!0});var ge=R(u);V(o.$$.fragment,ge),p=N(ge),V(k.$$.fragment,ge),ge.forEach(_),me.forEach(_),D=N(G),h=C(G,"LABEL",{class:!0});var de=R(h);y=C(de,"B",{"data-svelte-h":!0}),ie(y)!=="svelte-1flca3"&&(y.textContent=g),S=N(de),I=C(de,"DIV",{class:!0});var he=R(I);V(Y.$$.fragment,he),Z=N(he),K=C(he,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),he.forEach(_),de.forEach(_),ae=N(G),$=C(G,"LABEL",{class:!0});var $e=R($);z=C($e,"B",{"data-svelte-h":!0}),ie(z)!=="svelte-1evbw58"&&(z.textContent=J),W=N($e),Q=C($e,"DIV",{class:!0});var Ie=R(Q);V(j.$$.fragment,Ie),Ie.forEach(_),$e.forEach(_),B=N(G),V(T.$$.fragment,G),H=N(G),V(q.$$.fragment,G),G.forEach(_),this.h()},h(){d(u,"class","row svelte-1omoy36"),d(r,"class","svelte-1omoy36"),d(K,"type","number"),d(K,"min",0),d(K,"max",1e5),d(K,"step",1),d(K,"class","svelte-1omoy36"),d(I,"class","row svelte-1omoy36"),d(h,"class","svelte-1omoy36"),d(Q,"class","row svelte-1omoy36"),d($,"class","svelte-1omoy36"),d(e,"class","container svelte-1omoy36")},m(A,G){O(A,e,G),v(e,s),v(e,n),v(e,r),v(r,a),v(r,i),v(r,u),F(o,u,null),v(u,p),F(k,u,null),v(e,D),v(e,h),v(h,y),v(h,S),v(h,I),F(Y,I,null),v(I,Z),v(I,K),ke(K,l[0]),v(e,ae),v(e,$),v($,z),v($,W),v($,Q),F(j,Q,null),v(e,B),F(T,e,null),v(e,H),F(q,e,null),se=!0,ve||(Ee=[ce(K,"input",l[11]),ce(K,"keyup",l[12])],ve=!0)},p(A,G){const me={};!c&&G&2&&(c=!0,me.value=A[1].sortDirection,Re(()=>c=!1)),o.$set(me);const ge={};!m&&G&2&&(m=!0,ge.value=A[1].sortProperty,Re(()=>m=!1)),k.$set(ge);const de={};!oe&&G&2&&(oe=!0,de.value=A[1].scoreComparator,Re(()=>oe=!1)),Y.$set(de),G&1&&ot(K.value)!==A[0]&&ke(K,A[0]);const he={};!Se&&G&2&&(Se=!0,he.value=A[1].rating,Re(()=>Se=!1)),j.$set(he);const $e={};G&32768&&($e.$$scope={dirty:G,ctx:A}),T.$set($e);const Ie={};G&32768&&(Ie.$$scope={dirty:G,ctx:A}),q.$set(Ie)},i(A){se||(b(o.$$.fragment,A),b(k.$$.fragment,A),b(Y.$$.fragment,A),b(j.$$.fragment,A),b(T.$$.fragment,A),b(q.$$.fragment,A),se=!0)},o(A){w(o.$$.fragment,A),w(k.$$.fragment,A),w(Y.$$.fragment,A),w(j.$$.fragment,A),w(T.$$.fragment,A),w(q.$$.fragment,A),se=!1},d(A){A&&_(e),M(o),M(k),M(Y),M(j),M(T),M(q),ve=!1,je(Ee)}}}function Yt(l){let e,s,t,n,r,a,f,i,u,o,c,p,k,m,D,h=l[2]&&Ye(l);return{c(){e=E("button"),s=E("i"),t=P(),n=E("span"),r=X(l[4]),a=P(),f=E("i"),i=P(),u=E("span"),o=X(l[3]),c=P(),h&&h.c(),p=ue(),this.h()},l(y){e=C(y,"BUTTON",{class:!0});var g=R(e);s=C(g,"I",{class:!0}),R(s).forEach(_),t=N(g),n=C(g,"SPAN",{});var S=R(n);r=x(S,l[4]),S.forEach(_),a=N(g),f=C(g,"I",{class:!0}),R(f).forEach(_),i=N(g),u=C(g,"SPAN",{});var I=R(u);o=x(I,l[3]),I.forEach(_),g.forEach(_),c=N(y),h&&h.l(y),p=ue(),this.h()},h(){d(s,"class","codicon codicon-filter svelte-1omoy36"),d(f,"class","codicon codicon-arrow-swap svelte-1omoy36"),d(e,"class","svelte-1omoy36")},m(y,g){O(y,e,g),v(e,s),v(e,t),v(e,n),v(n,r),v(e,a),v(e,f),v(e,i),v(e,u),v(u,o),O(y,c,g),h&&h.m(y,g),O(y,p,g),k=!0,m||(D=ce(e,"click",l[5]),m=!0)},p(y,[g]){(!k||g&16)&&Ne(r,y[4]),(!k||g&8)&&Ne(o,y[3]),y[2]?h?(h.p(y,g),g&4&&b(h,1)):(h=Ye(y),h.c(),b(h,1),h.m(p.parentNode,p)):h&&(ee(),w(h,1,1,()=>{h=null}),te())},i(y){k||(b(h),k=!0)},o(y){w(h),k=!1},d(y){y&&(_(e),_(c),_(p)),h&&h.d(y),m=!1,D()}}}const Zt=Object.freeze({id:"Uploaded",score:"Score",updated:"Updated"}),Jt=Object.freeze({desc:"codicon codicon-arrow-down",asc:"codicon codicon-arrow-up"}),Qt=Object.freeze({">=":"≥","<=":"≤"}),mt=Object.freeze({all:"All",safe:"Safe",questionable:"Questionable",explicit:"Explicit"}),Xt=Object.freeze({id:{asc:"Oldest",desc:"Newest"},score:{asc:"Worst",desc:"Best"},updated:{asc:"Inactive",desc:"Active"}}),xt=(l,e,s)=>{let t=l==="all"?void 0:mt[l],n=e===0&&s===">="?void 0:`Score${s}${Te(e)}`;return[t,n].filter(r=>r!==void 0).join(",")||"All"};function es(l,e,s){let t,n,r;pe(l,fe,g=>s(1,r=g));const a=we();let f=!1;const i=()=>s(2,f=!0),u=()=>{s(2,f=!1),a("sortfilterupdate")},o=()=>{fe.reset(),s(0,c=r.scoreValue)};let c;function p(g){l.$$.not_equal(r.sortDirection,g)&&(r.sortDirection=g,fe.set(r))}function k(g){l.$$.not_equal(r.sortProperty,g)&&(r.sortProperty=g,fe.set(r))}function m(g){l.$$.not_equal(r.scoreComparator,g)&&(r.scoreComparator=g,fe.set(r))}function D(){c=ot(this.value),s(0,c),s(1,r)}const h=g=>ft(g)&&g.target.blur();function y(g){l.$$.not_equal(r.rating,g)&&(r.rating=g,fe.set(r))}return l.$$.update=()=>{if(l.$$.dirty&3){c===void 0&&s(0,c=r.scoreValue);let g=Number(c);isNaN(g)||$t(fe,r.scoreValue=g,r)}l.$$.dirty&2&&s(4,t=xt(r.rating,r.scoreValue,r.scoreComparator)),l.$$.dirty&2&&s(3,n=Xt[r.sortProperty][r.sortDirection])},[c,r,f,n,t,i,u,o,p,k,m,D,h,y]}class ts extends le{constructor(e){super(),re(this,e,es,Yt,ne,{})}}function ss(l){let e,s;return e=new _t({props:{post:l[1]}}),e.$on("click",l[2]),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,n){F(e,t,n),s=!0},p(t,n){const r={};n&2&&(r.post=t[1]),e.$set(r)},i(t){s||(b(e.$$.fragment,t),s=!0)},o(t){w(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function ns(l){let e,s;return e=new Tt({props:{src:l[1].file_url,poster:l[1].sample_url,width:l[1].width,height:l[1].height,loop:l[1].tags.some(Je)}}),e.$on("click",l[2]),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,n){F(e,t,n),s=!0},p(t,n){const r={};n&2&&(r.src=t[1].file_url),n&2&&(r.poster=t[1].sample_url),n&2&&(r.width=t[1].width),n&2&&(r.height=t[1].height),n&2&&(r.loop=t[1].tags.some(Je)),e.$set(r)},i(t){s||(b(e.$$.fragment,t),s=!0)},o(t){w(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function ls(l){let e,s;return e=new Rt({props:{post:l[1],open:l[0]}}),e.$on("click",l[2]),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,n){F(e,t,n),s=!0},p(t,n){const r={};n&2&&(r.post=t[1]),n&1&&(r.open=t[0]),e.$set(r)},i(t){s||(b(e.$$.fragment,t),s=!0)},o(t){w(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function Ze(l){let e,s;return e=new pt({props:{post:l[1]}}),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,n){F(e,t,n),s=!0},p(t,n){const r={};n&2&&(r.post=t[1]),e.$set(r)},i(t){s||(b(e.$$.fragment,t),s=!0)},o(t){w(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function rs(l){let e,s,t,n,r,a;const f=[ls,ns,ss],i=[];function u(c,p){return c[1].type==="image"?0:c[1].type==="video"?1:2}s=u(l),t=i[s]=f[s](l);let o=l[0]&&Ze(l);return{c(){e=E("div"),t.c(),n=P(),o&&o.c(),this.h()},l(c){e=C(c,"DIV",{id:!0,class:!0});var p=R(e);t.l(p),n=N(p),o&&o.l(p),p.forEach(_),this.h()},h(){d(e,"id",r="post_"+l[1].id),d(e,"class","post svelte-uali72"),Ae(e,"open",l[0])},m(c,p){O(c,e,p),i[s].m(e,null),v(e,n),o&&o.m(e,null),a=!0},p(c,[p]){let k=s;s=u(c),s===k?i[s].p(c,p):(ee(),w(i[k],1,1,()=>{i[k]=null}),te(),t=i[s],t?t.p(c,p):(t=i[s]=f[s](c),t.c()),b(t,1),t.m(e,n)),c[0]?o?(o.p(c,p),p&1&&b(o,1)):(o=Ze(c),o.c(),b(o,1),o.m(e,null)):o&&(ee(),w(o,1,1,()=>{o=null}),te()),(!a||p&2&&r!==(r="post_"+c[1].id))&&d(e,"id",r),(!a||p&1)&&Ae(e,"open",c[0])},i(c){a||(b(t),b(o),a=!0)},o(c){w(t),w(o),a=!1},d(c){c&&_(e),i[s].d(),o&&o.d()}}}const Je=l=>l.name=="loop";function os(l,e,s){let{post:t}=e,{open:n=!1}=e;const r=()=>{s(0,n=!n)};return l.$$set=a=>{"post"in a&&s(1,t=a.post),"open"in a&&s(0,n=a.open)},[n,t,r]}class as extends le{constructor(e){super(),re(this,e,os,rs,ne,{post:1,open:0})}}function Qe(l){let e,s=l[0].type==="video"?"▶":"GIF",t;return{c(){e=E("span"),t=X(s),this.h()},l(n){e=C(n,"SPAN",{class:!0});var r=R(e);t=x(r,s),r.forEach(_),this.h()},h(){d(e,"class","type svelte-14imjnt")},m(n,r){O(n,e,r),v(e,t)},p(n,r){r&1&&s!==(s=n[0].type==="video"?"▶":"GIF")&&Ne(t,s)},d(n){n&&_(e)}}}function is(l){let e,s,t,n,r,a=Te(l[0].score)+"",f,i,u,o,c,p=l[0].type!=="image"&&Qe(l);return{c(){e=E("div"),s=E("img"),n=P(),r=E("span"),f=X(a),i=P(),p&&p.c(),this.h()},l(k){e=C(k,"DIV",{id:!0,class:!0,style:!0});var m=R(e);s=C(m,"IMG",{src:!0,alt:!0,class:!0,tabindex:!0,loading:!0}),n=N(m),r=C(m,"SPAN",{class:!0});var D=R(r);f=x(D,a),D.forEach(_),i=N(m),p&&p.l(m),m.forEach(_),this.h()},h(){_e(s.src,t=l[1])||d(s,"src",t),d(s,"alt","post"),d(s,"class","post-media svelte-14imjnt"),d(s,"tabindex","-1"),d(s,"loading","lazy"),d(r,"class","score svelte-14imjnt"),d(e,"id",u="post_"+l[0].id),d(e,"class","post svelte-14imjnt"),Ve(e,"grid-row","span "+l[2]),Ae(e,"open",open)},m(k,m){O(k,e,m),v(e,s),v(e,n),v(e,r),v(r,f),v(e,i),p&&p.m(e,null),o||(c=[ce(e,"click",l[3]),ce(e,"keydown",l[4])],o=!0)},p(k,[m]){m&2&&!_e(s.src,t=k[1])&&d(s,"src",t),m&1&&a!==(a=Te(k[0].score)+"")&&Ne(f,a),k[0].type!=="image"?p?p.p(k,m):(p=Qe(k),p.c(),p.m(e,null)):p&&(p.d(1),p=null),m&1&&u!==(u="post_"+k[0].id)&&d(e,"id",u),m&0&&Ae(e,"open",open)},i:U,o:U,d(k){k&&_(e),p&&p.d(),o=!1,je(c)}}}function cs(l,e,s){let t,{post:n}=e,r=Math.min(Math.round(n.height/n.width*5),15);const a=u=>u.endsWith(".jpg")||u.endsWith(".jpeg")||u.endsWith(".png")||u.endsWith(".webp");function f(u){Fe.call(this,l,u)}const i=u=>{ft(u)&&u.target.click()};return l.$$set=u=>{"post"in u&&s(0,n=u.post)},l.$$.update=()=>{l.$$.dirty&1&&s(1,t=a(n.sample_url)?n.sample_url:n.preview_url)},[n,t,r,f,i]}class us extends le{constructor(e){super(),re(this,e,cs,is,ne,{post:0})}}function fs(l){let e,s,t,n;const r=l[3].default,a=vt(r,l,l[2],null);return{c(){e=E("div"),a&&a.c(),this.h()},l(f){e=C(f,"DIV",{role:!0,tabindex:!0,class:!0});var i=R(e);a&&a.l(i),i.forEach(_),this.h()},h(){d(e,"role","none"),d(e,"tabindex","-1"),d(e,"class","dialog svelte-1kq1os1")},m(f,i){O(f,e,i),a&&a.m(e,null),l[5](e),s=!0,t||(n=[ce(e,"keydown",l[4]),ce(e,"click",bt(ps))],t=!0)},p(f,[i]){a&&a.p&&(!s||i&4)&&kt(a,r,f,f[2],s?wt(r,f[2],i,null):yt(f[2]),null)},i(f){s||(b(a,f),s=!0)},o(f){w(a,f),s=!1},d(f){f&&_(e),a&&a.d(f),l[5](null),t=!1,je(n)}}}const ps=()=>{};function _s(l,e,s){let{$$slots:t={},$$scope:n}=e;const r=we(),a=()=>r("close");let f;Me(async()=>{f.focus()});const i=o=>{o.code==="Escape"&&a()};function u(o){be[o?"unshift":"push"](()=>{f=o,s(0,f)})}return l.$$set=o=>{"$$scope"in o&&s(2,n=o.$$scope)},[f,a,n,t,i,u]}class ms extends le{constructor(e){super(),re(this,e,_s,fs,ne,{})}}function gs(l){let e,s;return e=new _t({props:{post:l[0]}}),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,n){F(e,t,n),s=!0},p(t,n){const r={};n&1&&(r.post=t[0]),e.$set(r)},i(t){s||(b(e.$$.fragment,t),s=!0)},o(t){w(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function ds(l){let e,s;return{c(){e=E("video"),this.h()},l(t){e=C(t,"VIDEO",{src:!0,class:!0}),R(e).forEach(_),this.h()},h(){_e(e.src,s=l[0].file_url)||d(e,"src",s),e.controls=!0,d(e,"class","svelte-1arnhnh")},m(t,n){O(t,e,n)},p(t,n){n&1&&!_e(e.src,s=t[0].file_url)&&d(e,"src",s)},i:U,o:U,d(t){t&&_(e)}}}function hs(l){let e,s,t;return{c(){e=E("img"),this.h()},l(n){e=C(n,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){_e(e.src,s=l[0].file_url)||d(e,"src",s),d(e,"alt",t="Image of Post "+l[0].id),d(e,"class","svelte-1arnhnh")},m(n,r){O(n,e,r)},p(n,r){r&1&&!_e(e.src,s=n[0].file_url)&&d(e,"src",s),r&1&&t!==(t="Image of Post "+n[0].id)&&d(e,"alt",t)},i:U,o:U,d(n){n&&_(e)}}}function $s(l){let e;return{c(){e=E("i"),this.h()},l(s){e=C(s,"I",{class:!0}),R(e).forEach(_),this.h()},h(){d(e,"class","codicon codicon-close")},m(s,t){O(s,e,t)},p:U,d(s){s&&_(e)}}}function vs(l){let e,s,t,n,r,a,f,i,u,o;const c=[hs,ds,gs],p=[];function k(m,D){return m[0].type==="image"?0:m[0].type==="video"?1:2}return s=k(l),t=p[s]=c[s](l),r=new At({props:{class:"button-close",$$slots:{default:[$s]},$$scope:{ctx:l}}}),r.$on("click",l[2]),u=new pt({props:{post:l[0]}}),{c(){e=E("div"),t.c(),n=P(),L(r.$$.fragment),a=P(),f=E("i"),i=P(),L(u.$$.fragment),this.h()},l(m){e=C(m,"DIV",{class:!0});var D=R(e);t.l(D),n=N(D),V(r.$$.fragment,D),a=N(D),f=C(D,"I",{class:!0}),R(f).forEach(_),D.forEach(_),i=N(m),V(u.$$.fragment,m),this.h()},h(){d(f,"class","codicon codicon-chevron-down svelte-1arnhnh"),d(e,"class","svelte-1arnhnh")},m(m,D){O(m,e,D),p[s].m(e,null),v(e,n),F(r,e,null),v(e,a),v(e,f),O(m,i,D),F(u,m,D),o=!0},p(m,D){let h=s;s=k(m),s===h?p[s].p(m,D):(ee(),w(p[h],1,1,()=>{p[h]=null}),te(),t=p[s],t?t.p(m,D):(t=p[s]=c[s](m),t.c()),b(t,1),t.m(e,n));const y={};D&16&&(y.$$scope={dirty:D,ctx:m}),r.$set(y);const g={};D&1&&(g.post=m[0]),u.$set(g)},i(m){o||(b(t),b(r.$$.fragment,m),b(u.$$.fragment,m),o=!0)},o(m){w(t),w(r.$$.fragment,m),w(u.$$.fragment,m),o=!1},d(m){m&&(_(e),_(i)),p[s].d(),M(r),M(u,m)}}}function bs(l){let e,s;return e=new ms({props:{$$slots:{default:[vs]},$$scope:{ctx:l}}}),e.$on("close",l[3]),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,n){F(e,t,n),s=!0},p(t,[n]){const r={};n&17&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){s||(b(e.$$.fragment,t),s=!0)},o(t){w(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function ks(l,e,s){const t=we();let{post:n}=e;const r=()=>t("close");function a(f){Fe.call(this,l,f)}return l.$$set=f=>{"post"in f&&s(0,n=f.post)},[n,t,r,a]}class ys extends le{constructor(e){super(),re(this,e,ks,bs,ne,{post:0})}}function Xe(l,e,s){const t=l.slice();return t[8]=e[s],t}function xe(l,e,s){const t=l.slice();return t[8]=e[s],t}function ws(l){let e,s,t,n,r=ye(l[2].posts),a=[];for(let u=0;u<r.length;u+=1)a[u]=et(Xe(l,r,u));const f=u=>w(a[u],1,1,()=>{a[u]=null});let i=l[1]&&l[0]!==void 0&&tt(l);return{c(){e=E("section");for(let u=0;u<a.length;u+=1)a[u].c();s=P(),i&&i.c(),t=ue(),this.h()},l(u){e=C(u,"SECTION",{class:!0,style:!0});var o=R(e);for(let c=0;c<a.length;c+=1)a[c].l(o);o.forEach(_),s=N(u),i&&i.l(u),t=ue(),this.h()},h(){d(e,"class","multi svelte-q6spg0"),Ve(e,"grid-template-columns","repeat("+l[3]+", 1fr)")},m(u,o){O(u,e,o);for(let c=0;c<a.length;c+=1)a[c]&&a[c].m(e,null);O(u,s,o),i&&i.m(u,o),O(u,t,o),n=!0},p(u,o){if(o&5){r=ye(u[2].posts);let c;for(c=0;c<r.length;c+=1){const p=Xe(u,r,c);a[c]?(a[c].p(p,o),b(a[c],1)):(a[c]=et(p),a[c].c(),b(a[c],1),a[c].m(e,null))}for(ee(),c=r.length;c<a.length;c+=1)f(c);te()}(!n||o&8)&&Ve(e,"grid-template-columns","repeat("+u[3]+", 1fr)"),u[1]&&u[0]!==void 0?i?(i.p(u,o),o&3&&b(i,1)):(i=tt(u),i.c(),b(i,1),i.m(t.parentNode,t)):i&&(ee(),w(i,1,1,()=>{i=null}),te())},i(u){if(!n){for(let o=0;o<r.length;o+=1)b(a[o]);b(i),n=!0}},o(u){a=a.filter(Boolean);for(let o=0;o<a.length;o+=1)w(a[o]);w(i),n=!1},d(u){u&&(_(e),_(s),_(t)),qe(a,u),i&&i.d(u)}}}function Ss(l){let e,s,t=ye(l[2].posts),n=[];for(let a=0;a<t.length;a+=1)n[a]=st(xe(l,t,a));const r=a=>w(n[a],1,1,()=>{n[a]=null});return{c(){e=E("section");for(let a=0;a<n.length;a+=1)n[a].c();this.h()},l(a){e=C(a,"SECTION",{class:!0});var f=R(e);for(let i=0;i<n.length;i+=1)n[i].l(f);f.forEach(_),this.h()},h(){d(e,"class","single svelte-q6spg0")},m(a,f){O(a,e,f);for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(e,null);s=!0},p(a,f){if(f&4){t=ye(a[2].posts);let i;for(i=0;i<t.length;i+=1){const u=xe(a,t,i);n[i]?(n[i].p(u,f),b(n[i],1)):(n[i]=st(u),n[i].c(),b(n[i],1),n[i].m(e,null))}for(ee(),i=t.length;i<n.length;i+=1)r(i);te()}},i(a){if(!s){for(let f=0;f<t.length;f+=1)b(n[f]);s=!0}},o(a){n=n.filter(Boolean);for(let f=0;f<n.length;f+=1)w(n[f]);s=!1},d(a){a&&_(e),qe(n,a)}}}function et(l){let e,s;function t(){return l[5](l[8])}return e=new us({props:{post:l[8]}}),e.$on("click",t),{c(){L(e.$$.fragment)},l(n){V(e.$$.fragment,n)},m(n,r){F(e,n,r),s=!0},p(n,r){l=n;const a={};r&4&&(a.post=l[8]),e.$set(a)},i(n){s||(b(e.$$.fragment,n),s=!0)},o(n){w(e.$$.fragment,n),s=!1},d(n){M(e,n)}}}function tt(l){let e,s;return e=new ys({props:{post:l[0]}}),e.$on("close",l[6]),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,n){F(e,t,n),s=!0},p(t,n){const r={};n&1&&(r.post=t[0]),e.$set(r)},i(t){s||(b(e.$$.fragment,t),s=!0)},o(t){w(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function st(l){let e,s;return e=new as({props:{post:l[8]}}),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,n){F(e,t,n),s=!0},p(t,n){const r={};n&4&&(r.post=t[8]),e.$set(r)},i(t){s||(b(e.$$.fragment,t),s=!0)},o(t){w(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function Es(l){let e,s,t=Te(l[2].postCount)+"",n,r,a,f,i,u,o,c,p;f=new ts({}),f.$on("sortfilterupdate",l[4]);const k=[Ss,ws],m=[];function D(h,y){return h[3]==="1"?0:1}return u=D(l),o=m[u]=k[u](l),{c(){e=E("div"),s=E("span"),n=X(t),r=X(" posts"),a=P(),L(f.$$.fragment),i=P(),o.c(),c=ue(),this.h()},l(h){e=C(h,"DIV",{class:!0});var y=R(e);s=C(y,"SPAN",{});var g=R(s);n=x(g,t),r=x(g," posts"),g.forEach(_),a=N(y),V(f.$$.fragment,y),y.forEach(_),i=N(h),o.l(h),c=ue(),this.h()},h(){d(e,"class","svelte-q6spg0")},m(h,y){O(h,e,y),v(e,s),v(s,n),v(s,r),v(e,a),F(f,e,null),O(h,i,y),m[u].m(h,y),O(h,c,y),p=!0},p(h,[y]){(!p||y&4)&&t!==(t=Te(h[2].postCount)+"")&&Ne(n,t);let g=u;u=D(h),u===g?m[u].p(h,y):(ee(),w(m[g],1,1,()=>{m[g]=null}),te(),o=m[u],o?o.p(h,y):(o=m[u]=k[u](h),o.c()),b(o,1),o.m(c.parentNode,c))},i(h){p||(b(f.$$.fragment,h),b(o),p=!0)},o(h){w(f.$$.fragment,h),w(o),p=!1},d(h){h&&(_(e),_(i),_(c)),M(f),m[u].d(h)}}}function Cs(l,e,s){let t,n;pe(l,Pe,c=>s(2,t=c)),pe(l,Ot,c=>s(3,n=c));let r,a=location.hash.length>2;const f=()=>{s(1,a=location.hash.length>2)};Me(()=>{window.addEventListener("hashchange",f)}),at(()=>{window.removeEventListener("hashchange",f)});function i(c){Fe.call(this,l,c)}return[r,a,t,n,i,c=>{s(0,r=c),location.hash=`fullscreen_${c.id}`},()=>{s(0,r=void 0),history.back()}]}class Is extends le{constructor(e){super(),re(this,e,Cs,Es,ne,{})}}function Ds(l){let e;return{c(){e=E("div")},l(s){e=C(s,"DIV",{}),R(e).forEach(_)},m(s,t){O(s,e,t),l[2](e)},p:U,i:U,o:U,d(s){s&&_(e),l[2](null)}}}function Ps(l,e,s){let{rootMargin:t}=e;const n=we(),r=new IntersectionObserver(i=>{i[0].isIntersecting&&n("intersection")},{rootMargin:t});let a;function f(i){be[i?"unshift":"push"](()=>{a=i,s(0,a)})}return l.$$set=i=>{"rootMargin"in i&&s(1,t=i.rootMargin)},l.$$.update=()=>{l.$$.dirty&1&&(r.disconnect(),a&&r.observe(a))},[a,t,f]}class Ns extends le{constructor(e){super(),re(this,e,Ps,Ds,ne,{rootMargin:1})}}function Os(l){let e,s,t,n,r="You have seen everything there is to see...";return{c(){e=E("img"),t=P(),n=E("p"),n.textContent=r,this.h()},l(a){e=C(a,"IMG",{src:!0,alt:!0,class:!0}),t=N(a),n=C(a,"P",{"data-svelte-h":!0}),ie(n)!=="svelte-1i75mtf"&&(n.textContent=r),this.h()},h(){_e(e.src,s=ct+"/assets/shironeko-x.png")||d(e,"src",s),d(e,"alt","No more results to load"),d(e,"class","svelte-1pkma0d")},m(a,f){O(a,e,f),O(a,t,f),O(a,n,f)},p:U,i:U,o:U,d(a){a&&(_(e),_(t),_(n))}}}class Ts extends le{constructor(e){super(),re(this,e,null,Os,ne,{})}}function nt(l,e,s){const t=l.slice();return t[9]=e[s],t}function lt(l){let e,s;return e=new Vt({props:{tag:l[9]}}),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,n){F(e,t,n),s=!0},p(t,n){const r={};n&4&&(r.tag=t[9]),e.$set(r)},i(t){s||(b(e.$$.fragment,t),s=!0)},o(t){w(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function Rs(l){let e;return{c(){e=X("Create supertag")},l(s){e=x(s,"Create supertag")},m(s,t){O(s,e,t)},d(s){s&&_(e)}}}function Bs(l){let e,s,t="Create Supertag",n,r,a,f,i,u="Name",o,c,p,k,m,D="Description",h,y,g,S,I,Y="Tags",oe,Z,K,ae,$,z,J,W,Q=ye(l[2]),j=[];for(let B=0;B<Q.length;B+=1)j[B]=lt(nt(l,Q,B));const Se=B=>w(j[B],1,1,()=>{j[B]=null});return $=new Oe({props:{title:l[3]?"Click to create supertag":"Enter a valid name to continue",disabled:!l[3],$$slots:{default:[Rs]},$$scope:{ctx:l}}}),$.$on("click",l[8]),{c(){e=E("section"),s=E("h3"),s.textContent=t,n=P(),r=E("button"),a=P(),f=E("div"),i=E("label"),i.textContent=u,o=P(),c=E("input"),p=P(),k=E("div"),m=E("label"),m.textContent=D,h=P(),y=E("input"),g=P(),S=E("div"),I=E("span"),I.textContent=Y,oe=P(),Z=E("ol");for(let B=0;B<j.length;B+=1)j[B].c();K=P(),ae=E("div"),L($.$$.fragment),this.h()},l(B){e=C(B,"SECTION",{class:!0});var T=R(e);s=C(T,"H3",{"data-svelte-h":!0}),ie(s)!=="svelte-ho1cwx"&&(s.textContent=t),n=N(T),r=C(T,"BUTTON",{class:!0}),R(r).forEach(_),a=N(T),f=C(T,"DIV",{class:!0});var H=R(f);i=C(H,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),ie(i)!=="svelte-10k8a68"&&(i.textContent=u),o=N(H),c=C(H,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),H.forEach(_),p=N(T),k=C(T,"DIV",{class:!0});var q=R(k);m=C(q,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),ie(m)!=="svelte-14n9kp6"&&(m.textContent=D),h=N(q),y=C(q,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),q.forEach(_),g=N(T),S=C(T,"DIV",{class:!0});var se=R(S);I=C(se,"SPAN",{class:!0,"data-svelte-h":!0}),ie(I)!=="svelte-7hjyox"&&(I.textContent=Y),oe=N(se),Z=C(se,"OL",{class:!0});var ve=R(Z);for(let Ce=0;Ce<j.length;Ce+=1)j[Ce].l(ve);ve.forEach(_),se.forEach(_),K=N(T),ae=C(T,"DIV",{class:!0});var Ee=R(ae);V($.$$.fragment,Ee),Ee.forEach(_),T.forEach(_),this.h()},h(){d(r,"class",it("codicon codicon-close")+" svelte-xkjm86"),d(i,"for","supertag-name"),d(i,"class","svelte-xkjm86"),d(c,"type","text"),d(c,"placeholder","Descriptive name"),d(c,"id","supertag-name"),d(c,"class","svelte-xkjm86"),d(f,"class","svelte-xkjm86"),d(m,"for","supertag-description"),d(m,"class","svelte-xkjm86"),d(y,"type","text"),d(y,"placeholder","Short description"),d(y,"id","supertag-description"),d(y,"class","svelte-xkjm86"),d(k,"class","svelte-xkjm86"),d(I,"class","svelte-xkjm86"),d(Z,"class","svelte-xkjm86"),d(S,"class","svelte-xkjm86"),d(ae,"class","last svelte-xkjm86"),d(e,"class","svelte-xkjm86")},m(B,T){O(B,e,T),v(e,s),v(e,n),v(e,r),v(e,a),v(e,f),v(f,i),v(f,o),v(f,c),ke(c,l[0]),v(e,p),v(e,k),v(k,m),v(k,h),v(k,y),ke(y,l[1]),v(e,g),v(e,S),v(S,I),v(S,oe),v(S,Z);for(let H=0;H<j.length;H+=1)j[H]&&j[H].m(Z,null);v(e,K),v(e,ae),F($,ae,null),z=!0,J||(W=[ce(r,"click",l[5]),ce(c,"input",l[6]),ce(y,"input",l[7])],J=!0)},p(B,T){if(T&1&&c.value!==B[0]&&ke(c,B[0]),T&2&&y.value!==B[1]&&ke(y,B[1]),T&4){Q=ye(B[2]);let q;for(q=0;q<Q.length;q+=1){const se=nt(B,Q,q);j[q]?(j[q].p(se,T),b(j[q],1)):(j[q]=lt(se),j[q].c(),b(j[q],1),j[q].m(Z,null))}for(ee(),q=Q.length;q<j.length;q+=1)Se(q);te()}const H={};T&8&&(H.title=B[3]?"Click to create supertag":"Enter a valid name to continue"),T&8&&(H.disabled=!B[3]),T&4096&&(H.$$scope={dirty:T,ctx:B}),$.$set(H)},i(B){if(!z){for(let T=0;T<Q.length;T+=1)b(j[T]);b($.$$.fragment,B),z=!0}},o(B){j=j.filter(Boolean);for(let T=0;T<j.length;T+=1)w(j[T]);w($.$$.fragment,B),z=!1},d(B){B&&_(e),qe(j,B),M($),J=!1,je(W)}}}function As(l){let e,s;return e=new ut({props:{$$slots:{default:[Bs]},$$scope:{ctx:l}}}),e.$on("close",l[5]),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,n){F(e,t,n),s=!0},p(t,[n]){const r={};n&4111&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){s||(b(e.$$.fragment,t),s=!0)},o(t){w(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function js(l,e,s){let t,{name:n=""}=e,{description:r=""}=e,{tags:a}=e;const f=we(),i=()=>f("close");function u(){n=this.value,s(0,n)}function o(){r=this.value,s(1,r)}const c=()=>{f("submit",{name:n,description:r,tags:a.map(({modifier:p,name:k})=>({modifier:p,name:k}))}),i()};return l.$$set=p=>{"name"in p&&s(0,n=p.name),"description"in p&&s(1,r=p.description),"tags"in p&&s(2,a=p.tags)},l.$$.update=()=>{l.$$.dirty&5&&s(3,t=typeof n=="string"&&n!==""&&a.length>1)},[n,r,a,t,f,i,u,o,c]}class Ls extends le{constructor(e){super(),re(this,e,js,As,ne,{name:0,description:1,tags:2})}}function Vs(l){let e,s,t,n,r,a,f,i,u,o;return{c(){e=E("div"),s=E("div"),t=E("i"),n=P(),r=E("div"),a=E("h3"),f=X(l[0]),i=P(),u=E("span"),o=X(l[2]),this.h()},l(c){e=C(c,"DIV",{class:!0});var p=R(e);s=C(p,"DIV",{class:!0});var k=R(s);t=C(k,"I",{class:!0}),R(t).forEach(_),k.forEach(_),n=N(p),r=C(p,"DIV",{});var m=R(r);a=C(m,"H3",{class:!0});var D=R(a);f=x(D,l[0]),D.forEach(_),i=N(m),u=C(m,"SPAN",{});var h=R(u);o=x(h,l[2]),h.forEach(_),m.forEach(_),p.forEach(_),this.h()},h(){d(t,"class",it(l[1])+" svelte-1tvgln1"),d(s,"class","icon svelte-1tvgln1"),d(a,"class","svelte-1tvgln1"),d(e,"class","error svelte-1tvgln1")},m(c,p){O(c,e,p),v(e,s),v(s,t),v(e,n),v(e,r),v(r,a),v(a,f),v(r,i),v(r,u),v(u,o)},p:U,i:U,o:U,d(c){c&&_(e)}}}function Fs(l,e,s){let{error:t}=e,n=t.message==="Failed to fetch"?"Connection Error":"Application Error",r=t.message==="Failed to fetch"?"codicon codicon-debug-disconnect":"codicon codicon-error",a=t.message==="Failed to fetch"?"Failed to connect to the server. Make sure you have a stable internet connection.":t.message;return l.$$set=f=>{"error"in f&&s(3,t=f.error)},[n,r,a,t]}class Ms extends le{constructor(e){super(),re(this,e,Fs,Vs,ne,{error:3})}}function qs(l){let e;return{c(){e=X("Search")},l(s){e=x(s,"Search")},m(s,t){O(s,e,t)},d(s){s&&_(e)}}}function zs(l){let e,s,t,n,r,a;const f=[Ks,Us],i=[];function u(o,c){return o[2].postCount===0?0:1}return s=u(l),t=i[s]=f[s](l),r=new Ft({}),{c(){e=E("section"),t.c(),n=P(),L(r.$$.fragment),this.h()},l(o){e=C(o,"SECTION",{class:!0});var c=R(e);t.l(c),c.forEach(_),n=N(o),V(r.$$.fragment,o),this.h()},h(){d(e,"class","svelte-rk0y4a")},m(o,c){O(o,e,c),i[s].m(e,null),O(o,n,c),F(r,o,c),a=!0},p(o,c){let p=s;s=u(o),s===p?i[s].p(o,c):(ee(),w(i[p],1,1,()=>{i[p]=null}),te(),t=i[s],t?t.p(o,c):(t=i[s]=f[s](o),t.c()),b(t,1),t.m(e,null))},i(o){a||(b(t),b(r.$$.fragment,o),a=!0)},o(o){w(t),w(r.$$.fragment,o),a=!1},d(o){o&&(_(e),_(n)),i[s].d(),M(r,o)}}}function Gs(l){let e,s;return e=new Ms({props:{error:l[0]}}),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,n){F(e,t,n),s=!0},p(t,n){const r={};n&1&&(r.error=t[0]),e.$set(r)},i(t){s||(b(e.$$.fragment,t),s=!0)},o(t){w(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function Us(l){let e,s,t,n,r,a;e=new Is({}),e.$on("sortfilterupdate",l[7]);const f=[Ws,Hs],i=[];function u(o,c){return o[2].posts.length===o[2].postCount?0:1}return t=u(l),n=i[t]=f[t](l),{c(){L(e.$$.fragment),s=P(),n.c(),r=ue()},l(o){V(e.$$.fragment,o),s=N(o),n.l(o),r=ue()},m(o,c){F(e,o,c),O(o,s,c),i[t].m(o,c),O(o,r,c),a=!0},p(o,c){let p=t;t=u(o),t===p?i[t].p(o,c):(ee(),w(i[p],1,1,()=>{i[p]=null}),te(),n=i[t],n?n.p(o,c):(n=i[t]=f[t](o),n.c()),b(n,1),n.m(r.parentNode,r))},i(o){a||(b(e.$$.fragment,o),b(n),a=!0)},o(o){w(e.$$.fragment,o),w(n),a=!1},d(o){o&&(_(s),_(r)),M(e,o),i[t].d(o)}}}function Ks(l){let e,s;return e=new Ut({}),e.$on("sortfilterupdate",l[7]),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,n){F(e,t,n),s=!0},p:U,i(t){s||(b(e.$$.fragment,t),s=!0)},o(t){w(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function Hs(l){let e,s;return e=new Ns({props:{rootMargin:"1000px"}}),e.$on("intersection",l[8]),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,n){F(e,t,n),s=!0},p:U,i(t){s||(b(e.$$.fragment,t),s=!0)},o(t){w(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function Ws(l){let e,s;return e=new Ts({}),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,n){F(e,t,n),s=!0},p:U,i(t){s||(b(e.$$.fragment,t),s=!0)},o(t){w(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function rt(l){let e,s;return e=new Ls({props:{tags:l[4]}}),e.$on("close",l[13]),e.$on("submit",l[14]),{c(){L(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,n){F(e,t,n),s=!0},p(t,n){const r={};n&16&&(r.tags=t[4]),e.$set(r)},i(t){s||(b(e.$$.fragment,t),s=!0)},o(t){w(e.$$.fragment,t),s=!1},d(t){M(e,t)}}}function Ys(l){let e,s,t,n,r,a,f,i,u,o,c,p,k,m;s=new St({}),n=new It({props:{placeholder:"Search for tags",fetchSuggestions:l[6]}}),n.$on("pick",l[9]),a=new Oe({props:{title:"Search with the tags above",$$slots:{default:[qs]},$$scope:{ctx:l}}}),a.$on("click",l[7]),i=new Et({props:{tags:[...l[4],...l[3]]}}),i.$on("click",l[10]),i.$on("contextmenu",l[11]),i.$on("createSupertag",l[12]);const D=[Gs,zs],h=[];function y(S,I){return S[0]?0:S[2].requested?1:-1}~(o=y(l))&&(c=h[o]=D[o](l));let g=l[1]&&rt(l);return{c(){e=E("section"),L(s.$$.fragment),t=P(),L(n.$$.fragment),r=P(),L(a.$$.fragment),f=P(),L(i.$$.fragment),u=P(),c&&c.c(),p=P(),g&&g.c(),k=ue(),this.h()},l(S){e=C(S,"SECTION",{id:!0,class:!0});var I=R(e);V(s.$$.fragment,I),t=N(I),V(n.$$.fragment,I),r=N(I),V(a.$$.fragment,I),f=N(I),V(i.$$.fragment,I),I.forEach(_),u=N(S),c&&c.l(S),p=N(S),g&&g.l(S),k=ue(),this.h()},h(){d(e,"id","search"),d(e,"class","svelte-rk0y4a")},m(S,I){O(S,e,I),F(s,e,null),v(e,t),F(n,e,null),v(e,r),F(a,e,null),v(e,f),F(i,e,null),O(S,u,I),~o&&h[o].m(S,I),O(S,p,I),g&&g.m(S,I),O(S,k,I),m=!0},p(S,[I]){const Y={};I&8388608&&(Y.$$scope={dirty:I,ctx:S}),a.$set(Y);const oe={};I&24&&(oe.tags=[...S[4],...S[3]]),i.$set(oe);let Z=o;o=y(S),o===Z?~o&&h[o].p(S,I):(c&&(ee(),w(h[Z],1,1,()=>{h[Z]=null}),te()),~o?(c=h[o],c?c.p(S,I):(c=h[o]=D[o](S),c.c()),b(c,1),c.m(p.parentNode,p)):c=null),S[1]?g?(g.p(S,I),I&2&&b(g,1)):(g=rt(S),g.c(),b(g,1),g.m(k.parentNode,k)):g&&(ee(),w(g,1,1,()=>{g=null}),te())},i(S){m||(b(s.$$.fragment,S),b(n.$$.fragment,S),b(a.$$.fragment,S),b(i.$$.fragment,S),b(c),b(g),m=!0)},o(S){w(s.$$.fragment,S),w(n.$$.fragment,S),w(a.$$.fragment,S),w(i.$$.fragment,S),w(c),w(g),m=!1},d(S){S&&(_(e),_(u),_(p),_(k)),M(s),M(n),M(a),M(i),~o&&h[o].d(S),g&&g.d(S)}}}const Zs=()=>{const l=new URL(location.href);if(!l.searchParams.has("tags"))return;const s=(l.searchParams.get("tags")??"").split(";");if(!(!Array.isArray(s)||s.length===0))return s};function Js(l,e,s){let t,n,r,a,f,i;pe(l,Pe,$=>s(2,t=$)),pe(l,Le,$=>s(3,n=$)),pe(l,fe,$=>s(17,r=$)),pe(l,Lt,$=>s(18,a=$)),pe(l,De,$=>s(4,f=$)),pe(l,He,$=>s(5,i=$));let u=!1,o,c=!1,p=0;const k=async $=>{const z=await Pt($);return[...i.items.filter(({name:W})=>W.toLowerCase().includes($.toLowerCase())).map(W=>({label:W.name,count:W.tags.length,type:"supertag"})),...z]},m=Zs();m&&m.forEach($=>{f.some(z=>z.name===$)||De.addByName($)});const D=()=>new Ct().withPid(t.pageCount).withTags(f).withBlockedContent(a).withSortProperty(r.sortProperty).withSortDirection(r.sortDirection).withScoreValue(r.scoreValue).withScoreComparator(r.scoreComparator).withRating(r.rating).withSupertags(n),h=async $=>{if(!u){s(0,o=void 0),u=!0;try{const z=t.pageCount;await $(),Mt(z).catch(()=>{})}catch(z){s(0,o=z),console.warn(z)}finally{u=!1}}},y=async()=>{Pe.reset(),p=0,h(async()=>{const[$,z]=await D().getPageAndCount();console.log($,z),Pe.addPage($,z)})},g=async()=>{h(async()=>{const $=await D().getPage();Pe.addPage($)})},S=$=>{var z,J;if(console.log($),($.key==="/"||$.key==="s")&&(!document.activeElement||document.activeElement===document.body)&&((z=document.getElementById("searchbar"))==null||z.focus(),$.preventDefault(),$.stopPropagation()),$.ctrlKey&&$.key==="Enter"&&($.preventDefault(),$.stopPropagation(),y()),$.ctrlKey&&$.key==="m"&&((J=document.getElementById("select-modifier"))==null||J.click()),$.ctrlKey&&$.key==="ArrowDown"){const W=document.getElementsByClassName("post-media");W[p].focus(),p=Math.min(p+1,Math.max(0,W.length-1))}$.ctrlKey&&$.key==="ArrowUp"&&(document.getElementsByClassName("post-media")[p].focus(),p=Math.max(p-1,0))};return Me(()=>{document.addEventListener("keydown",S)}),at(()=>{document.removeEventListener("keydown",S)}),[o,c,t,n,f,i,k,y,g,async $=>{const z=$.detail;if(z.type==="supertag"){const J=i.items.find(W=>W.name===z.label);if(!J){console.log("Supertag not present.");return}Le.addOrReplace(J)}else{const J=await Nt($.detail.label);De.addOrReplace({name:$.detail.label,modifier:$.detail.modifier,count:$.detail.count,type:J.type})}},$=>"description"in $.detail?Le.removeByName($.detail.name):De.removeByName($.detail.name),$=>{"description"in $.detail||($.detail.modifier=Dt($.detail.modifier),De.addOrReplace($.detail))},()=>s(1,c=!0),()=>s(1,c=!1),$=>He.add($.detail)]}class hn extends le{constructor(e){super(),re(this,e,Js,Ys,ne,{})}}export{hn as component};
