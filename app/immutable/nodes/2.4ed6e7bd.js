import{s as pe,D as Re,f as E,a as N,g as I,h as A,y as ce,c as T,d as g,j as d,r as Gt,i as O,u as _,E as Ke,F as Ie,G as Ye,H as ft,l as ue,m as fe,v as Q,I as ke,w as ln,J as rn,z as on,A as an,B as cn,o as ot,K as it,p as Oe,n as Le,C as le,e as we,k as Be,L as tt,M as st,N as ut,O as un,P as qt,Q as _t}from"../chunks/scheduler.32f194ce.js";import{S as _e,i as me,b as V,d as R,m as F,a as v,t as b,e as M,g as ie,c as ae,f as nt,h as fn}from"../chunks/index.aa0a4971.js";import{e as De}from"../chunks/each.e59479a4.js";import{D as Ht,r as Kt}from"../chunks/result-columns-store.74912f3b.js";import{T as Qe}from"../chunks/TextButton.98b56d16.js";import{D as pn}from"../chunks/DetailedTag.42657508.js";import{K as _n,A as mn}from"../chunks/ActiveTagList.10ef882f.js";import{b as Wt}from"../chunks/paths.ca3da844.js";import{f as lt}from"../chunks/format-tag.7e313273.js";import{r as We,a as pt}from"../chunks/active-supertags-store.9241f644.js";import{I as Qt,R as dn}from"../chunks/ModifierSelect.b17e978c.js";import{h as mt,u as gn}from"../chunks/await_block.af8be678.js";import{L as Yt}from"../chunks/LoadingAnimation.1752780f.js";import{r as Ae,g as hn,a as $n}from"../chunks/tags.b027a74d.js";import{R as vn,S as bn,a as kn,K as wn,E as Zt,b as yn,g as dt,P as Cn,C as Sn,c as En,d as Jt,i as In,e as Xt,D as Dn,G as Pn,V as Nn,f as gt,I as Tn}from"../chunks/Details.4623b961.js";import{i as at,a as On}from"../chunks/always-loop-store.7008ae9e.js";import{f as Me,s as je,S as An}from"../chunks/search-builder.6c15ea23.js";import{S as ht}from"../chunks/Select.86ea1f7f.js";import{R as Vn}from"../chunks/RotatingTextSelect.068e75cb.js";import{S as Rn}from"../chunks/Searchbar.d2df380d.js";import{S as Fn}from"../chunks/ScrollUpButton.7d16a589.js";import{l as Mn}from"../chunks/analytics.b280da65.js";import{n as Ln,s as $t}from"../chunks/supertags-store.e49dc1f8.js";import{a as ct}from"../chunks/active-tags-store.d23316a6.js";import{b as Bn}from"../chunks/blocked-content-store.7cdb997c.js";import{c as xt}from"../chunks/cookies-accepted-store.00223971.js";function vt(l,e,n){const t=l.slice();return t[9]=e[n],t}function bt(l){let e,n;return e=new pn({props:{tag:l[9]}}),{c(){V(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p(t,s){const r={};s&4&&(r.tag=t[9]),e.$set(r)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function jn(l){let e;return{c(){e=ue("Create supertag")},l(n){e=fe(n,"Create supertag")},m(n,t){O(n,e,t)},d(n){n&&g(e)}}}function zn(l){let e,n,t="Create Supertag",s,r,o,a,i,u="Name",c,f,m,S,C,k="Description",$,p,h,w,y,D="Tags",B,K,Z,ee,se,re,P,X,q=De(l[2]),L=[];for(let j=0;j<q.length;j+=1)L[j]=bt(vt(l,q,j));const ne=j=>b(L[j],1,1,()=>{L[j]=null});return se=new Qe({props:{title:l[3]?"Click to create supertag":"Enter a valid name to continue",disabled:!l[3],$$slots:{default:[jn]},$$scope:{ctx:l}}}),se.$on("click",l[8]),{c(){e=E("section"),n=E("h3"),n.textContent=t,s=N(),r=E("button"),o=N(),a=E("div"),i=E("label"),i.textContent=u,c=N(),f=E("input"),m=N(),S=E("div"),C=E("label"),C.textContent=k,$=N(),p=E("input"),h=N(),w=E("div"),y=E("span"),y.textContent=D,B=N(),K=E("ol");for(let j=0;j<L.length;j+=1)L[j].c();Z=N(),ee=E("div"),V(se.$$.fragment),this.h()},l(j){e=I(j,"SECTION",{class:!0});var z=A(e);n=I(z,"H3",{"data-svelte-h":!0}),ce(n)!=="svelte-ho1cwx"&&(n.textContent=t),s=T(z),r=I(z,"BUTTON",{class:!0}),A(r).forEach(g),o=T(z),a=I(z,"DIV",{class:!0});var x=A(a);i=I(x,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),ce(i)!=="svelte-10k8a68"&&(i.textContent=u),c=T(x),f=I(x,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),x.forEach(g),m=T(z),S=I(z,"DIV",{class:!0});var W=A(S);C=I(W,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),ce(C)!=="svelte-14n9kp6"&&(C.textContent=k),$=T(W),p=I(W,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),W.forEach(g),h=T(z),w=I(z,"DIV",{class:!0});var ge=A(w);y=I(ge,"SPAN",{class:!0,"data-svelte-h":!0}),ce(y)!=="svelte-7hjyox"&&(y.textContent=D),B=T(ge),K=I(ge,"OL",{class:!0});var he=A(K);for(let Se=0;Se<L.length;Se+=1)L[Se].l(he);he.forEach(g),ge.forEach(g),Z=T(z),ee=I(z,"DIV",{class:!0});var Ve=A(ee);R(se.$$.fragment,Ve),Ve.forEach(g),z.forEach(g),this.h()},h(){d(r,"class",Gt("codicon codicon-close")+" svelte-1x6vc81"),d(i,"for","supertag-name"),d(i,"class","svelte-1x6vc81"),d(f,"type","text"),d(f,"placeholder","Descriptive name"),d(f,"id","supertag-name"),d(f,"class","svelte-1x6vc81"),d(a,"class","svelte-1x6vc81"),d(C,"for","supertag-description"),d(C,"class","svelte-1x6vc81"),d(p,"type","text"),d(p,"placeholder","Short description"),d(p,"id","supertag-description"),d(p,"class","svelte-1x6vc81"),d(S,"class","svelte-1x6vc81"),d(y,"class","svelte-1x6vc81"),d(K,"class","svelte-1x6vc81"),d(w,"class","svelte-1x6vc81"),d(ee,"class","last svelte-1x6vc81"),d(e,"class","svelte-1x6vc81")},m(j,z){O(j,e,z),_(e,n),_(e,s),_(e,r),_(e,o),_(e,a),_(a,i),_(a,c),_(a,f),Ke(f,l[0]),_(e,m),_(e,S),_(S,C),_(S,$),_(S,p),Ke(p,l[1]),_(e,h),_(e,w),_(w,y),_(w,B),_(w,K);for(let x=0;x<L.length;x+=1)L[x]&&L[x].m(K,null);_(e,Z),_(e,ee),F(se,ee,null),re=!0,P||(X=[Ie(r,"click",l[5]),Ie(f,"input",l[6]),Ie(p,"input",l[7])],P=!0)},p(j,z){if(z&1&&f.value!==j[0]&&Ke(f,j[0]),z&2&&p.value!==j[1]&&Ke(p,j[1]),z&4){q=De(j[2]);let W;for(W=0;W<q.length;W+=1){const ge=vt(j,q,W);L[W]?(L[W].p(ge,z),v(L[W],1)):(L[W]=bt(ge),L[W].c(),v(L[W],1),L[W].m(K,null))}for(ie(),W=q.length;W<L.length;W+=1)ne(W);ae()}const x={};z&8&&(x.title=j[3]?"Click to create supertag":"Enter a valid name to continue"),z&8&&(x.disabled=!j[3]),z&4096&&(x.$$scope={dirty:z,ctx:j}),se.$set(x)},i(j){if(!re){for(let z=0;z<q.length;z+=1)v(L[z]);v(se.$$.fragment,j),re=!0}},o(j){L=L.filter(Boolean);for(let z=0;z<L.length;z+=1)b(L[z]);b(se.$$.fragment,j),re=!1},d(j){j&&g(e),Ye(L,j),M(se),P=!1,ft(X)}}}function Un(l){let e,n;return e=new Ht({props:{$$slots:{default:[zn]},$$scope:{ctx:l}}}),e.$on("close",l[5]),{c(){V(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p(t,[s]){const r={};s&4111&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function Gn(l,e,n){let t,{name:s=""}=e,{description:r=""}=e,{tags:o}=e;const a=Re(),i=()=>a("close");function u(){s=this.value,n(0,s)}function c(){r=this.value,n(1,r)}const f=()=>{a("submit",{name:s,description:r,tags:o.map(({modifier:m,name:S})=>({modifier:m,name:S}))}),i()};return l.$$set=m=>{"name"in m&&n(0,s=m.name),"description"in m&&n(1,r=m.description),"tags"in m&&n(2,o=m.tags)},l.$$.update=()=>{l.$$.dirty&5&&n(3,t=typeof s=="string"&&s!==""&&o.length>1)},[s,r,o,t,a,i,u,c,f]}class qn extends _e{constructor(e){super(),me(this,e,Gn,Un,pe,{name:0,description:1,tags:2})}}function Hn(l){let e,n,t,s,r,o,a,i,u,c;return{c(){e=E("div"),n=E("div"),t=E("i"),s=N(),r=E("div"),o=E("h3"),a=ue(l[0]),i=N(),u=E("span"),c=ue(l[2]),this.h()},l(f){e=I(f,"DIV",{class:!0});var m=A(e);n=I(m,"DIV",{class:!0});var S=A(n);t=I(S,"I",{class:!0}),A(t).forEach(g),S.forEach(g),s=T(m),r=I(m,"DIV",{});var C=A(r);o=I(C,"H3",{class:!0});var k=A(o);a=fe(k,l[0]),k.forEach(g),i=T(C),u=I(C,"SPAN",{});var $=A(u);c=fe($,l[2]),$.forEach(g),C.forEach(g),m.forEach(g),this.h()},h(){d(t,"class",Gt(l[1])+" svelte-1yohziu"),d(n,"class","icon svelte-1yohziu"),d(o,"class","svelte-1yohziu"),d(e,"class","error svelte-1yohziu")},m(f,m){O(f,e,m),_(e,n),_(n,t),_(e,s),_(e,r),_(r,o),_(o,a),_(r,i),_(r,u),_(u,c)},p:Q,i:Q,o:Q,d(f){f&&g(e)}}}function Kn(l,e,n){let{error:t}=e,s=t.message==="Failed to fetch"?"Connection Error":"Application Error",r=t.message==="Failed to fetch"?"codicon codicon-debug-disconnect":"codicon codicon-error",o=t.message==="Failed to fetch"?"Failed to connect to the server. Make sure you have a stable internet connection.":t.message;return l.$$set=a=>{"error"in a&&n(3,t=a.error)},[s,r,o,t]}class Wn extends _e{constructor(e){super(),me(this,e,Kn,Hn,pe,{error:3})}}function Qn(l){let e,n,t,s,r="You have seen everything there is to see...";return{c(){e=E("img"),t=N(),s=E("p"),s.textContent=r,this.h()},l(o){e=I(o,"IMG",{src:!0,alt:!0,class:!0}),t=T(o),s=I(o,"P",{"data-svelte-h":!0}),ce(s)!=="svelte-1i75mtf"&&(s.textContent=r),this.h()},h(){ke(e.src,n=Wt+"/assets/shironeko-x.png")||d(e,"src",n),d(e,"alt","No more results to load"),d(e,"class","svelte-1pkma0d")},m(o,a){O(o,e,a),O(o,t,a),O(o,s,a)},p:Q,i:Q,o:Q,d(o){o&&(g(e),g(t),g(s))}}}class Yn extends _e{constructor(e){super(),me(this,e,null,Qn,pe,{})}}const rt=l=>`post_${l}`;function Zn(l){let e,n,t,s;const r=l[3].default,o=ln(r,l,l[2],null);return{c(){e=E("div"),o&&o.c(),this.h()},l(a){e=I(a,"DIV",{role:!0,tabindex:!0,class:!0});var i=A(e);o&&o.l(i),i.forEach(g),this.h()},h(){d(e,"role","none"),d(e,"tabindex","-1"),d(e,"class","svelte-6sy8qz")},m(a,i){O(a,e,i),o&&o.m(e,null),l[4](e),n=!0,t||(s=[Ie(e,"click",rn(Jn)),Ie(e,"keydown",l[1])],t=!0)},p(a,[i]){o&&o.p&&(!n||i&4)&&on(o,r,a,a[2],n?cn(r,a[2],i,null):an(a[2]),null)},i(a){n||(v(o,a),n=!0)},o(a){b(o,a),n=!1},d(a){a&&g(e),o&&o.d(a),l[4](null),t=!1,ft(s)}}}const Jn=()=>{};function Xn(l,e,n){let{$$slots:t={},$$scope:s}=e;const r=Re(),o=()=>r("close"),a=f=>{f.key==="Escape"&&o()},i=()=>{document.fullscreenElement||o()};let u;ot(async()=>{u.focus(),document.addEventListener("fullscreenchange",i);try{await u.requestFullscreen()}catch{}}),it(async()=>{document.removeEventListener("fullscreenchange",i);try{await document.exitFullscreen()}catch{}});function c(f){Oe[f?"unshift":"push"](()=>{u=f,n(0,u)})}return l.$$set=f=>{"$$scope"in f&&n(2,s=f.$$scope)},[u,a,s,t,c]}class xn extends _e{constructor(e){super(),me(this,e,Xn,Zn,pe,{})}}function es(l){let e,n;return{c(){e=E("div"),this.h()},l(t){e=I(t,"DIV",{style:!0}),A(e).forEach(g),this.h()},h(){d(e,"style",n=l[0]?`position:absolute;top:${l[0]};`:void 0)},m(t,s){O(t,e,s),l[3](e)},p(t,[s]){s&1&&n!==(n=t[0]?`position:absolute;top:${t[0]};`:void 0)&&d(e,"style",n)},i:Q,o:Q,d(t){t&&g(e),l[3](null)}}}function ts(l,e,n){let{rootMargin:t}=e,{absoluteTop:s}=e;console.log("creating intersection observer: ",t);const r=Re(),o=new IntersectionObserver(u=>{u[0].isIntersecting&&r("intersection")},{rootMargin:t});let a;function i(u){Oe[u?"unshift":"push"](()=>{a=u,n(1,a)})}return l.$$set=u=>{"rootMargin"in u&&n(2,t=u.rootMargin),"absoluteTop"in u&&n(0,s=u.absoluteTop)},l.$$.update=()=>{l.$$.dirty&2&&(o.disconnect(),a&&o.observe(a))},[s,a,t,i]}class en extends _e{constructor(e){super(),me(this,e,ts,es,pe,{rootMargin:2,absoluteTop:0})}}function kt(l,e,n){const t=l.slice();return t[6]=e[n],t}function wt(l,e,n){const t=l.slice();return t[9]=e[n][0],t[10]=e[n][1],t}function yt(l){let e,n="•",t,s,r;return s=new Zt({props:{source:l[0].source}}),{c(){e=E("span"),e.textContent=n,t=N(),V(s.$$.fragment)},l(o){e=I(o,"SPAN",{"data-svelte-h":!0}),ce(e)!=="svelte-7hh8jk"&&(e.textContent=n),t=T(o),R(s.$$.fragment,o)},m(o,a){O(o,e,a),O(o,t,a),F(s,o,a),r=!0},p(o,a){const i={};a&1&&(i.source=o[0].source),s.$set(i)},i(o){r||(v(s.$$.fragment,o),r=!0)},o(o){b(s.$$.fragment,o),r=!1},d(o){o&&(g(e),g(t)),M(s,o)}}}function Ct(l){let e,n=l[9]+"",t,s,r,o;return r=new Cn({props:{tags:l[10]}}),{c(){e=E("h3"),t=ue(n),s=N(),V(r.$$.fragment),this.h()},l(a){e=I(a,"H3",{class:!0});var i=A(e);t=fe(i,n),i.forEach(g),s=T(a),R(r.$$.fragment,a),this.h()},h(){d(e,"class","svelte-1kekodt")},m(a,i){O(a,e,i),_(e,t),O(a,s,i),F(r,a,i),o=!0},p(a,i){(!o||i&2)&&n!==(n=a[9]+"")&&Le(t,n);const u={};i&2&&(u.tags=a[10]),r.$set(u)},i(a){o||(v(r.$$.fragment,a),o=!0)},o(a){b(r.$$.fragment,a),o=!1},d(a){a&&(g(e),g(s)),M(r,a)}}}function ns(l){return{c:Q,l:Q,m:Q,p:Q,i:Q,o:Q,d:Q}}function ss(l){let e,n,t,s;const r=[rs,ls],o=[];function a(i,u){return i[5].length>0?0:1}return e=a(l),n=o[e]=r[e](l),{c(){n.c(),t=we()},l(i){n.l(i),t=we()},m(i,u){o[e].m(i,u),O(i,t,u),s=!0},p(i,u){let c=e;e=a(i),e===c?o[e].p(i,u):(ie(),b(o[c],1,1,()=>{o[c]=null}),ae(),n=o[e],n?n.p(i,u):(n=o[e]=r[e](i),n.c()),v(n,1),n.m(t.parentNode,t))},i(i){s||(v(n),s=!0)},o(i){b(n),s=!1},d(i){i&&g(t),o[e].d(i)}}}function ls(l){let e,n="Comments for this post are not available";return{c(){e=E("span"),e.textContent=n,this.h()},l(t){e=I(t,"SPAN",{class:!0,"data-svelte-h":!0}),ce(e)!=="svelte-4t2lxe"&&(e.textContent=n),this.h()},h(){d(e,"class","no-comments svelte-1kekodt")},m(t,s){O(t,e,s)},p:Q,i:Q,o:Q,d(t){t&&g(e)}}}function rs(l){let e,n,t=De(l[5]),s=[];for(let o=0;o<t.length;o+=1)s[o]=St(kt(l,t,o));const r=o=>b(s[o],1,1,()=>{s[o]=null});return{c(){e=E("ul");for(let o=0;o<s.length;o+=1)s[o].c();this.h()},l(o){e=I(o,"UL",{class:!0});var a=A(e);for(let i=0;i<s.length;i+=1)s[i].l(a);a.forEach(g),this.h()},h(){d(e,"class","comments svelte-1kekodt")},m(o,a){O(o,e,a);for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(e,null);n=!0},p(o,a){if(a&1){t=De(o[5]);let i;for(i=0;i<t.length;i+=1){const u=kt(o,t,i);s[i]?(s[i].p(u,a),v(s[i],1)):(s[i]=St(u),s[i].c(),v(s[i],1),s[i].m(e,null))}for(ie(),i=t.length;i<s.length;i+=1)r(i);ae()}},i(o){if(!n){for(let a=0;a<t.length;a+=1)v(s[a]);n=!0}},o(o){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)b(s[a]);n=!1},d(o){o&&g(e),Ye(s,o)}}}function St(l){let e,n;return e=new Sn({props:{comment:l[6]}}),{c(){V(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p(t,s){const r={};s&1&&(r.comment=t[6]),e.$set(r)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function os(l){let e,n;return e=new Yt({}),{c(){V(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p:Q,i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function is(l){let e,n,t,s,r,o,a,i,u=l[0].id+"",c,f,m,S,C,k,$="•",p,h,w=l[0].type.toUpperCase()+"",y,D,B,K="•",Z,ee,se,re,P="•",X,q,L,ne,j,z,x,W="•",ge,he,Ve,Se,Ze="•",Je,Pe,Xe,ze,Fe,Ue,U,Y,Te="Comments",Ne,Ee,$e;S=new vn({props:{value:l[0].rating}}),ee=new bn({props:{value:l[0].score}}),q=new kn({props:{value:l[0].change}}),j=new wn({props:{url:"/post?id="+l[0].id+"&src="+encodeURIComponent(l[3])}}),he=new Zt({props:{source:"https://rule34.xxx/index.php?page=post&s=view&id="+l[0].id}}),Pe=new yn({props:{url:l[3]}});let J=l[0].source&&yt(l),ye=De(Object.entries(l[1])),te=[];for(let H=0;H<ye.length;H+=1)te[H]=Ct(wt(l,ye,H));const sn=H=>b(te[H],1,1,()=>{te[H]=null});let ve={ctx:l,current:null,token:null,hasCatch:!1,pending:os,then:ss,catch:ns,value:5,blocks:[,,,]};return mt(Ee=dt(l[0].id),ve),{c(){e=E("div"),n=E("img"),s=N(),r=E("h1"),o=ue("Post "),a=E("b"),i=ue("#"),c=ue(u),f=N(),m=E("div"),V(S.$$.fragment),C=N(),k=E("span"),k.textContent=$,p=N(),h=E("span"),y=ue(w),D=N(),B=E("span"),B.textContent=K,Z=N(),V(ee.$$.fragment),se=N(),re=E("span"),re.textContent=P,X=N(),V(q.$$.fragment),L=N(),ne=E("div"),V(j.$$.fragment),z=N(),x=E("span"),x.textContent=W,ge=N(),V(he.$$.fragment),Ve=N(),Se=E("span"),Se.textContent=Ze,Je=N(),V(Pe.$$.fragment),Xe=N(),J&&J.c(),ze=N(),Fe=E("div");for(let H=0;H<te.length;H+=1)te[H].c();Ue=N(),U=E("div"),Y=E("h3"),Y.textContent=Te,Ne=N(),ve.block.c(),this.h()},l(H){e=I(H,"DIV",{class:!0});var G=A(e);n=I(G,"IMG",{class:!0,src:!0,alt:!0}),s=T(G),r=I(G,"H1",{class:!0});var Ce=A(r);o=fe(Ce,"Post "),a=I(Ce,"B",{});var Ge=A(a);i=fe(Ge,"#"),c=fe(Ge,u),Ge.forEach(g),Ce.forEach(g),f=T(G),m=I(G,"DIV",{class:!0});var de=A(m);R(S.$$.fragment,de),C=T(de),k=I(de,"SPAN",{"data-svelte-h":!0}),ce(k)!=="svelte-7hh8jk"&&(k.textContent=$),p=T(de),h=I(de,"SPAN",{});var xe=A(h);y=fe(xe,w),xe.forEach(g),D=T(de),B=I(de,"SPAN",{"data-svelte-h":!0}),ce(B)!=="svelte-7hh8jk"&&(B.textContent=K),Z=T(de),R(ee.$$.fragment,de),se=T(de),re=I(de,"SPAN",{"data-svelte-h":!0}),ce(re)!=="svelte-7hh8jk"&&(re.textContent=P),X=T(de),R(q.$$.fragment,de),de.forEach(g),L=T(G),ne=I(G,"DIV",{class:!0});var be=A(ne);R(j.$$.fragment,be),z=T(be),x=I(be,"SPAN",{"data-svelte-h":!0}),ce(x)!=="svelte-7hh8jk"&&(x.textContent=W),ge=T(be),R(he.$$.fragment,be),Ve=T(be),Se=I(be,"SPAN",{"data-svelte-h":!0}),ce(Se)!=="svelte-7hh8jk"&&(Se.textContent=Ze),Je=T(be),R(Pe.$$.fragment,be),Xe=T(be),J&&J.l(be),be.forEach(g),ze=T(G),Fe=I(G,"DIV",{});var et=A(Fe);for(let qe=0;qe<te.length;qe+=1)te[qe].l(et);et.forEach(g),Ue=T(G),U=I(G,"DIV",{});var oe=A(U);Y=I(oe,"H3",{class:!0,"data-svelte-h":!0}),ce(Y)!=="svelte-kc6sae"&&(Y.textContent=Te),Ne=T(oe),ve.block.l(oe),oe.forEach(g),G.forEach(g),this.h()},h(){d(n,"class","preview svelte-1kekodt"),ke(n.src,t=l[2])||d(n,"src",t),d(n,"alt","preview"),d(r,"class","svelte-1kekodt"),d(m,"class","flex-row svelte-1kekodt"),d(ne,"class","flex-row svelte-1kekodt"),d(Y,"class","svelte-1kekodt"),d(e,"class","details svelte-1kekodt")},m(H,G){O(H,e,G),_(e,n),_(e,s),_(e,r),_(r,o),_(r,a),_(a,i),_(a,c),_(e,f),_(e,m),F(S,m,null),_(m,C),_(m,k),_(m,p),_(m,h),_(h,y),_(m,D),_(m,B),_(m,Z),F(ee,m,null),_(m,se),_(m,re),_(m,X),F(q,m,null),_(e,L),_(e,ne),F(j,ne,null),_(ne,z),_(ne,x),_(ne,ge),F(he,ne,null),_(ne,Ve),_(ne,Se),_(ne,Je),F(Pe,ne,null),_(ne,Xe),J&&J.m(ne,null),_(e,ze),_(e,Fe);for(let Ce=0;Ce<te.length;Ce+=1)te[Ce]&&te[Ce].m(Fe,null);_(e,Ue),_(e,U),_(U,Y),_(U,Ne),ve.block.m(U,ve.anchor=null),ve.mount=()=>U,ve.anchor=null,$e=!0},p(H,[G]){l=H,(!$e||G&4&&!ke(n.src,t=l[2]))&&d(n,"src",t),(!$e||G&1)&&u!==(u=l[0].id+"")&&Le(c,u);const Ce={};G&1&&(Ce.value=l[0].rating),S.$set(Ce),(!$e||G&1)&&w!==(w=l[0].type.toUpperCase()+"")&&Le(y,w);const Ge={};G&1&&(Ge.value=l[0].score),ee.$set(Ge);const de={};G&1&&(de.value=l[0].change),q.$set(de);const xe={};G&9&&(xe.url="/post?id="+l[0].id+"&src="+encodeURIComponent(l[3])),j.$set(xe);const be={};G&1&&(be.source="https://rule34.xxx/index.php?page=post&s=view&id="+l[0].id),he.$set(be);const et={};if(G&8&&(et.url=l[3]),Pe.$set(et),l[0].source?J?(J.p(l,G),G&1&&v(J,1)):(J=yt(l),J.c(),v(J,1),J.m(ne,null)):J&&(ie(),b(J,1,1,()=>{J=null}),ae()),G&2){ye=De(Object.entries(l[1]));let oe;for(oe=0;oe<ye.length;oe+=1){const qe=wt(l,ye,oe);te[oe]?(te[oe].p(qe,G),v(te[oe],1)):(te[oe]=Ct(qe),te[oe].c(),v(te[oe],1),te[oe].m(Fe,null))}for(ie(),oe=ye.length;oe<te.length;oe+=1)sn(oe);ae()}ve.ctx=l,G&1&&Ee!==(Ee=dt(l[0].id))&&mt(Ee,ve)||gn(ve,l,G)},i(H){if(!$e){v(S.$$.fragment,H),v(ee.$$.fragment,H),v(q.$$.fragment,H),v(j.$$.fragment,H),v(he.$$.fragment,H),v(Pe.$$.fragment,H),v(J);for(let G=0;G<ye.length;G+=1)v(te[G]);v(ve.block),$e=!0}},o(H){b(S.$$.fragment,H),b(ee.$$.fragment,H),b(q.$$.fragment,H),b(j.$$.fragment,H),b(he.$$.fragment,H),b(Pe.$$.fragment,H),b(J),te=te.filter(Boolean);for(let G=0;G<te.length;G+=1)b(te[G]);for(let G=0;G<3;G+=1){const Ce=ve.blocks[G];b(Ce)}$e=!1},d(H){H&&g(e),M(S),M(ee),M(q),M(j),M(he),M(Pe),J&&J.d(),Ye(te,H),ve.block.d(),ve.token=null,ve=null}}}function as(l,e,n){let t,s,r,o;le(l,at,i=>n(4,o=i));let{post:a}=e;return l.$$set=i=>{"post"in i&&n(0,a=i.post)},l.$$.update=()=>{l.$$.dirty&17&&n(3,t=Ae(a.file_url,o)),l.$$.dirty&17&&n(2,s=Ae(a.sample_url,o)),l.$$.dirty&1&&n(1,r=a.tags.reduce((i,u)=>(i[u.type]===void 0&&(i[u.type]=[]),i[u.type].push(u),i),{}))},[a,r,s,t,o]}class cs extends _e{constructor(e){super(),me(this,e,as,is,pe,{post:0})}}const He=new IntersectionObserver(l=>{for(const e of l)if(e.target){const n=e.target;e.isIntersecting&&n.autoplay&&n.paused&&n.play(),!e.isIntersecting&&!n.paused&&n.pause()}},{rootMargin:"-1px",threshold:.001});function us(l){const e=l.slice(),n=En(e[0].file_url,e[0].sample_url,e[0].preview_url);e[6]=n;const t=Ae(e[6].animated,e[2]);return e[7]=t,e}function fs(l){const e=l.slice(),n=Jt(e[0].file_url,e[0].sample_url,e[0].preview_url);e[6]=n;const t=Ae(e[6].animated,e[2]);e[7]=t;const s=Ae(e[6].static,e[2]);return e[8]=s,e}function ps(l){const e=l.slice(),n=Ae(e[0].sample_url,e[2]);return e[5]=n,e}function _s(l){let e,n,t,s;return{c(){e=E("img"),this.h()},l(r){e=I(r,"IMG",{src:!0,alt:!0,title:!0,class:!0}),this.h()},h(){ke(e.src,n=l[7])||d(e,"src",n),d(e,"alt",t="[GIF] post #"+l[0].id),d(e,"title",s="[GIF] post #"+l[0].id),d(e,"class","svelte-1cjgn2p")},m(r,o){O(r,e,o)},p(r,o){o&5&&!ke(e.src,n=r[7])&&d(e,"src",n),o&1&&t!==(t="[GIF] post #"+r[0].id)&&d(e,"alt",t),o&1&&s!==(s="[GIF] post #"+r[0].id)&&d(e,"title",s)},d(r){r&&g(e)}}}function Et(l){let e,n,t,s;return{c(){e=E("video"),this.h()},l(r){e=I(r,"VIDEO",{src:!0,poster:!0,title:!0,preload:!0,class:!0}),A(e).forEach(g),this.h()},h(){ke(e.src,n=l[7])||d(e,"src",n),d(e,"poster",t=l[8]),e.loop=!0,d(e,"title",s="[VIDEO] post #"+l[0].id),e.controls=!0,d(e,"preload","metadata"),e.autoplay=!0,d(e,"class","svelte-1cjgn2p")},m(r,o){O(r,e,o),l[3](e)},p(r,o){o&5&&!ke(e.src,n=r[7])&&d(e,"src",n),o&5&&t!==(t=r[8])&&d(e,"poster",t),o&1&&s!==(s="[VIDEO] post #"+r[0].id)&&d(e,"title",s)},d(r){r&&g(e),l[3](null)}}}function It(l){let e,n,t,s;return{c(){e=E("img"),this.h()},l(r){e=I(r,"IMG",{src:!0,alt:!0,title:!0,class:!0}),this.h()},h(){ke(e.src,n=l[5])||d(e,"src",n),d(e,"alt",t="[IMAGE] post #"+l[0].id),d(e,"title",s="[IMAGE] post #"+l[0].id),d(e,"class","svelte-1cjgn2p")},m(r,o){O(r,e,o)},p(r,o){o&5&&!ke(e.src,n=r[5])&&d(e,"src",n),o&1&&t!==(t="[IMAGE] post #"+r[0].id)&&d(e,"alt",t),o&1&&s!==(s="[IMAGE] post #"+r[0].id)&&d(e,"title",s)},d(r){r&&g(e)}}}function ms(l){let e;function n(o,a){return o[0].type==="image"?It:o[0].type==="video"?Et:_s}function t(o,a){return a===It?ps(o):a===Et?fs(o):us(o)}let s=n(l),r=s(t(l,s));return{c(){r.c(),e=we()},l(o){r.l(o),e=we()},m(o,a){r.m(o,a),O(o,e,a)},p(o,[a]){s===(s=n(o))&&r?r.p(t(o,s),a):(r.d(1),r=s(t(o,s)),r&&(r.c(),r.m(e.parentNode,e)))},i:Q,o:Q,d(o){o&&g(e),r.d(o)}}}function ds(l,e,n){let t;le(l,at,i=>n(2,t=i));let{post:s}=e,r;const o=i=>{s.type==="video"&&r&&(i.key==="ArrowLeft"&&(i.preventDefault(),i.stopPropagation(),n(1,r.currentTime=Math.max(0,r.currentTime-5),r)),i.key==="ArrowRight"&&(i.preventDefault(),i.stopPropagation(),n(1,r.currentTime=Math.min(r.duration,r.currentTime+5),r)))};ot(()=>{r&&(He==null||He.observe(r)),document.addEventListener("keydown",o)}),it(()=>{r&&(He==null||He.unobserve(r)),document.removeEventListener("keydown",o)});function a(i){Oe[i?"unshift":"push"](()=>{r=i,n(1,r)})}return l.$$set=i=>{"post"in i&&n(0,s=i.post)},[s,r,t,a]}class gs extends _e{constructor(e){super(),me(this,e,ds,ms,pe,{post:0})}}function hs(l){let e,n,t;return{c(){e=E("img"),this.h()},l(s){e=I(s,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){ke(e.src,n=l[2])||d(e,"src",n),d(e,"alt",t="post #"+l[0].id),d(e,"class","svelte-itxz72"),Be(e,"top",l[1])},m(s,r){O(s,e,r)},p(s,[r]){r&4&&!ke(e.src,n=s[2])&&d(e,"src",n),r&1&&t!==(t="post #"+s[0].id)&&d(e,"alt",t),r&2&&Be(e,"top",s[1])},i:Q,o:Q,d(s){s&&g(e)}}}function $s(l,e,n){let t,s;le(l,at,a=>n(3,s=a));let{post:r}=e,{offset:o}=e;return l.$$set=a=>{"post"in a&&n(0,r=a.post),"offset"in a&&n(1,o=a.offset)},l.$$.update=()=>{l.$$.dirty&9&&n(2,t=Ae(In(r.sample_url)?r.preview_url:r.sample_url,s))},[r,o,t,s]}class tn extends _e{constructor(e){super(),me(this,e,$s,hs,pe,{post:0,offset:1})}}function Dt(l,e,n){const t=l.slice();return t[17]=e[n],t[19]=n,t}function Pt(l){let e,n;return e=new tn({props:{post:l[3],offset:l[6]}}),{c(){V(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p(t,s){const r={};s&8&&(r.post=t[3]),s&64&&(r.offset=t[6]),e.$set(r)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function Nt(l){let e,n;return e=new tn({props:{post:l[4],offset:l[7]}}),{c(){V(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p(t,s){const r={};s&16&&(r.post=t[4]),s&128&&(r.offset=t[7]),e.$set(r)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function Tt(l){let e,n=`${l[19]*100}vh`;return{c(){e=E("div"),this.h()},l(t){e=I(t,"DIV",{class:!0}),A(e).forEach(g),this.h()},h(){d(e,"class","pseudo snap-item svelte-3khu3"),Be(e,"top",n)},m(t,s){O(t,e,s)},p:Q,d(t){t&&g(e)}}}function vs(l){let e,n,t,s,r,o,a,i,u,c,f,m,S,C=l[3]&&Pt(l);s=new gs({props:{post:l[2]}}),o=new cs({props:{post:l[2]}});let k=l[4]&&Nt(l),$=De({length:l[8].posts.length}),p=[];for(let h=0;h<$.length;h+=1)p[h]=Tt(Dt(l,$,h));return c=new en({props:{absoluteTop:l[8].posts.length*100+"vh",rootMargin:window.innerHeight*3+"px"}}),c.$on("intersection",l[13]),{c(){e=E("div"),C&&C.c(),n=N(),t=E("div"),V(s.$$.fragment),r=N(),V(o.$$.fragment),a=N(),k&&k.c(),i=N();for(let h=0;h<p.length;h+=1)p[h].c();u=N(),V(c.$$.fragment),this.h()},l(h){e=I(h,"DIV",{class:!0});var w=A(e);C&&C.l(w),n=T(w),t=I(w,"DIV",{class:!0});var y=A(t);R(s.$$.fragment,y),r=T(y),R(o.$$.fragment,y),y.forEach(g),a=T(w),k&&k.l(w),i=T(w);for(let D=0;D<p.length;D+=1)p[D].l(w);u=T(w),R(c.$$.fragment,w),w.forEach(g),this.h()},h(){d(t,"class","screen snap-container horizontal current svelte-3khu3"),Be(t,"top",l[5]),d(e,"class","root screen snap-container svelte-3khu3")},m(h,w){O(h,e,w),C&&C.m(e,null),_(e,n),_(e,t),F(s,t,null),_(t,r),F(o,t,null),l[12](t),_(e,a),k&&k.m(e,null),_(e,i);for(let y=0;y<p.length;y+=1)p[y]&&p[y].m(e,null);_(e,u),F(c,e,null),l[14](e),f=!0,m||(S=Ie(e,"scroll",l[10]),m=!0)},p(h,[w]){h[3]?C?(C.p(h,w),w&8&&v(C,1)):(C=Pt(h),C.c(),v(C,1),C.m(e,n)):C&&(ie(),b(C,1,1,()=>{C=null}),ae());const y={};w&4&&(y.post=h[2]),s.$set(y);const D={};if(w&4&&(D.post=h[2]),o.$set(D),w&32&&Be(t,"top",h[5]),h[4]?k?(k.p(h,w),w&16&&v(k,1)):(k=Nt(h),k.c(),v(k,1),k.m(e,i)):k&&(ie(),b(k,1,1,()=>{k=null}),ae()),w&256){$=De({length:h[8].posts.length});let K;for(K=0;K<$.length;K+=1){const Z=Dt(h,$,K);p[K]?p[K].p(Z,w):(p[K]=Tt(Z),p[K].c(),p[K].m(e,u))}for(;K<p.length;K+=1)p[K].d(1);p.length=$.length}const B={};w&256&&(B.absoluteTop=h[8].posts.length*100+"vh"),c.$set(B)},i(h){f||(v(C),v(s.$$.fragment,h),v(o.$$.fragment,h),v(k),v(c.$$.fragment,h),f=!0)},o(h){b(C),b(s.$$.fragment,h),b(o.$$.fragment,h),b(k),b(c.$$.fragment,h),f=!1},d(h){h&&g(e),C&&C.d(),M(s),M(o),l[12](null),k&&k.d(),Ye(p,h),M(c),l[14](null),m=!1,S()}}}function bs(l,e,n){let t;le(l,We,y=>n(8,t=y));let{index:s}=e,r,o,a=t.posts[s],i=s>0?t.posts[s-1]:void 0,u=s<t.posts.length-1?t.posts[s+1]:void 0,c=`${s*100}vh`,f=`${(s-1)*100}vh`,m=`${(s+1)*100}vh`;const S=Re(),C=()=>{o&&(o.scrollIntoView(),n(1,o.scrollLeft=0,o))},k=y=>{const D=y.target,B=D.getBoundingClientRect().height,K=D.scrollTop/B,Z=Math.round(K);Z!=s&&requestAnimationFrame(()=>{n(11,s=Z),n(2,a=t.posts[s]),n(3,i=s>0?t.posts[s-1]:void 0),n(4,u=s<t.posts.length-1?t.posts[s+1]:void 0),n(5,c=`${s*100}vh`),n(6,f=`${(s-1)*100}vh`),n(7,m=`${(s+1)*100}vh`),o&&n(1,o.scrollLeft=0,o)})},$=y=>{y.key==="d"&&(y.preventDefault(),y.stopPropagation(),o.scrollLeft===0?o.scrollBy({left:r.clientWidth,top:0,behavior:"smooth"}):o.scrollBy({left:-r.clientWidth,top:0,behavior:"smooth"})),y.key==="ArrowUp"&&(y.preventDefault(),y.stopPropagation(),r.scrollTo({left:0,top:r.clientHeight*(s-1),behavior:"smooth"})),y.key==="ArrowDown"&&(y.preventDefault(),y.stopPropagation(),r.scrollTo({left:0,top:r.clientHeight*(s+1),behavior:"smooth"}))};ot(()=>{document.addEventListener("keydown",$),C()}),it(()=>{document.removeEventListener("keydown",$)});function p(y){Oe[y?"unshift":"push"](()=>{o=y,n(1,o)})}const h=()=>{console.log("endreached"),S("endreached")};function w(y){Oe[y?"unshift":"push"](()=>{r=y,n(0,r)})}return l.$$set=y=>{"index"in y&&n(11,s=y.index)},window.innerHeight&&console.log(window.innerHeight*2,"height"),[r,o,a,i,u,c,f,m,t,S,k,s,p,h,w]}class ks extends _e{constructor(e){super(),me(this,e,bs,vs,pe,{index:11})}}function ws(l){let e;return{c(){e=E("i"),this.h()},l(n){e=I(n,"I",{class:!0}),A(e).forEach(g),this.h()},h(){d(e,"class","codicon codicon-close")},m(n,t){O(n,e,t)},p:Q,d(n){n&&g(e)}}}function ys(l){let e,n,t,s,r;function o(i){l[2](i)}let a={};return l[0]!==void 0&&(a.index=l[0]),e=new ks({props:a}),Oe.push(()=>nt(e,"index",o)),e.$on("endreached",l[3]),s=new Qt({props:{class:"button-close",$$slots:{default:[ws]},$$scope:{ctx:l}}}),s.$on("click",l[1]),{c(){V(e.$$.fragment),t=N(),V(s.$$.fragment)},l(i){R(e.$$.fragment,i),t=T(i),R(s.$$.fragment,i)},m(i,u){F(e,i,u),O(i,t,u),F(s,i,u),r=!0},p(i,u){const c={};!n&&u&1&&(n=!0,c.index=i[0],tt(()=>n=!1)),e.$set(c);const f={};u&128&&(f.$$scope={dirty:u,ctx:i}),s.$set(f)},i(i){r||(v(e.$$.fragment,i),v(s.$$.fragment,i),r=!0)},o(i){b(e.$$.fragment,i),b(s.$$.fragment,i),r=!1},d(i){i&&g(t),M(e,i),M(s,i)}}}function Cs(l){let e,n;return e=new xn({props:{$$slots:{default:[ys]},$$scope:{ctx:l}}}),e.$on("close",l[1]),{c(){V(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p(t,[s]){const r={};s&129&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function Ss(l,e,n){let{index:t}=e;const s=Re(),r=()=>{s("close",t)},o=c=>{c.key==="f"&&(c.preventDefault(),c.stopPropagation(),r())},a=()=>{var c,f;(((c=history.state)==null?void 0:c.fullscreen)===void 0||((f=history.state)==null?void 0:f.fullscreen)===!1)&&r()};ot(()=>{window.addEventListener("popstate",a),document.addEventListener("keydown",o)}),it(()=>{window.removeEventListener("popstate",a),document.removeEventListener("keydown",o)});function i(c){t=c,n(0,t)}function u(c){st.call(this,l,c)}return l.$$set=c=>{"index"in c&&n(0,t=c.index)},[t,r,i,u]}class Es extends _e{constructor(e){super(),me(this,e,Ss,Cs,pe,{index:0})}}function Ot(l){let e,n=l[0].type==="video"?"▶":"GIF",t;return{c(){e=E("span"),t=ue(n),this.h()},l(s){e=I(s,"SPAN",{class:!0});var r=A(e);t=fe(r,n),r.forEach(g),this.h()},h(){d(e,"class","type svelte-1213alg")},m(s,r){O(s,e,r),_(e,t)},p(s,r){r&1&&n!==(n=s[0].type==="video"?"▶":"GIF")&&Le(t,n)},d(s){s&&g(e)}}}function Is(l){let e,n,t,s,r,o=lt(l[0].score)+"",a,i,u,c,f,m=l[0].type!=="image"&&Ot(l);return{c(){e=E("div"),n=E("img"),s=N(),r=E("span"),a=ue(o),i=N(),m&&m.c(),this.h()},l(S){e=I(S,"DIV",{id:!0,class:!0,style:!0});var C=A(e);n=I(C,"IMG",{src:!0,alt:!0,class:!0,tabindex:!0,loading:!0}),s=T(C),r=I(C,"SPAN",{class:!0});var k=A(r);a=fe(k,o),k.forEach(g),i=T(C),m&&m.l(C),C.forEach(g),this.h()},h(){ke(n.src,t=l[1])||d(n,"src",t),d(n,"alt","post"),d(n,"class","post-media svelte-1213alg"),d(n,"tabindex","-1"),d(n,"loading","lazy"),d(r,"class","score svelte-1213alg"),d(e,"id",u=rt(l[0].id)),d(e,"class","post svelte-1213alg"),Be(e,"grid-row","span "+l[2]),ut(e,"open",open)},m(S,C){O(S,e,C),_(e,n),_(e,s),_(e,r),_(r,a),_(e,i),m&&m.m(e,null),c||(f=[Ie(e,"click",l[4]),Ie(e,"keydown",l[5])],c=!0)},p(S,[C]){C&2&&!ke(n.src,t=S[1])&&d(n,"src",t),C&1&&o!==(o=lt(S[0].score)+"")&&Le(a,o),S[0].type!=="image"?m?m.p(S,C):(m=Ot(S),m.c(),m.m(e,null)):m&&(m.d(1),m=null),C&1&&u!==(u=rt(S[0].id))&&d(e,"id",u),C&0&&ut(e,"open",open)},i:Q,o:Q,d(S){S&&g(e),m&&m.d(),c=!1,ft(f)}}}let At=3;function Ds(l,e,n){let t,s;le(l,at,c=>n(3,s=c));let{post:r}=e,o=Math.min(Math.round(r.height/r.width)*At,At*3);const a=c=>c.endsWith(".jpg")||c.endsWith(".jpeg")||c.endsWith(".png")||c.endsWith(".webp");function i(c){st.call(this,l,c)}const u=c=>{var f;(Xt(c)||c.key==="f")&&((f=c.target)==null||f.click())};return l.$$set=c=>{"post"in c&&n(0,r=c.post)},l.$$.update=()=>{l.$$.dirty&9&&n(1,t=Ae(a(r.sample_url)?r.sample_url:r.preview_url,s))},[r,t,o,s,i,u]}class Ps extends _e{constructor(e){super(),me(this,e,Ds,Is,pe,{post:0})}}function Ns(l){const e=l.slice(),n=Jt(e[1].file_url,e[1].sample_url,e[1].preview_url);e[8]=n;const t=Ae(e[8].animated,e[2]);e[9]=t;const s=Ae(e[8].static,e[2]);return e[10]=s,e}function Ts(l){let e,n;return e=new Pn({props:{post:l[1]}}),e.$on("click",l[5]),{c(){V(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p(t,s){const r={};s&2&&(r.post=t[1]),e.$set(r)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function Os(l){let e,n;return e=new Nn({props:{src:l[9],poster:l[10],width:l[1].width,height:l[1].height,loop:l[3]||gt(l[1].tags)}}),e.$on("click",l[5]),{c(){V(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p(t,s){const r={};s&6&&(r.src=t[9]),s&6&&(r.poster=t[10]),s&2&&(r.width=t[1].width),s&2&&(r.height=t[1].height),s&10&&(r.loop=t[3]||gt(t[1].tags)),e.$set(r)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function As(l){let e,n;return e=new Tn({props:{post:l[1],open:l[0]}}),e.$on("click",l[5]),{c(){V(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p(t,s){const r={};s&2&&(r.post=t[1]),s&1&&(r.open=t[0]),e.$set(r)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function Vs(l){let e;return{c(){e=E("i"),this.h()},l(n){e=I(n,"I",{class:!0}),A(e).forEach(g),this.h()},h(){d(e,"class","codicon codicon-screen-full")},m(n,t){O(n,e,t)},p:Q,d(n){n&&g(e)}}}function Vt(l){let e,n;return e=new Dn({props:{post:l[1]}}),{c(){V(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p(t,s){const r={};s&2&&(r.post=t[1]),e.$set(r)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function Rs(l){let e,n,t,s,r,o,a,i,u,c;const f=[As,Os,Ts],m=[];function S($,p){return $[1].type==="image"?0:$[1].type==="video"?1:2}function C($,p){return p===1?Ns($):$}n=S(l),t=m[n]=f[n](C(l,n)),r=new Qt({props:{class:"button-fullscreen","aria-label":"Enter Fullscreen mode",$$slots:{default:[Vs]},$$scope:{ctx:l}}}),r.$on("click",l[6]);let k=l[0]&&Vt(l);return{c(){e=E("div"),t.c(),s=N(),V(r.$$.fragment),o=N(),k&&k.c(),this.h()},l($){e=I($,"DIV",{id:!0,class:!0});var p=A(e);t.l(p),s=T(p),R(r.$$.fragment,p),o=T(p),k&&k.l(p),p.forEach(g),this.h()},h(){d(e,"id",a=rt(l[1].id)),d(e,"class","post svelte-pwgq1f"),ut(e,"open",l[0])},m($,p){O($,e,p),m[n].m(e,null),_(e,s),F(r,e,null),_(e,o),k&&k.m(e,null),i=!0,u||(c=Ie(e,"keydown",l[7]),u=!0)},p($,[p]){let h=n;n=S($),n===h?m[n].p(C($,n),p):(ie(),b(m[h],1,1,()=>{m[h]=null}),ae(),t=m[n],t?t.p(C($,n),p):(t=m[n]=f[n](C($,n)),t.c()),v(t,1),t.m(e,s));const w={};p&2048&&(w.$$scope={dirty:p,ctx:$}),r.$set(w),$[0]?k?(k.p($,p),p&1&&v(k,1)):(k=Vt($),k.c(),v(k,1),k.m(e,null)):k&&(ie(),b(k,1,1,()=>{k=null}),ae()),(!i||p&2&&a!==(a=rt($[1].id)))&&d(e,"id",a),(!i||p&1)&&ut(e,"open",$[0])},i($){i||(v(t),v(r.$$.fragment,$),v(k),i=!0)},o($){b(t),b(r.$$.fragment,$),b(k),i=!1},d($){$&&g(e),m[n].d(),M(r),k&&k.d(),u=!1,c()}}}function Fs(l,e,n){let t,s;le(l,at,f=>n(2,t=f)),le(l,On,f=>n(3,s=f));const r=Re(),o=()=>n(0,i=!i);let{post:a}=e,{open:i=!1}=e;const u=()=>r("fullscreen"),c=f=>{f.key==="f"&&r("fullscreen")};return l.$$set=f=>{"post"in f&&n(1,a=f.post),"open"in f&&n(0,i=f.open)},[i,a,t,s,r,o,u,c]}class Ms extends _e{constructor(e){super(),me(this,e,Fs,Rs,pe,{post:1,open:0})}}function Ls(l){let e;return{c(){e=ue("Done")},l(n){e=fe(n,"Done")},m(n,t){O(n,e,t)},d(n){n&&g(e)}}}function Bs(l){let e;return{c(){e=ue("Reset")},l(n){e=fe(n,"Reset")},m(n,t){O(n,e,t)},d(n){n&&g(e)}}}function js(l){let e,n,t="Sorting and Filtering",s,r,o,a="Sorting",i,u,c,f,m,S,C,k,$,p,h="Filtering by Score",w,y,D,B,K,Z,ee,se,re,P="Filtering by Rating",X,q,L,ne,j,z,x,W,ge,he,Ve;function Se(U){l[6](U)}let Ze={options:Gs};l[2].direction!==void 0&&(Ze.value=l[2].direction),c=new dn({props:Ze}),Oe.push(()=>nt(c,"value",Se));function Je(U){l[7](U)}let Pe={options:Us};l[2].property!==void 0&&(Pe.value=l[2].property),S=new ht({props:Pe}),Oe.push(()=>nt(S,"value",Je));function Xe(U){l[8](U)}let ze={options:qs};l[1].scoreComparator!==void 0&&(ze.value=l[1].scoreComparator),D=new Vn({props:ze}),Oe.push(()=>nt(D,"value",Xe));function Fe(U){l[10](U)}let Ue={options:nn};return l[1].rating!==void 0&&(Ue.value=l[1].rating),L=new ht({props:Ue}),Oe.push(()=>nt(L,"value",Fe)),z=new Qe({props:{title:"Return to searching.",$$slots:{default:[Ls]},$$scope:{ctx:l}}}),z.$on("click",l[11]),W=new Qe({props:{title:"Reset sort and filter.",type:"secondary",$$slots:{default:[Bs]},$$scope:{ctx:l}}}),W.$on("click",l[5]),{c(){e=E("div"),n=E("h3"),n.textContent=t,s=N(),r=E("div"),o=E("b"),o.textContent=a,i=N(),u=E("div"),V(c.$$.fragment),m=N(),V(S.$$.fragment),k=N(),$=E("div"),p=E("b"),p.textContent=h,w=N(),y=E("div"),V(D.$$.fragment),K=N(),Z=E("input"),ee=N(),se=E("div"),re=E("b"),re.textContent=P,X=N(),q=E("div"),V(L.$$.fragment),j=N(),V(z.$$.fragment),x=N(),V(W.$$.fragment),this.h()},l(U){e=I(U,"DIV",{class:!0});var Y=A(e);n=I(Y,"H3",{"data-svelte-h":!0}),ce(n)!=="svelte-15zouq3"&&(n.textContent=t),s=T(Y),r=I(Y,"DIV",{});var Te=A(r);o=I(Te,"B",{class:!0,"data-svelte-h":!0}),ce(o)!=="svelte-ekzpgg"&&(o.textContent=a),i=T(Te),u=I(Te,"DIV",{class:!0});var Ne=A(u);R(c.$$.fragment,Ne),m=T(Ne),R(S.$$.fragment,Ne),Ne.forEach(g),Te.forEach(g),k=T(Y),$=I(Y,"DIV",{});var Ee=A($);p=I(Ee,"B",{class:!0,"data-svelte-h":!0}),ce(p)!=="svelte-1flca3"&&(p.textContent=h),w=T(Ee),y=I(Ee,"DIV",{class:!0});var $e=A(y);R(D.$$.fragment,$e),K=T($e),Z=I($e,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),$e.forEach(g),Ee.forEach(g),ee=T(Y),se=I(Y,"DIV",{});var J=A(se);re=I(J,"B",{class:!0,"data-svelte-h":!0}),ce(re)!=="svelte-1evbw58"&&(re.textContent=P),X=T(J),q=I(J,"DIV",{class:!0});var ye=A(q);R(L.$$.fragment,ye),ye.forEach(g),J.forEach(g),j=T(Y),R(z.$$.fragment,Y),x=T(Y),R(W.$$.fragment,Y),Y.forEach(g),this.h()},h(){d(o,"class","svelte-kdg2ou"),d(u,"class","row svelte-kdg2ou"),d(p,"class","svelte-kdg2ou"),d(Z,"type","number"),d(Z,"min",0),d(Z,"max",1e5),d(Z,"step",1),d(Z,"class","svelte-kdg2ou"),d(y,"class","row svelte-kdg2ou"),d(re,"class","svelte-kdg2ou"),d(q,"class","row svelte-kdg2ou"),d(e,"class","container svelte-kdg2ou")},m(U,Y){O(U,e,Y),_(e,n),_(e,s),_(e,r),_(r,o),_(r,i),_(r,u),F(c,u,null),_(u,m),F(S,u,null),_(e,k),_(e,$),_($,p),_($,w),_($,y),F(D,y,null),_(y,K),_(y,Z),Ke(Z,l[0]),_(e,ee),_(e,se),_(se,re),_(se,X),_(se,q),F(L,q,null),_(e,j),F(z,e,null),_(e,x),F(W,e,null),ge=!0,he||(Ve=[Ie(Z,"input",l[9]),Ie(Z,"keyup",l[4])],he=!0)},p(U,Y){const Te={};!f&&Y&4&&(f=!0,Te.value=U[2].direction,tt(()=>f=!1)),c.$set(Te);const Ne={};!C&&Y&4&&(C=!0,Ne.value=U[2].property,tt(()=>C=!1)),S.$set(Ne);const Ee={};!B&&Y&2&&(B=!0,Ee.value=U[1].scoreComparator,tt(()=>B=!1)),D.$set(Ee),Y&1&&qt(Z.value)!==U[0]&&Ke(Z,U[0]);const $e={};!ne&&Y&2&&(ne=!0,$e.value=U[1].rating,tt(()=>ne=!1)),L.$set($e);const J={};Y&8192&&(J.$$scope={dirty:Y,ctx:U}),z.$set(J);const ye={};Y&8192&&(ye.$$scope={dirty:Y,ctx:U}),W.$set(ye)},i(U){ge||(v(c.$$.fragment,U),v(S.$$.fragment,U),v(D.$$.fragment,U),v(L.$$.fragment,U),v(z.$$.fragment,U),v(W.$$.fragment,U),ge=!0)},o(U){b(c.$$.fragment,U),b(S.$$.fragment,U),b(D.$$.fragment,U),b(L.$$.fragment,U),b(z.$$.fragment,U),b(W.$$.fragment,U),ge=!1},d(U){U&&g(e),M(c),M(S),M(D),M(L),M(z),M(W),he=!1,ft(Ve)}}}function zs(l){let e,n;return e=new Ht({props:{$$slots:{default:[js]},$$scope:{ctx:l}}}),e.$on("close",l[12]),{c(){V(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p(t,[s]){const r={};s&8199&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}const nn=Object.freeze({all:"All",safe:"Safe",questionable:"Questionable",explicit:"Explicit"}),Us=Object.freeze({id:"Uploaded",score:"Score",updated:"Updated",random:"Random"}),Gs=Object.freeze({desc:"codicon codicon-arrow-down",asc:"codicon codicon-arrow-up"}),qs=Object.freeze({">=":"≥","<=":"≤"});function Hs(l,e,n){let t,s;le(l,Me,$=>n(1,t=$)),le(l,je,$=>n(2,s=$));let r;const o=Re(),a=$=>{var p;return Xt($)&&((p=$.target)==null?void 0:p.blur())},i=()=>{je.reset(),Me.reset(),n(0,r=t.scoreValue)};function u($){l.$$.not_equal(s.direction,$)&&(s.direction=$,je.set(s))}function c($){l.$$.not_equal(s.property,$)&&(s.property=$,je.set(s))}function f($){l.$$.not_equal(t.scoreComparator,$)&&(t.scoreComparator=$,Me.set(t))}function m(){r=qt(this.value),n(0,r),n(1,t)}function S($){l.$$.not_equal(t.rating,$)&&(t.rating=$,Me.set(t))}const C=()=>o("close");function k($){st.call(this,l,$)}return l.$$.update=()=>{if(l.$$.dirty&3){r===void 0&&n(0,r=t.scoreValue);let $=Number(r);isNaN($)||un(Me,t.scoreValue=$,t)}},[r,t,s,o,a,i,u,c,f,m,S,C,k]}class Ks extends _e{constructor(e){super(),me(this,e,Hs,zs,pe,{})}}function Rt(l){let e,n;return e=new Ks({}),e.$on("close",l[4]),{c(){V(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p:Q,i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function Ws(l){let e,n,t,s,r,o,a,i,u,c,f,m,S,C,k,$=l[0]&&Rt(l);return{c(){e=E("button"),n=E("i"),t=N(),s=E("span"),r=ue(l[2]),o=N(),a=E("i"),i=N(),u=E("span"),c=ue(l[1]),f=N(),$&&$.c(),m=we(),this.h()},l(p){e=I(p,"BUTTON",{class:!0});var h=A(e);n=I(h,"I",{class:!0}),A(n).forEach(g),t=T(h),s=I(h,"SPAN",{});var w=A(s);r=fe(w,l[2]),w.forEach(g),o=T(h),a=I(h,"I",{class:!0}),A(a).forEach(g),i=T(h),u=I(h,"SPAN",{});var y=A(u);c=fe(y,l[1]),y.forEach(g),h.forEach(g),f=T(p),$&&$.l(p),m=we(),this.h()},h(){d(n,"class","codicon codicon-filter svelte-a4zz3f"),d(a,"class","codicon codicon-arrow-swap svelte-a4zz3f"),d(e,"class","svelte-a4zz3f")},m(p,h){O(p,e,h),_(e,n),_(e,t),_(e,s),_(s,r),_(e,o),_(e,a),_(e,i),_(e,u),_(u,c),O(p,f,h),$&&$.m(p,h),O(p,m,h),S=!0,C||(k=Ie(e,"click",l[3]),C=!0)},p(p,[h]){(!S||h&4)&&Le(r,p[2]),(!S||h&2)&&Le(c,p[1]),p[0]?$?($.p(p,h),h&1&&v($,1)):($=Rt(p),$.c(),v($,1),$.m(m.parentNode,m)):$&&(ie(),b($,1,1,()=>{$=null}),ae())},i(p){S||(v($),S=!0)},o(p){b($),S=!1},d(p){p&&(g(e),g(f),g(m)),$&&$.d(p),C=!1,k()}}}const Qs=Object.freeze({id:{asc:"Oldest",desc:"Newest"},score:{asc:"Worst",desc:"Best"},updated:{asc:"Inactive",desc:"Active"},random:{asc:"Random",desc:"Random"}}),Ys=(l,e,n)=>{let t=l==="all"?void 0:nn[l],s=e===0&&n===">="?void 0:`Score${n}${lt(e)}`;return[t,s].filter(r=>r!==void 0).join(",")||"All"};function Zs(l,e,n){let t,s,r,o;le(l,je,f=>n(5,r=f)),le(l,Me,f=>n(6,o=f));let a=!1;const i=Re(),u=()=>n(0,a=!0),c=()=>{n(0,a=!1),i("sortfilterupdate")};return l.$$.update=()=>{l.$$.dirty&64&&n(2,t=Ys(o.rating,o.scoreValue,o.scoreComparator)),l.$$.dirty&32&&n(1,s=Qs[r.property][r.direction])},[a,s,t,u,c,r,o]}class Js extends _e{constructor(e){super(),me(this,e,Zs,Ws,pe,{})}}function Ft(l,e,n){const t=l.slice();return t[8]=e[n],t[10]=n,t}function Mt(l,e,n){const t=l.slice();return t[8]=e[n],t[10]=n,t}function Xs(l){let e,n,t=De(l[1].posts),s=[];for(let o=0;o<t.length;o+=1)s[o]=Lt(Ft(l,t,o));const r=o=>b(s[o],1,1,()=>{s[o]=null});return{c(){e=E("section");for(let o=0;o<s.length;o+=1)s[o].c();this.h()},l(o){e=I(o,"SECTION",{class:!0,style:!0});var a=A(e);for(let i=0;i<s.length;i+=1)s[i].l(a);a.forEach(g),this.h()},h(){d(e,"class","multi-column svelte-wypqh"),Be(e,"grid-template-columns","repeat("+l[2]+", 1fr)")},m(o,a){O(o,e,a);for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(e,null);n=!0},p(o,a){if(a&3){t=De(o[1].posts);let i;for(i=0;i<t.length;i+=1){const u=Ft(o,t,i);s[i]?(s[i].p(u,a),v(s[i],1)):(s[i]=Lt(u),s[i].c(),v(s[i],1),s[i].m(e,null))}for(ie(),i=t.length;i<s.length;i+=1)r(i);ae()}(!n||a&4)&&Be(e,"grid-template-columns","repeat("+o[2]+", 1fr)")},i(o){if(!n){for(let a=0;a<t.length;a+=1)v(s[a]);n=!0}},o(o){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)b(s[a]);n=!1},d(o){o&&g(e),Ye(s,o)}}}function xs(l){let e,n,t=De(l[1].posts),s=[];for(let o=0;o<t.length;o+=1)s[o]=Bt(Mt(l,t,o));const r=o=>b(s[o],1,1,()=>{s[o]=null});return{c(){e=E("section");for(let o=0;o<s.length;o+=1)s[o].c();this.h()},l(o){e=I(o,"SECTION",{class:!0});var a=A(e);for(let i=0;i<s.length;i+=1)s[i].l(a);a.forEach(g),this.h()},h(){d(e,"class","single-column svelte-wypqh")},m(o,a){O(o,e,a);for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(e,null);n=!0},p(o,a){if(a&3){t=De(o[1].posts);let i;for(i=0;i<t.length;i+=1){const u=Mt(o,t,i);s[i]?(s[i].p(u,a),v(s[i],1)):(s[i]=Bt(u),s[i].c(),v(s[i],1),s[i].m(e,null))}for(ie(),i=t.length;i<s.length;i+=1)r(i);ae()}},i(o){if(!n){for(let a=0;a<t.length;a+=1)v(s[a]);n=!0}},o(o){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)b(s[a]);n=!1},d(o){o&&g(e),Ye(s,o)}}}function Lt(l){let e,n;function t(){return l[6](l[10])}return e=new Ps({props:{post:l[8]}}),e.$on("click",t),{c(){V(e.$$.fragment)},l(s){R(e.$$.fragment,s)},m(s,r){F(e,s,r),n=!0},p(s,r){l=s;const o={};r&2&&(o.post=l[8]),e.$set(o)},i(s){n||(v(e.$$.fragment,s),n=!0)},o(s){b(e.$$.fragment,s),n=!1},d(s){M(e,s)}}}function Bt(l){let e,n;function t(){return l[5](l[10])}return e=new Ms({props:{post:l[8]}}),e.$on("fullscreen",t),{c(){V(e.$$.fragment)},l(s){R(e.$$.fragment,s)},m(s,r){F(e,s,r),n=!0},p(s,r){l=s;const o={};r&2&&(o.post=l[8]),e.$set(o)},i(s){n||(v(e.$$.fragment,s),n=!0)},o(s){b(e.$$.fragment,s),n=!1},d(s){M(e,s)}}}function jt(l){let e,n;return e=new Es({props:{index:l[0]}}),e.$on("close",l[3]),e.$on("endreached",l[7]),{c(){V(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p(t,s){const r={};s&1&&(r.index=t[0]),e.$set(r)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function el(l){let e,n,t=lt(l[1].postCount)+"",s,r,o,a,i,u,c,f,m,S;a=new Js({}),a.$on("sortfilterupdate",l[4]);const C=[xs,Xs],k=[];function $(h,w){return h[2]==="1"?0:1}u=$(l),c=k[u]=C[u](l);let p=l[0]!==void 0&&jt(l);return{c(){e=E("div"),n=E("span"),s=ue(t),r=ue(" posts"),o=N(),V(a.$$.fragment),i=N(),c.c(),f=N(),p&&p.c(),m=we(),this.h()},l(h){e=I(h,"DIV",{class:!0});var w=A(e);n=I(w,"SPAN",{});var y=A(n);s=fe(y,t),r=fe(y," posts"),y.forEach(g),o=T(w),R(a.$$.fragment,w),w.forEach(g),i=T(h),c.l(h),f=T(h),p&&p.l(h),m=we(),this.h()},h(){d(e,"class","svelte-wypqh")},m(h,w){O(h,e,w),_(e,n),_(n,s),_(n,r),_(e,o),F(a,e,null),O(h,i,w),k[u].m(h,w),O(h,f,w),p&&p.m(h,w),O(h,m,w),S=!0},p(h,[w]){(!S||w&2)&&t!==(t=lt(h[1].postCount)+"")&&Le(s,t);let y=u;u=$(h),u===y?k[u].p(h,w):(ie(),b(k[y],1,1,()=>{k[y]=null}),ae(),c=k[u],c?c.p(h,w):(c=k[u]=C[u](h),c.c()),v(c,1),c.m(f.parentNode,f)),h[0]!==void 0?p?(p.p(h,w),w&1&&v(p,1)):(p=jt(h),p.c(),v(p,1),p.m(m.parentNode,m)):p&&(ie(),b(p,1,1,()=>{p=null}),ae())},i(h){S||(v(a.$$.fragment,h),v(c),v(p),S=!0)},o(h){b(a.$$.fragment,h),b(c),b(p),S=!1},d(h){h&&(g(e),g(i),g(f),g(m)),M(a),k[u].d(h),p&&p.d(h)}}}function tl(l,e,n){let t,s;le(l,We,f=>n(1,t=f)),le(l,Kt,f=>n(2,s=f));let r;const o=f=>{var C;const m=t.posts[f.detail],S=rt(m.id);(C=document.getElementById(S))==null||C.scrollIntoView(),n(0,r=void 0)};function a(f){st.call(this,l,f)}const i=f=>{n(0,r=f)},u=f=>{n(0,r=f)};function c(f){st.call(this,l,f)}return l.$$.update=()=>{var f;l.$$.dirty&1&&(r!==void 0?history.pushState({...history.state,fullscreen:!0},""):(f=history.state)!=null&&f.fullscreen&&history.back())},[r,t,s,o,a,i,u,c]}class nl extends _e{constructor(e){super(),me(this,e,tl,el,pe,{})}}function sl(l){let e;return{c(){e=ue("Reset Filter")},l(n){e=fe(n,"Reset Filter")},m(n,t){O(n,e,t)},d(n){n&&g(e)}}}function ll(l){let e,n,t,s,r="We couldn't find any posts matching your tags. Sorry...",o,a,i;return a=new Qe({props:{title:"In case your filter caused all posts to vanish. Reset it.",$$slots:{default:[sl]},$$scope:{ctx:l}}}),a.$on("click",l[1]),{c(){e=E("img"),t=N(),s=E("p"),s.textContent=r,o=N(),V(a.$$.fragment),this.h()},l(u){e=I(u,"IMG",{src:!0,alt:!0,class:!0}),t=T(u),s=I(u,"P",{"data-svelte-h":!0}),ce(s)!=="svelte-1utxj3w"&&(s.textContent=r),o=T(u),R(a.$$.fragment,u),this.h()},h(){ke(e.src,n=Wt+"/assets/shironeko-confused.png")||d(e,"src",n),d(e,"alt","Nothing here..."),d(e,"class","svelte-1bb5e7g")},m(u,c){O(u,e,c),O(u,t,c),O(u,s,c),O(u,o,c),F(a,u,c),i=!0},p(u,[c]){const f={};c&4&&(f.$$scope={dirty:c,ctx:u}),a.$set(f)},i(u){i||(v(a.$$.fragment,u),i=!0)},o(u){b(a.$$.fragment,u),i=!1},d(u){u&&(g(e),g(t),g(s),g(o)),M(a,u)}}}function rl(l){const e=Re();return[e,()=>{je.reset(),Me.reset(),e("sortfilterupdate")}]}class ol extends _e{constructor(e){super(),me(this,e,rl,ll,pe,{})}}function il(l){const e=l-1;return e*e*e+1}function al(l,{delay:e=0,duration:n=400,easing:t=il,x:s=0,y:r=0,opacity:o=0}={}){const a=getComputedStyle(l),i=+a.opacity,u=a.transform==="none"?"":a.transform,c=i*(1-o),[f,m]=_t(s),[S,C]=_t(r);return{delay:e,duration:n,easing:t,css:(k,$)=>`
			transform: ${u} translate(${(1-k)*f}${m}, ${(1-k)*S}${C});
			opacity: ${i-c*$}`}}function cl(l){let e;return{c(){e=ue("Ok")},l(n){e=fe(n,"Ok")},m(n,t){O(n,e,t)},d(n){n&&g(e)}}}function ul(l){let e,n,t="This site uses cookies",s,r,o,a;return r=new Qe({props:{title:"Accept cookies",$$slots:{default:[cl]},$$scope:{ctx:l}}}),r.$on("click",l[0]),{c(){e=E("div"),n=E("span"),n.textContent=t,s=N(),V(r.$$.fragment),this.h()},l(i){e=I(i,"DIV",{class:!0});var u=A(e);n=I(u,"SPAN",{"data-svelte-h":!0}),ce(n)!=="svelte-17tpe0c"&&(n.textContent=t),s=T(u),R(r.$$.fragment,u),u.forEach(g),this.h()},h(){d(e,"class","svelte-20j44m")},m(i,u){O(i,e,u),_(e,n),_(e,s),F(r,e,null),a=!0},p(i,[u]){const c={};u&2&&(c.$$scope={dirty:u,ctx:i}),r.$set(c)},i(i){a||(v(r.$$.fragment,i),o&&o.end(1),a=!0)},o(i){b(r.$$.fragment,i),i&&(o=fn(e,al,{y:200,duration:200})),a=!1},d(i){i&&g(e),M(r),i&&o&&o.end()}}}function fl(l){return[()=>xt.set(!0)]}class pl extends _e{constructor(e){super(),me(this,e,fl,ul,pe,{})}}function _l(l){let e;return{c(){e=ue("Search")},l(n){e=fe(n,"Search")},m(n,t){O(n,e,t)},i:Q,o:Q,d(n){n&&g(e)}}}function ml(l){let e,n;return e=new Yt({}),{c(){V(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function dl(l){let e,n,t,s;const r=[ml,_l],o=[];function a(i,u){return i[0]?0:1}return e=a(l),n=o[e]=r[e](l),{c(){n.c(),t=we()},l(i){n.l(i),t=we()},m(i,u){o[e].m(i,u),O(i,t,u),s=!0},p(i,u){let c=e;e=a(i),e!==c&&(ie(),b(o[c],1,1,()=>{o[c]=null}),ae(),n=o[e],n||(n=o[e]=r[e](i),n.c()),v(n,1),n.m(t.parentNode,t))},i(i){s||(v(n),s=!0)},o(i){b(n),s=!1},d(i){i&&g(t),o[e].d(i)}}}function gl(l){let e,n,t,s,r,o;const a=[vl,$l],i=[];function u(c,f){return c[3].postCount===0?0:1}return n=u(l),t=i[n]=a[n](l),r=new Fn({}),{c(){e=E("section"),t.c(),s=N(),V(r.$$.fragment),this.h()},l(c){e=I(c,"SECTION",{class:!0});var f=A(e);t.l(f),f.forEach(g),s=T(c),R(r.$$.fragment,c),this.h()},h(){d(e,"class","svelte-1muglpt")},m(c,f){O(c,e,f),i[n].m(e,null),O(c,s,f),F(r,c,f),o=!0},p(c,f){let m=n;n=u(c),n===m?i[n].p(c,f):(ie(),b(i[m],1,1,()=>{i[m]=null}),ae(),t=i[n],t?t.p(c,f):(t=i[n]=a[n](c),t.c()),v(t,1),t.m(e,null))},i(c){o||(v(t),v(r.$$.fragment,c),o=!0)},o(c){b(t),b(r.$$.fragment,c),o=!1},d(c){c&&(g(e),g(s)),i[n].d(),M(r,c)}}}function hl(l){let e,n;return e=new Wn({props:{error:l[1]}}),{c(){V(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p(t,s){const r={};s&2&&(r.error=t[1]),e.$set(r)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function $l(l){let e,n,t,s,r,o;e=new nl({}),e.$on("sortfilterupdate",l[10]),e.$on("endreached",l[11]);const a=[kl,bl],i=[];function u(c,f){return c[3].posts.length===c[3].postCount?0:1}return t=u(l),s=i[t]=a[t](l),{c(){V(e.$$.fragment),n=N(),s.c(),r=we()},l(c){R(e.$$.fragment,c),n=T(c),s.l(c),r=we()},m(c,f){F(e,c,f),O(c,n,f),i[t].m(c,f),O(c,r,f),o=!0},p(c,f){let m=t;t=u(c),t===m?i[t].p(c,f):(ie(),b(i[m],1,1,()=>{i[m]=null}),ae(),s=i[t],s?s.p(c,f):(s=i[t]=a[t](c),s.c()),v(s,1),s.m(r.parentNode,r))},i(c){o||(v(e.$$.fragment,c),v(s),o=!0)},o(c){b(e.$$.fragment,c),b(s),o=!1},d(c){c&&(g(n),g(r)),M(e,c),i[t].d(c)}}}function vl(l){let e,n;return e=new ol({}),e.$on("sortfilterupdate",l[10]),{c(){V(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p:Q,i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function bl(l){let e,n;return e=new en({props:{absoluteTop:void 0,rootMargin:1e3/Number(l[7])+"px"}}),e.$on("intersection",l[11]),{c(){V(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p(t,s){const r={};s&128&&(r.rootMargin=1e3/Number(t[7])+"px"),e.$set(r)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function kl(l){let e,n;return e=new Yn({}),{c(){V(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p:Q,i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function zt(l){let e,n;return e=new qn({props:{tags:l[5]}}),e.$on("close",l[16]),e.$on("submit",l[17]),{c(){V(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},p(t,s){const r={};s&32&&(r.tags=t[5]),e.$set(r)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function Ut(l){let e,n;return e=new pl({}),{c(){V(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,s){F(e,t,s),n=!0},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){b(e.$$.fragment,t),n=!1},d(t){M(e,t)}}}function wl(l){let e,n,t,s,r,o,a,i,u,c,f,m,S,C,k;n=new _n({}),s=new Rn({props:{placeholder:"Search for tags",fetchSuggestions:l[9]}}),s.$on("pick",l[12]),o=new Qe({props:{title:"Search with the tags above",$$slots:{default:[dl]},$$scope:{ctx:l}}}),o.$on("click",l[10]),i=new mn({props:{tags:[...l[5],...l[4]]}}),i.$on("click",l[13]),i.$on("contextmenu",l[14]),i.$on("createSupertag",l[15]);const $=[hl,gl],p=[];function h(D,B){return D[1]?0:D[3].requested?1:-1}~(c=h(l))&&(f=p[c]=$[c](l));let w=l[2]&&zt(l),y=!l[8]&&Ut();return{c(){e=E("section"),V(n.$$.fragment),t=N(),V(s.$$.fragment),r=N(),V(o.$$.fragment),a=N(),V(i.$$.fragment),u=N(),f&&f.c(),m=N(),w&&w.c(),S=N(),y&&y.c(),C=we(),this.h()},l(D){e=I(D,"SECTION",{id:!0,class:!0});var B=A(e);R(n.$$.fragment,B),t=T(B),R(s.$$.fragment,B),r=T(B),R(o.$$.fragment,B),a=T(B),R(i.$$.fragment,B),B.forEach(g),u=T(D),f&&f.l(D),m=T(D),w&&w.l(D),S=T(D),y&&y.l(D),C=we(),this.h()},h(){d(e,"id","search"),d(e,"class","svelte-1muglpt")},m(D,B){O(D,e,B),F(n,e,null),_(e,t),F(s,e,null),_(e,r),F(o,e,null),_(e,a),F(i,e,null),O(D,u,B),~c&&p[c].m(D,B),O(D,m,B),w&&w.m(D,B),O(D,S,B),y&&y.m(D,B),O(D,C,B),k=!0},p(D,[B]){const K={};B&33554433&&(K.$$scope={dirty:B,ctx:D}),o.$set(K);const Z={};B&48&&(Z.tags=[...D[5],...D[4]]),i.$set(Z);let ee=c;c=h(D),c===ee?~c&&p[c].p(D,B):(f&&(ie(),b(p[ee],1,1,()=>{p[ee]=null}),ae()),~c?(f=p[c],f?f.p(D,B):(f=p[c]=$[c](D),f.c()),v(f,1),f.m(m.parentNode,m)):f=null),D[2]?w?(w.p(D,B),B&4&&v(w,1)):(w=zt(D),w.c(),v(w,1),w.m(S.parentNode,S)):w&&(ie(),b(w,1,1,()=>{w=null}),ae()),D[8]?y&&(ie(),b(y,1,1,()=>{y=null}),ae()):y?B&256&&v(y,1):(y=Ut(),y.c(),v(y,1),y.m(C.parentNode,C))},i(D){k||(v(n.$$.fragment,D),v(s.$$.fragment,D),v(o.$$.fragment,D),v(i.$$.fragment,D),v(f),v(w),v(y),k=!0)},o(D){b(n.$$.fragment,D),b(s.$$.fragment,D),b(o.$$.fragment,D),b(i.$$.fragment,D),b(f),b(w),b(y),k=!1},d(D){D&&(g(e),g(u),g(m),g(S),g(C)),M(n),M(s),M(o),M(i),~c&&p[c].d(D),w&&w.d(D),y&&y.d(D)}}}function yl(l,e,n){let t,s,r,o,a,i,u,c,f;le(l,We,P=>n(3,t=P)),le(l,pt,P=>n(4,s=P)),le(l,Me,P=>n(19,r=P)),le(l,je,P=>n(20,o=P)),le(l,Bn,P=>n(21,a=P)),le(l,ct,P=>n(5,i=P)),le(l,$t,P=>n(6,u=P)),le(l,Kt,P=>n(7,c=P)),le(l,xt,P=>n(8,f=P));let m=!1,S,C=!1,k=0;const $=async P=>{const X=await hn(P);return[...u.items.filter(({name:L})=>L.toLowerCase().includes(P.toLowerCase())).map(L=>({label:L.name,count:L.tags.length,type:"supertag"})),...X]},p=()=>new An().withPid(t.pageCount).withTags(i).withBlockedContent(a).withSortProperty(o.property).withSortDirection(o.direction).withScoreValue(r.scoreValue).withScoreComparator(r.scoreComparator).withRating(r.rating).withSupertags(s),h=async P=>{if(!m){n(1,S=void 0),n(0,m=!0);try{const X=t.pageCount;await P(),Mn(X).catch(()=>{})}catch(X){n(1,S=X),console.warn(X)}finally{n(0,m=!1)}}},w=async()=>{We.reset(),k=0,h(async()=>{const[P,X]=await p().getPageAndCount();We.addPage(P,X)})},y=async()=>{h(async()=>{const P=await p().getPage();We.addPage(P)})},D=P=>{var X,q;if((P.key==="/"||P.key==="s")&&(!document.activeElement||document.activeElement===document.body)&&((X=document.getElementById("searchbar"))==null||X.focus(),P.preventDefault(),P.stopPropagation()),P.ctrlKey&&P.key==="Enter"&&(P.preventDefault(),P.stopPropagation(),w()),P.ctrlKey&&P.key==="m"&&((q=document.getElementById("select-modifier"))==null||q.click()),P.ctrlKey&&P.key==="ArrowDown"){const L=document.getElementsByClassName("post-media");L[k].focus(),k=Math.min(k+1,Math.max(0,L.length-1))}P.ctrlKey&&P.key==="ArrowUp"&&(document.getElementsByClassName("post-media")[k].focus(),k=Math.max(k-1,0))};return ot(async()=>{document.addEventListener("keydown",D)}),it(()=>{document.removeEventListener("keydown",D)}),[m,S,C,t,s,i,u,c,f,$,w,y,async P=>{const X=P.detail;if(X.type==="supertag"){const q=u.items.find(L=>L.name===X.label);if(!q){console.warn("Supertag not present.");return}pt.addOrReplace(q)}else{const q=await $n(P.detail.label);ct.addOrReplace({name:P.detail.label,modifier:P.detail.modifier,count:P.detail.count,type:(q==null?void 0:q.type)??"tag"})}},P=>"description"in P.detail?pt.removeByName(P.detail.name):ct.removeByName(P.detail.name),P=>{"description"in P.detail||(P.detail.modifier=Ln(P.detail.modifier),ct.addOrReplace(P.detail))},()=>n(2,C=!0),()=>n(2,C=!1),P=>$t.add(P.detail)]}class Zl extends _e{constructor(e){super(),me(this,e,yl,wl,pe,{})}}export{Zl as component};
