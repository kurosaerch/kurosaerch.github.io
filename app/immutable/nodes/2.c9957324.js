import{s as oe,f as C,a as T,g as I,c as O,y as ue,D as pe,j as v,i as N,d,E as _e,l as te,m as se,e as me,h as L,u as y,F as le,n as Te,C as fe,G as kt,p as ke,H as we,I as Re,J as ft,K as Ae,L as Se,v as W,k as Fe,M as qe,w as yt,N as wt,z as St,A as Et,B as Ct,o as Be,O as Me,P as ze,r as pt}from"../chunks/scheduler.88299003.js";import{S as ae,i as ie,b as A,d as B,m as M,a as w,t as S,e as U,g as x,c as ee,f as Ve}from"../chunks/index.15b414ac.js";import{s as ce,r as Ne,K as It,A as Pt,a as Ue,S as Dt}from"../chunks/search-builder.8a812114.js";import{a as De}from"../chunks/posts.e71a7ea5.js";import{S as Nt,n as Tt,s as Ze}from"../chunks/supertags-store.d82b2789.js";import{T as Oe}from"../chunks/TextButton.2f318c50.js";import{g as Ot,a as Lt}from"../chunks/tags.58927cde.js";import{b as mt}from"../chunks/paths.c5914f4a.js";import{e as Ee}from"../chunks/each.e59479a4.js";import{D as Ge,r as Rt}from"../chunks/Dialog.105383f8.js";import{i as _t,D as dt,g as Vt,G as gt,V as jt,I as At}from"../chunks/Details.e1f7c82b.js";import{f as Le}from"../chunks/format-tag.d6c065e3.js";import{R as Bt,I as je}from"../chunks/ModifierSelect.623aacd6.js";import{S as Je}from"../chunks/Select.22805bc7.js";import{R as Mt}from"../chunks/RotatingTextSelect.7e32facf.js";import{b as Ut}from"../chunks/blocked-content-store.db35eae7.js";import{D as Ft}from"../chunks/DetailedTag.28ff9b0d.js";import{S as qt}from"../chunks/ScrollUpButton.cfa21b3f.js";import{l as zt}from"../chunks/analytics.eca95ce1.js";import{H as Gt}from"../chunks/Heading3.581258ce.js";function Ht(n){let e;return{c(){e=te("Reset Filter")},l(s){e=se(s,"Reset Filter")},m(s,t){N(s,e,t)},d(s){s&&d(e)}}}function Kt(n){let e,s,t,r,l="We couldn't find any posts matching your tags. Sorry...",o,a,i;return a=new Oe({props:{title:"In case your filter caused all posts to vanish. Reset it.",$$slots:{default:[Ht]},$$scope:{ctx:n}}}),a.$on("click",n[1]),{c(){e=C("img"),t=T(),r=C("p"),r.textContent=l,o=T(),A(a.$$.fragment),this.h()},l(f){e=I(f,"IMG",{src:!0,alt:!0,class:!0}),t=O(f),r=I(f,"P",{"data-svelte-h":!0}),ue(r)!=="svelte-1utxj3w"&&(r.textContent=l),o=O(f),B(a.$$.fragment,f),this.h()},h(){pe(e.src,s=mt+"/assets/shironeko-confused.png")||v(e,"src",s),v(e,"alt","Nothing here..."),v(e,"class","svelte-1bb5e7g")},m(f,u){N(f,e,u),N(f,t,u),N(f,r,u),N(f,o,u),M(a,f,u),i=!0},p(f,[u]){const p={};u&4&&(p.$$scope={dirty:u,ctx:f}),a.$set(p)},i(f){i||(w(a.$$.fragment,f),i=!0)},o(f){S(a.$$.fragment,f),i=!1},d(f){f&&(d(e),d(t),d(r),d(o)),U(a,f)}}}function Wt(n){const e=_e();return[e,()=>{ce.reset(),e("sortfilterupdate")}]}class Yt extends ae{constructor(e){super(),ie(this,e,Wt,Kt,oe,{})}}function Qe(n){let e,s;return e=new Ge({props:{$$slots:{default:[Qt]},$$scope:{ctx:n}}}),e.$on("close",n[6]),{c(){A(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,r){M(e,t,r),s=!0},p(t,r){const l={};r&32771&&(l.$$scope={dirty:r,ctx:t}),e.$set(l)},i(t){s||(w(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){U(e,t)}}}function Zt(n){let e;return{c(){e=te("Done")},l(s){e=se(s,"Done")},m(s,t){N(s,e,t)},d(s){s&&d(e)}}}function Jt(n){let e;return{c(){e=te("Reset")},l(s){e=se(s,"Reset")},m(s,t){N(s,e,t)},d(s){s&&d(e)}}}function Qt(n){let e,s,t="Sorting and Filtering",r,l,o,a="Sorting",i,f,u,p,m,b,$,k,g,_,c="Filtering by Score",h,D,E,j,Z,H,X,Y,ne,de="Filtering by Rating",P,z,R,Q,F,V,J,G,re,ye,Ce;function Ie(q){n[8](q)}let He={options:es};n[1].sortDirection!==void 0&&(He.value=n[1].sortDirection),u=new Bt({props:He}),ke.push(()=>Ve(u,"value",Ie));function $t(q){n[9](q)}let Ke={options:xt};n[1].sortProperty!==void 0&&(Ke.value=n[1].sortProperty),b=new Je({props:Ke}),ke.push(()=>Ve(b,"value",$t));function vt(q){n[10](q)}let We={options:ts};n[1].scoreComparator!==void 0&&(We.value=n[1].scoreComparator),E=new Mt({props:We}),ke.push(()=>Ve(E,"value",vt));function bt(q){n[13](q)}let Ye={options:ht};return n[1].rating!==void 0&&(Ye.value=n[1].rating),R=new Je({props:Ye}),ke.push(()=>Ve(R,"value",bt)),V=new Oe({props:{title:"Return to searching.",$$slots:{default:[Zt]},$$scope:{ctx:n}}}),V.$on("click",n[6]),G=new Oe({props:{title:"Reset sort and filter.",type:"secondary",$$slots:{default:[Jt]},$$scope:{ctx:n}}}),G.$on("click",n[7]),{c(){e=C("div"),s=C("h3"),s.textContent=t,r=T(),l=C("label"),o=C("b"),o.textContent=a,i=T(),f=C("div"),A(u.$$.fragment),m=T(),A(b.$$.fragment),k=T(),g=C("label"),_=C("b"),_.textContent=c,h=T(),D=C("div"),A(E.$$.fragment),Z=T(),H=C("input"),X=T(),Y=C("label"),ne=C("b"),ne.textContent=de,P=T(),z=C("div"),A(R.$$.fragment),F=T(),A(V.$$.fragment),J=T(),A(G.$$.fragment),this.h()},l(q){e=I(q,"DIV",{class:!0});var K=L(e);s=I(K,"H3",{"data-svelte-h":!0}),ue(s)!=="svelte-15zouq3"&&(s.textContent=t),r=O(K),l=I(K,"LABEL",{class:!0});var ge=L(l);o=I(ge,"B",{"data-svelte-h":!0}),ue(o)!=="svelte-ekzpgg"&&(o.textContent=a),i=O(ge),f=I(ge,"DIV",{class:!0});var he=L(f);B(u.$$.fragment,he),m=O(he),B(b.$$.fragment,he),he.forEach(d),ge.forEach(d),k=O(K),g=I(K,"LABEL",{class:!0});var $e=L(g);_=I($e,"B",{"data-svelte-h":!0}),ue(_)!=="svelte-1flca3"&&(_.textContent=c),h=O($e),D=I($e,"DIV",{class:!0});var ve=L(D);B(E.$$.fragment,ve),Z=O(ve),H=I(ve,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),ve.forEach(d),$e.forEach(d),X=O(K),Y=I(K,"LABEL",{class:!0});var be=L(Y);ne=I(be,"B",{"data-svelte-h":!0}),ue(ne)!=="svelte-1evbw58"&&(ne.textContent=de),P=O(be),z=I(be,"DIV",{class:!0});var Pe=L(z);B(R.$$.fragment,Pe),Pe.forEach(d),be.forEach(d),F=O(K),B(V.$$.fragment,K),J=O(K),B(G.$$.fragment,K),K.forEach(d),this.h()},h(){v(f,"class","row svelte-1omoy36"),v(l,"class","svelte-1omoy36"),v(H,"type","number"),v(H,"min",0),v(H,"max",1e5),v(H,"step",1),v(H,"class","svelte-1omoy36"),v(D,"class","row svelte-1omoy36"),v(g,"class","svelte-1omoy36"),v(z,"class","row svelte-1omoy36"),v(Y,"class","svelte-1omoy36"),v(e,"class","container svelte-1omoy36")},m(q,K){N(q,e,K),y(e,s),y(e,r),y(e,l),y(l,o),y(l,i),y(l,f),M(u,f,null),y(f,m),M(b,f,null),y(e,k),y(e,g),y(g,_),y(g,h),y(g,D),M(E,D,null),y(D,Z),y(D,H),we(H,n[0]),y(e,X),y(e,Y),y(Y,ne),y(Y,P),y(Y,z),M(R,z,null),y(e,F),M(V,e,null),y(e,J),M(G,e,null),re=!0,ye||(Ce=[le(H,"input",n[11]),le(H,"keyup",n[12])],ye=!0)},p(q,K){const ge={};!p&&K&2&&(p=!0,ge.value=q[1].sortDirection,Re(()=>p=!1)),u.$set(ge);const he={};!$&&K&2&&($=!0,he.value=q[1].sortProperty,Re(()=>$=!1)),b.$set(he);const $e={};!j&&K&2&&(j=!0,$e.value=q[1].scoreComparator,Re(()=>j=!1)),E.$set($e),K&1&&ft(H.value)!==q[0]&&we(H,q[0]);const ve={};!Q&&K&2&&(Q=!0,ve.value=q[1].rating,Re(()=>Q=!1)),R.$set(ve);const be={};K&32768&&(be.$$scope={dirty:K,ctx:q}),V.$set(be);const Pe={};K&32768&&(Pe.$$scope={dirty:K,ctx:q}),G.$set(Pe)},i(q){re||(w(u.$$.fragment,q),w(b.$$.fragment,q),w(E.$$.fragment,q),w(R.$$.fragment,q),w(V.$$.fragment,q),w(G.$$.fragment,q),re=!0)},o(q){S(u.$$.fragment,q),S(b.$$.fragment,q),S(E.$$.fragment,q),S(R.$$.fragment,q),S(V.$$.fragment,q),S(G.$$.fragment,q),re=!1},d(q){q&&d(e),U(u),U(b),U(E),U(R),U(V),U(G),ye=!1,Ae(Ce)}}}function Xt(n){let e,s,t,r,l,o,a,i,f,u,p,m,b,$,k,g=n[2]&&Qe(n);return{c(){e=C("button"),s=C("i"),t=T(),r=C("span"),l=te(n[4]),o=T(),a=C("i"),i=T(),f=C("span"),u=te(n[3]),p=T(),g&&g.c(),m=me(),this.h()},l(_){e=I(_,"BUTTON",{class:!0});var c=L(e);s=I(c,"I",{class:!0}),L(s).forEach(d),t=O(c),r=I(c,"SPAN",{});var h=L(r);l=se(h,n[4]),h.forEach(d),o=O(c),a=I(c,"I",{class:!0}),L(a).forEach(d),i=O(c),f=I(c,"SPAN",{});var D=L(f);u=se(D,n[3]),D.forEach(d),c.forEach(d),p=O(_),g&&g.l(_),m=me(),this.h()},h(){v(s,"class","codicon codicon-filter svelte-1omoy36"),v(a,"class","codicon codicon-arrow-swap svelte-1omoy36"),v(e,"class","svelte-1omoy36")},m(_,c){N(_,e,c),y(e,s),y(e,t),y(e,r),y(r,l),y(e,o),y(e,a),y(e,i),y(e,f),y(f,u),N(_,p,c),g&&g.m(_,c),N(_,m,c),b=!0,$||(k=le(e,"click",n[5]),$=!0)},p(_,[c]){(!b||c&16)&&Te(l,_[4]),(!b||c&8)&&Te(u,_[3]),_[2]?g?(g.p(_,c),c&4&&w(g,1)):(g=Qe(_),g.c(),w(g,1),g.m(m.parentNode,m)):g&&(x(),S(g,1,1,()=>{g=null}),ee())},i(_){b||(w(g),b=!0)},o(_){S(g),b=!1},d(_){_&&(d(e),d(p),d(m)),g&&g.d(_),$=!1,k()}}}const xt=Object.freeze({id:"Uploaded",score:"Score",updated:"Updated"}),es=Object.freeze({desc:"codicon codicon-arrow-down",asc:"codicon codicon-arrow-up"}),ts=Object.freeze({">=":"≥","<=":"≤"}),ht=Object.freeze({all:"All",safe:"Safe",questionable:"Questionable",explicit:"Explicit"}),ss=Object.freeze({id:{asc:"Oldest",desc:"Newest"},score:{asc:"Worst",desc:"Best"},updated:{asc:"Inactive",desc:"Active"}}),ns=(n,e,s)=>{let t=n==="all"?void 0:ht[n],r=e===0&&s===">="?void 0:`Score${s}${Le(e)}`;return[t,r].filter(l=>l!==void 0).join(",")||"All"};function rs(n,e,s){let t,r,l;fe(n,ce,c=>s(1,l=c));const o=_e();let a=!1;const i=()=>s(2,a=!0),f=()=>{s(2,a=!1),o("sortfilterupdate")},u=()=>{ce.reset(),s(0,p=l.scoreValue)};let p;function m(c){n.$$.not_equal(l.sortDirection,c)&&(l.sortDirection=c,ce.set(l))}function b(c){n.$$.not_equal(l.sortProperty,c)&&(l.sortProperty=c,ce.set(l))}function $(c){n.$$.not_equal(l.scoreComparator,c)&&(l.scoreComparator=c,ce.set(l))}function k(){p=ft(this.value),s(0,p),s(1,l)}const g=c=>_t(c)&&c.target.blur();function _(c){n.$$.not_equal(l.rating,c)&&(l.rating=c,ce.set(l))}return n.$$.update=()=>{if(n.$$.dirty&3){p===void 0&&s(0,p=l.scoreValue);let c=Number(p);isNaN(c)||kt(ce,l.scoreValue=c,l)}n.$$.dirty&2&&s(4,t=ns(l.rating,l.scoreValue,l.scoreComparator)),n.$$.dirty&2&&s(3,r=ss[l.sortProperty][l.sortDirection])},[p,l,a,r,t,i,f,u,m,b,$,k,g,_]}class ls extends ae{constructor(e){super(),ie(this,e,rs,Xt,oe,{})}}function os(n){const e=n.slice(),s=Vt(e[1].file_url,e[1].sample_url,e[1].preview_url);return e[6]=s,e}function as(n){let e,s;return e=new gt({props:{post:n[1]}}),e.$on("click",n[3]),{c(){A(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,r){M(e,t,r),s=!0},p(t,r){const l={};r&2&&(l.post=t[1]),e.$set(l)},i(t){s||(w(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){U(e,t)}}}function is(n){let e,s;return e=new jt({props:{src:n[6].animated,poster:n[6].static,width:n[1].width,height:n[1].height,loop:n[1].tags.some(xe)}}),e.$on("click",n[3]),{c(){A(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,r){M(e,t,r),s=!0},p(t,r){const l={};r&2&&(l.src=t[6].animated),r&2&&(l.poster=t[6].static),r&2&&(l.width=t[1].width),r&2&&(l.height=t[1].height),r&2&&(l.loop=t[1].tags.some(xe)),e.$set(l)},i(t){s||(w(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){U(e,t)}}}function cs(n){let e,s;return e=new At({props:{post:n[1],open:n[0]}}),e.$on("click",n[3]),{c(){A(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,r){M(e,t,r),s=!0},p(t,r){const l={};r&2&&(l.post=t[1]),r&1&&(l.open=t[0]),e.$set(l)},i(t){s||(w(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){U(e,t)}}}function us(n){let e;return{c(){e=C("i"),this.h()},l(s){e=I(s,"I",{class:!0}),L(e).forEach(d),this.h()},h(){v(e,"class","codicon codicon-screen-full")},m(s,t){N(s,e,t)},p:W,d(s){s&&d(e)}}}function Xe(n){let e,s;return e=new dt({props:{post:n[1]}}),{c(){A(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,r){M(e,t,r),s=!0},p(t,r){const l={};r&2&&(l.post=t[1]),e.$set(l)},i(t){s||(w(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){U(e,t)}}}function fs(n){let e,s,t,r,l,o,a,i,f,u;const p=[cs,is,as],m=[];function b(g,_){return g[1].type==="image"?0:g[1].type==="video"?1:2}function $(g,_){return _===1?os(g):g}s=b(n),t=m[s]=p[s]($(n,s)),l=new je({props:{class:"button-fullscreen","aria-label":"Enter Fullscreen mode",$$slots:{default:[us]},$$scope:{ctx:n}}}),l.$on("click",n[4]);let k=n[0]&&Xe(n);return{c(){e=C("div"),t.c(),r=T(),A(l.$$.fragment),o=T(),k&&k.c(),this.h()},l(g){e=I(g,"DIV",{id:!0,class:!0});var _=L(e);t.l(_),r=O(_),B(l.$$.fragment,_),o=O(_),k&&k.l(_),_.forEach(d),this.h()},h(){v(e,"id",a="post_"+n[1].id),v(e,"class","post svelte-pwgq1f"),Se(e,"open",n[0])},m(g,_){N(g,e,_),m[s].m(e,null),y(e,r),M(l,e,null),y(e,o),k&&k.m(e,null),i=!0,f||(u=le(e,"keydown",n[5]),f=!0)},p(g,[_]){let c=s;s=b(g),s===c?m[s].p($(g,s),_):(x(),S(m[c],1,1,()=>{m[c]=null}),ee(),t=m[s],t?t.p($(g,s),_):(t=m[s]=p[s]($(g,s)),t.c()),w(t,1),t.m(e,r));const h={};_&128&&(h.$$scope={dirty:_,ctx:g}),l.$set(h),g[0]?k?(k.p(g,_),_&1&&w(k,1)):(k=Xe(g),k.c(),w(k,1),k.m(e,null)):k&&(x(),S(k,1,1,()=>{k=null}),ee()),(!i||_&2&&a!==(a="post_"+g[1].id))&&v(e,"id",a),(!i||_&1)&&Se(e,"open",g[0])},i(g){i||(w(t),w(l.$$.fragment,g),w(k),i=!0)},o(g){S(t),S(l.$$.fragment,g),S(k),i=!1},d(g){g&&d(e),m[s].d(),U(l),k&&k.d(),f=!1,u()}}}const xe=n=>n.name==="loop";function ps(n,e,s){const t=_e(),r=()=>s(0,o=!o);let{post:l}=e,{open:o=!1}=e;const a=()=>t("fullscreen"),i=f=>{f.key==="f"&&t("fullscreen")};return n.$$set=f=>{"post"in f&&s(1,l=f.post),"open"in f&&s(0,o=f.open)},[o,l,t,r,a,i]}class ms extends ae{constructor(e){super(),ie(this,e,ps,fs,oe,{post:1,open:0})}}function et(n){let e,s=n[0].type==="video"?"▶":"GIF",t;return{c(){e=C("span"),t=te(s),this.h()},l(r){e=I(r,"SPAN",{class:!0});var l=L(e);t=se(l,s),l.forEach(d),this.h()},h(){v(e,"class","type svelte-14imjnt")},m(r,l){N(r,e,l),y(e,t)},p(r,l){l&1&&s!==(s=r[0].type==="video"?"▶":"GIF")&&Te(t,s)},d(r){r&&d(e)}}}function _s(n){let e,s,t,r,l,o=Le(n[0].score)+"",a,i,f,u,p,m=n[0].type!=="image"&&et(n);return{c(){e=C("div"),s=C("img"),r=T(),l=C("span"),a=te(o),i=T(),m&&m.c(),this.h()},l(b){e=I(b,"DIV",{id:!0,class:!0,style:!0});var $=L(e);s=I($,"IMG",{src:!0,alt:!0,class:!0,tabindex:!0,loading:!0}),r=O($),l=I($,"SPAN",{class:!0});var k=L(l);a=se(k,o),k.forEach(d),i=O($),m&&m.l($),$.forEach(d),this.h()},h(){pe(s.src,t=n[1])||v(s,"src",t),v(s,"alt","post"),v(s,"class","post-media svelte-14imjnt"),v(s,"tabindex","-1"),v(s,"loading","lazy"),v(l,"class","score svelte-14imjnt"),v(e,"id",f="post_"+n[0].id),v(e,"class","post svelte-14imjnt"),Fe(e,"grid-row","span "+n[2]),Se(e,"open",open)},m(b,$){N(b,e,$),y(e,s),y(e,r),y(e,l),y(l,a),y(e,i),m&&m.m(e,null),u||(p=[le(e,"click",n[3]),le(e,"keydown",n[4])],u=!0)},p(b,[$]){$&2&&!pe(s.src,t=b[1])&&v(s,"src",t),$&1&&o!==(o=Le(b[0].score)+"")&&Te(a,o),b[0].type!=="image"?m?m.p(b,$):(m=et(b),m.c(),m.m(e,null)):m&&(m.d(1),m=null),$&1&&f!==(f="post_"+b[0].id)&&v(e,"id",f),$&0&&Se(e,"open",open)},i:W,o:W,d(b){b&&d(e),m&&m.d(),u=!1,Ae(p)}}}function ds(n,e,s){let t,{post:r}=e,l=Math.min(Math.round(r.height/r.width*5),15);const o=f=>f.endsWith(".jpg")||f.endsWith(".jpeg")||f.endsWith(".png")||f.endsWith(".webp");function a(f){qe.call(this,n,f)}const i=f=>{var u;(_t(f)||f.key==="f")&&((u=f.target)==null||u.click())};return n.$$set=f=>{"post"in f&&s(0,r=f.post)},n.$$.update=()=>{n.$$.dirty&1&&s(1,t=o(r.sample_url)?r.sample_url:r.preview_url)},[r,t,l,a,i]}class gs extends ae{constructor(e){super(),ie(this,e,ds,_s,oe,{post:0})}}function hs(n){let e,s,t,r;const l=n[3].default,o=yt(l,n,n[2],null);return{c(){e=C("div"),o&&o.c(),this.h()},l(a){e=I(a,"DIV",{role:!0,tabindex:!0,class:!0});var i=L(e);o&&o.l(i),i.forEach(d),this.h()},h(){v(e,"role","none"),v(e,"tabindex","-1"),v(e,"class","dialog fullscreen svelte-1j44awz")},m(a,i){N(a,e,i),o&&o.m(e,null),n[5](e),s=!0,t||(r=[le(e,"keydown",n[4]),le(e,"click",wt($s))],t=!0)},p(a,[i]){o&&o.p&&(!s||i&4)&&St(o,l,a,a[2],s?Ct(l,a[2],i,null):Et(a[2]),null)},i(a){s||(w(o,a),s=!0)},o(a){S(o,a),s=!1},d(a){a&&d(e),o&&o.d(a),n[5](null),t=!1,Ae(r)}}}const $s=()=>{};function vs(n,e,s){let{$$slots:t={},$$scope:r}=e;const l=_e(),o=()=>l("close"),a=m=>{m.key==="Escape"&&o()};let i=()=>{document.fullscreenElement||o()},f;Be(async()=>{f.focus(),document.addEventListener("keydown",a),document.addEventListener("fullscreenchange",i);try{await f.requestFullscreen()}catch{}}),Me(async()=>{document.removeEventListener("keydown",a),document.removeEventListener("fullscreenchange",i);try{await document.exitFullscreen()}catch{}});const u=m=>{m.code==="Escape"&&o()};function p(m){ke[m?"unshift":"push"](()=>{f=m,s(0,f)})}return n.$$set=m=>{"$$scope"in m&&s(2,r=m.$$scope)},[f,o,r,t,u,p]}class bs extends ae{constructor(e){super(),ie(this,e,vs,hs,oe,{})}}function ks(n){let e,s;return e=new gt({props:{post:n[0]}}),{c(){A(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,r){M(e,t,r),s=!0},p(t,r){const l={};r&1&&(l.post=t[0]),e.$set(l)},i(t){s||(w(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){U(e,t)}}}function ys(n){let e,s;return{c(){e=C("video"),this.h()},l(t){e=I(t,"VIDEO",{class:!0,src:!0}),L(e).forEach(d),this.h()},h(){v(e,"class","post-media svelte-12glt11"),pe(e.src,s=n[0].file_url)||v(e,"src",s),e.controls=!0},m(t,r){N(t,e,r),n[5](e)},p(t,r){r&1&&!pe(e.src,s=t[0].file_url)&&v(e,"src",s)},i:W,o:W,d(t){t&&d(e),n[5](null)}}}function ws(n){let e,s,t,r,l;return{c(){e=C("img"),this.h()},l(o){e=I(o,"IMG",{class:!0,src:!0,alt:!0}),this.h()},h(){v(e,"class","post-media svelte-12glt11"),pe(e.src,s=n[0].file_url)||v(e,"src",s),v(e,"alt",t="Image of Post "+n[0].id),Se(e,"zoomed",n[1])},m(o,a){N(o,e,a),r||(l=le(e,"click",n[4]),r=!0)},p(o,a){a&1&&!pe(e.src,s=o[0].file_url)&&v(e,"src",s),a&1&&t!==(t="Image of Post "+o[0].id)&&v(e,"alt",t),a&2&&Se(e,"zoomed",o[1])},i:W,o:W,d(o){o&&d(e),r=!1,l()}}}function Ss(n){let e;return{c(){e=C("i"),this.h()},l(s){e=I(s,"I",{class:!0}),L(e).forEach(d),this.h()},h(){v(e,"class","codicon codicon-close")},m(s,t){N(s,e,t)},p:W,d(s){s&&d(e)}}}function Es(n){let e;return{c(){e=C("i"),this.h()},l(s){e=I(s,"I",{class:!0}),L(e).forEach(d),this.h()},h(){v(e,"class","codicon codicon-chevron-left")},m(s,t){N(s,e,t)},p:W,d(s){s&&d(e)}}}function Cs(n){let e;return{c(){e=C("i"),this.h()},l(s){e=I(s,"I",{class:!0}),L(e).forEach(d),this.h()},h(){v(e,"class","codicon codicon-chevron-right")},m(s,t){N(s,e,t)},p:W,d(s){s&&d(e)}}}function Is(n){let e,s,t,r,l,o,a,i,f,u,p,m,b,$;const k=[ws,ys,ks],g=[];function _(c,h){return c[0].type==="image"?0:c[0].type==="video"?1:2}return s=_(n),t=g[s]=k[s](n),a=new dt({props:{post:n[0]}}),f=new je({props:{class:"button-close",$$slots:{default:[Ss]},$$scope:{ctx:n}}}),f.$on("click",n[6]),p=new je({props:{class:"button-previous",$$slots:{default:[Es]},$$scope:{ctx:n}}}),p.$on("click",n[7]),b=new je({props:{class:"button-next",$$slots:{default:[Cs]},$$scope:{ctx:n}}}),b.$on("click",n[8]),{c(){e=C("div"),t.c(),r=T(),l=C("i"),o=T(),A(a.$$.fragment),i=T(),A(f.$$.fragment),u=T(),A(p.$$.fragment),m=T(),A(b.$$.fragment),this.h()},l(c){e=I(c,"DIV",{class:!0});var h=L(e);t.l(h),r=O(h),l=I(h,"I",{class:!0}),L(l).forEach(d),h.forEach(d),o=O(c),B(a.$$.fragment,c),i=O(c),B(f.$$.fragment,c),u=O(c),B(p.$$.fragment,c),m=O(c),B(b.$$.fragment,c),this.h()},h(){v(l,"class","codicon codicon-chevron-down svelte-12glt11"),v(e,"class","svelte-12glt11")},m(c,h){N(c,e,h),g[s].m(e,null),y(e,r),y(e,l),N(c,o,h),M(a,c,h),N(c,i,h),M(f,c,h),N(c,u,h),M(p,c,h),N(c,m,h),M(b,c,h),$=!0},p(c,h){let D=s;s=_(c),s===D?g[s].p(c,h):(x(),S(g[D],1,1,()=>{g[D]=null}),ee(),t=g[s],t?t.p(c,h):(t=g[s]=k[s](c),t.c()),w(t,1),t.m(e,r));const E={};h&1&&(E.post=c[0]),a.$set(E);const j={};h&2048&&(j.$$scope={dirty:h,ctx:c}),f.$set(j);const Z={};h&2048&&(Z.$$scope={dirty:h,ctx:c}),p.$set(Z);const H={};h&2048&&(H.$$scope={dirty:h,ctx:c}),b.$set(H)},i(c){$||(w(t),w(a.$$.fragment,c),w(f.$$.fragment,c),w(p.$$.fragment,c),w(b.$$.fragment,c),$=!0)},o(c){S(t),S(a.$$.fragment,c),S(f.$$.fragment,c),S(p.$$.fragment,c),S(b.$$.fragment,c),$=!1},d(c){c&&(d(e),d(o),d(i),d(u),d(m)),g[s].d(),U(a,c),U(f,c),U(p,c),U(b,c)}}}function Ps(n){let e,s;return e=new bs({props:{$$slots:{default:[Is]},$$scope:{ctx:n}}}),e.$on("close",n[9]),{c(){A(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,r){M(e,t,r),s=!0},p(t,[r]){const l={};r&2055&&(l.$$scope={dirty:r,ctx:t}),e.$set(l)},i(t){s||(w(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){U(e,t)}}}function Ds(n,e,s){const t=_e(),r=$=>{if($.key==="f"&&($.preventDefault(),$.stopPropagation(),t("close")),$.key==="ArrowLeft"&&($.preventDefault(),$.stopPropagation(),t("previous")),$.key==="ArrowRight"&&($.preventDefault(),$.stopPropagation(),t("next")),$.key===" "||$.key==="k"){$.preventDefault(),$.stopPropagation(),a&&(a.paused?a.play():a.pause());const k=document.querySelector(".fullscreen.circle");k&&k.click()}a&&($.key==="j"?s(2,a.currentTime=Math.max(0,a.currentTime-5),a):$.key==="l"&&s(2,a.currentTime=Math.min(a.duration,a.currentTime+5),a))};let{post:l}=e,o=l.width/l.height<.33,a;Be(()=>{document.addEventListener("keydown",r)}),Me(()=>document.removeEventListener("keydown",r));const i=()=>s(1,o=!o);function f($){ke[$?"unshift":"push"](()=>{a=$,s(2,a)})}const u=()=>t("close"),p=()=>t("previous"),m=()=>t("next");function b($){qe.call(this,n,$)}return n.$$set=$=>{"post"in $&&s(0,l=$.post)},[l,o,a,t,i,f,u,p,m,b]}class Ns extends ae{constructor(e){super(),ie(this,e,Ds,Ps,oe,{post:0})}}function tt(n,e,s){const t=n.slice();return t[12]=e[s],t[14]=s,t}function st(n,e,s){const t=n.slice();return t[12]=e[s],t[14]=s,t}function Ts(n){let e,s,t=Ee(n[2].posts),r=[];for(let o=0;o<t.length;o+=1)r[o]=nt(tt(n,t,o));const l=o=>S(r[o],1,1,()=>{r[o]=null});return{c(){e=C("section");for(let o=0;o<r.length;o+=1)r[o].c();this.h()},l(o){e=I(o,"SECTION",{class:!0,style:!0});var a=L(e);for(let i=0;i<r.length;i+=1)r[i].l(a);a.forEach(d),this.h()},h(){v(e,"class","multi svelte-q6spg0"),Fe(e,"grid-template-columns","repeat("+n[3]+", 1fr)")},m(o,a){N(o,e,a);for(let i=0;i<r.length;i+=1)r[i]&&r[i].m(e,null);s=!0},p(o,a){if(a&5){t=Ee(o[2].posts);let i;for(i=0;i<t.length;i+=1){const f=tt(o,t,i);r[i]?(r[i].p(f,a),w(r[i],1)):(r[i]=nt(f),r[i].c(),w(r[i],1),r[i].m(e,null))}for(x(),i=t.length;i<r.length;i+=1)l(i);ee()}(!s||a&8)&&Fe(e,"grid-template-columns","repeat("+o[3]+", 1fr)")},i(o){if(!s){for(let a=0;a<t.length;a+=1)w(r[a]);s=!0}},o(o){r=r.filter(Boolean);for(let a=0;a<r.length;a+=1)S(r[a]);s=!1},d(o){o&&d(e),ze(r,o)}}}function Os(n){let e,s,t=Ee(n[2].posts),r=[];for(let o=0;o<t.length;o+=1)r[o]=rt(st(n,t,o));const l=o=>S(r[o],1,1,()=>{r[o]=null});return{c(){e=C("section");for(let o=0;o<r.length;o+=1)r[o].c();this.h()},l(o){e=I(o,"SECTION",{class:!0});var a=L(e);for(let i=0;i<r.length;i+=1)r[i].l(a);a.forEach(d),this.h()},h(){v(e,"class","single svelte-q6spg0")},m(o,a){N(o,e,a);for(let i=0;i<r.length;i+=1)r[i]&&r[i].m(e,null);s=!0},p(o,a){if(a&5){t=Ee(o[2].posts);let i;for(i=0;i<t.length;i+=1){const f=st(o,t,i);r[i]?(r[i].p(f,a),w(r[i],1)):(r[i]=rt(f),r[i].c(),w(r[i],1),r[i].m(e,null))}for(x(),i=t.length;i<r.length;i+=1)l(i);ee()}},i(o){if(!s){for(let a=0;a<t.length;a+=1)w(r[a]);s=!0}},o(o){r=r.filter(Boolean);for(let a=0;a<r.length;a+=1)S(r[a]);s=!1},d(o){o&&d(e),ze(r,o)}}}function nt(n){let e,s;function t(){return n[7](n[12],n[14])}return e=new gs({props:{post:n[12]}}),e.$on("click",t),{c(){A(e.$$.fragment)},l(r){B(e.$$.fragment,r)},m(r,l){M(e,r,l),s=!0},p(r,l){n=r;const o={};l&4&&(o.post=n[12]),e.$set(o)},i(r){s||(w(e.$$.fragment,r),s=!0)},o(r){S(e.$$.fragment,r),s=!1},d(r){U(e,r)}}}function rt(n){let e,s;function t(){return n[6](n[12],n[14])}return e=new ms({props:{post:n[12]}}),e.$on("fullscreen",t),{c(){A(e.$$.fragment)},l(r){B(e.$$.fragment,r)},m(r,l){M(e,r,l),s=!0},p(r,l){n=r;const o={};l&4&&(o.post=n[12]),e.$set(o)},i(r){s||(w(e.$$.fragment,r),s=!0)},o(r){S(e.$$.fragment,r),s=!1},d(r){U(e,r)}}}function lt(n){let e,s;return e=new Ns({props:{post:n[0].post}}),e.$on("close",n[8]),e.$on("previous",n[9]),e.$on("next",n[10]),{c(){A(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,r){M(e,t,r),s=!0},p(t,r){const l={};r&1&&(l.post=t[0].post),e.$set(l)},i(t){s||(w(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){U(e,t)}}}function Ls(n){let e,s,t=Le(n[2].postCount)+"",r,l,o,a,i,f,u,p,m,b;a=new ls({}),a.$on("sortfilterupdate",n[5]);const $=[Os,Ts],k=[];function g(c,h){return c[3]==="1"?0:1}f=g(n),u=k[f]=$[f](n);let _=n[1]&&n[0]!==void 0&&lt(n);return{c(){e=C("div"),s=C("span"),r=te(t),l=te(" posts"),o=T(),A(a.$$.fragment),i=T(),u.c(),p=T(),_&&_.c(),m=me(),this.h()},l(c){e=I(c,"DIV",{class:!0});var h=L(e);s=I(h,"SPAN",{});var D=L(s);r=se(D,t),l=se(D," posts"),D.forEach(d),o=O(h),B(a.$$.fragment,h),h.forEach(d),i=O(c),u.l(c),p=O(c),_&&_.l(c),m=me(),this.h()},h(){v(e,"class","svelte-q6spg0")},m(c,h){N(c,e,h),y(e,s),y(s,r),y(s,l),y(e,o),M(a,e,null),N(c,i,h),k[f].m(c,h),N(c,p,h),_&&_.m(c,h),N(c,m,h),b=!0},p(c,[h]){(!b||h&4)&&t!==(t=Le(c[2].postCount)+"")&&Te(r,t);let D=f;f=g(c),f===D?k[f].p(c,h):(x(),S(k[D],1,1,()=>{k[D]=null}),ee(),u=k[f],u?u.p(c,h):(u=k[f]=$[f](c),u.c()),w(u,1),u.m(p.parentNode,p)),c[1]&&c[0]!==void 0?_?(_.p(c,h),h&3&&w(_,1)):(_=lt(c),_.c(),w(_,1),_.m(m.parentNode,m)):_&&(x(),S(_,1,1,()=>{_=null}),ee())},i(c){b||(w(a.$$.fragment,c),w(u),w(_),b=!0)},o(c){S(a.$$.fragment,c),S(u),S(_),b=!1},d(c){c&&(d(e),d(i),d(p),d(m)),U(a),k[f].d(c),_&&_.d(c)}}}function Rs(n,e,s){let t,r;fe(n,Ne,k=>s(2,t=k)),fe(n,Rt,k=>s(3,r=k));const l=_e(),o=()=>{s(1,i=location.hash.length>2)};let a,i=location.hash.length>2;Be(()=>{window.addEventListener("hashchange",o)}),Me(()=>{window.removeEventListener("hashchange",o)});function f(k){qe.call(this,n,k)}return[a,i,t,r,l,f,(k,g)=>{s(0,a={post:k,index:g}),location.hash="fullscreen"},(k,g)=>{s(0,a={post:k,index:g}),location.hash="fullscreen"},()=>{var k,g;(k=a==null?void 0:a.post)!=null&&k.id&&((g=document.querySelector(`#post_${a.post.id} .post-media`))==null||g.focus()),s(0,a=void 0),history.back()},()=>{let k=Math.max(a.index-1,0);s(0,a={index:k,post:t.posts[k]})},()=>{let k=Math.min(a.index+1,t.posts.length);s(0,a={index:k,post:t.posts[k]}),k>t.posts.length-3&&t.posts.length!==t.postCount&&l("endreached")}]}class Vs extends ae{constructor(e){super(),ie(this,e,Rs,Ls,oe,{})}}function js(n){let e;return{c(){e=C("div")},l(s){e=I(s,"DIV",{}),L(e).forEach(d)},m(s,t){N(s,e,t),n[2](e)},p:W,i:W,o:W,d(s){s&&d(e),n[2](null)}}}function As(n,e,s){let{rootMargin:t}=e;const r=_e(),l=new IntersectionObserver(i=>{i[0].isIntersecting&&r("intersection")},{rootMargin:t});let o;function a(i){ke[i?"unshift":"push"](()=>{o=i,s(0,o)})}return n.$$set=i=>{"rootMargin"in i&&s(1,t=i.rootMargin)},n.$$.update=()=>{n.$$.dirty&1&&(l.disconnect(),o&&l.observe(o))},[o,t,a]}class Bs extends ae{constructor(e){super(),ie(this,e,As,js,oe,{rootMargin:1})}}function Ms(n){let e,s,t,r,l="You have seen everything there is to see...";return{c(){e=C("img"),t=T(),r=C("p"),r.textContent=l,this.h()},l(o){e=I(o,"IMG",{src:!0,alt:!0,class:!0}),t=O(o),r=I(o,"P",{"data-svelte-h":!0}),ue(r)!=="svelte-1i75mtf"&&(r.textContent=l),this.h()},h(){pe(e.src,s=mt+"/assets/shironeko-x.png")||v(e,"src",s),v(e,"alt","No more results to load"),v(e,"class","svelte-1pkma0d")},m(o,a){N(o,e,a),N(o,t,a),N(o,r,a)},p:W,i:W,o:W,d(o){o&&(d(e),d(t),d(r))}}}class Us extends ae{constructor(e){super(),ie(this,e,null,Ms,oe,{})}}function ot(n,e,s){const t=n.slice();return t[9]=e[s],t}function at(n){let e,s;return e=new Ft({props:{tag:n[9]}}),{c(){A(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,r){M(e,t,r),s=!0},p(t,r){const l={};r&4&&(l.tag=t[9]),e.$set(l)},i(t){s||(w(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){U(e,t)}}}function Fs(n){let e;return{c(){e=te("Create supertag")},l(s){e=se(s,"Create supertag")},m(s,t){N(s,e,t)},d(s){s&&d(e)}}}function qs(n){let e,s,t="Create Supertag",r,l,o,a,i,f="Name",u,p,m,b,$,k="Description",g,_,c,h,D,E="Tags",j,Z,H,X,Y,ne,de,P,z=Ee(n[2]),R=[];for(let F=0;F<z.length;F+=1)R[F]=at(ot(n,z,F));const Q=F=>S(R[F],1,1,()=>{R[F]=null});return Y=new Oe({props:{title:n[3]?"Click to create supertag":"Enter a valid name to continue",disabled:!n[3],$$slots:{default:[Fs]},$$scope:{ctx:n}}}),Y.$on("click",n[8]),{c(){e=C("section"),s=C("h3"),s.textContent=t,r=T(),l=C("button"),o=T(),a=C("div"),i=C("label"),i.textContent=f,u=T(),p=C("input"),m=T(),b=C("div"),$=C("label"),$.textContent=k,g=T(),_=C("input"),c=T(),h=C("div"),D=C("span"),D.textContent=E,j=T(),Z=C("ol");for(let F=0;F<R.length;F+=1)R[F].c();H=T(),X=C("div"),A(Y.$$.fragment),this.h()},l(F){e=I(F,"SECTION",{class:!0});var V=L(e);s=I(V,"H3",{"data-svelte-h":!0}),ue(s)!=="svelte-ho1cwx"&&(s.textContent=t),r=O(V),l=I(V,"BUTTON",{class:!0}),L(l).forEach(d),o=O(V),a=I(V,"DIV",{class:!0});var J=L(a);i=I(J,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),ue(i)!=="svelte-10k8a68"&&(i.textContent=f),u=O(J),p=I(J,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),J.forEach(d),m=O(V),b=I(V,"DIV",{class:!0});var G=L(b);$=I(G,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),ue($)!=="svelte-14n9kp6"&&($.textContent=k),g=O(G),_=I(G,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),G.forEach(d),c=O(V),h=I(V,"DIV",{class:!0});var re=L(h);D=I(re,"SPAN",{class:!0,"data-svelte-h":!0}),ue(D)!=="svelte-7hjyox"&&(D.textContent=E),j=O(re),Z=I(re,"OL",{class:!0});var ye=L(Z);for(let Ie=0;Ie<R.length;Ie+=1)R[Ie].l(ye);ye.forEach(d),re.forEach(d),H=O(V),X=I(V,"DIV",{class:!0});var Ce=L(X);B(Y.$$.fragment,Ce),Ce.forEach(d),V.forEach(d),this.h()},h(){v(l,"class",pt("codicon codicon-close")+" svelte-xkjm86"),v(i,"for","supertag-name"),v(i,"class","svelte-xkjm86"),v(p,"type","text"),v(p,"placeholder","Descriptive name"),v(p,"id","supertag-name"),v(p,"class","svelte-xkjm86"),v(a,"class","svelte-xkjm86"),v($,"for","supertag-description"),v($,"class","svelte-xkjm86"),v(_,"type","text"),v(_,"placeholder","Short description"),v(_,"id","supertag-description"),v(_,"class","svelte-xkjm86"),v(b,"class","svelte-xkjm86"),v(D,"class","svelte-xkjm86"),v(Z,"class","svelte-xkjm86"),v(h,"class","svelte-xkjm86"),v(X,"class","last svelte-xkjm86"),v(e,"class","svelte-xkjm86")},m(F,V){N(F,e,V),y(e,s),y(e,r),y(e,l),y(e,o),y(e,a),y(a,i),y(a,u),y(a,p),we(p,n[0]),y(e,m),y(e,b),y(b,$),y(b,g),y(b,_),we(_,n[1]),y(e,c),y(e,h),y(h,D),y(h,j),y(h,Z);for(let J=0;J<R.length;J+=1)R[J]&&R[J].m(Z,null);y(e,H),y(e,X),M(Y,X,null),ne=!0,de||(P=[le(l,"click",n[5]),le(p,"input",n[6]),le(_,"input",n[7])],de=!0)},p(F,V){if(V&1&&p.value!==F[0]&&we(p,F[0]),V&2&&_.value!==F[1]&&we(_,F[1]),V&4){z=Ee(F[2]);let G;for(G=0;G<z.length;G+=1){const re=ot(F,z,G);R[G]?(R[G].p(re,V),w(R[G],1)):(R[G]=at(re),R[G].c(),w(R[G],1),R[G].m(Z,null))}for(x(),G=z.length;G<R.length;G+=1)Q(G);ee()}const J={};V&8&&(J.title=F[3]?"Click to create supertag":"Enter a valid name to continue"),V&8&&(J.disabled=!F[3]),V&4096&&(J.$$scope={dirty:V,ctx:F}),Y.$set(J)},i(F){if(!ne){for(let V=0;V<z.length;V+=1)w(R[V]);w(Y.$$.fragment,F),ne=!0}},o(F){R=R.filter(Boolean);for(let V=0;V<R.length;V+=1)S(R[V]);S(Y.$$.fragment,F),ne=!1},d(F){F&&d(e),ze(R,F),U(Y),de=!1,Ae(P)}}}function zs(n){let e,s;return e=new Ge({props:{$$slots:{default:[qs]},$$scope:{ctx:n}}}),e.$on("close",n[5]),{c(){A(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,r){M(e,t,r),s=!0},p(t,[r]){const l={};r&4111&&(l.$$scope={dirty:r,ctx:t}),e.$set(l)},i(t){s||(w(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){U(e,t)}}}function Gs(n,e,s){let t,{name:r=""}=e,{description:l=""}=e,{tags:o}=e;const a=_e(),i=()=>a("close");function f(){r=this.value,s(0,r)}function u(){l=this.value,s(1,l)}const p=()=>{a("submit",{name:r,description:l,tags:o.map(({modifier:m,name:b})=>({modifier:m,name:b}))}),i()};return n.$$set=m=>{"name"in m&&s(0,r=m.name),"description"in m&&s(1,l=m.description),"tags"in m&&s(2,o=m.tags)},n.$$.update=()=>{n.$$.dirty&5&&s(3,t=typeof r=="string"&&r!==""&&o.length>1)},[r,l,o,t,a,i,f,u,p]}class Hs extends ae{constructor(e){super(),ie(this,e,Gs,zs,oe,{name:0,description:1,tags:2})}}function Ks(n){let e,s,t,r,l,o,a,i,f,u;return{c(){e=C("div"),s=C("div"),t=C("i"),r=T(),l=C("div"),o=C("h3"),a=te(n[0]),i=T(),f=C("span"),u=te(n[2]),this.h()},l(p){e=I(p,"DIV",{class:!0});var m=L(e);s=I(m,"DIV",{class:!0});var b=L(s);t=I(b,"I",{class:!0}),L(t).forEach(d),b.forEach(d),r=O(m),l=I(m,"DIV",{});var $=L(l);o=I($,"H3",{class:!0});var k=L(o);a=se(k,n[0]),k.forEach(d),i=O($),f=I($,"SPAN",{});var g=L(f);u=se(g,n[2]),g.forEach(d),$.forEach(d),m.forEach(d),this.h()},h(){v(t,"class",pt(n[1])+" svelte-1tvgln1"),v(s,"class","icon svelte-1tvgln1"),v(o,"class","svelte-1tvgln1"),v(e,"class","error svelte-1tvgln1")},m(p,m){N(p,e,m),y(e,s),y(s,t),y(e,r),y(e,l),y(l,o),y(o,a),y(l,i),y(l,f),y(f,u)},p:W,i:W,o:W,d(p){p&&d(e)}}}function Ws(n,e,s){let{error:t}=e,r=t.message==="Failed to fetch"?"Connection Error":"Application Error",l=t.message==="Failed to fetch"?"codicon codicon-debug-disconnect":"codicon codicon-error",o=t.message==="Failed to fetch"?"Failed to connect to the server. Make sure you have a stable internet connection.":t.message;return n.$$set=a=>{"error"in a&&s(3,t=a.error)},[r,l,o,t]}class Ys extends ae{constructor(e){super(),ie(this,e,Ws,Ks,oe,{error:3})}}const Zs=()=>{const n=new URL(location.href),e=Js(n),s=Qs(n),t=Xs(n);return{tags:e,sort:s,filter:t}},it=(n,e)=>{const s=new URL(location.protocol+"//"+location.host+location.pathname);if(n.length>0){const t=n.map(r=>r.name).join(";");s.searchParams.append("tags",t)}if(e.sortProperty!=="id"||e.sortDirection!=="desc"){const t=e.sortProperty+":"+e.sortDirection;s.searchParams.append("sort",t)}if(e.rating!=="all"||e.scoreComparator!==">="||e.scoreValue!==0){const t=[];if(e.rating!=="all"){const l="rating:"+e.rating;t.push(l)}if(e.scoreComparator!==">="||e.scoreValue!==0){const l="score"+e.scoreComparator+e.scoreValue;t.push(l)}const r=t.join(";");s.searchParams.append("filter",r)}return s.toString()},Js=n=>{if(!n.searchParams.has("tags"))return;const s=(n.searchParams.get("tags")??"").split(";");if(!(!Array.isArray(s)||s.length===0))return s},Qs=n=>{try{if(!n.searchParams.has("sort"))return;const e=n.searchParams.get("sort")??"",[s,t]=e.split(":");return{property:s,direction:t}}catch{console.warn("Invalid sort provided in url");return}},Xs=n=>{try{if(!n.searchParams.has("filter"))return;const s=(n.searchParams.get("filter")??"").split(";");let t={};return s.forEach(r=>{if(r.startsWith("rating:")){const[,l]=r.split(":");l!=="all"&&(t.rating=l)}if(r.startsWith("score")){const l=r.match(/score(.*)(\d+)/);if(l){const[,o,a]=l;t.scoreComparator=o;const i=Number(a);i&&(t.scoreValue=i)}}}),t}catch{console.warn("Invalid sort provided in url");return}};function xs(n){let e;return{c(){e=te("Search")},l(s){e=se(s,"Search")},m(s,t){N(s,e,t)},d(s){s&&d(e)}}}function en(n){let e,s,t,r,l,o;const a=[nn,sn],i=[];function f(u,p){return u[3].postCount===0?0:1}return s=f(n),t=i[s]=a[s](n),l=new qt({}),{c(){e=C("section"),t.c(),r=T(),A(l.$$.fragment),this.h()},l(u){e=I(u,"SECTION",{class:!0});var p=L(e);t.l(p),p.forEach(d),r=O(u),B(l.$$.fragment,u),this.h()},h(){v(e,"class","svelte-xbsifd")},m(u,p){N(u,e,p),i[s].m(e,null),N(u,r,p),M(l,u,p),o=!0},p(u,p){let m=s;s=f(u),s===m?i[s].p(u,p):(x(),S(i[m],1,1,()=>{i[m]=null}),ee(),t=i[s],t?t.p(u,p):(t=i[s]=a[s](u),t.c()),w(t,1),t.m(e,null))},i(u){o||(w(t),w(l.$$.fragment,u),o=!0)},o(u){S(t),S(l.$$.fragment,u),o=!1},d(u){u&&(d(e),d(r)),i[s].d(),U(l,u)}}}function tn(n){let e,s;return e=new Ys({props:{error:n[0]}}),{c(){A(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,r){M(e,t,r),s=!0},p(t,r){const l={};r&1&&(l.error=t[0]),e.$set(l)},i(t){s||(w(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){U(e,t)}}}function sn(n){let e,s,t,r,l,o;e=new Vs({}),e.$on("sortfilterupdate",n[9]),e.$on("endreached",n[10]);const a=[ln,rn],i=[];function f(u,p){return u[3].posts.length===u[3].postCount?0:1}return t=f(n),r=i[t]=a[t](n),{c(){A(e.$$.fragment),s=T(),r.c(),l=me()},l(u){B(e.$$.fragment,u),s=O(u),r.l(u),l=me()},m(u,p){M(e,u,p),N(u,s,p),i[t].m(u,p),N(u,l,p),o=!0},p(u,p){let m=t;t=f(u),t===m?i[t].p(u,p):(x(),S(i[m],1,1,()=>{i[m]=null}),ee(),r=i[t],r?r.p(u,p):(r=i[t]=a[t](u),r.c()),w(r,1),r.m(l.parentNode,l))},i(u){o||(w(e.$$.fragment,u),w(r),o=!0)},o(u){S(e.$$.fragment,u),S(r),o=!1},d(u){u&&(d(s),d(l)),U(e,u),i[t].d(u)}}}function nn(n){let e,s;return e=new Yt({}),e.$on("sortfilterupdate",n[9]),{c(){A(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,r){M(e,t,r),s=!0},p:W,i(t){s||(w(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){U(e,t)}}}function rn(n){let e,s;return e=new Bs({props:{rootMargin:"1000px"}}),e.$on("intersection",n[10]),{c(){A(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,r){M(e,t,r),s=!0},p:W,i(t){s||(w(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){U(e,t)}}}function ln(n){let e,s;return e=new Us({}),{c(){A(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,r){M(e,t,r),s=!0},p:W,i(t){s||(w(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){U(e,t)}}}function ct(n){let e,s;return e=new Hs({props:{tags:n[6]}}),e.$on("close",n[16]),e.$on("submit",n[17]),{c(){A(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,r){M(e,t,r),s=!0},p(t,r){const l={};r&64&&(l.tags=t[6]),e.$set(l)},i(t){s||(w(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){U(e,t)}}}function ut(n){let e,s;return e=new Ge({props:{$$slots:{default:[an]},$$scope:{ctx:n}}}),e.$on("close",n[18]),{c(){A(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,r){M(e,t,r),s=!0},p(t,r){const l={};r&67108960&&(l.$$scope={dirty:r,ctx:t}),e.$set(l)},i(t){s||(w(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){U(e,t)}}}function on(n){let e;return{c(){e=te("Share this search")},l(s){e=se(s,"Share this search")},m(s,t){N(s,e,t)},d(s){s&&d(e)}}}function an(n){let e,s,t,r,l,o;return s=new Gt({props:{$$slots:{default:[on]},$$scope:{ctx:n}}}),{c(){e=C("div"),A(s.$$.fragment),t=T(),r=C("input"),this.h()},l(a){e=I(a,"DIV",{});var i=L(e);B(s.$$.fragment,i),t=O(i),r=I(i,"INPUT",{type:!0,class:!0}),i.forEach(d),this.h()},h(){v(r,"type","text"),r.value=l=it(n[6],n[5]),v(r,"class","svelte-xbsifd")},m(a,i){N(a,e,i),M(s,e,null),y(e,t),y(e,r),o=!0},p(a,i){const f={};i&67108864&&(f.$$scope={dirty:i,ctx:a}),s.$set(f),(!o||i&96&&l!==(l=it(a[6],a[5]))&&r.value!==l)&&(r.value=l)},i(a){o||(w(s.$$.fragment,a),o=!0)},o(a){S(s.$$.fragment,a),o=!1},d(a){a&&d(e),U(s)}}}function cn(n){let e,s,t,r,l,o,a,i,f,u,p,m,b,$,k;s=new It({}),r=new Nt({props:{placeholder:"Search for tags",fetchSuggestions:n[8]}}),r.$on("pick",n[11]),o=new Oe({props:{title:"Search with the tags above",$$slots:{default:[xs]},$$scope:{ctx:n}}}),o.$on("click",n[9]),i=new Pt({props:{tags:[...n[6],...n[4]]}}),i.$on("click",n[12]),i.$on("contextmenu",n[13]),i.$on("createSupertag",n[14]),i.$on("copy",n[15]);const g=[tn,en],_=[];function c(E,j){return E[0]?0:E[3].requested?1:-1}~(u=c(n))&&(p=_[u]=g[u](n));let h=n[1]&&ct(n),D=n[2]&&ut(n);return{c(){e=C("section"),A(s.$$.fragment),t=T(),A(r.$$.fragment),l=T(),A(o.$$.fragment),a=T(),A(i.$$.fragment),f=T(),p&&p.c(),m=T(),h&&h.c(),b=T(),D&&D.c(),$=me(),this.h()},l(E){e=I(E,"SECTION",{id:!0,class:!0});var j=L(e);B(s.$$.fragment,j),t=O(j),B(r.$$.fragment,j),l=O(j),B(o.$$.fragment,j),a=O(j),B(i.$$.fragment,j),j.forEach(d),f=O(E),p&&p.l(E),m=O(E),h&&h.l(E),b=O(E),D&&D.l(E),$=me(),this.h()},h(){v(e,"id","search"),v(e,"class","svelte-xbsifd")},m(E,j){N(E,e,j),M(s,e,null),y(e,t),M(r,e,null),y(e,l),M(o,e,null),y(e,a),M(i,e,null),N(E,f,j),~u&&_[u].m(E,j),N(E,m,j),h&&h.m(E,j),N(E,b,j),D&&D.m(E,j),N(E,$,j),k=!0},p(E,[j]){const Z={};j&67108864&&(Z.$$scope={dirty:j,ctx:E}),o.$set(Z);const H={};j&80&&(H.tags=[...E[6],...E[4]]),i.$set(H);let X=u;u=c(E),u===X?~u&&_[u].p(E,j):(p&&(x(),S(_[X],1,1,()=>{_[X]=null}),ee()),~u?(p=_[u],p?p.p(E,j):(p=_[u]=g[u](E),p.c()),w(p,1),p.m(m.parentNode,m)):p=null),E[1]?h?(h.p(E,j),j&2&&w(h,1)):(h=ct(E),h.c(),w(h,1),h.m(b.parentNode,b)):h&&(x(),S(h,1,1,()=>{h=null}),ee()),E[2]?D?(D.p(E,j),j&4&&w(D,1)):(D=ut(E),D.c(),w(D,1),D.m($.parentNode,$)):D&&(x(),S(D,1,1,()=>{D=null}),ee())},i(E){k||(w(s.$$.fragment,E),w(r.$$.fragment,E),w(o.$$.fragment,E),w(i.$$.fragment,E),w(p),w(h),w(D),k=!0)},o(E){S(s.$$.fragment,E),S(r.$$.fragment,E),S(o.$$.fragment,E),S(i.$$.fragment,E),S(p),S(h),S(D),k=!1},d(E){E&&(d(e),d(f),d(m),d(b),d($)),U(s),U(r),U(o),U(i),~u&&_[u].d(E),h&&h.d(E),D&&D.d(E)}}}const un=(n,e)=>{let s=!1;const{tags:t,sort:r,filter:l}=Zs();return t&&(n.reset(),t.forEach(o=>n.addByName(o)),s=!0),r&&(e.update({sortProperty:r.property,sortDirection:r.direction}),s=!0),l&&(e.update(l),s=!0),s};function fn(n,e,s){let t,r,l,o,a,i;fe(n,Ne,P=>s(3,t=P)),fe(n,Ue,P=>s(4,r=P)),fe(n,ce,P=>s(5,l=P)),fe(n,Ut,P=>s(21,o=P)),fe(n,De,P=>s(6,a=P)),fe(n,Ze,P=>s(7,i=P));let f=!1,u,p=!1,m=!1,b=0;const $=async P=>{const z=await Ot(P);return[...i.items.filter(({name:Q})=>Q.toLowerCase().includes(P.toLowerCase())).map(Q=>({label:Q.name,count:Q.tags.length,type:"supertag"})),...z]},k=un(De,ce),g=()=>new Dt().withPid(t.pageCount).withTags(a).withBlockedContent(o).withSortProperty(l.sortProperty).withSortDirection(l.sortDirection).withScoreValue(l.scoreValue).withScoreComparator(l.scoreComparator).withRating(l.rating).withSupertags(r),_=async P=>{if(!f){s(0,u=void 0),f=!0;try{const z=t.pageCount;await P(),zt(z).catch(()=>{})}catch(z){s(0,u=z),console.warn(z)}finally{f=!1}}},c=async()=>{Ne.reset(),b=0,_(async()=>{const[P,z]=await g().getPageAndCount();console.log(P,z),Ne.addPage(P,z)})},h=async()=>{_(async()=>{const P=await g().getPage();Ne.addPage(P)})},D=P=>{var z,R;if((P.key==="/"||P.key==="s")&&(!document.activeElement||document.activeElement===document.body)&&((z=document.getElementById("searchbar"))==null||z.focus(),P.preventDefault(),P.stopPropagation()),P.ctrlKey&&P.key==="Enter"&&(P.preventDefault(),P.stopPropagation(),c()),P.ctrlKey&&P.key==="m"&&((R=document.getElementById("select-modifier"))==null||R.click()),P.ctrlKey&&P.key==="ArrowDown"){const Q=document.getElementsByClassName("post-media");Q[b].focus(),b=Math.min(b+1,Math.max(0,Q.length-1))}P.ctrlKey&&P.key==="ArrowUp"&&(document.getElementsByClassName("post-media")[b].focus(),b=Math.max(b-1,0))};return Be(()=>{document.addEventListener("keydown",D),k&&c()}),Me(()=>{document.removeEventListener("keydown",D)}),[u,p,m,t,r,l,a,i,$,c,h,async P=>{const z=P.detail;if(z.type==="supertag"){const R=i.items.find(Q=>Q.name===z.label);if(!R){console.log("Supertag not present.");return}Ue.addOrReplace(R)}else{const R=await Lt(P.detail.label);De.addOrReplace({name:P.detail.label,modifier:P.detail.modifier,count:P.detail.count,type:R.type})}},P=>"description"in P.detail?Ue.removeByName(P.detail.name):De.removeByName(P.detail.name),P=>{"description"in P.detail||(P.detail.modifier=Tt(P.detail.modifier),De.addOrReplace(P.detail))},()=>s(1,p=!0),()=>s(2,m=!0),()=>s(1,p=!1),P=>Ze.add(P.detail),()=>s(2,m=!1)]}class On extends ae{constructor(e){super(),ie(this,e,fn,cn,oe,{})}}export{On as component};
