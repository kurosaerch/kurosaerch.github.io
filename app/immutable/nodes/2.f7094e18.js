import{s as _e,D as Ae,f as S,a as P,g as I,h as V,y as fe,c as N,d as $,j as h,r as Rt,i as T,u as g,E as Be,F as ke,G as Ue,H as lt,l as oe,m as ie,v as Y,I as ve,e as we,n as Fe,C as $e,J as Wt,p as Se,K as Ye,L as Lt,M as nt,k as Ve,N as st,w as Yt,O as Zt,z as Jt,A as Qt,B as Xt,o as xe,P as et}from"../chunks/scheduler.0a29c992.js";import{S as me,i as de,b as A,d as O,m as R,a as b,t as E,e as L,g as ae,c as ce,f as Ze}from"../chunks/index.6d8df040.js";import{e as Ce}from"../chunks/each.e59479a4.js";import{D as Ft,r as Mt}from"../chunks/result-columns-store.7454cbad.js";import{T as Je}from"../chunks/TextButton.f6017ea8.js";import{D as xt}from"../chunks/DetailedTag.6129a1d8.js";import{K as en,A as tn}from"../chunks/ActiveTagList.0ac41c7b.js";import{b as jt}from"../chunks/paths.f0ebfb03.js";import{s as Ge,f as Le,r as qe,a as ot,S as nn}from"../chunks/active-supertags-store.11df592d.js";import{i as Bt,D as sn,g as Gt,G as ln,V as rn,a as it,I as on,b as an,c as cn,R as un,S as fn,d as pn,E as qt,e as _n,f as at,P as mn,C as dn}from"../chunks/Details.a345adcf.js";import{f as Qe}from"../chunks/format-tag.7e313273.js";import{R as gn,I as Ut}from"../chunks/ModifierSelect.51f2ca82.js";import{S as ct}from"../chunks/Select.0781c4e2.js";import{R as hn}from"../chunks/RotatingTextSelect.f25d5f18.js";import{a as $n}from"../chunks/always-loop-store.ec22e8f2.js";import{L as vn}from"../chunks/LoadingAnimation.91c05c4c.js";import{a as tt}from"../chunks/active-tags-store.a60398a6.js";import"../chunks/SimpleTag.952bfde9.js";import{h as ut,u as bn}from"../chunks/await_block.f127d874.js";import{S as kn,n as wn,s as ft}from"../chunks/supertags-store.efadef0d.js";import{S as Cn}from"../chunks/ScrollUpButton.be9a5994.js";import{g as En,a as yn}from"../chunks/tags.49324235.js";import{l as Sn}from"../chunks/analytics.eca95ce1.js";import{b as In}from"../chunks/blocked-content-store.2a43e35e.js";function pt(l,e,n){const t=l.slice();return t[9]=e[n],t}function _t(l){let e,n;return e=new xt({props:{tag:l[9]}}),{c(){A(e.$$.fragment)},l(t){O(e.$$.fragment,t)},m(t,s){R(e,t,s),n=!0},p(t,s){const o={};s&4&&(o.tag=t[9]),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){E(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function Dn(l){let e;return{c(){e=oe("Create supertag")},l(n){e=ie(n,"Create supertag")},m(n,t){T(n,e,t)},d(n){n&&$(e)}}}function Pn(l){let e,n,t="Create Supertag",s,o,r,a,i,u="Name",c,m,_,w,C,y="Description",k,d,p,f,v,Z="Tags",H,X,J,se,te,D,x,ne,z=Ce(l[2]),U=[];for(let M=0;M<z.length;M+=1)U[M]=_t(pt(l,z,M));const le=M=>E(U[M],1,1,()=>{U[M]=null});return te=new Je({props:{title:l[3]?"Click to create supertag":"Enter a valid name to continue",disabled:!l[3],$$slots:{default:[Dn]},$$scope:{ctx:l}}}),te.$on("click",l[8]),{c(){e=S("section"),n=S("h3"),n.textContent=t,s=P(),o=S("button"),r=P(),a=S("div"),i=S("label"),i.textContent=u,c=P(),m=S("input"),_=P(),w=S("div"),C=S("label"),C.textContent=y,k=P(),d=S("input"),p=P(),f=S("div"),v=S("span"),v.textContent=Z,H=P(),X=S("ol");for(let M=0;M<U.length;M+=1)U[M].c();J=P(),se=S("div"),A(te.$$.fragment),this.h()},l(M){e=I(M,"SECTION",{class:!0});var j=V(e);n=I(j,"H3",{"data-svelte-h":!0}),fe(n)!=="svelte-ho1cwx"&&(n.textContent=t),s=N(j),o=I(j,"BUTTON",{class:!0}),V(o).forEach($),r=N(j),a=I(j,"DIV",{class:!0});var Q=V(a);i=I(Q,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),fe(i)!=="svelte-10k8a68"&&(i.textContent=u),c=N(Q),m=I(Q,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),Q.forEach($),_=N(j),w=I(j,"DIV",{class:!0});var K=V(w);C=I(K,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),fe(C)!=="svelte-14n9kp6"&&(C.textContent=y),k=N(K),d=I(K,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),K.forEach($),p=N(j),f=I(j,"DIV",{class:!0});var pe=V(f);v=I(pe,"SPAN",{class:!0,"data-svelte-h":!0}),fe(v)!=="svelte-7hjyox"&&(v.textContent=Z),H=N(pe),X=I(pe,"OL",{class:!0});var ge=V(X);for(let De=0;De<U.length;De+=1)U[De].l(ge);ge.forEach($),pe.forEach($),J=N(j),se=I(j,"DIV",{class:!0});var Ie=V(se);O(te.$$.fragment,Ie),Ie.forEach($),j.forEach($),this.h()},h(){h(o,"class",Rt("codicon codicon-close")+" svelte-xkjm86"),h(i,"for","supertag-name"),h(i,"class","svelte-xkjm86"),h(m,"type","text"),h(m,"placeholder","Descriptive name"),h(m,"id","supertag-name"),h(m,"class","svelte-xkjm86"),h(a,"class","svelte-xkjm86"),h(C,"for","supertag-description"),h(C,"class","svelte-xkjm86"),h(d,"type","text"),h(d,"placeholder","Short description"),h(d,"id","supertag-description"),h(d,"class","svelte-xkjm86"),h(w,"class","svelte-xkjm86"),h(v,"class","svelte-xkjm86"),h(X,"class","svelte-xkjm86"),h(f,"class","svelte-xkjm86"),h(se,"class","last svelte-xkjm86"),h(e,"class","svelte-xkjm86")},m(M,j){T(M,e,j),g(e,n),g(e,s),g(e,o),g(e,r),g(e,a),g(a,i),g(a,c),g(a,m),Be(m,l[0]),g(e,_),g(e,w),g(w,C),g(w,k),g(w,d),Be(d,l[1]),g(e,p),g(e,f),g(f,v),g(f,H),g(f,X);for(let Q=0;Q<U.length;Q+=1)U[Q]&&U[Q].m(X,null);g(e,J),g(e,se),R(te,se,null),D=!0,x||(ne=[ke(o,"click",l[5]),ke(m,"input",l[6]),ke(d,"input",l[7])],x=!0)},p(M,j){if(j&1&&m.value!==M[0]&&Be(m,M[0]),j&2&&d.value!==M[1]&&Be(d,M[1]),j&4){z=Ce(M[2]);let K;for(K=0;K<z.length;K+=1){const pe=pt(M,z,K);U[K]?(U[K].p(pe,j),b(U[K],1)):(U[K]=_t(pe),U[K].c(),b(U[K],1),U[K].m(X,null))}for(ae(),K=z.length;K<U.length;K+=1)le(K);ce()}const Q={};j&8&&(Q.title=M[3]?"Click to create supertag":"Enter a valid name to continue"),j&8&&(Q.disabled=!M[3]),j&4096&&(Q.$$scope={dirty:j,ctx:M}),te.$set(Q)},i(M){if(!D){for(let j=0;j<z.length;j+=1)b(U[j]);b(te.$$.fragment,M),D=!0}},o(M){U=U.filter(Boolean);for(let j=0;j<U.length;j+=1)E(U[j]);E(te.$$.fragment,M),D=!1},d(M){M&&$(e),Ue(U,M),L(te),x=!1,lt(ne)}}}function Nn(l){let e,n;return e=new Ft({props:{$$slots:{default:[Pn]},$$scope:{ctx:l}}}),e.$on("close",l[5]),{c(){A(e.$$.fragment)},l(t){O(e.$$.fragment,t)},m(t,s){R(e,t,s),n=!0},p(t,[s]){const o={};s&4111&&(o.$$scope={dirty:s,ctx:t}),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){E(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function Tn(l,e,n){let t,{name:s=""}=e,{description:o=""}=e,{tags:r}=e;const a=Ae(),i=()=>a("close");function u(){s=this.value,n(0,s)}function c(){o=this.value,n(1,o)}const m=()=>{a("submit",{name:s,description:o,tags:r.map(({modifier:_,name:w})=>({modifier:_,name:w}))}),i()};return l.$$set=_=>{"name"in _&&n(0,s=_.name),"description"in _&&n(1,o=_.description),"tags"in _&&n(2,r=_.tags)},l.$$.update=()=>{l.$$.dirty&5&&n(3,t=typeof s=="string"&&s!==""&&r.length>1)},[s,o,r,t,a,i,u,c,m]}class Vn extends me{constructor(e){super(),de(this,e,Tn,Nn,_e,{name:0,description:1,tags:2})}}function An(l){let e,n,t,s,o,r,a,i,u,c;return{c(){e=S("div"),n=S("div"),t=S("i"),s=P(),o=S("div"),r=S("h3"),a=oe(l[0]),i=P(),u=S("span"),c=oe(l[2]),this.h()},l(m){e=I(m,"DIV",{class:!0});var _=V(e);n=I(_,"DIV",{class:!0});var w=V(n);t=I(w,"I",{class:!0}),V(t).forEach($),w.forEach($),s=N(_),o=I(_,"DIV",{});var C=V(o);r=I(C,"H3",{class:!0});var y=V(r);a=ie(y,l[0]),y.forEach($),i=N(C),u=I(C,"SPAN",{});var k=V(u);c=ie(k,l[2]),k.forEach($),C.forEach($),_.forEach($),this.h()},h(){h(t,"class",Rt(l[1])+" svelte-1tvgln1"),h(n,"class","icon svelte-1tvgln1"),h(r,"class","svelte-1tvgln1"),h(e,"class","error svelte-1tvgln1")},m(m,_){T(m,e,_),g(e,n),g(n,t),g(e,s),g(e,o),g(o,r),g(r,a),g(o,i),g(o,u),g(u,c)},p:Y,i:Y,o:Y,d(m){m&&$(e)}}}function On(l,e,n){let{error:t}=e,s=t.message==="Failed to fetch"?"Connection Error":"Application Error",o=t.message==="Failed to fetch"?"codicon codicon-debug-disconnect":"codicon codicon-error",r=t.message==="Failed to fetch"?"Failed to connect to the server. Make sure you have a stable internet connection.":t.message;return l.$$set=a=>{"error"in a&&n(3,t=a.error)},[s,o,r,t]}class Rn extends me{constructor(e){super(),de(this,e,On,An,_e,{error:3})}}function Ln(l){let e,n,t,s,o="You have seen everything there is to see...";return{c(){e=S("img"),t=P(),s=S("p"),s.textContent=o,this.h()},l(r){e=I(r,"IMG",{src:!0,alt:!0,class:!0}),t=N(r),s=I(r,"P",{"data-svelte-h":!0}),fe(s)!=="svelte-1i75mtf"&&(s.textContent=o),this.h()},h(){ve(e.src,n=jt+"/assets/shironeko-x.png")||h(e,"src",n),h(e,"alt","No more results to load"),h(e,"class","svelte-1pkma0d")},m(r,a){T(r,e,a),T(r,t,a),T(r,s,a)},p:Y,i:Y,o:Y,d(r){r&&($(e),$(t),$(s))}}}class Fn extends me{constructor(e){super(),de(this,e,null,Ln,_e,{})}}function mt(l){let e,n;return e=new Ft({props:{$$slots:{default:[Bn]},$$scope:{ctx:l}}}),e.$on("close",l[7]),{c(){A(e.$$.fragment)},l(t){O(e.$$.fragment,t)},m(t,s){R(e,t,s),n=!0},p(t,s){const o={};s&65543&&(o.$$scope={dirty:s,ctx:t}),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){E(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function Mn(l){let e;return{c(){e=oe("Done")},l(n){e=ie(n,"Done")},m(n,t){T(n,e,t)},d(n){n&&$(e)}}}function jn(l){let e;return{c(){e=oe("Reset")},l(n){e=ie(n,"Reset")},m(n,t){T(n,e,t)},d(n){n&&$(e)}}}function Bn(l){let e,n,t="Sorting and Filtering",s,o,r,a="Sorting",i,u,c,m,_,w,C,y,k,d,p="Filtering by Score",f,v,Z,H,X,J,se,te,D,x="Filtering by Rating",ne,z,U,le,M,j,Q,K,pe,ge,Ie;function De(G){l[10](G)}let Pe={options:Un};l[1].direction!==void 0&&(Pe.value=l[1].direction),c=new gn({props:Pe}),Se.push(()=>Ze(c,"value",De));function ze(G){l[11](G)}let Ee={options:qn};l[1].property!==void 0&&(Ee.value=l[1].property),w=new ct({props:Ee}),Se.push(()=>Ze(w,"value",ze));function Ne(G){l[12](G)}let He={options:zn};l[2].scoreComparator!==void 0&&(He.value=l[2].scoreComparator),Z=new hn({props:He}),Se.push(()=>Ze(Z,"value",Ne));function Ke(G){l[14](G)}let Oe={options:zt};return l[2].rating!==void 0&&(Oe.value=l[2].rating),U=new ct({props:Oe}),Se.push(()=>Ze(U,"value",Ke)),j=new Je({props:{title:"Return to searching.",$$slots:{default:[Mn]},$$scope:{ctx:l}}}),j.$on("click",l[7]),K=new Je({props:{title:"Reset sort and filter.",type:"secondary",$$slots:{default:[jn]},$$scope:{ctx:l}}}),K.$on("click",l[9]),{c(){e=S("div"),n=S("h3"),n.textContent=t,s=P(),o=S("div"),r=S("b"),r.textContent=a,i=P(),u=S("div"),A(c.$$.fragment),_=P(),A(w.$$.fragment),y=P(),k=S("div"),d=S("b"),d.textContent=p,f=P(),v=S("div"),A(Z.$$.fragment),X=P(),J=S("input"),se=P(),te=S("div"),D=S("b"),D.textContent=x,ne=P(),z=S("div"),A(U.$$.fragment),M=P(),A(j.$$.fragment),Q=P(),A(K.$$.fragment),this.h()},l(G){e=I(G,"DIV",{class:!0});var B=V(e);n=I(B,"H3",{"data-svelte-h":!0}),fe(n)!=="svelte-15zouq3"&&(n.textContent=t),s=N(B),o=I(B,"DIV",{});var he=V(o);r=I(he,"B",{class:!0,"data-svelte-h":!0}),fe(r)!=="svelte-ekzpgg"&&(r.textContent=a),i=N(he),u=I(he,"DIV",{class:!0});var W=V(u);O(c.$$.fragment,W),_=N(W),O(w.$$.fragment,W),W.forEach($),he.forEach($),y=N(B),k=I(B,"DIV",{});var Te=V(k);d=I(Te,"B",{class:!0,"data-svelte-h":!0}),fe(d)!=="svelte-1flca3"&&(d.textContent=p),f=N(Te),v=I(Te,"DIV",{class:!0});var ee=V(v);O(Z.$$.fragment,ee),X=N(ee),J=I(ee,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),ee.forEach($),Te.forEach($),se=N(B),te=I(B,"DIV",{});var q=V(te);D=I(q,"B",{class:!0,"data-svelte-h":!0}),fe(D)!=="svelte-1evbw58"&&(D.textContent=x),ne=N(q),z=I(q,"DIV",{class:!0});var F=V(z);O(U.$$.fragment,F),F.forEach($),q.forEach($),M=N(B),O(j.$$.fragment,B),Q=N(B),O(K.$$.fragment,B),B.forEach($),this.h()},h(){h(r,"class","svelte-gf4ubn"),h(u,"class","row svelte-gf4ubn"),h(d,"class","svelte-gf4ubn"),h(J,"type","number"),h(J,"min",0),h(J,"max",1e5),h(J,"step",1),h(J,"class","svelte-gf4ubn"),h(v,"class","row svelte-gf4ubn"),h(D,"class","svelte-gf4ubn"),h(z,"class","row svelte-gf4ubn"),h(e,"class","container svelte-gf4ubn")},m(G,B){T(G,e,B),g(e,n),g(e,s),g(e,o),g(o,r),g(o,i),g(o,u),R(c,u,null),g(u,_),R(w,u,null),g(e,y),g(e,k),g(k,d),g(k,f),g(k,v),R(Z,v,null),g(v,X),g(v,J),Be(J,l[0]),g(e,se),g(e,te),g(te,D),g(te,ne),g(te,z),R(U,z,null),g(e,M),R(j,e,null),g(e,Q),R(K,e,null),pe=!0,ge||(Ie=[ke(J,"input",l[13]),ke(J,"keyup",l[8])],ge=!0)},p(G,B){const he={};!m&&B&2&&(m=!0,he.value=G[1].direction,Ye(()=>m=!1)),c.$set(he);const W={};!C&&B&2&&(C=!0,W.value=G[1].property,Ye(()=>C=!1)),w.$set(W);const Te={};!H&&B&4&&(H=!0,Te.value=G[2].scoreComparator,Ye(()=>H=!1)),Z.$set(Te),B&1&&Lt(J.value)!==G[0]&&Be(J,G[0]);const ee={};!le&&B&4&&(le=!0,ee.value=G[2].rating,Ye(()=>le=!1)),U.$set(ee);const q={};B&65536&&(q.$$scope={dirty:B,ctx:G}),j.$set(q);const F={};B&65536&&(F.$$scope={dirty:B,ctx:G}),K.$set(F)},i(G){pe||(b(c.$$.fragment,G),b(w.$$.fragment,G),b(Z.$$.fragment,G),b(U.$$.fragment,G),b(j.$$.fragment,G),b(K.$$.fragment,G),pe=!0)},o(G){E(c.$$.fragment,G),E(w.$$.fragment,G),E(Z.$$.fragment,G),E(U.$$.fragment,G),E(j.$$.fragment,G),E(K.$$.fragment,G),pe=!1},d(G){G&&$(e),L(c),L(w),L(Z),L(U),L(j),L(K),ge=!1,lt(Ie)}}}function Gn(l){let e,n,t,s,o,r,a,i,u,c,m,_,w,C,y,k=l[3]&&mt(l);return{c(){e=S("button"),n=S("i"),t=P(),s=S("span"),o=oe(l[5]),r=P(),a=S("i"),i=P(),u=S("span"),c=oe(l[4]),m=P(),k&&k.c(),_=we(),this.h()},l(d){e=I(d,"BUTTON",{class:!0});var p=V(e);n=I(p,"I",{class:!0}),V(n).forEach($),t=N(p),s=I(p,"SPAN",{});var f=V(s);o=ie(f,l[5]),f.forEach($),r=N(p),a=I(p,"I",{class:!0}),V(a).forEach($),i=N(p),u=I(p,"SPAN",{});var v=V(u);c=ie(v,l[4]),v.forEach($),p.forEach($),m=N(d),k&&k.l(d),_=we(),this.h()},h(){h(n,"class","codicon codicon-filter svelte-gf4ubn"),h(a,"class","codicon codicon-arrow-swap svelte-gf4ubn"),h(e,"class","svelte-gf4ubn")},m(d,p){T(d,e,p),g(e,n),g(e,t),g(e,s),g(s,o),g(e,r),g(e,a),g(e,i),g(e,u),g(u,c),T(d,m,p),k&&k.m(d,p),T(d,_,p),w=!0,C||(y=ke(e,"click",l[6]),C=!0)},p(d,[p]){(!w||p&32)&&Fe(o,d[5]),(!w||p&16)&&Fe(c,d[4]),d[3]?k?(k.p(d,p),p&8&&b(k,1)):(k=mt(d),k.c(),b(k,1),k.m(_.parentNode,_)):k&&(ae(),E(k,1,1,()=>{k=null}),ce())},i(d){w||(b(k),w=!0)},o(d){E(k),w=!1},d(d){d&&($(e),$(m),$(_)),k&&k.d(d),C=!1,y()}}}const qn=Object.freeze({id:"Uploaded",score:"Score",updated:"Updated",random:"Random"}),Un=Object.freeze({desc:"codicon codicon-arrow-down",asc:"codicon codicon-arrow-up"}),zn=Object.freeze({">=":"≥","<=":"≤"}),zt=Object.freeze({all:"All",safe:"Safe",questionable:"Questionable",explicit:"Explicit"}),Hn=Object.freeze({id:{asc:"Oldest",desc:"Newest"},score:{asc:"Worst",desc:"Best"},updated:{asc:"Inactive",desc:"Active"},random:{asc:"Random",desc:"Random"}}),Kn=(l,e,n)=>{let t=l==="all"?void 0:zt[l],s=e===0&&n===">="?void 0:`Score${n}${Qe(e)}`;return[t,s].filter(o=>o!==void 0).join(",")||"All"};function Wn(l,e,n){let t,s,o,r;$e(l,Ge,f=>n(1,o=f)),$e(l,Le,f=>n(2,r=f));const a=Ae();let i=!1;const u=()=>n(3,i=!0),c=()=>{n(3,i=!1),a("sortfilterupdate")},m=f=>{var v;return Bt(f)&&((v=f.target)==null?void 0:v.blur())},_=()=>{Ge.reset(),Le.reset(),n(0,w=r.scoreValue)};let w;function C(f){l.$$.not_equal(o.direction,f)&&(o.direction=f,Ge.set(o))}function y(f){l.$$.not_equal(o.property,f)&&(o.property=f,Ge.set(o))}function k(f){l.$$.not_equal(r.scoreComparator,f)&&(r.scoreComparator=f,Le.set(r))}function d(){w=Lt(this.value),n(0,w),n(2,r)}function p(f){l.$$.not_equal(r.rating,f)&&(r.rating=f,Le.set(r))}return l.$$.update=()=>{if(l.$$.dirty&5){w===void 0&&n(0,w=r.scoreValue);let f=Number(w);isNaN(f)||Wt(Le,r.scoreValue=f,r)}l.$$.dirty&4&&n(5,t=Kn(r.rating,r.scoreValue,r.scoreComparator)),l.$$.dirty&2&&n(4,s=Hn[o.property][o.direction])},[w,o,r,i,s,t,u,c,m,_,C,y,k,d,p]}class Yn extends me{constructor(e){super(),de(this,e,Wn,Gn,_e,{})}}const Xe=l=>`post_${l}`;function Zn(l){const e=l.slice(),n=Gt(e[1].file_url,e[1].sample_url,e[1].preview_url);return e[7]=n,e}function Jn(l){let e,n;return e=new ln({props:{post:l[1]}}),e.$on("click",l[4]),{c(){A(e.$$.fragment)},l(t){O(e.$$.fragment,t)},m(t,s){R(e,t,s),n=!0},p(t,s){const o={};s&2&&(o.post=t[1]),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){E(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function Qn(l){let e,n;return e=new rn({props:{src:l[7].animated,poster:l[7].static,width:l[1].width,height:l[1].height,loop:l[2]||it(l[1].tags)}}),e.$on("click",l[4]),{c(){A(e.$$.fragment)},l(t){O(e.$$.fragment,t)},m(t,s){R(e,t,s),n=!0},p(t,s){const o={};s&2&&(o.src=t[7].animated),s&2&&(o.poster=t[7].static),s&2&&(o.width=t[1].width),s&2&&(o.height=t[1].height),s&6&&(o.loop=t[2]||it(t[1].tags)),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){E(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function Xn(l){let e,n;return e=new on({props:{post:l[1],open:l[0]}}),e.$on("click",l[4]),{c(){A(e.$$.fragment)},l(t){O(e.$$.fragment,t)},m(t,s){R(e,t,s),n=!0},p(t,s){const o={};s&2&&(o.post=t[1]),s&1&&(o.open=t[0]),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){E(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function xn(l){let e;return{c(){e=S("i"),this.h()},l(n){e=I(n,"I",{class:!0}),V(e).forEach($),this.h()},h(){h(e,"class","codicon codicon-screen-full")},m(n,t){T(n,e,t)},p:Y,d(n){n&&$(e)}}}function dt(l){let e,n;return e=new sn({props:{post:l[1]}}),{c(){A(e.$$.fragment)},l(t){O(e.$$.fragment,t)},m(t,s){R(e,t,s),n=!0},p(t,s){const o={};s&2&&(o.post=t[1]),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){E(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function es(l){let e,n,t,s,o,r,a,i,u,c;const m=[Xn,Qn,Jn],_=[];function w(k,d){return k[1].type==="image"?0:k[1].type==="video"?1:2}function C(k,d){return d===1?Zn(k):k}n=w(l),t=_[n]=m[n](C(l,n)),o=new Ut({props:{class:"button-fullscreen","aria-label":"Enter Fullscreen mode",$$slots:{default:[xn]},$$scope:{ctx:l}}}),o.$on("click",l[5]);let y=l[0]&&dt(l);return{c(){e=S("div"),t.c(),s=P(),A(o.$$.fragment),r=P(),y&&y.c(),this.h()},l(k){e=I(k,"DIV",{id:!0,class:!0});var d=V(e);t.l(d),s=N(d),O(o.$$.fragment,d),r=N(d),y&&y.l(d),d.forEach($),this.h()},h(){h(e,"id",a=Xe(l[1].id)),h(e,"class","post svelte-pwgq1f"),nt(e,"open",l[0])},m(k,d){T(k,e,d),_[n].m(e,null),g(e,s),R(o,e,null),g(e,r),y&&y.m(e,null),i=!0,u||(c=ke(e,"keydown",l[6]),u=!0)},p(k,[d]){let p=n;n=w(k),n===p?_[n].p(C(k,n),d):(ae(),E(_[p],1,1,()=>{_[p]=null}),ce(),t=_[n],t?t.p(C(k,n),d):(t=_[n]=m[n](C(k,n)),t.c()),b(t,1),t.m(e,s));const f={};d&256&&(f.$$scope={dirty:d,ctx:k}),o.$set(f),k[0]?y?(y.p(k,d),d&1&&b(y,1)):(y=dt(k),y.c(),b(y,1),y.m(e,null)):y&&(ae(),E(y,1,1,()=>{y=null}),ce()),(!i||d&2&&a!==(a=Xe(k[1].id)))&&h(e,"id",a),(!i||d&1)&&nt(e,"open",k[0])},i(k){i||(b(t),b(o.$$.fragment,k),b(y),i=!0)},o(k){E(t),E(o.$$.fragment,k),E(y),i=!1},d(k){k&&$(e),_[n].d(),L(o),y&&y.d(),u=!1,c()}}}function ts(l,e,n){let t;$e(l,$n,c=>n(2,t=c));const s=Ae(),o=()=>n(0,a=!a);let{post:r}=e,{open:a=!1}=e;const i=()=>s("fullscreen"),u=c=>{c.key==="f"&&s("fullscreen")};return l.$$set=c=>{"post"in c&&n(1,r=c.post),"open"in c&&n(0,a=c.open)},[a,r,t,s,o,i,u]}class ns extends me{constructor(e){super(),de(this,e,ts,es,_e,{post:1,open:0})}}function gt(l){let e,n=l[0].type==="video"?"▶":"GIF",t;return{c(){e=S("span"),t=oe(n),this.h()},l(s){e=I(s,"SPAN",{class:!0});var o=V(e);t=ie(o,n),o.forEach($),this.h()},h(){h(e,"class","type svelte-1pol80g")},m(s,o){T(s,e,o),g(e,t)},p(s,o){o&1&&n!==(n=s[0].type==="video"?"▶":"GIF")&&Fe(t,n)},d(s){s&&$(e)}}}function ss(l){let e,n,t,s,o,r=Qe(l[0].score)+"",a,i,u,c,m,_=l[0].type!=="image"&&gt(l);return{c(){e=S("div"),n=S("img"),s=P(),o=S("span"),a=oe(r),i=P(),_&&_.c(),this.h()},l(w){e=I(w,"DIV",{id:!0,class:!0,style:!0});var C=V(e);n=I(C,"IMG",{src:!0,alt:!0,class:!0,tabindex:!0,loading:!0}),s=N(C),o=I(C,"SPAN",{class:!0});var y=V(o);a=ie(y,r),y.forEach($),i=N(C),_&&_.l(C),C.forEach($),this.h()},h(){ve(n.src,t=l[1])||h(n,"src",t),h(n,"alt","post"),h(n,"class","post-media svelte-1pol80g"),h(n,"tabindex","-1"),h(n,"loading","lazy"),h(o,"class","score svelte-1pol80g"),h(e,"id",u=Xe(l[0].id)),h(e,"class","post svelte-1pol80g"),Ve(e,"grid-row","span "+l[2]),nt(e,"open",open)},m(w,C){T(w,e,C),g(e,n),g(e,s),g(e,o),g(o,a),g(e,i),_&&_.m(e,null),c||(m=[ke(e,"click",l[3]),ke(e,"keydown",l[4])],c=!0)},p(w,[C]){C&2&&!ve(n.src,t=w[1])&&h(n,"src",t),C&1&&r!==(r=Qe(w[0].score)+"")&&Fe(a,r),w[0].type!=="image"?_?_.p(w,C):(_=gt(w),_.c(),_.m(e,null)):_&&(_.d(1),_=null),C&1&&u!==(u=Xe(w[0].id))&&h(e,"id",u),C&0&&nt(e,"open",open)},i:Y,o:Y,d(w){w&&$(e),_&&_.d(),c=!1,lt(m)}}}let ht=3;function ls(l,e,n){let t,{post:s}=e,o=Math.min(Math.round(s.height/s.width)*ht,ht*3);const r=u=>u.endsWith(".jpg")||u.endsWith(".jpeg")||u.endsWith(".png")||u.endsWith(".webp");function a(u){st.call(this,l,u)}const i=u=>{var c;(Bt(u)||u.key==="f")&&((c=u.target)==null||c.click())};return l.$$set=u=>{"post"in u&&n(0,s=u.post)},l.$$.update=()=>{l.$$.dirty&1&&n(1,t=r(s.sample_url)?s.sample_url:s.preview_url)},[s,t,o,a,i]}class rs extends me{constructor(e){super(),de(this,e,ls,ss,_e,{post:0})}}function os(l){let e,n,t,s;const o=l[3].default,r=Yt(o,l,l[2],null);return{c(){e=S("div"),r&&r.c(),this.h()},l(a){e=I(a,"DIV",{role:!0,tabindex:!0,class:!0});var i=V(e);r&&r.l(i),i.forEach($),this.h()},h(){h(e,"role","none"),h(e,"tabindex","-1"),h(e,"class","dialog fullscreen svelte-1gmivor")},m(a,i){T(a,e,i),r&&r.m(e,null),l[5](e),n=!0,t||(s=[ke(e,"keydown",l[4]),ke(e,"click",Zt(is))],t=!0)},p(a,[i]){r&&r.p&&(!n||i&4)&&Jt(r,o,a,a[2],n?Xt(o,a[2],i,null):Qt(a[2]),null)},i(a){n||(b(r,a),n=!0)},o(a){E(r,a),n=!1},d(a){a&&$(e),r&&r.d(a),l[5](null),t=!1,lt(s)}}}const is=()=>{};function as(l,e,n){let{$$slots:t={},$$scope:s}=e;const o=Ae(),r=()=>o("close"),a=_=>{_.key==="Escape"&&r()};let i=()=>{document.fullscreenElement||r()},u;xe(async()=>{u.focus(),document.addEventListener("keydown",a),document.addEventListener("fullscreenchange",i)}),et(async()=>{document.removeEventListener("keydown",a),document.removeEventListener("fullscreenchange",i)});const c=_=>{_.code==="Escape"&&r()};function m(_){Se[_?"unshift":"push"](()=>{u=_,n(0,u)})}return l.$$set=_=>{"$$scope"in _&&n(2,s=_.$$scope)},[u,r,s,t,c,m]}class cs extends me{constructor(e){super(),de(this,e,as,os,_e,{})}}function us(l){let e;return{c(){e=S("div")},l(n){e=I(n,"DIV",{}),V(e).forEach($)},m(n,t){T(n,e,t),l[2](e)},p:Y,i:Y,o:Y,d(n){n&&$(e),l[2](null)}}}function fs(l,e,n){let{rootMargin:t}=e;const s=Ae(),o=new IntersectionObserver(i=>{i[0].isIntersecting&&s("intersection")},{rootMargin:t});let r;function a(i){Se[i?"unshift":"push"](()=>{r=i,n(0,r)})}return l.$$set=i=>{"rootMargin"in i&&n(1,t=i.rootMargin)},l.$$.update=()=>{l.$$.dirty&1&&(o.disconnect(),r&&o.observe(r))},[r,t,a]}class Ht extends me{constructor(e){super(),de(this,e,fs,us,_e,{rootMargin:1})}}const je=new IntersectionObserver(l=>{for(const e of l)if(e.target){const n=e.target;e.isIntersecting&&n.autoplay&&n.paused&&n.play(),!e.isIntersecting&&!n.paused&&n.pause()}},{rootMargin:"-1px",threshold:.001});function ps(l){const e=l.slice(),n=an(e[0].file_url,e[0].sample_url,e[0].preview_url);return e[4]=n,e}function _s(l){const e=l.slice(),n=Gt(e[0].file_url,e[0].sample_url,e[0].preview_url);return e[4]=n,e}function $t(l){let e,n,t,s;return{c(){e=S("img"),this.h()},l(o){e=I(o,"IMG",{src:!0,alt:!0,title:!0,class:!0}),this.h()},h(){ve(e.src,n=l[4].animated)||h(e,"src",n),h(e,"alt",t="[GIF] post #"+l[0].id),h(e,"title",s="[GIF] post #"+l[0].id),h(e,"class","svelte-1cjgn2p")},m(o,r){T(o,e,r)},p(o,r){r&1&&!ve(e.src,n=o[4].animated)&&h(e,"src",n),r&1&&t!==(t="[GIF] post #"+o[0].id)&&h(e,"alt",t),r&1&&s!==(s="[GIF] post #"+o[0].id)&&h(e,"title",s)},d(o){o&&$(e)}}}function vt(l){let e,n,t,s;return{c(){e=S("video"),this.h()},l(o){e=I(o,"VIDEO",{src:!0,poster:!0,title:!0,preload:!0,class:!0}),V(e).forEach($),this.h()},h(){ve(e.src,n=l[4].animated)||h(e,"src",n),h(e,"poster",t=l[4].static),e.loop=!0,h(e,"title",s="[VIDEO] post #"+l[0].id),e.controls=!0,h(e,"preload","metadata"),e.autoplay=!0,h(e,"class","svelte-1cjgn2p")},m(o,r){T(o,e,r),l[2](e)},p(o,r){r&1&&!ve(e.src,n=o[4].animated)&&h(e,"src",n),r&1&&t!==(t=o[4].static)&&h(e,"poster",t),r&1&&s!==(s="[VIDEO] post #"+o[0].id)&&h(e,"title",s)},d(o){o&&$(e),l[2](null)}}}function ms(l){let e,n,t,s;return{c(){e=S("img"),this.h()},l(o){e=I(o,"IMG",{src:!0,alt:!0,title:!0,class:!0}),this.h()},h(){ve(e.src,n=l[0].sample_url)||h(e,"src",n),h(e,"alt",t="[IMAGE] post #"+l[0].id),h(e,"title",s="[IMAGE] post #"+l[0].id),h(e,"class","svelte-1cjgn2p")},m(o,r){T(o,e,r)},p(o,r){r&1&&!ve(e.src,n=o[0].sample_url)&&h(e,"src",n),r&1&&t!==(t="[IMAGE] post #"+o[0].id)&&h(e,"alt",t),r&1&&s!==(s="[IMAGE] post #"+o[0].id)&&h(e,"title",s)},d(o){o&&$(e)}}}function ds(l){let e;function n(r,a){return r[0].type==="image"?ms:r[0].type==="video"?vt:$t}function t(r,a){return a===vt?_s(r):a===$t?ps(r):r}let s=n(l),o=s(t(l,s));return{c(){o.c(),e=we()},l(r){o.l(r),e=we()},m(r,a){o.m(r,a),T(r,e,a)},p(r,[a]){s===(s=n(r))&&o?o.p(t(r,s),a):(o.d(1),o=s(t(r,s)),o&&(o.c(),o.m(e.parentNode,e)))},i:Y,o:Y,d(r){r&&$(e),o.d(r)}}}function gs(l,e,n){let{post:t}=e,s;const o=a=>{t.type==="video"&&s&&(a.key==="ArrowLeft"&&(a.preventDefault(),a.stopPropagation(),n(1,s.currentTime=Math.max(0,s.currentTime-5),s)),a.key==="ArrowRight"&&(a.preventDefault(),a.stopPropagation(),n(1,s.currentTime=Math.min(s.duration,s.currentTime+5),s)))};xe(()=>{s&&(je==null||je.observe(s)),document.addEventListener("keydown",o)}),et(()=>{s&&(je==null||je.unobserve(s)),document.removeEventListener("keydown",o)});function r(a){Se[a?"unshift":"push"](()=>{s=a,n(1,s)})}return l.$$set=a=>{"post"in a&&n(0,t=a.post)},[t,s,r]}class hs extends me{constructor(e){super(),de(this,e,gs,ds,_e,{post:0})}}function $s(l){let e,n,t;return{c(){e=S("img"),this.h()},l(s){e=I(s,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){ve(e.src,n=l[2])||h(e,"src",n),h(e,"alt",t="post #"+l[0].id),h(e,"class","svelte-itxz72"),Ve(e,"top",l[1])},m(s,o){T(s,e,o)},p(s,[o]){o&4&&!ve(e.src,n=s[2])&&h(e,"src",n),o&1&&t!==(t="post #"+s[0].id)&&h(e,"alt",t),o&2&&Ve(e,"top",s[1])},i:Y,o:Y,d(s){s&&$(e)}}}function vs(l,e,n){let t,{post:s}=e,{offset:o}=e;return l.$$set=r=>{"post"in r&&n(0,s=r.post),"offset"in r&&n(1,o=r.offset)},l.$$.update=()=>{l.$$.dirty&1&&n(2,t=cn(s.sample_url)?s.preview_url:s.sample_url)},[s,o,t]}class Kt extends me{constructor(e){super(),de(this,e,vs,$s,_e,{post:0,offset:1})}}function bt(l,e,n){const t=l.slice();return t[3]=e[n],t}function kt(l,e,n){const t=l.slice();return t[6]=e[n][0],t[7]=e[n][1],t}function wt(l){let e,n="•",t,s,o;return s=new qt({props:{source:l[0].source}}),{c(){e=S("span"),e.textContent=n,t=P(),A(s.$$.fragment)},l(r){e=I(r,"SPAN",{"data-svelte-h":!0}),fe(e)!=="svelte-7hh8jk"&&(e.textContent=n),t=N(r),O(s.$$.fragment,r)},m(r,a){T(r,e,a),T(r,t,a),R(s,r,a),o=!0},p(r,a){const i={};a&1&&(i.source=r[0].source),s.$set(i)},i(r){o||(b(s.$$.fragment,r),o=!0)},o(r){E(s.$$.fragment,r),o=!1},d(r){r&&($(e),$(t)),L(s,r)}}}function Ct(l){let e,n=l[6]+"",t,s,o,r;return o=new mn({props:{tags:l[7]}}),{c(){e=S("h3"),t=oe(n),s=P(),A(o.$$.fragment),this.h()},l(a){e=I(a,"H3",{class:!0});var i=V(e);t=ie(i,n),i.forEach($),s=N(a),O(o.$$.fragment,a),this.h()},h(){h(e,"class","svelte-1kekodt")},m(a,i){T(a,e,i),g(e,t),T(a,s,i),R(o,a,i),r=!0},p:Y,i(a){r||(b(o.$$.fragment,a),r=!0)},o(a){E(o.$$.fragment,a),r=!1},d(a){a&&($(e),$(s)),L(o,a)}}}function bs(l){return{c:Y,l:Y,m:Y,p:Y,i:Y,o:Y,d:Y}}function ks(l){let e,n,t,s;const o=[Cs,ws],r=[];function a(i,u){return i[2].length>0?0:1}return e=a(l),n=r[e]=o[e](l),{c(){n.c(),t=we()},l(i){n.l(i),t=we()},m(i,u){r[e].m(i,u),T(i,t,u),s=!0},p(i,u){let c=e;e=a(i),e===c?r[e].p(i,u):(ae(),E(r[c],1,1,()=>{r[c]=null}),ce(),n=r[e],n?n.p(i,u):(n=r[e]=o[e](i),n.c()),b(n,1),n.m(t.parentNode,t))},i(i){s||(b(n),s=!0)},o(i){E(n),s=!1},d(i){i&&$(t),r[e].d(i)}}}function ws(l){let e,n="Comments for this post are not available";return{c(){e=S("span"),e.textContent=n,this.h()},l(t){e=I(t,"SPAN",{class:!0,"data-svelte-h":!0}),fe(e)!=="svelte-4t2lxe"&&(e.textContent=n),this.h()},h(){h(e,"class","no-comments svelte-1kekodt")},m(t,s){T(t,e,s)},p:Y,i:Y,o:Y,d(t){t&&$(e)}}}function Cs(l){let e,n,t=Ce(l[2]),s=[];for(let r=0;r<t.length;r+=1)s[r]=Et(bt(l,t,r));const o=r=>E(s[r],1,1,()=>{s[r]=null});return{c(){e=S("ul");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){e=I(r,"UL",{class:!0});var a=V(e);for(let i=0;i<s.length;i+=1)s[i].l(a);a.forEach($),this.h()},h(){h(e,"class","comments svelte-1kekodt")},m(r,a){T(r,e,a);for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(e,null);n=!0},p(r,a){if(a&1){t=Ce(r[2]);let i;for(i=0;i<t.length;i+=1){const u=bt(r,t,i);s[i]?(s[i].p(u,a),b(s[i],1)):(s[i]=Et(u),s[i].c(),b(s[i],1),s[i].m(e,null))}for(ae(),i=t.length;i<s.length;i+=1)o(i);ce()}},i(r){if(!n){for(let a=0;a<t.length;a+=1)b(s[a]);n=!0}},o(r){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)E(s[a]);n=!1},d(r){r&&$(e),Ue(s,r)}}}function Et(l){let e,n;return e=new dn({props:{comment:l[3]}}),{c(){A(e.$$.fragment)},l(t){O(e.$$.fragment,t)},m(t,s){R(e,t,s),n=!0},p(t,s){const o={};s&1&&(o.comment=t[3]),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){E(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function Es(l){let e,n;return e=new vn({}),{c(){A(e.$$.fragment)},l(t){O(e.$$.fragment,t)},m(t,s){R(e,t,s),n=!0},p:Y,i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){E(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function ys(l){let e,n,t,s,o,r,a,i,u=l[0].id+"",c,m,_,w,C,y,k="•",d,p,f=l[0].type.toUpperCase()+"",v,Z,H,X="•",J,se,te,D,x="•",ne,z,U,le,M,j,Q,K="•",pe,ge,Ie,De,Pe,ze,Ee,Ne,He="Comments",Ke,Oe,G;w=new un({props:{value:l[0].rating}}),se=new fn({props:{value:l[0].score}}),z=new pn({props:{value:l[0].change}}),M=new qt({props:{source:"https://rule34.xxx/index.php?page=post&s=view&id="+l[0].id}}),ge=new _n({props:{url:l[0].file_url}});let B=l[0].source&&wt(l),he=Ce(Object.entries(l[1])),W=[];for(let q=0;q<he.length;q+=1)W[q]=Ct(kt(l,he,q));const Te=q=>E(W[q],1,1,()=>{W[q]=null});let ee={ctx:l,current:null,token:null,hasCatch:!1,pending:Es,then:ks,catch:bs,value:2,blocks:[,,,]};return ut(Oe=at(l[0].id),ee),{c(){e=S("div"),n=S("img"),s=P(),o=S("h1"),r=oe("Post "),a=S("b"),i=oe("#"),c=oe(u),m=P(),_=S("div"),A(w.$$.fragment),C=P(),y=S("span"),y.textContent=k,d=P(),p=S("span"),v=oe(f),Z=P(),H=S("span"),H.textContent=X,J=P(),A(se.$$.fragment),te=P(),D=S("span"),D.textContent=x,ne=P(),A(z.$$.fragment),U=P(),le=S("div"),A(M.$$.fragment),j=P(),Q=S("span"),Q.textContent=K,pe=P(),A(ge.$$.fragment),Ie=P(),B&&B.c(),De=P(),Pe=S("div");for(let q=0;q<W.length;q+=1)W[q].c();ze=P(),Ee=S("div"),Ne=S("h3"),Ne.textContent=He,Ke=P(),ee.block.c(),this.h()},l(q){e=I(q,"DIV",{class:!0});var F=V(e);n=I(F,"IMG",{class:!0,src:!0,alt:!0}),s=N(F),o=I(F,"H1",{class:!0});var be=V(o);r=ie(be,"Post "),a=I(be,"B",{});var Me=V(a);i=ie(Me,"#"),c=ie(Me,u),Me.forEach($),be.forEach($),m=N(F),_=I(F,"DIV",{class:!0});var ue=V(_);O(w.$$.fragment,ue),C=N(ue),y=I(ue,"SPAN",{"data-svelte-h":!0}),fe(y)!=="svelte-7hh8jk"&&(y.textContent=k),d=N(ue),p=I(ue,"SPAN",{});var We=V(p);v=ie(We,f),We.forEach($),Z=N(ue),H=I(ue,"SPAN",{"data-svelte-h":!0}),fe(H)!=="svelte-7hh8jk"&&(H.textContent=X),J=N(ue),O(se.$$.fragment,ue),te=N(ue),D=I(ue,"SPAN",{"data-svelte-h":!0}),fe(D)!=="svelte-7hh8jk"&&(D.textContent=x),ne=N(ue),O(z.$$.fragment,ue),ue.forEach($),U=N(F),le=I(F,"DIV",{class:!0});var ye=V(le);O(M.$$.fragment,ye),j=N(ye),Q=I(ye,"SPAN",{"data-svelte-h":!0}),fe(Q)!=="svelte-7hh8jk"&&(Q.textContent=K),pe=N(ye),O(ge.$$.fragment,ye),Ie=N(ye),B&&B.l(ye),ye.forEach($),De=N(F),Pe=I(F,"DIV",{});var re=V(Pe);for(let rt=0;rt<W.length;rt+=1)W[rt].l(re);re.forEach($),ze=N(F),Ee=I(F,"DIV",{});var Re=V(Ee);Ne=I(Re,"H3",{class:!0,"data-svelte-h":!0}),fe(Ne)!=="svelte-kc6sae"&&(Ne.textContent=He),Ke=N(Re),ee.block.l(Re),Re.forEach($),F.forEach($),this.h()},h(){h(n,"class","preview svelte-1kekodt"),ve(n.src,t=l[0].sample_url)||h(n,"src",t),h(n,"alt","preview"),h(o,"class","svelte-1kekodt"),h(_,"class","flex-row svelte-1kekodt"),h(le,"class","flex-row svelte-1kekodt"),h(Ne,"class","svelte-1kekodt"),h(e,"class","details svelte-1kekodt")},m(q,F){T(q,e,F),g(e,n),g(e,s),g(e,o),g(o,r),g(o,a),g(a,i),g(a,c),g(e,m),g(e,_),R(w,_,null),g(_,C),g(_,y),g(_,d),g(_,p),g(p,v),g(_,Z),g(_,H),g(_,J),R(se,_,null),g(_,te),g(_,D),g(_,ne),R(z,_,null),g(e,U),g(e,le),R(M,le,null),g(le,j),g(le,Q),g(le,pe),R(ge,le,null),g(le,Ie),B&&B.m(le,null),g(e,De),g(e,Pe);for(let be=0;be<W.length;be+=1)W[be]&&W[be].m(Pe,null);g(e,ze),g(e,Ee),g(Ee,Ne),g(Ee,Ke),ee.block.m(Ee,ee.anchor=null),ee.mount=()=>Ee,ee.anchor=null,G=!0},p(q,[F]){l=q,(!G||F&1&&!ve(n.src,t=l[0].sample_url))&&h(n,"src",t),(!G||F&1)&&u!==(u=l[0].id+"")&&Fe(c,u);const be={};F&1&&(be.value=l[0].rating),w.$set(be),(!G||F&1)&&f!==(f=l[0].type.toUpperCase()+"")&&Fe(v,f);const Me={};F&1&&(Me.value=l[0].score),se.$set(Me);const ue={};F&1&&(ue.value=l[0].change),z.$set(ue);const We={};F&1&&(We.source="https://rule34.xxx/index.php?page=post&s=view&id="+l[0].id),M.$set(We);const ye={};if(F&1&&(ye.url=l[0].file_url),ge.$set(ye),l[0].source?B?(B.p(l,F),F&1&&b(B,1)):(B=wt(l),B.c(),b(B,1),B.m(le,null)):B&&(ae(),E(B,1,1,()=>{B=null}),ce()),F&2){he=Ce(Object.entries(l[1]));let re;for(re=0;re<he.length;re+=1){const Re=kt(l,he,re);W[re]?(W[re].p(Re,F),b(W[re],1)):(W[re]=Ct(Re),W[re].c(),b(W[re],1),W[re].m(Pe,null))}for(ae(),re=he.length;re<W.length;re+=1)Te(re);ce()}ee.ctx=l,F&1&&Oe!==(Oe=at(l[0].id))&&ut(Oe,ee)||bn(ee,l,F)},i(q){if(!G){b(w.$$.fragment,q),b(se.$$.fragment,q),b(z.$$.fragment,q),b(M.$$.fragment,q),b(ge.$$.fragment,q),b(B);for(let F=0;F<he.length;F+=1)b(W[F]);b(ee.block),G=!0}},o(q){E(w.$$.fragment,q),E(se.$$.fragment,q),E(z.$$.fragment,q),E(M.$$.fragment,q),E(ge.$$.fragment,q),E(B),W=W.filter(Boolean);for(let F=0;F<W.length;F+=1)E(W[F]);for(let F=0;F<3;F+=1){const be=ee.blocks[F];E(be)}G=!1},d(q){q&&$(e),L(w),L(se),L(z),L(M),L(ge),B&&B.d(),Ue(W,q),ee.block.d(),ee.token=null,ee=null}}}function Ss(l,e,n){let{post:t}=e,s=t.tags.reduce((o,r)=>(o[r.type]===void 0&&(o[r.type]=[]),o[r.type].push(r),o),{});return l.$$set=o=>{"post"in o&&n(0,t=o.post)},[t,s]}class Is extends me{constructor(e){super(),de(this,e,Ss,ys,_e,{post:0})}}function yt(l,e,n){const t=l.slice();return t[17]=e[n],t[19]=n,t}function St(l){let e,n;return e=new Kt({props:{post:l[3],offset:l[6]}}),{c(){A(e.$$.fragment)},l(t){O(e.$$.fragment,t)},m(t,s){R(e,t,s),n=!0},p(t,s){const o={};s&8&&(o.post=t[3]),s&64&&(o.offset=t[6]),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){E(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function It(l){let e,n;return e=new Kt({props:{post:l[4],offset:l[7]}}),{c(){A(e.$$.fragment)},l(t){O(e.$$.fragment,t)},m(t,s){R(e,t,s),n=!0},p(t,s){const o={};s&16&&(o.post=t[4]),s&128&&(o.offset=t[7]),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){E(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function Dt(l){let e,n=`${l[19]*100}vh`;return{c(){e=S("div"),this.h()},l(t){e=I(t,"DIV",{class:!0}),V(e).forEach($),this.h()},h(){h(e,"class","pseudo snap-item svelte-3khu3"),Ve(e,"top",n)},m(t,s){T(t,e,s)},p:Y,d(t){t&&$(e)}}}function Ds(l){let e,n,t,s,o,r,a,i,u,c,m,_,w,C=l[3]&&St(l);s=new hs({props:{post:l[2]}}),r=new Is({props:{post:l[2]}});let y=l[4]&&It(l),k=Ce({length:l[8].posts.length}),d=[];for(let p=0;p<k.length;p+=1)d[p]=Dt(yt(l,k,p));return c=new Ht({props:{rootMargin:window.innerHeight*2+"px"}}),c.$on("intersection",l[13]),{c(){e=S("div"),C&&C.c(),n=P(),t=S("div"),A(s.$$.fragment),o=P(),A(r.$$.fragment),a=P(),y&&y.c(),i=P();for(let p=0;p<d.length;p+=1)d[p].c();u=P(),A(c.$$.fragment),this.h()},l(p){e=I(p,"DIV",{class:!0});var f=V(e);C&&C.l(f),n=N(f),t=I(f,"DIV",{class:!0});var v=V(t);O(s.$$.fragment,v),o=N(v),O(r.$$.fragment,v),v.forEach($),a=N(f),y&&y.l(f),i=N(f);for(let Z=0;Z<d.length;Z+=1)d[Z].l(f);u=N(f),O(c.$$.fragment,f),f.forEach($),this.h()},h(){h(t,"class","screen snap-container horizontal current svelte-3khu3"),Ve(t,"top",l[5]),h(e,"class","root screen snap-container svelte-3khu3")},m(p,f){T(p,e,f),C&&C.m(e,null),g(e,n),g(e,t),R(s,t,null),g(t,o),R(r,t,null),l[12](t),g(e,a),y&&y.m(e,null),g(e,i);for(let v=0;v<d.length;v+=1)d[v]&&d[v].m(e,null);g(e,u),R(c,e,null),l[14](e),m=!0,_||(w=ke(e,"scroll",l[10]),_=!0)},p(p,[f]){p[3]?C?(C.p(p,f),f&8&&b(C,1)):(C=St(p),C.c(),b(C,1),C.m(e,n)):C&&(ae(),E(C,1,1,()=>{C=null}),ce());const v={};f&4&&(v.post=p[2]),s.$set(v);const Z={};if(f&4&&(Z.post=p[2]),r.$set(Z),f&32&&Ve(t,"top",p[5]),p[4]?y?(y.p(p,f),f&16&&b(y,1)):(y=It(p),y.c(),b(y,1),y.m(e,i)):y&&(ae(),E(y,1,1,()=>{y=null}),ce()),f&256){k=Ce({length:p[8].posts.length});let H;for(H=0;H<k.length;H+=1){const X=yt(p,k,H);d[H]?d[H].p(X,f):(d[H]=Dt(X),d[H].c(),d[H].m(e,u))}for(;H<d.length;H+=1)d[H].d(1);d.length=k.length}},i(p){m||(b(C),b(s.$$.fragment,p),b(r.$$.fragment,p),b(y),b(c.$$.fragment,p),m=!0)},o(p){E(C),E(s.$$.fragment,p),E(r.$$.fragment,p),E(y),E(c.$$.fragment,p),m=!1},d(p){p&&$(e),C&&C.d(),L(s),L(r),l[12](null),y&&y.d(),Ue(d,p),L(c),l[14](null),_=!1,w()}}}function Ps(l,e,n){let t;$e(l,qe,v=>n(8,t=v));let{index:s}=e,o,r,a=t.posts[s],i=s>0?t.posts[s-1]:void 0,u=s<t.posts.length-1?t.posts[s+1]:void 0,c=`${s*100}vh`,m=`${(s-1)*100}vh`,_=`${(s+1)*100}vh`;const w=Ae(),C=()=>{r&&(r.scrollIntoView(),n(1,r.scrollLeft=0,r))},y=v=>{const Z=v.target,H=Z.getBoundingClientRect().height,X=Z.scrollTop/H,J=Math.round(X);J!=s&&requestAnimationFrame(()=>{n(11,s=J),n(2,a=t.posts[s]),n(3,i=s>0?t.posts[s-1]:void 0),n(4,u=s<t.posts.length-1?t.posts[s+1]:void 0),n(5,c=`${s*100}vh`),n(6,m=`${(s-1)*100}vh`),n(7,_=`${(s+1)*100}vh`),r&&n(1,r.scrollLeft=0,r)})},k=v=>{v.key==="d"&&(v.preventDefault(),v.stopPropagation(),r.scrollLeft==0?r.scrollBy({left:o.clientWidth,top:0,behavior:"smooth"}):r.scrollBy({left:-o.clientWidth,top:0,behavior:"smooth"})),v.key==="ArrowUp"&&(v.preventDefault(),v.stopPropagation(),o.scrollTo({left:0,top:o.clientHeight*(s-1),behavior:"smooth"})),v.key==="ArrowDown"&&(v.preventDefault(),v.stopPropagation(),o.scrollTo({left:0,top:o.clientHeight*(s+1),behavior:"smooth"}))};xe(()=>{document.addEventListener("keydown",k),C()}),et(()=>document.removeEventListener("keydown",k));function d(v){Se[v?"unshift":"push"](()=>{r=v,n(1,r)})}const p=()=>w("endreached");function f(v){Se[v?"unshift":"push"](()=>{o=v,n(0,o)})}return l.$$set=v=>{"index"in v&&n(11,s=v.index)},[o,r,a,i,u,c,m,_,t,w,y,s,d,p,f]}class Ns extends me{constructor(e){super(),de(this,e,Ps,Ds,_e,{index:11})}}function Ts(l){let e;return{c(){e=S("i"),this.h()},l(n){e=I(n,"I",{class:!0}),V(e).forEach($),this.h()},h(){h(e,"class","codicon codicon-close")},m(n,t){T(n,e,t)},p:Y,d(n){n&&$(e)}}}function Vs(l){let e,n,t,s,o;function r(i){l[2](i)}let a={};return l[0]!==void 0&&(a.index=l[0]),e=new Ns({props:a}),Se.push(()=>Ze(e,"index",r)),e.$on("endreached",l[3]),s=new Ut({props:{class:"button-close",$$slots:{default:[Ts]},$$scope:{ctx:l}}}),s.$on("click",l[1]),{c(){A(e.$$.fragment),t=P(),A(s.$$.fragment)},l(i){O(e.$$.fragment,i),t=N(i),O(s.$$.fragment,i)},m(i,u){R(e,i,u),T(i,t,u),R(s,i,u),o=!0},p(i,u){const c={};!n&&u&1&&(n=!0,c.index=i[0],Ye(()=>n=!1)),e.$set(c);const m={};u&64&&(m.$$scope={dirty:u,ctx:i}),s.$set(m)},i(i){o||(b(e.$$.fragment,i),b(s.$$.fragment,i),o=!0)},o(i){E(e.$$.fragment,i),E(s.$$.fragment,i),o=!1},d(i){i&&$(t),L(e,i),L(s,i)}}}function As(l){let e,n;return e=new cs({props:{$$slots:{default:[Vs]},$$scope:{ctx:l}}}),e.$on("close",l[1]),{c(){A(e.$$.fragment)},l(t){O(e.$$.fragment,t)},m(t,s){R(e,t,s),n=!0},p(t,[s]){const o={};s&65&&(o.$$scope={dirty:s,ctx:t}),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){E(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function Os(l,e,n){let{index:t}=e;const s=Ae(),o=u=>{u.key==="f"&&(u.preventDefault(),u.stopPropagation(),s("close"))},r=()=>s("close",t);xe(()=>document.addEventListener("keydown",o)),et(()=>document.removeEventListener("keydown",o));function a(u){t=u,n(0,t)}function i(u){st.call(this,l,u)}return l.$$set=u=>{"index"in u&&n(0,t=u.index)},[t,r,a,i]}class Rs extends me{constructor(e){super(),de(this,e,Os,As,_e,{index:0})}}function Pt(l,e,n){const t=l.slice();return t[8]=e[n],t[10]=n,t}function Nt(l,e,n){const t=l.slice();return t[8]=e[n],t[10]=n,t}function Ls(l){let e,n,t=Ce(l[1].posts),s=[];for(let r=0;r<t.length;r+=1)s[r]=Tt(Pt(l,t,r));const o=r=>E(s[r],1,1,()=>{s[r]=null});return{c(){e=S("section");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){e=I(r,"SECTION",{class:!0,style:!0});var a=V(e);for(let i=0;i<s.length;i+=1)s[i].l(a);a.forEach($),this.h()},h(){h(e,"class","multi-column svelte-wypqh"),Ve(e,"grid-template-columns","repeat("+l[2]+", 1fr)")},m(r,a){T(r,e,a);for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(e,null);n=!0},p(r,a){if(a&3){t=Ce(r[1].posts);let i;for(i=0;i<t.length;i+=1){const u=Pt(r,t,i);s[i]?(s[i].p(u,a),b(s[i],1)):(s[i]=Tt(u),s[i].c(),b(s[i],1),s[i].m(e,null))}for(ae(),i=t.length;i<s.length;i+=1)o(i);ce()}(!n||a&4)&&Ve(e,"grid-template-columns","repeat("+r[2]+", 1fr)")},i(r){if(!n){for(let a=0;a<t.length;a+=1)b(s[a]);n=!0}},o(r){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)E(s[a]);n=!1},d(r){r&&$(e),Ue(s,r)}}}function Fs(l){let e,n,t=Ce(l[1].posts),s=[];for(let r=0;r<t.length;r+=1)s[r]=Vt(Nt(l,t,r));const o=r=>E(s[r],1,1,()=>{s[r]=null});return{c(){e=S("section");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){e=I(r,"SECTION",{class:!0});var a=V(e);for(let i=0;i<s.length;i+=1)s[i].l(a);a.forEach($),this.h()},h(){h(e,"class","single-column svelte-wypqh")},m(r,a){T(r,e,a);for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(e,null);n=!0},p(r,a){if(a&3){t=Ce(r[1].posts);let i;for(i=0;i<t.length;i+=1){const u=Nt(r,t,i);s[i]?(s[i].p(u,a),b(s[i],1)):(s[i]=Vt(u),s[i].c(),b(s[i],1),s[i].m(e,null))}for(ae(),i=t.length;i<s.length;i+=1)o(i);ce()}},i(r){if(!n){for(let a=0;a<t.length;a+=1)b(s[a]);n=!0}},o(r){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)E(s[a]);n=!1},d(r){r&&$(e),Ue(s,r)}}}function Tt(l){let e,n;function t(){return l[6](l[10])}return e=new rs({props:{post:l[8]}}),e.$on("click",t),{c(){A(e.$$.fragment)},l(s){O(e.$$.fragment,s)},m(s,o){R(e,s,o),n=!0},p(s,o){l=s;const r={};o&2&&(r.post=l[8]),e.$set(r)},i(s){n||(b(e.$$.fragment,s),n=!0)},o(s){E(e.$$.fragment,s),n=!1},d(s){L(e,s)}}}function Vt(l){let e,n;function t(){return l[5](l[10])}return e=new ns({props:{post:l[8]}}),e.$on("fullscreen",t),{c(){A(e.$$.fragment)},l(s){O(e.$$.fragment,s)},m(s,o){R(e,s,o),n=!0},p(s,o){l=s;const r={};o&2&&(r.post=l[8]),e.$set(r)},i(s){n||(b(e.$$.fragment,s),n=!0)},o(s){E(e.$$.fragment,s),n=!1},d(s){L(e,s)}}}function At(l){let e,n;return e=new Rs({props:{index:l[0]}}),e.$on("close",l[3]),e.$on("endreached",l[7]),{c(){A(e.$$.fragment)},l(t){O(e.$$.fragment,t)},m(t,s){R(e,t,s),n=!0},p(t,s){const o={};s&1&&(o.index=t[0]),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){E(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function Ms(l){let e,n,t=Qe(l[1].postCount)+"",s,o,r,a,i,u,c,m,_,w;a=new Yn({}),a.$on("sortfilterupdate",l[4]);const C=[Fs,Ls],y=[];function k(p,f){return p[2]==="1"?0:1}u=k(l),c=y[u]=C[u](l);let d=l[0]!==void 0&&At(l);return{c(){e=S("div"),n=S("span"),s=oe(t),o=oe(" posts"),r=P(),A(a.$$.fragment),i=P(),c.c(),m=P(),d&&d.c(),_=we(),this.h()},l(p){e=I(p,"DIV",{class:!0});var f=V(e);n=I(f,"SPAN",{});var v=V(n);s=ie(v,t),o=ie(v," posts"),v.forEach($),r=N(f),O(a.$$.fragment,f),f.forEach($),i=N(p),c.l(p),m=N(p),d&&d.l(p),_=we(),this.h()},h(){h(e,"class","svelte-wypqh")},m(p,f){T(p,e,f),g(e,n),g(n,s),g(n,o),g(e,r),R(a,e,null),T(p,i,f),y[u].m(p,f),T(p,m,f),d&&d.m(p,f),T(p,_,f),w=!0},p(p,[f]){(!w||f&2)&&t!==(t=Qe(p[1].postCount)+"")&&Fe(s,t);let v=u;u=k(p),u===v?y[u].p(p,f):(ae(),E(y[v],1,1,()=>{y[v]=null}),ce(),c=y[u],c?c.p(p,f):(c=y[u]=C[u](p),c.c()),b(c,1),c.m(m.parentNode,m)),p[0]!==void 0?d?(d.p(p,f),f&1&&b(d,1)):(d=At(p),d.c(),b(d,1),d.m(_.parentNode,_)):d&&(ae(),E(d,1,1,()=>{d=null}),ce())},i(p){w||(b(a.$$.fragment,p),b(c),b(d),w=!0)},o(p){E(a.$$.fragment,p),E(c),E(d),w=!1},d(p){p&&($(e),$(i),$(m),$(_)),L(a),y[u].d(p),d&&d.d(p)}}}function js(l,e,n){let t,s;$e(l,qe,m=>n(1,t=m)),$e(l,Mt,m=>n(2,s=m));let o;const r=m=>{var w;const _=t.posts[m.detail];Xe(_.id),(w=document.getElementById(`post_${_.id}`))==null||w.scrollIntoView(),n(0,o=void 0)};function a(m){st.call(this,l,m)}const i=m=>{n(0,o=m)},u=m=>{n(0,o=m)};function c(m){st.call(this,l,m)}return[o,t,s,r,a,i,u,c]}class Bs extends me{constructor(e){super(),de(this,e,js,Ms,_e,{})}}function Gs(l){let e;return{c(){e=oe("Reset Filter")},l(n){e=ie(n,"Reset Filter")},m(n,t){T(n,e,t)},d(n){n&&$(e)}}}function qs(l){let e,n,t,s,o="We couldn't find any posts matching your tags. Sorry...",r,a,i;return a=new Je({props:{title:"In case your filter caused all posts to vanish. Reset it.",$$slots:{default:[Gs]},$$scope:{ctx:l}}}),a.$on("click",l[1]),{c(){e=S("img"),t=P(),s=S("p"),s.textContent=o,r=P(),A(a.$$.fragment),this.h()},l(u){e=I(u,"IMG",{src:!0,alt:!0,class:!0}),t=N(u),s=I(u,"P",{"data-svelte-h":!0}),fe(s)!=="svelte-1utxj3w"&&(s.textContent=o),r=N(u),O(a.$$.fragment,u),this.h()},h(){ve(e.src,n=jt+"/assets/shironeko-confused.png")||h(e,"src",n),h(e,"alt","Nothing here..."),h(e,"class","svelte-1bb5e7g")},m(u,c){T(u,e,c),T(u,t,c),T(u,s,c),T(u,r,c),R(a,u,c),i=!0},p(u,[c]){const m={};c&4&&(m.$$scope={dirty:c,ctx:u}),a.$set(m)},i(u){i||(b(a.$$.fragment,u),i=!0)},o(u){E(a.$$.fragment,u),i=!1},d(u){u&&($(e),$(t),$(s),$(r)),L(a,u)}}}function Us(l){const e=Ae();return[e,()=>{Ge.reset(),Le.reset(),e("sortfilterupdate")}]}class zs extends me{constructor(e){super(),de(this,e,Us,qs,_e,{})}}function Hs(l){let e;return{c(){e=oe("Search")},l(n){e=ie(n,"Search")},m(n,t){T(n,e,t)},d(n){n&&$(e)}}}function Ks(l){let e,n,t,s,o,r;const a=[Zs,Ys],i=[];function u(c,m){return c[2].postCount===0?0:1}return n=u(l),t=i[n]=a[n](l),o=new Cn({}),{c(){e=S("section"),t.c(),s=P(),A(o.$$.fragment),this.h()},l(c){e=I(c,"SECTION",{class:!0});var m=V(e);t.l(m),m.forEach($),s=N(c),O(o.$$.fragment,c),this.h()},h(){h(e,"class","svelte-rk0y4a")},m(c,m){T(c,e,m),i[n].m(e,null),T(c,s,m),R(o,c,m),r=!0},p(c,m){let _=n;n=u(c),n===_?i[n].p(c,m):(ae(),E(i[_],1,1,()=>{i[_]=null}),ce(),t=i[n],t?t.p(c,m):(t=i[n]=a[n](c),t.c()),b(t,1),t.m(e,null))},i(c){r||(b(t),b(o.$$.fragment,c),r=!0)},o(c){E(t),E(o.$$.fragment,c),r=!1},d(c){c&&($(e),$(s)),i[n].d(),L(o,c)}}}function Ws(l){let e,n;return e=new Rn({props:{error:l[0]}}),{c(){A(e.$$.fragment)},l(t){O(e.$$.fragment,t)},m(t,s){R(e,t,s),n=!0},p(t,s){const o={};s&1&&(o.error=t[0]),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){E(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function Ys(l){let e,n,t,s,o,r;e=new Bs({}),e.$on("sortfilterupdate",l[8]),e.$on("endreached",l[9]);const a=[Qs,Js],i=[];function u(c,m){return c[2].posts.length===c[2].postCount?0:1}return t=u(l),s=i[t]=a[t](l),{c(){A(e.$$.fragment),n=P(),s.c(),o=we()},l(c){O(e.$$.fragment,c),n=N(c),s.l(c),o=we()},m(c,m){R(e,c,m),T(c,n,m),i[t].m(c,m),T(c,o,m),r=!0},p(c,m){let _=t;t=u(c),t===_?i[t].p(c,m):(ae(),E(i[_],1,1,()=>{i[_]=null}),ce(),s=i[t],s?s.p(c,m):(s=i[t]=a[t](c),s.c()),b(s,1),s.m(o.parentNode,o))},i(c){r||(b(e.$$.fragment,c),b(s),r=!0)},o(c){E(e.$$.fragment,c),E(s),r=!1},d(c){c&&($(n),$(o)),L(e,c),i[t].d(c)}}}function Zs(l){let e,n;return e=new zs({}),e.$on("sortfilterupdate",l[8]),{c(){A(e.$$.fragment)},l(t){O(e.$$.fragment,t)},m(t,s){R(e,t,s),n=!0},p:Y,i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){E(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function Js(l){let e,n;return e=new Ht({props:{rootMargin:1e3/Number(l[6])+"px"}}),e.$on("intersection",l[9]),{c(){A(e.$$.fragment)},l(t){O(e.$$.fragment,t)},m(t,s){R(e,t,s),n=!0},p(t,s){const o={};s&64&&(o.rootMargin=1e3/Number(t[6])+"px"),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){E(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function Qs(l){let e,n;return e=new Fn({}),{c(){A(e.$$.fragment)},l(t){O(e.$$.fragment,t)},m(t,s){R(e,t,s),n=!0},p:Y,i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){E(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function Ot(l){let e,n;return e=new Vn({props:{tags:l[4]}}),e.$on("close",l[14]),e.$on("submit",l[15]),{c(){A(e.$$.fragment)},l(t){O(e.$$.fragment,t)},m(t,s){R(e,t,s),n=!0},p(t,s){const o={};s&16&&(o.tags=t[4]),e.$set(o)},i(t){n||(b(e.$$.fragment,t),n=!0)},o(t){E(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function Xs(l){let e,n,t,s,o,r,a,i,u,c,m,_,w,C;n=new en({}),s=new kn({props:{placeholder:"Search for tags",fetchSuggestions:l[7]}}),s.$on("pick",l[10]),r=new Je({props:{title:"Search with the tags above",$$slots:{default:[Hs]},$$scope:{ctx:l}}}),r.$on("click",l[8]),i=new tn({props:{tags:[...l[4],...l[3]]}}),i.$on("click",l[11]),i.$on("contextmenu",l[12]),i.$on("createSupertag",l[13]);const y=[Ws,Ks],k=[];function d(f,v){return f[0]?0:f[2].requested?1:-1}~(c=d(l))&&(m=k[c]=y[c](l));let p=l[1]&&Ot(l);return{c(){e=S("section"),A(n.$$.fragment),t=P(),A(s.$$.fragment),o=P(),A(r.$$.fragment),a=P(),A(i.$$.fragment),u=P(),m&&m.c(),_=P(),p&&p.c(),w=we(),this.h()},l(f){e=I(f,"SECTION",{id:!0,class:!0});var v=V(e);O(n.$$.fragment,v),t=N(v),O(s.$$.fragment,v),o=N(v),O(r.$$.fragment,v),a=N(v),O(i.$$.fragment,v),v.forEach($),u=N(f),m&&m.l(f),_=N(f),p&&p.l(f),w=we(),this.h()},h(){h(e,"id","search"),h(e,"class","svelte-rk0y4a")},m(f,v){T(f,e,v),R(n,e,null),g(e,t),R(s,e,null),g(e,o),R(r,e,null),g(e,a),R(i,e,null),T(f,u,v),~c&&k[c].m(f,v),T(f,_,v),p&&p.m(f,v),T(f,w,v),C=!0},p(f,[v]){const Z={};v&16777216&&(Z.$$scope={dirty:v,ctx:f}),r.$set(Z);const H={};v&24&&(H.tags=[...f[4],...f[3]]),i.$set(H);let X=c;c=d(f),c===X?~c&&k[c].p(f,v):(m&&(ae(),E(k[X],1,1,()=>{k[X]=null}),ce()),~c?(m=k[c],m?m.p(f,v):(m=k[c]=y[c](f),m.c()),b(m,1),m.m(_.parentNode,_)):m=null),f[1]?p?(p.p(f,v),v&2&&b(p,1)):(p=Ot(f),p.c(),b(p,1),p.m(w.parentNode,w)):p&&(ae(),E(p,1,1,()=>{p=null}),ce())},i(f){C||(b(n.$$.fragment,f),b(s.$$.fragment,f),b(r.$$.fragment,f),b(i.$$.fragment,f),b(m),b(p),C=!0)},o(f){E(n.$$.fragment,f),E(s.$$.fragment,f),E(r.$$.fragment,f),E(i.$$.fragment,f),E(m),E(p),C=!1},d(f){f&&($(e),$(u),$(_),$(w)),L(n),L(s),L(r),L(i),~c&&k[c].d(f),p&&p.d(f)}}}function xs(l,e,n){let t,s,o,r,a,i,u,c;$e(l,qe,D=>n(2,t=D)),$e(l,ot,D=>n(3,s=D)),$e(l,Le,D=>n(18,o=D)),$e(l,Ge,D=>n(19,r=D)),$e(l,In,D=>n(20,a=D)),$e(l,tt,D=>n(4,i=D)),$e(l,ft,D=>n(5,u=D)),$e(l,Mt,D=>n(6,c=D));let m=!1,_,w=!1,C=0;const y=async D=>{const x=await En(D);return[...u.items.filter(({name:z})=>z.toLowerCase().includes(D.toLowerCase())).map(z=>({label:z.name,count:z.tags.length,type:"supertag"})),...x]},k=()=>new nn().withPid(t.pageCount).withTags(i).withBlockedContent(a).withSortProperty(r.property).withSortDirection(r.direction).withScoreValue(o.scoreValue).withScoreComparator(o.scoreComparator).withRating(o.rating).withSupertags(s),d=async D=>{if(!m){n(0,_=void 0),m=!0;try{const x=t.pageCount;await D(),Sn(x).catch(()=>{})}catch(x){n(0,_=x),console.warn(x)}finally{m=!1}}},p=async()=>{qe.reset(),C=0,d(async()=>{const[D,x]=await k().getPageAndCount();qe.addPage(D,x)})},f=async()=>{d(async()=>{const D=await k().getPage();qe.addPage(D)})},v=D=>{var x,ne;if((D.key==="/"||D.key==="s")&&(!document.activeElement||document.activeElement===document.body)&&((x=document.getElementById("searchbar"))==null||x.focus(),D.preventDefault(),D.stopPropagation()),D.ctrlKey&&D.key==="Enter"&&(D.preventDefault(),D.stopPropagation(),p()),D.ctrlKey&&D.key==="m"&&((ne=document.getElementById("select-modifier"))==null||ne.click()),D.ctrlKey&&D.key==="ArrowDown"){const z=document.getElementsByClassName("post-media");z[C].focus(),C=Math.min(C+1,Math.max(0,z.length-1))}D.ctrlKey&&D.key==="ArrowUp"&&(document.getElementsByClassName("post-media")[C].focus(),C=Math.max(C-1,0))};return xe(async()=>{document.addEventListener("keydown",v)}),et(()=>{document.removeEventListener("keydown",v)}),[_,w,t,s,i,u,c,y,p,f,async D=>{const x=D.detail;if(x.type==="supertag"){const ne=u.items.find(z=>z.name===x.label);if(!ne){console.warn("Supertag not present.");return}ot.addOrReplace(ne)}else{const ne=await yn(D.detail.label);tt.addOrReplace({name:D.detail.label,modifier:D.detail.modifier,count:D.detail.count,type:(ne==null?void 0:ne.type)??"tag"})}},D=>"description"in D.detail?ot.removeByName(D.detail.name):tt.removeByName(D.detail.name),D=>{"description"in D.detail||(D.detail.modifier=wn(D.detail.modifier),tt.addOrReplace(D.detail))},()=>n(1,w=!0),()=>n(1,w=!1),D=>ft.add(D.detail)]}class El extends me{constructor(e){super(),de(this,e,xs,Xs,_e,{})}}export{El as component};
