import{s as re,f as C,a as N,g as I,c as O,y as ce,D as pe,j as $,i as P,d as g,E as me,l as x,m as ee,e as _e,h as T,u as y,F as le,n as Oe,C as fe,G as vt,p as be,H as ye,I as Re,J as it,K as Fe,L as we,v as U,k as qe,M as ze,w as bt,N as kt,z as yt,A as wt,B as Et,o as je,O as Ve,P as Ge,r as ct}from"../chunks/scheduler.88299003.js";import{S as oe,i as ae,b as R,d as A,m as B,a as E,t as S,e as F,g as te,c as se,f as Ae}from"../chunks/index.15b414ac.js";import{s as ue,r as Ne,K as St,A as Ct,a as Me,S as It}from"../chunks/search-builder.1bb73e3b.js";import{S as Dt,n as Pt,s as Ye}from"../chunks/supertags-store.f34a5c3b.js";import{T as Te}from"../chunks/TextButton.2f318c50.js";import{g as Nt,a as Ot}from"../chunks/tags.58927cde.js";import{a as Pe}from"../chunks/active-tags-store.ee1f6602.js";import{b as ut}from"../chunks/paths.6a6310aa.js";import{e as Ee}from"../chunks/each.e59479a4.js";import{D as ft,r as Tt}from"../chunks/Dialog.f8853b6f.js";import{i as pt,D as _t,g as Lt,G as mt,V as Rt,I as At}from"../chunks/Details.2d3d6c23.js";import{f as Le}from"../chunks/format-tag.d6c065e3.js";import{R as Bt,I as Be}from"../chunks/ModifierSelect.623aacd6.js";import{S as Ze}from"../chunks/Select.22805bc7.js";import{R as Ft}from"../chunks/RotatingTextSelect.7e32facf.js";import{b as jt}from"../chunks/blocked-content-store.805c4a3d.js";import{D as Vt}from"../chunks/DetailedTag.28ff9b0d.js";import{S as Mt}from"../chunks/ScrollUpButton.cfa21b3f.js";import{l as qt}from"../chunks/analytics.12ea4383.js";function zt(n){let e;return{c(){e=x("Reset Filter")},l(s){e=ee(s,"Reset Filter")},m(s,t){P(s,e,t)},d(s){s&&g(e)}}}function Gt(n){let e,s,t,l,r="We couldn't find any posts matching your tags. Sorry...",o,a,i;return a=new Te({props:{title:"In case your filter caused all posts to vanish. Reset it.",$$slots:{default:[zt]},$$scope:{ctx:n}}}),a.$on("click",n[1]),{c(){e=C("img"),t=N(),l=C("p"),l.textContent=r,o=N(),R(a.$$.fragment),this.h()},l(f){e=I(f,"IMG",{src:!0,alt:!0,class:!0}),t=O(f),l=I(f,"P",{"data-svelte-h":!0}),ce(l)!=="svelte-1utxj3w"&&(l.textContent=r),o=O(f),A(a.$$.fragment,f),this.h()},h(){pe(e.src,s=ut+"/assets/shironeko-confused.png")||$(e,"src",s),$(e,"alt","Nothing here..."),$(e,"class","svelte-1bb5e7g")},m(f,u){P(f,e,u),P(f,t,u),P(f,l,u),P(f,o,u),B(a,f,u),i=!0},p(f,[u]){const p={};u&4&&(p.$$scope={dirty:u,ctx:f}),a.$set(p)},i(f){i||(E(a.$$.fragment,f),i=!0)},o(f){S(a.$$.fragment,f),i=!1},d(f){f&&(g(e),g(t),g(l),g(o)),F(a,f)}}}function Ut(n){const e=me();return[e,()=>{ue.reset(),e("sortfilterupdate")}]}class Kt extends oe{constructor(e){super(),ae(this,e,Ut,Gt,re,{})}}function Je(n){let e,s;return e=new ft({props:{$$slots:{default:[Yt]},$$scope:{ctx:n}}}),e.$on("close",n[6]),{c(){R(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,l){B(e,t,l),s=!0},p(t,l){const r={};l&32771&&(r.$$scope={dirty:l,ctx:t}),e.$set(r)},i(t){s||(E(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){F(e,t)}}}function Ht(n){let e;return{c(){e=x("Done")},l(s){e=ee(s,"Done")},m(s,t){P(s,e,t)},d(s){s&&g(e)}}}function Wt(n){let e;return{c(){e=x("Reset")},l(s){e=ee(s,"Reset")},m(s,t){P(s,e,t)},d(s){s&&g(e)}}}function Yt(n){let e,s,t="Sorting and Filtering",l,r,o,a="Sorting",i,f,u,p,m,k,v,b,d,h,c="Filtering by Score",_,D,H,Q,W,K,ie,w,z,J="Filtering by Rating",Z,X,M,Se,j,L,Y,q,ne,ke,Ce;function Ie(V){n[8](V)}let Ue={options:Qt};n[1].sortDirection!==void 0&&(Ue.value=n[1].sortDirection),u=new Bt({props:Ue}),be.push(()=>Ae(u,"value",Ie));function gt(V){n[9](V)}let Ke={options:Jt};n[1].sortProperty!==void 0&&(Ke.value=n[1].sortProperty),k=new Ze({props:Ke}),be.push(()=>Ae(k,"value",gt));function ht(V){n[10](V)}let He={options:Xt};n[1].scoreComparator!==void 0&&(He.value=n[1].scoreComparator),H=new Ft({props:He}),be.push(()=>Ae(H,"value",ht));function $t(V){n[13](V)}let We={options:dt};return n[1].rating!==void 0&&(We.value=n[1].rating),M=new Ze({props:We}),be.push(()=>Ae(M,"value",$t)),L=new Te({props:{title:"Return to searching.",$$slots:{default:[Ht]},$$scope:{ctx:n}}}),L.$on("click",n[6]),q=new Te({props:{title:"Reset sort and filter.",type:"secondary",$$slots:{default:[Wt]},$$scope:{ctx:n}}}),q.$on("click",n[7]),{c(){e=C("div"),s=C("h3"),s.textContent=t,l=N(),r=C("label"),o=C("b"),o.textContent=a,i=N(),f=C("div"),R(u.$$.fragment),m=N(),R(k.$$.fragment),b=N(),d=C("label"),h=C("b"),h.textContent=c,_=N(),D=C("div"),R(H.$$.fragment),W=N(),K=C("input"),ie=N(),w=C("label"),z=C("b"),z.textContent=J,Z=N(),X=C("div"),R(M.$$.fragment),j=N(),R(L.$$.fragment),Y=N(),R(q.$$.fragment),this.h()},l(V){e=I(V,"DIV",{class:!0});var G=T(e);s=I(G,"H3",{"data-svelte-h":!0}),ce(s)!=="svelte-15zouq3"&&(s.textContent=t),l=O(G),r=I(G,"LABEL",{class:!0});var de=T(r);o=I(de,"B",{"data-svelte-h":!0}),ce(o)!=="svelte-ekzpgg"&&(o.textContent=a),i=O(de),f=I(de,"DIV",{class:!0});var ge=T(f);A(u.$$.fragment,ge),m=O(ge),A(k.$$.fragment,ge),ge.forEach(g),de.forEach(g),b=O(G),d=I(G,"LABEL",{class:!0});var he=T(d);h=I(he,"B",{"data-svelte-h":!0}),ce(h)!=="svelte-1flca3"&&(h.textContent=c),_=O(he),D=I(he,"DIV",{class:!0});var $e=T(D);A(H.$$.fragment,$e),W=O($e),K=I($e,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),$e.forEach(g),he.forEach(g),ie=O(G),w=I(G,"LABEL",{class:!0});var ve=T(w);z=I(ve,"B",{"data-svelte-h":!0}),ce(z)!=="svelte-1evbw58"&&(z.textContent=J),Z=O(ve),X=I(ve,"DIV",{class:!0});var De=T(X);A(M.$$.fragment,De),De.forEach(g),ve.forEach(g),j=O(G),A(L.$$.fragment,G),Y=O(G),A(q.$$.fragment,G),G.forEach(g),this.h()},h(){$(f,"class","row svelte-1omoy36"),$(r,"class","svelte-1omoy36"),$(K,"type","number"),$(K,"min",0),$(K,"max",1e5),$(K,"step",1),$(K,"class","svelte-1omoy36"),$(D,"class","row svelte-1omoy36"),$(d,"class","svelte-1omoy36"),$(X,"class","row svelte-1omoy36"),$(w,"class","svelte-1omoy36"),$(e,"class","container svelte-1omoy36")},m(V,G){P(V,e,G),y(e,s),y(e,l),y(e,r),y(r,o),y(r,i),y(r,f),B(u,f,null),y(f,m),B(k,f,null),y(e,b),y(e,d),y(d,h),y(d,_),y(d,D),B(H,D,null),y(D,W),y(D,K),ye(K,n[0]),y(e,ie),y(e,w),y(w,z),y(w,Z),y(w,X),B(M,X,null),y(e,j),B(L,e,null),y(e,Y),B(q,e,null),ne=!0,ke||(Ce=[le(K,"input",n[11]),le(K,"keyup",n[12])],ke=!0)},p(V,G){const de={};!p&&G&2&&(p=!0,de.value=V[1].sortDirection,Re(()=>p=!1)),u.$set(de);const ge={};!v&&G&2&&(v=!0,ge.value=V[1].sortProperty,Re(()=>v=!1)),k.$set(ge);const he={};!Q&&G&2&&(Q=!0,he.value=V[1].scoreComparator,Re(()=>Q=!1)),H.$set(he),G&1&&it(K.value)!==V[0]&&ye(K,V[0]);const $e={};!Se&&G&2&&(Se=!0,$e.value=V[1].rating,Re(()=>Se=!1)),M.$set($e);const ve={};G&32768&&(ve.$$scope={dirty:G,ctx:V}),L.$set(ve);const De={};G&32768&&(De.$$scope={dirty:G,ctx:V}),q.$set(De)},i(V){ne||(E(u.$$.fragment,V),E(k.$$.fragment,V),E(H.$$.fragment,V),E(M.$$.fragment,V),E(L.$$.fragment,V),E(q.$$.fragment,V),ne=!0)},o(V){S(u.$$.fragment,V),S(k.$$.fragment,V),S(H.$$.fragment,V),S(M.$$.fragment,V),S(L.$$.fragment,V),S(q.$$.fragment,V),ne=!1},d(V){V&&g(e),F(u),F(k),F(H),F(M),F(L),F(q),ke=!1,Fe(Ce)}}}function Zt(n){let e,s,t,l,r,o,a,i,f,u,p,m,k,v,b,d=n[2]&&Je(n);return{c(){e=C("button"),s=C("i"),t=N(),l=C("span"),r=x(n[4]),o=N(),a=C("i"),i=N(),f=C("span"),u=x(n[3]),p=N(),d&&d.c(),m=_e(),this.h()},l(h){e=I(h,"BUTTON",{class:!0});var c=T(e);s=I(c,"I",{class:!0}),T(s).forEach(g),t=O(c),l=I(c,"SPAN",{});var _=T(l);r=ee(_,n[4]),_.forEach(g),o=O(c),a=I(c,"I",{class:!0}),T(a).forEach(g),i=O(c),f=I(c,"SPAN",{});var D=T(f);u=ee(D,n[3]),D.forEach(g),c.forEach(g),p=O(h),d&&d.l(h),m=_e(),this.h()},h(){$(s,"class","codicon codicon-filter svelte-1omoy36"),$(a,"class","codicon codicon-arrow-swap svelte-1omoy36"),$(e,"class","svelte-1omoy36")},m(h,c){P(h,e,c),y(e,s),y(e,t),y(e,l),y(l,r),y(e,o),y(e,a),y(e,i),y(e,f),y(f,u),P(h,p,c),d&&d.m(h,c),P(h,m,c),k=!0,v||(b=le(e,"click",n[5]),v=!0)},p(h,[c]){(!k||c&16)&&Oe(r,h[4]),(!k||c&8)&&Oe(u,h[3]),h[2]?d?(d.p(h,c),c&4&&E(d,1)):(d=Je(h),d.c(),E(d,1),d.m(m.parentNode,m)):d&&(te(),S(d,1,1,()=>{d=null}),se())},i(h){k||(E(d),k=!0)},o(h){S(d),k=!1},d(h){h&&(g(e),g(p),g(m)),d&&d.d(h),v=!1,b()}}}const Jt=Object.freeze({id:"Uploaded",score:"Score",updated:"Updated"}),Qt=Object.freeze({desc:"codicon codicon-arrow-down",asc:"codicon codicon-arrow-up"}),Xt=Object.freeze({">=":"≥","<=":"≤"}),dt=Object.freeze({all:"All",safe:"Safe",questionable:"Questionable",explicit:"Explicit"}),xt=Object.freeze({id:{asc:"Oldest",desc:"Newest"},score:{asc:"Worst",desc:"Best"},updated:{asc:"Inactive",desc:"Active"}}),es=(n,e,s)=>{let t=n==="all"?void 0:dt[n],l=e===0&&s===">="?void 0:`Score${s}${Le(e)}`;return[t,l].filter(r=>r!==void 0).join(",")||"All"};function ts(n,e,s){let t,l,r;fe(n,ue,c=>s(1,r=c));const o=me();let a=!1;const i=()=>s(2,a=!0),f=()=>{s(2,a=!1),o("sortfilterupdate")},u=()=>{ue.reset(),s(0,p=r.scoreValue)};let p;function m(c){n.$$.not_equal(r.sortDirection,c)&&(r.sortDirection=c,ue.set(r))}function k(c){n.$$.not_equal(r.sortProperty,c)&&(r.sortProperty=c,ue.set(r))}function v(c){n.$$.not_equal(r.scoreComparator,c)&&(r.scoreComparator=c,ue.set(r))}function b(){p=it(this.value),s(0,p),s(1,r)}const d=c=>pt(c)&&c.target.blur();function h(c){n.$$.not_equal(r.rating,c)&&(r.rating=c,ue.set(r))}return n.$$.update=()=>{if(n.$$.dirty&3){p===void 0&&s(0,p=r.scoreValue);let c=Number(p);isNaN(c)||vt(ue,r.scoreValue=c,r)}n.$$.dirty&2&&s(4,t=es(r.rating,r.scoreValue,r.scoreComparator)),n.$$.dirty&2&&s(3,l=xt[r.sortProperty][r.sortDirection])},[p,r,a,l,t,i,f,u,m,k,v,b,d,h]}class ss extends oe{constructor(e){super(),ae(this,e,ts,Zt,re,{})}}function ns(n){const e=n.slice(),s=Lt(e[1].file_url,e[1].sample_url,e[1].preview_url);return e[6]=s,e}function ls(n){let e,s;return e=new mt({props:{post:n[1]}}),e.$on("click",n[3]),{c(){R(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,l){B(e,t,l),s=!0},p(t,l){const r={};l&2&&(r.post=t[1]),e.$set(r)},i(t){s||(E(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){F(e,t)}}}function rs(n){let e,s;return e=new Rt({props:{src:n[6].animated,poster:n[6].static,width:n[1].width,height:n[1].height,loop:n[1].tags.some(Xe)}}),e.$on("click",n[3]),{c(){R(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,l){B(e,t,l),s=!0},p(t,l){const r={};l&2&&(r.src=t[6].animated),l&2&&(r.poster=t[6].static),l&2&&(r.width=t[1].width),l&2&&(r.height=t[1].height),l&2&&(r.loop=t[1].tags.some(Xe)),e.$set(r)},i(t){s||(E(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){F(e,t)}}}function os(n){let e,s;return e=new At({props:{post:n[1],open:n[0]}}),e.$on("click",n[3]),{c(){R(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,l){B(e,t,l),s=!0},p(t,l){const r={};l&2&&(r.post=t[1]),l&1&&(r.open=t[0]),e.$set(r)},i(t){s||(E(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){F(e,t)}}}function as(n){let e;return{c(){e=C("i"),this.h()},l(s){e=I(s,"I",{class:!0}),T(e).forEach(g),this.h()},h(){$(e,"class","codicon codicon-screen-full")},m(s,t){P(s,e,t)},p:U,d(s){s&&g(e)}}}function Qe(n){let e,s;return e=new _t({props:{post:n[1]}}),{c(){R(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,l){B(e,t,l),s=!0},p(t,l){const r={};l&2&&(r.post=t[1]),e.$set(r)},i(t){s||(E(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){F(e,t)}}}function is(n){let e,s,t,l,r,o,a,i,f,u;const p=[os,rs,ls],m=[];function k(d,h){return d[1].type==="image"?0:d[1].type==="video"?1:2}function v(d,h){return h===1?ns(d):d}s=k(n),t=m[s]=p[s](v(n,s)),r=new Be({props:{class:"button-fullscreen","aria-label":"Enter Fullscreen mode",$$slots:{default:[as]},$$scope:{ctx:n}}}),r.$on("click",n[4]);let b=n[0]&&Qe(n);return{c(){e=C("div"),t.c(),l=N(),R(r.$$.fragment),o=N(),b&&b.c(),this.h()},l(d){e=I(d,"DIV",{id:!0,class:!0});var h=T(e);t.l(h),l=O(h),A(r.$$.fragment,h),o=O(h),b&&b.l(h),h.forEach(g),this.h()},h(){$(e,"id",a="post_"+n[1].id),$(e,"class","post svelte-pwgq1f"),we(e,"open",n[0])},m(d,h){P(d,e,h),m[s].m(e,null),y(e,l),B(r,e,null),y(e,o),b&&b.m(e,null),i=!0,f||(u=le(e,"keydown",n[5]),f=!0)},p(d,[h]){let c=s;s=k(d),s===c?m[s].p(v(d,s),h):(te(),S(m[c],1,1,()=>{m[c]=null}),se(),t=m[s],t?t.p(v(d,s),h):(t=m[s]=p[s](v(d,s)),t.c()),E(t,1),t.m(e,l));const _={};h&128&&(_.$$scope={dirty:h,ctx:d}),r.$set(_),d[0]?b?(b.p(d,h),h&1&&E(b,1)):(b=Qe(d),b.c(),E(b,1),b.m(e,null)):b&&(te(),S(b,1,1,()=>{b=null}),se()),(!i||h&2&&a!==(a="post_"+d[1].id))&&$(e,"id",a),(!i||h&1)&&we(e,"open",d[0])},i(d){i||(E(t),E(r.$$.fragment,d),E(b),i=!0)},o(d){S(t),S(r.$$.fragment,d),S(b),i=!1},d(d){d&&g(e),m[s].d(),F(r),b&&b.d(),f=!1,u()}}}const Xe=n=>n.name==="loop";function cs(n,e,s){const t=me(),l=()=>s(0,o=!o);let{post:r}=e,{open:o=!1}=e;const a=()=>t("fullscreen"),i=f=>{f.key==="f"&&t("fullscreen")};return n.$$set=f=>{"post"in f&&s(1,r=f.post),"open"in f&&s(0,o=f.open)},[o,r,t,l,a,i]}class us extends oe{constructor(e){super(),ae(this,e,cs,is,re,{post:1,open:0})}}function xe(n){let e,s=n[0].type==="video"?"▶":"GIF",t;return{c(){e=C("span"),t=x(s),this.h()},l(l){e=I(l,"SPAN",{class:!0});var r=T(e);t=ee(r,s),r.forEach(g),this.h()},h(){$(e,"class","type svelte-14imjnt")},m(l,r){P(l,e,r),y(e,t)},p(l,r){r&1&&s!==(s=l[0].type==="video"?"▶":"GIF")&&Oe(t,s)},d(l){l&&g(e)}}}function fs(n){let e,s,t,l,r,o=Le(n[0].score)+"",a,i,f,u,p,m=n[0].type!=="image"&&xe(n);return{c(){e=C("div"),s=C("img"),l=N(),r=C("span"),a=x(o),i=N(),m&&m.c(),this.h()},l(k){e=I(k,"DIV",{id:!0,class:!0,style:!0});var v=T(e);s=I(v,"IMG",{src:!0,alt:!0,class:!0,tabindex:!0,loading:!0}),l=O(v),r=I(v,"SPAN",{class:!0});var b=T(r);a=ee(b,o),b.forEach(g),i=O(v),m&&m.l(v),v.forEach(g),this.h()},h(){pe(s.src,t=n[1])||$(s,"src",t),$(s,"alt","post"),$(s,"class","post-media svelte-14imjnt"),$(s,"tabindex","-1"),$(s,"loading","lazy"),$(r,"class","score svelte-14imjnt"),$(e,"id",f="post_"+n[0].id),$(e,"class","post svelte-14imjnt"),qe(e,"grid-row","span "+n[2]),we(e,"open",open)},m(k,v){P(k,e,v),y(e,s),y(e,l),y(e,r),y(r,a),y(e,i),m&&m.m(e,null),u||(p=[le(e,"click",n[3]),le(e,"keydown",n[4])],u=!0)},p(k,[v]){v&2&&!pe(s.src,t=k[1])&&$(s,"src",t),v&1&&o!==(o=Le(k[0].score)+"")&&Oe(a,o),k[0].type!=="image"?m?m.p(k,v):(m=xe(k),m.c(),m.m(e,null)):m&&(m.d(1),m=null),v&1&&f!==(f="post_"+k[0].id)&&$(e,"id",f),v&0&&we(e,"open",open)},i:U,o:U,d(k){k&&g(e),m&&m.d(),u=!1,Fe(p)}}}function ps(n,e,s){let t,{post:l}=e,r=Math.min(Math.round(l.height/l.width*5),15);const o=f=>f.endsWith(".jpg")||f.endsWith(".jpeg")||f.endsWith(".png")||f.endsWith(".webp");function a(f){ze.call(this,n,f)}const i=f=>{var u;(pt(f)||f.key==="f")&&((u=f.target)==null||u.click())};return n.$$set=f=>{"post"in f&&s(0,l=f.post)},n.$$.update=()=>{n.$$.dirty&1&&s(1,t=o(l.sample_url)?l.sample_url:l.preview_url)},[l,t,r,a,i]}class _s extends oe{constructor(e){super(),ae(this,e,ps,fs,re,{post:0})}}function ms(n){let e,s,t,l;const r=n[3].default,o=bt(r,n,n[2],null);return{c(){e=C("div"),o&&o.c(),this.h()},l(a){e=I(a,"DIV",{role:!0,tabindex:!0,class:!0});var i=T(e);o&&o.l(i),i.forEach(g),this.h()},h(){$(e,"role","none"),$(e,"tabindex","-1"),$(e,"class","dialog fullscreen svelte-1j44awz")},m(a,i){P(a,e,i),o&&o.m(e,null),n[5](e),s=!0,t||(l=[le(e,"keydown",n[4]),le(e,"click",kt(ds))],t=!0)},p(a,[i]){o&&o.p&&(!s||i&4)&&yt(o,r,a,a[2],s?Et(r,a[2],i,null):wt(a[2]),null)},i(a){s||(E(o,a),s=!0)},o(a){S(o,a),s=!1},d(a){a&&g(e),o&&o.d(a),n[5](null),t=!1,Fe(l)}}}const ds=()=>{};function gs(n,e,s){let{$$slots:t={},$$scope:l}=e;const r=me(),o=()=>r("close"),a=m=>{m.key==="Escape"&&o()};let i=()=>{document.fullscreenElement||o()},f;je(async()=>{f.focus(),document.addEventListener("keydown",a),document.addEventListener("fullscreenchange",i);try{await f.requestFullscreen()}catch{}}),Ve(async()=>{document.removeEventListener("keydown",a),document.removeEventListener("fullscreenchange",i);try{await document.exitFullscreen()}catch{}});const u=m=>{m.code==="Escape"&&o()};function p(m){be[m?"unshift":"push"](()=>{f=m,s(0,f)})}return n.$$set=m=>{"$$scope"in m&&s(2,l=m.$$scope)},[f,o,l,t,u,p]}class hs extends oe{constructor(e){super(),ae(this,e,gs,ms,re,{})}}function $s(n){let e,s;return e=new mt({props:{post:n[0]}}),{c(){R(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,l){B(e,t,l),s=!0},p(t,l){const r={};l&1&&(r.post=t[0]),e.$set(r)},i(t){s||(E(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){F(e,t)}}}function vs(n){let e,s;return{c(){e=C("video"),this.h()},l(t){e=I(t,"VIDEO",{class:!0,src:!0}),T(e).forEach(g),this.h()},h(){$(e,"class","post-media svelte-12glt11"),pe(e.src,s=n[0].file_url)||$(e,"src",s),e.controls=!0},m(t,l){P(t,e,l),n[5](e)},p(t,l){l&1&&!pe(e.src,s=t[0].file_url)&&$(e,"src",s)},i:U,o:U,d(t){t&&g(e),n[5](null)}}}function bs(n){let e,s,t,l,r;return{c(){e=C("img"),this.h()},l(o){e=I(o,"IMG",{class:!0,src:!0,alt:!0}),this.h()},h(){$(e,"class","post-media svelte-12glt11"),pe(e.src,s=n[0].file_url)||$(e,"src",s),$(e,"alt",t="Image of Post "+n[0].id),we(e,"zoomed",n[1])},m(o,a){P(o,e,a),l||(r=le(e,"click",n[4]),l=!0)},p(o,a){a&1&&!pe(e.src,s=o[0].file_url)&&$(e,"src",s),a&1&&t!==(t="Image of Post "+o[0].id)&&$(e,"alt",t),a&2&&we(e,"zoomed",o[1])},i:U,o:U,d(o){o&&g(e),l=!1,r()}}}function ks(n){let e;return{c(){e=C("i"),this.h()},l(s){e=I(s,"I",{class:!0}),T(e).forEach(g),this.h()},h(){$(e,"class","codicon codicon-close")},m(s,t){P(s,e,t)},p:U,d(s){s&&g(e)}}}function ys(n){let e;return{c(){e=C("i"),this.h()},l(s){e=I(s,"I",{class:!0}),T(e).forEach(g),this.h()},h(){$(e,"class","codicon codicon-chevron-left")},m(s,t){P(s,e,t)},p:U,d(s){s&&g(e)}}}function ws(n){let e;return{c(){e=C("i"),this.h()},l(s){e=I(s,"I",{class:!0}),T(e).forEach(g),this.h()},h(){$(e,"class","codicon codicon-chevron-right")},m(s,t){P(s,e,t)},p:U,d(s){s&&g(e)}}}function Es(n){let e,s,t,l,r,o,a,i,f,u,p,m,k,v;const b=[bs,vs,$s],d=[];function h(c,_){return c[0].type==="image"?0:c[0].type==="video"?1:2}return s=h(n),t=d[s]=b[s](n),a=new _t({props:{post:n[0]}}),f=new Be({props:{class:"button-close",$$slots:{default:[ks]},$$scope:{ctx:n}}}),f.$on("click",n[6]),p=new Be({props:{class:"button-previous",$$slots:{default:[ys]},$$scope:{ctx:n}}}),p.$on("click",n[7]),k=new Be({props:{class:"button-next",$$slots:{default:[ws]},$$scope:{ctx:n}}}),k.$on("click",n[8]),{c(){e=C("div"),t.c(),l=N(),r=C("i"),o=N(),R(a.$$.fragment),i=N(),R(f.$$.fragment),u=N(),R(p.$$.fragment),m=N(),R(k.$$.fragment),this.h()},l(c){e=I(c,"DIV",{class:!0});var _=T(e);t.l(_),l=O(_),r=I(_,"I",{class:!0}),T(r).forEach(g),_.forEach(g),o=O(c),A(a.$$.fragment,c),i=O(c),A(f.$$.fragment,c),u=O(c),A(p.$$.fragment,c),m=O(c),A(k.$$.fragment,c),this.h()},h(){$(r,"class","codicon codicon-chevron-down svelte-12glt11"),$(e,"class","svelte-12glt11")},m(c,_){P(c,e,_),d[s].m(e,null),y(e,l),y(e,r),P(c,o,_),B(a,c,_),P(c,i,_),B(f,c,_),P(c,u,_),B(p,c,_),P(c,m,_),B(k,c,_),v=!0},p(c,_){let D=s;s=h(c),s===D?d[s].p(c,_):(te(),S(d[D],1,1,()=>{d[D]=null}),se(),t=d[s],t?t.p(c,_):(t=d[s]=b[s](c),t.c()),E(t,1),t.m(e,l));const H={};_&1&&(H.post=c[0]),a.$set(H);const Q={};_&2048&&(Q.$$scope={dirty:_,ctx:c}),f.$set(Q);const W={};_&2048&&(W.$$scope={dirty:_,ctx:c}),p.$set(W);const K={};_&2048&&(K.$$scope={dirty:_,ctx:c}),k.$set(K)},i(c){v||(E(t),E(a.$$.fragment,c),E(f.$$.fragment,c),E(p.$$.fragment,c),E(k.$$.fragment,c),v=!0)},o(c){S(t),S(a.$$.fragment,c),S(f.$$.fragment,c),S(p.$$.fragment,c),S(k.$$.fragment,c),v=!1},d(c){c&&(g(e),g(o),g(i),g(u),g(m)),d[s].d(),F(a,c),F(f,c),F(p,c),F(k,c)}}}function Ss(n){let e,s;return e=new hs({props:{$$slots:{default:[Es]},$$scope:{ctx:n}}}),e.$on("close",n[9]),{c(){R(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,l){B(e,t,l),s=!0},p(t,[l]){const r={};l&2055&&(r.$$scope={dirty:l,ctx:t}),e.$set(r)},i(t){s||(E(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){F(e,t)}}}function Cs(n,e,s){const t=me(),l=v=>{if(v.key==="f"&&(v.preventDefault(),v.stopPropagation(),t("close")),v.key==="ArrowLeft"&&(v.preventDefault(),v.stopPropagation(),t("previous")),v.key==="ArrowRight"&&(v.preventDefault(),v.stopPropagation(),t("next")),v.key===" "){v.preventDefault(),v.stopPropagation(),console.log("play"),a&&(a.paused?a.play():a.pause());const b=document.querySelector(".fullscreen.circle");b&&b.click()}};let{post:r}=e,o=r.width/r.height<.33,a;je(()=>{document.addEventListener("keydown",l)}),Ve(()=>document.removeEventListener("keydown",l));const i=()=>s(1,o=!o);function f(v){be[v?"unshift":"push"](()=>{a=v,s(2,a)})}const u=()=>t("close"),p=()=>t("previous"),m=()=>t("next");function k(v){ze.call(this,n,v)}return n.$$set=v=>{"post"in v&&s(0,r=v.post)},[r,o,a,t,i,f,u,p,m,k]}class Is extends oe{constructor(e){super(),ae(this,e,Cs,Ss,re,{post:0})}}function et(n,e,s){const t=n.slice();return t[12]=e[s],t[14]=s,t}function tt(n,e,s){const t=n.slice();return t[12]=e[s],t[14]=s,t}function Ds(n){let e,s,t=Ee(n[2].posts),l=[];for(let o=0;o<t.length;o+=1)l[o]=st(et(n,t,o));const r=o=>S(l[o],1,1,()=>{l[o]=null});return{c(){e=C("section");for(let o=0;o<l.length;o+=1)l[o].c();this.h()},l(o){e=I(o,"SECTION",{class:!0,style:!0});var a=T(e);for(let i=0;i<l.length;i+=1)l[i].l(a);a.forEach(g),this.h()},h(){$(e,"class","multi svelte-q6spg0"),qe(e,"grid-template-columns","repeat("+n[3]+", 1fr)")},m(o,a){P(o,e,a);for(let i=0;i<l.length;i+=1)l[i]&&l[i].m(e,null);s=!0},p(o,a){if(a&5){t=Ee(o[2].posts);let i;for(i=0;i<t.length;i+=1){const f=et(o,t,i);l[i]?(l[i].p(f,a),E(l[i],1)):(l[i]=st(f),l[i].c(),E(l[i],1),l[i].m(e,null))}for(te(),i=t.length;i<l.length;i+=1)r(i);se()}(!s||a&8)&&qe(e,"grid-template-columns","repeat("+o[3]+", 1fr)")},i(o){if(!s){for(let a=0;a<t.length;a+=1)E(l[a]);s=!0}},o(o){l=l.filter(Boolean);for(let a=0;a<l.length;a+=1)S(l[a]);s=!1},d(o){o&&g(e),Ge(l,o)}}}function Ps(n){let e,s,t=Ee(n[2].posts),l=[];for(let o=0;o<t.length;o+=1)l[o]=nt(tt(n,t,o));const r=o=>S(l[o],1,1,()=>{l[o]=null});return{c(){e=C("section");for(let o=0;o<l.length;o+=1)l[o].c();this.h()},l(o){e=I(o,"SECTION",{class:!0});var a=T(e);for(let i=0;i<l.length;i+=1)l[i].l(a);a.forEach(g),this.h()},h(){$(e,"class","single svelte-q6spg0")},m(o,a){P(o,e,a);for(let i=0;i<l.length;i+=1)l[i]&&l[i].m(e,null);s=!0},p(o,a){if(a&5){t=Ee(o[2].posts);let i;for(i=0;i<t.length;i+=1){const f=tt(o,t,i);l[i]?(l[i].p(f,a),E(l[i],1)):(l[i]=nt(f),l[i].c(),E(l[i],1),l[i].m(e,null))}for(te(),i=t.length;i<l.length;i+=1)r(i);se()}},i(o){if(!s){for(let a=0;a<t.length;a+=1)E(l[a]);s=!0}},o(o){l=l.filter(Boolean);for(let a=0;a<l.length;a+=1)S(l[a]);s=!1},d(o){o&&g(e),Ge(l,o)}}}function st(n){let e,s;function t(){return n[7](n[12],n[14])}return e=new _s({props:{post:n[12]}}),e.$on("click",t),{c(){R(e.$$.fragment)},l(l){A(e.$$.fragment,l)},m(l,r){B(e,l,r),s=!0},p(l,r){n=l;const o={};r&4&&(o.post=n[12]),e.$set(o)},i(l){s||(E(e.$$.fragment,l),s=!0)},o(l){S(e.$$.fragment,l),s=!1},d(l){F(e,l)}}}function nt(n){let e,s;function t(){return n[6](n[12],n[14])}return e=new us({props:{post:n[12]}}),e.$on("fullscreen",t),{c(){R(e.$$.fragment)},l(l){A(e.$$.fragment,l)},m(l,r){B(e,l,r),s=!0},p(l,r){n=l;const o={};r&4&&(o.post=n[12]),e.$set(o)},i(l){s||(E(e.$$.fragment,l),s=!0)},o(l){S(e.$$.fragment,l),s=!1},d(l){F(e,l)}}}function lt(n){let e,s;return e=new Is({props:{post:n[0].post}}),e.$on("close",n[8]),e.$on("previous",n[9]),e.$on("next",n[10]),{c(){R(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,l){B(e,t,l),s=!0},p(t,l){const r={};l&1&&(r.post=t[0].post),e.$set(r)},i(t){s||(E(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){F(e,t)}}}function Ns(n){let e,s,t=Le(n[2].postCount)+"",l,r,o,a,i,f,u,p,m,k;a=new ss({}),a.$on("sortfilterupdate",n[5]);const v=[Ps,Ds],b=[];function d(c,_){return c[3]==="1"?0:1}f=d(n),u=b[f]=v[f](n);let h=n[1]&&n[0]!==void 0&&lt(n);return{c(){e=C("div"),s=C("span"),l=x(t),r=x(" posts"),o=N(),R(a.$$.fragment),i=N(),u.c(),p=N(),h&&h.c(),m=_e(),this.h()},l(c){e=I(c,"DIV",{class:!0});var _=T(e);s=I(_,"SPAN",{});var D=T(s);l=ee(D,t),r=ee(D," posts"),D.forEach(g),o=O(_),A(a.$$.fragment,_),_.forEach(g),i=O(c),u.l(c),p=O(c),h&&h.l(c),m=_e(),this.h()},h(){$(e,"class","svelte-q6spg0")},m(c,_){P(c,e,_),y(e,s),y(s,l),y(s,r),y(e,o),B(a,e,null),P(c,i,_),b[f].m(c,_),P(c,p,_),h&&h.m(c,_),P(c,m,_),k=!0},p(c,[_]){(!k||_&4)&&t!==(t=Le(c[2].postCount)+"")&&Oe(l,t);let D=f;f=d(c),f===D?b[f].p(c,_):(te(),S(b[D],1,1,()=>{b[D]=null}),se(),u=b[f],u?u.p(c,_):(u=b[f]=v[f](c),u.c()),E(u,1),u.m(p.parentNode,p)),c[1]&&c[0]!==void 0?h?(h.p(c,_),_&3&&E(h,1)):(h=lt(c),h.c(),E(h,1),h.m(m.parentNode,m)):h&&(te(),S(h,1,1,()=>{h=null}),se())},i(c){k||(E(a.$$.fragment,c),E(u),E(h),k=!0)},o(c){S(a.$$.fragment,c),S(u),S(h),k=!1},d(c){c&&(g(e),g(i),g(p),g(m)),F(a),b[f].d(c),h&&h.d(c)}}}function Os(n,e,s){let t,l;fe(n,Ne,b=>s(2,t=b)),fe(n,Tt,b=>s(3,l=b));const r=me(),o=()=>{s(1,i=location.hash.length>2)};let a,i=location.hash.length>2;je(()=>{window.addEventListener("hashchange",o)}),Ve(()=>{window.removeEventListener("hashchange",o)});function f(b){ze.call(this,n,b)}return[a,i,t,l,r,f,(b,d)=>{s(0,a={post:b,index:d}),location.hash="fullscreen"},(b,d)=>{s(0,a={post:b,index:d}),location.hash="fullscreen"},()=>{var b,d;(b=a==null?void 0:a.post)!=null&&b.id&&((d=document.querySelector(`#post_${a.post.id} .post-media`))==null||d.focus()),s(0,a=void 0),history.back()},()=>{let b=Math.max(a.index-1,0);s(0,a={index:b,post:t.posts[b]})},()=>{let b=Math.min(a.index+1,t.posts.length);s(0,a={index:b,post:t.posts[b]}),b>t.posts.length-3&&t.posts.length!==t.postCount&&r("endreached")}]}class Ts extends oe{constructor(e){super(),ae(this,e,Os,Ns,re,{})}}function Ls(n){let e;return{c(){e=C("div")},l(s){e=I(s,"DIV",{}),T(e).forEach(g)},m(s,t){P(s,e,t),n[2](e)},p:U,i:U,o:U,d(s){s&&g(e),n[2](null)}}}function Rs(n,e,s){let{rootMargin:t}=e;const l=me(),r=new IntersectionObserver(i=>{i[0].isIntersecting&&l("intersection")},{rootMargin:t});let o;function a(i){be[i?"unshift":"push"](()=>{o=i,s(0,o)})}return n.$$set=i=>{"rootMargin"in i&&s(1,t=i.rootMargin)},n.$$.update=()=>{n.$$.dirty&1&&(r.disconnect(),o&&r.observe(o))},[o,t,a]}class As extends oe{constructor(e){super(),ae(this,e,Rs,Ls,re,{rootMargin:1})}}function Bs(n){let e,s,t,l,r="You have seen everything there is to see...";return{c(){e=C("img"),t=N(),l=C("p"),l.textContent=r,this.h()},l(o){e=I(o,"IMG",{src:!0,alt:!0,class:!0}),t=O(o),l=I(o,"P",{"data-svelte-h":!0}),ce(l)!=="svelte-1i75mtf"&&(l.textContent=r),this.h()},h(){pe(e.src,s=ut+"/assets/shironeko-x.png")||$(e,"src",s),$(e,"alt","No more results to load"),$(e,"class","svelte-1pkma0d")},m(o,a){P(o,e,a),P(o,t,a),P(o,l,a)},p:U,i:U,o:U,d(o){o&&(g(e),g(t),g(l))}}}class Fs extends oe{constructor(e){super(),ae(this,e,null,Bs,re,{})}}function rt(n,e,s){const t=n.slice();return t[9]=e[s],t}function ot(n){let e,s;return e=new Vt({props:{tag:n[9]}}),{c(){R(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,l){B(e,t,l),s=!0},p(t,l){const r={};l&4&&(r.tag=t[9]),e.$set(r)},i(t){s||(E(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){F(e,t)}}}function js(n){let e;return{c(){e=x("Create supertag")},l(s){e=ee(s,"Create supertag")},m(s,t){P(s,e,t)},d(s){s&&g(e)}}}function Vs(n){let e,s,t="Create Supertag",l,r,o,a,i,f="Name",u,p,m,k,v,b="Description",d,h,c,_,D,H="Tags",Q,W,K,ie,w,z,J,Z,X=Ee(n[2]),M=[];for(let j=0;j<X.length;j+=1)M[j]=ot(rt(n,X,j));const Se=j=>S(M[j],1,1,()=>{M[j]=null});return w=new Te({props:{title:n[3]?"Click to create supertag":"Enter a valid name to continue",disabled:!n[3],$$slots:{default:[js]},$$scope:{ctx:n}}}),w.$on("click",n[8]),{c(){e=C("section"),s=C("h3"),s.textContent=t,l=N(),r=C("button"),o=N(),a=C("div"),i=C("label"),i.textContent=f,u=N(),p=C("input"),m=N(),k=C("div"),v=C("label"),v.textContent=b,d=N(),h=C("input"),c=N(),_=C("div"),D=C("span"),D.textContent=H,Q=N(),W=C("ol");for(let j=0;j<M.length;j+=1)M[j].c();K=N(),ie=C("div"),R(w.$$.fragment),this.h()},l(j){e=I(j,"SECTION",{class:!0});var L=T(e);s=I(L,"H3",{"data-svelte-h":!0}),ce(s)!=="svelte-ho1cwx"&&(s.textContent=t),l=O(L),r=I(L,"BUTTON",{class:!0}),T(r).forEach(g),o=O(L),a=I(L,"DIV",{class:!0});var Y=T(a);i=I(Y,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),ce(i)!=="svelte-10k8a68"&&(i.textContent=f),u=O(Y),p=I(Y,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),Y.forEach(g),m=O(L),k=I(L,"DIV",{class:!0});var q=T(k);v=I(q,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),ce(v)!=="svelte-14n9kp6"&&(v.textContent=b),d=O(q),h=I(q,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),q.forEach(g),c=O(L),_=I(L,"DIV",{class:!0});var ne=T(_);D=I(ne,"SPAN",{class:!0,"data-svelte-h":!0}),ce(D)!=="svelte-7hjyox"&&(D.textContent=H),Q=O(ne),W=I(ne,"OL",{class:!0});var ke=T(W);for(let Ie=0;Ie<M.length;Ie+=1)M[Ie].l(ke);ke.forEach(g),ne.forEach(g),K=O(L),ie=I(L,"DIV",{class:!0});var Ce=T(ie);A(w.$$.fragment,Ce),Ce.forEach(g),L.forEach(g),this.h()},h(){$(r,"class",ct("codicon codicon-close")+" svelte-xkjm86"),$(i,"for","supertag-name"),$(i,"class","svelte-xkjm86"),$(p,"type","text"),$(p,"placeholder","Descriptive name"),$(p,"id","supertag-name"),$(p,"class","svelte-xkjm86"),$(a,"class","svelte-xkjm86"),$(v,"for","supertag-description"),$(v,"class","svelte-xkjm86"),$(h,"type","text"),$(h,"placeholder","Short description"),$(h,"id","supertag-description"),$(h,"class","svelte-xkjm86"),$(k,"class","svelte-xkjm86"),$(D,"class","svelte-xkjm86"),$(W,"class","svelte-xkjm86"),$(_,"class","svelte-xkjm86"),$(ie,"class","last svelte-xkjm86"),$(e,"class","svelte-xkjm86")},m(j,L){P(j,e,L),y(e,s),y(e,l),y(e,r),y(e,o),y(e,a),y(a,i),y(a,u),y(a,p),ye(p,n[0]),y(e,m),y(e,k),y(k,v),y(k,d),y(k,h),ye(h,n[1]),y(e,c),y(e,_),y(_,D),y(_,Q),y(_,W);for(let Y=0;Y<M.length;Y+=1)M[Y]&&M[Y].m(W,null);y(e,K),y(e,ie),B(w,ie,null),z=!0,J||(Z=[le(r,"click",n[5]),le(p,"input",n[6]),le(h,"input",n[7])],J=!0)},p(j,L){if(L&1&&p.value!==j[0]&&ye(p,j[0]),L&2&&h.value!==j[1]&&ye(h,j[1]),L&4){X=Ee(j[2]);let q;for(q=0;q<X.length;q+=1){const ne=rt(j,X,q);M[q]?(M[q].p(ne,L),E(M[q],1)):(M[q]=ot(ne),M[q].c(),E(M[q],1),M[q].m(W,null))}for(te(),q=X.length;q<M.length;q+=1)Se(q);se()}const Y={};L&8&&(Y.title=j[3]?"Click to create supertag":"Enter a valid name to continue"),L&8&&(Y.disabled=!j[3]),L&4096&&(Y.$$scope={dirty:L,ctx:j}),w.$set(Y)},i(j){if(!z){for(let L=0;L<X.length;L+=1)E(M[L]);E(w.$$.fragment,j),z=!0}},o(j){M=M.filter(Boolean);for(let L=0;L<M.length;L+=1)S(M[L]);S(w.$$.fragment,j),z=!1},d(j){j&&g(e),Ge(M,j),F(w),J=!1,Fe(Z)}}}function Ms(n){let e,s;return e=new ft({props:{$$slots:{default:[Vs]},$$scope:{ctx:n}}}),e.$on("close",n[5]),{c(){R(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,l){B(e,t,l),s=!0},p(t,[l]){const r={};l&4111&&(r.$$scope={dirty:l,ctx:t}),e.$set(r)},i(t){s||(E(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){F(e,t)}}}function qs(n,e,s){let t,{name:l=""}=e,{description:r=""}=e,{tags:o}=e;const a=me(),i=()=>a("close");function f(){l=this.value,s(0,l)}function u(){r=this.value,s(1,r)}const p=()=>{a("submit",{name:l,description:r,tags:o.map(({modifier:m,name:k})=>({modifier:m,name:k}))}),i()};return n.$$set=m=>{"name"in m&&s(0,l=m.name),"description"in m&&s(1,r=m.description),"tags"in m&&s(2,o=m.tags)},n.$$.update=()=>{n.$$.dirty&5&&s(3,t=typeof l=="string"&&l!==""&&o.length>1)},[l,r,o,t,a,i,f,u,p]}class zs extends oe{constructor(e){super(),ae(this,e,qs,Ms,re,{name:0,description:1,tags:2})}}function Gs(n){let e,s,t,l,r,o,a,i,f,u;return{c(){e=C("div"),s=C("div"),t=C("i"),l=N(),r=C("div"),o=C("h3"),a=x(n[0]),i=N(),f=C("span"),u=x(n[2]),this.h()},l(p){e=I(p,"DIV",{class:!0});var m=T(e);s=I(m,"DIV",{class:!0});var k=T(s);t=I(k,"I",{class:!0}),T(t).forEach(g),k.forEach(g),l=O(m),r=I(m,"DIV",{});var v=T(r);o=I(v,"H3",{class:!0});var b=T(o);a=ee(b,n[0]),b.forEach(g),i=O(v),f=I(v,"SPAN",{});var d=T(f);u=ee(d,n[2]),d.forEach(g),v.forEach(g),m.forEach(g),this.h()},h(){$(t,"class",ct(n[1])+" svelte-1tvgln1"),$(s,"class","icon svelte-1tvgln1"),$(o,"class","svelte-1tvgln1"),$(e,"class","error svelte-1tvgln1")},m(p,m){P(p,e,m),y(e,s),y(s,t),y(e,l),y(e,r),y(r,o),y(o,a),y(r,i),y(r,f),y(f,u)},p:U,i:U,o:U,d(p){p&&g(e)}}}function Us(n,e,s){let{error:t}=e,l=t.message==="Failed to fetch"?"Connection Error":"Application Error",r=t.message==="Failed to fetch"?"codicon codicon-debug-disconnect":"codicon codicon-error",o=t.message==="Failed to fetch"?"Failed to connect to the server. Make sure you have a stable internet connection.":t.message;return n.$$set=a=>{"error"in a&&s(3,t=a.error)},[l,r,o,t]}class Ks extends oe{constructor(e){super(),ae(this,e,Us,Gs,re,{error:3})}}function Hs(n){let e;return{c(){e=x("Search")},l(s){e=ee(s,"Search")},m(s,t){P(s,e,t)},d(s){s&&g(e)}}}function Ws(n){let e,s,t,l,r,o;const a=[Js,Zs],i=[];function f(u,p){return u[2].postCount===0?0:1}return s=f(n),t=i[s]=a[s](n),r=new Mt({}),{c(){e=C("section"),t.c(),l=N(),R(r.$$.fragment),this.h()},l(u){e=I(u,"SECTION",{class:!0});var p=T(e);t.l(p),p.forEach(g),l=O(u),A(r.$$.fragment,u),this.h()},h(){$(e,"class","svelte-rk0y4a")},m(u,p){P(u,e,p),i[s].m(e,null),P(u,l,p),B(r,u,p),o=!0},p(u,p){let m=s;s=f(u),s===m?i[s].p(u,p):(te(),S(i[m],1,1,()=>{i[m]=null}),se(),t=i[s],t?t.p(u,p):(t=i[s]=a[s](u),t.c()),E(t,1),t.m(e,null))},i(u){o||(E(t),E(r.$$.fragment,u),o=!0)},o(u){S(t),S(r.$$.fragment,u),o=!1},d(u){u&&(g(e),g(l)),i[s].d(),F(r,u)}}}function Ys(n){let e,s;return e=new Ks({props:{error:n[0]}}),{c(){R(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,l){B(e,t,l),s=!0},p(t,l){const r={};l&1&&(r.error=t[0]),e.$set(r)},i(t){s||(E(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){F(e,t)}}}function Zs(n){let e,s,t,l,r,o;e=new Ts({}),e.$on("sortfilterupdate",n[7]),e.$on("endreached",n[8]);const a=[Xs,Qs],i=[];function f(u,p){return u[2].posts.length===u[2].postCount?0:1}return t=f(n),l=i[t]=a[t](n),{c(){R(e.$$.fragment),s=N(),l.c(),r=_e()},l(u){A(e.$$.fragment,u),s=O(u),l.l(u),r=_e()},m(u,p){B(e,u,p),P(u,s,p),i[t].m(u,p),P(u,r,p),o=!0},p(u,p){let m=t;t=f(u),t===m?i[t].p(u,p):(te(),S(i[m],1,1,()=>{i[m]=null}),se(),l=i[t],l?l.p(u,p):(l=i[t]=a[t](u),l.c()),E(l,1),l.m(r.parentNode,r))},i(u){o||(E(e.$$.fragment,u),E(l),o=!0)},o(u){S(e.$$.fragment,u),S(l),o=!1},d(u){u&&(g(s),g(r)),F(e,u),i[t].d(u)}}}function Js(n){let e,s;return e=new Kt({}),e.$on("sortfilterupdate",n[7]),{c(){R(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,l){B(e,t,l),s=!0},p:U,i(t){s||(E(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){F(e,t)}}}function Qs(n){let e,s;return e=new As({props:{rootMargin:"1000px"}}),e.$on("intersection",n[8]),{c(){R(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,l){B(e,t,l),s=!0},p:U,i(t){s||(E(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){F(e,t)}}}function Xs(n){let e,s;return e=new Fs({}),{c(){R(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,l){B(e,t,l),s=!0},p:U,i(t){s||(E(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){F(e,t)}}}function at(n){let e,s;return e=new zs({props:{tags:n[4]}}),e.$on("close",n[13]),e.$on("submit",n[14]),{c(){R(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,l){B(e,t,l),s=!0},p(t,l){const r={};l&16&&(r.tags=t[4]),e.$set(r)},i(t){s||(E(e.$$.fragment,t),s=!0)},o(t){S(e.$$.fragment,t),s=!1},d(t){F(e,t)}}}function xs(n){let e,s,t,l,r,o,a,i,f,u,p,m,k,v;s=new St({}),l=new Dt({props:{placeholder:"Search for tags",fetchSuggestions:n[6]}}),l.$on("pick",n[9]),o=new Te({props:{title:"Search with the tags above",$$slots:{default:[Hs]},$$scope:{ctx:n}}}),o.$on("click",n[7]),i=new Ct({props:{tags:[...n[4],...n[3]]}}),i.$on("click",n[10]),i.$on("contextmenu",n[11]),i.$on("createSupertag",n[12]);const b=[Ys,Ws],d=[];function h(_,D){return _[0]?0:_[2].requested?1:-1}~(u=h(n))&&(p=d[u]=b[u](n));let c=n[1]&&at(n);return{c(){e=C("section"),R(s.$$.fragment),t=N(),R(l.$$.fragment),r=N(),R(o.$$.fragment),a=N(),R(i.$$.fragment),f=N(),p&&p.c(),m=N(),c&&c.c(),k=_e(),this.h()},l(_){e=I(_,"SECTION",{id:!0,class:!0});var D=T(e);A(s.$$.fragment,D),t=O(D),A(l.$$.fragment,D),r=O(D),A(o.$$.fragment,D),a=O(D),A(i.$$.fragment,D),D.forEach(g),f=O(_),p&&p.l(_),m=O(_),c&&c.l(_),k=_e(),this.h()},h(){$(e,"id","search"),$(e,"class","svelte-rk0y4a")},m(_,D){P(_,e,D),B(s,e,null),y(e,t),B(l,e,null),y(e,r),B(o,e,null),y(e,a),B(i,e,null),P(_,f,D),~u&&d[u].m(_,D),P(_,m,D),c&&c.m(_,D),P(_,k,D),v=!0},p(_,[D]){const H={};D&8388608&&(H.$$scope={dirty:D,ctx:_}),o.$set(H);const Q={};D&24&&(Q.tags=[..._[4],..._[3]]),i.$set(Q);let W=u;u=h(_),u===W?~u&&d[u].p(_,D):(p&&(te(),S(d[W],1,1,()=>{d[W]=null}),se()),~u?(p=d[u],p?p.p(_,D):(p=d[u]=b[u](_),p.c()),E(p,1),p.m(m.parentNode,m)):p=null),_[1]?c?(c.p(_,D),D&2&&E(c,1)):(c=at(_),c.c(),E(c,1),c.m(k.parentNode,k)):c&&(te(),S(c,1,1,()=>{c=null}),se())},i(_){v||(E(s.$$.fragment,_),E(l.$$.fragment,_),E(o.$$.fragment,_),E(i.$$.fragment,_),E(p),E(c),v=!0)},o(_){S(s.$$.fragment,_),S(l.$$.fragment,_),S(o.$$.fragment,_),S(i.$$.fragment,_),S(p),S(c),v=!1},d(_){_&&(g(e),g(f),g(m),g(k)),F(s),F(l),F(o),F(i),~u&&d[u].d(_),c&&c.d(_)}}}const en=()=>{const n=new URL(location.href);if(!n.searchParams.has("tags"))return;const s=(n.searchParams.get("tags")??"").split(";");if(!(!Array.isArray(s)||s.length===0))return s};function tn(n,e,s){let t,l,r,o,a,i;fe(n,Ne,w=>s(2,t=w)),fe(n,Me,w=>s(3,l=w)),fe(n,ue,w=>s(17,r=w)),fe(n,jt,w=>s(18,o=w)),fe(n,Pe,w=>s(4,a=w)),fe(n,Ye,w=>s(5,i=w));let f=!1,u,p=!1,m=0;const k=async w=>{const z=await Nt(w);return[...i.items.filter(({name:Z})=>Z.toLowerCase().includes(w.toLowerCase())).map(Z=>({label:Z.name,count:Z.tags.length,type:"supertag"})),...z]},v=en();v&&v.forEach(w=>{a.some(z=>z.name===w)||Pe.addByName(w)});const b=()=>new It().withPid(t.pageCount).withTags(a).withBlockedContent(o).withSortProperty(r.sortProperty).withSortDirection(r.sortDirection).withScoreValue(r.scoreValue).withScoreComparator(r.scoreComparator).withRating(r.rating).withSupertags(l),d=async w=>{if(!f){s(0,u=void 0),f=!0;try{const z=t.pageCount;await w(),qt(z).catch(()=>{})}catch(z){s(0,u=z),console.warn(z)}finally{f=!1}}},h=async()=>{Ne.reset(),m=0,d(async()=>{const[w,z]=await b().getPageAndCount();console.log(w,z),Ne.addPage(w,z)})},c=async()=>{d(async()=>{const w=await b().getPage();Ne.addPage(w)})},_=w=>{var z,J;if((w.key==="/"||w.key==="s")&&(!document.activeElement||document.activeElement===document.body)&&((z=document.getElementById("searchbar"))==null||z.focus(),w.preventDefault(),w.stopPropagation()),w.ctrlKey&&w.key==="Enter"&&(w.preventDefault(),w.stopPropagation(),h()),w.ctrlKey&&w.key==="m"&&((J=document.getElementById("select-modifier"))==null||J.click()),w.ctrlKey&&w.key==="ArrowDown"){const Z=document.getElementsByClassName("post-media");Z[m].focus(),m=Math.min(m+1,Math.max(0,Z.length-1))}w.ctrlKey&&w.key==="ArrowUp"&&(document.getElementsByClassName("post-media")[m].focus(),m=Math.max(m-1,0))};return je(()=>{document.addEventListener("keydown",_)}),Ve(()=>{document.removeEventListener("keydown",_)}),[u,p,t,l,a,i,k,h,c,async w=>{const z=w.detail;if(z.type==="supertag"){const J=i.items.find(Z=>Z.name===z.label);if(!J){console.log("Supertag not present.");return}Me.addOrReplace(J)}else{const J=await Ot(w.detail.label);Pe.addOrReplace({name:w.detail.label,modifier:w.detail.modifier,count:w.detail.count,type:J.type})}},w=>"description"in w.detail?Me.removeByName(w.detail.name):Pe.removeByName(w.detail.name),w=>{"description"in w.detail||(w.detail.modifier=Pt(w.detail.modifier),Pe.addOrReplace(w.detail))},()=>s(1,p=!0),()=>s(1,p=!1),w=>Ye.add(w.detail)]}class yn extends oe{constructor(e){super(),ae(this,e,tn,xs,re,{})}}export{yn as component};
