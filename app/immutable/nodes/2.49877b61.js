import{s as pe,D as Ve,f as S,a as N,g as I,h as V,y as ue,c as O,d as $,j as h,r as Mt,i as T,u as d,E as je,F as we,G as Ue,H as lt,l as ie,m as ae,v as Q,I as ve,w as Jt,J as Xt,z as xt,A as en,B as tn,o as xe,K as et,p as Se,n as Te,e as be,k as Ae,C as $e,L as Ye,M as nt,N as st,O as nn,P as Lt,Q as it}from"../chunks/scheduler.a20787a1.js";import{S as _e,i as de,b as R,d as F,m as M,a as v,t as w,e as L,g as le,c as re,f as Ze,h as sn}from"../chunks/index.16c92c5c.js";import{e as ye}from"../chunks/each.e59479a4.js";import{D as Bt,r as jt}from"../chunks/result-columns-store.fb17ebd6.js";import{T as qe}from"../chunks/TextButton.217547ed.js";import{D as ln}from"../chunks/DetailedTag.2d4ca846.js";import{K as rn,A as on}from"../chunks/ActiveTagList.707face6.js";import{b as Gt}from"../chunks/paths.979c565c.js";import{f as Je}from"../chunks/format-tag.7e313273.js";import{r as Ge,s as ze,f as Me,a as ot,S as an}from"../chunks/active-supertags-store.ab7cc25a.js";import{I as zt,R as cn}from"../chunks/ModifierSelect.6fdc6a54.js";import{h as at,u as un}from"../chunks/await_block.091a89a4.js";import{L as qt}from"../chunks/LoadingAnimation.08dd10df.js";import{R as fn,S as pn,a as _n,E as Ut,b as dn,g as ct,P as mn,C as gn,c as hn,d as Ht,i as $n,e as Wt,D as vn,G as bn,V as kn,f as ut,I as wn}from"../chunks/Details.db3464c9.js";import{a as yn}from"../chunks/always-loop-store.15242a8e.js";import{S as ft}from"../chunks/Select.ce2f7816.js";import{R as Cn}from"../chunks/RotatingTextSelect.2729c896.js";import{S as En,n as Sn,s as pt}from"../chunks/supertags-store.9e24db63.js";import{S as In}from"../chunks/ScrollUpButton.0d29f4f6.js";import{g as Dn,a as Pn}from"../chunks/tags.49324235.js";import{l as Nn}from"../chunks/analytics.eca95ce1.js";import{a as tt}from"../chunks/active-tags-store.b3e4fe76.js";import{b as On}from"../chunks/blocked-content-store.9c031c36.js";import{c as Kt}from"../chunks/cookies-accepted-store.5162e58d.js";function _t(l,e,n){const t=l.slice();return t[9]=e[n],t}function dt(l){let e,n;return e=new ln({props:{tag:l[9]}}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p(t,s){const o={};s&4&&(o.tag=t[9]),e.$set(o)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function Tn(l){let e;return{c(){e=ie("Create supertag")},l(n){e=ae(n,"Create supertag")},m(n,t){T(n,e,t)},d(n){n&&$(e)}}}function An(l){let e,n,t="Create Supertag",s,o,r,a,i,u="Name",c,f,_,y,C,b="Description",E,p,g,m,k,D="Tags",A,ee,Z,x,ne,se,P,J,W=ye(l[2]),B=[];for(let G=0;G<W.length;G+=1)B[G]=dt(_t(l,W,G));const oe=G=>w(B[G],1,1,()=>{B[G]=null});return ne=new qe({props:{title:l[3]?"Click to create supertag":"Enter a valid name to continue",disabled:!l[3],$$slots:{default:[Tn]},$$scope:{ctx:l}}}),ne.$on("click",l[8]),{c(){e=S("section"),n=S("h3"),n.textContent=t,s=N(),o=S("button"),r=N(),a=S("div"),i=S("label"),i.textContent=u,c=N(),f=S("input"),_=N(),y=S("div"),C=S("label"),C.textContent=b,E=N(),p=S("input"),g=N(),m=S("div"),k=S("span"),k.textContent=D,A=N(),ee=S("ol");for(let G=0;G<B.length;G+=1)B[G].c();Z=N(),x=S("div"),R(ne.$$.fragment),this.h()},l(G){e=I(G,"SECTION",{class:!0});var z=V(e);n=I(z,"H3",{"data-svelte-h":!0}),ue(n)!=="svelte-ho1cwx"&&(n.textContent=t),s=O(z),o=I(z,"BUTTON",{class:!0}),V(o).forEach($),r=O(z),a=I(z,"DIV",{class:!0});var X=V(a);i=I(X,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),ue(i)!=="svelte-10k8a68"&&(i.textContent=u),c=O(X),f=I(X,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),X.forEach($),_=O(z),y=I(z,"DIV",{class:!0});var K=V(y);C=I(K,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),ue(C)!=="svelte-14n9kp6"&&(C.textContent=b),E=O(K),p=I(K,"INPUT",{type:!0,placeholder:!0,id:!0,class:!0}),K.forEach($),g=O(z),m=I(z,"DIV",{class:!0});var me=V(m);k=I(me,"SPAN",{class:!0,"data-svelte-h":!0}),ue(k)!=="svelte-7hjyox"&&(k.textContent=D),A=O(me),ee=I(me,"OL",{class:!0});var ge=V(ee);for(let De=0;De<B.length;De+=1)B[De].l(ge);ge.forEach($),me.forEach($),Z=O(z),x=I(z,"DIV",{class:!0});var Ie=V(x);F(ne.$$.fragment,Ie),Ie.forEach($),z.forEach($),this.h()},h(){h(o,"class",Mt("codicon codicon-close")+" svelte-1x6vc81"),h(i,"for","supertag-name"),h(i,"class","svelte-1x6vc81"),h(f,"type","text"),h(f,"placeholder","Descriptive name"),h(f,"id","supertag-name"),h(f,"class","svelte-1x6vc81"),h(a,"class","svelte-1x6vc81"),h(C,"for","supertag-description"),h(C,"class","svelte-1x6vc81"),h(p,"type","text"),h(p,"placeholder","Short description"),h(p,"id","supertag-description"),h(p,"class","svelte-1x6vc81"),h(y,"class","svelte-1x6vc81"),h(k,"class","svelte-1x6vc81"),h(ee,"class","svelte-1x6vc81"),h(m,"class","svelte-1x6vc81"),h(x,"class","last svelte-1x6vc81"),h(e,"class","svelte-1x6vc81")},m(G,z){T(G,e,z),d(e,n),d(e,s),d(e,o),d(e,r),d(e,a),d(a,i),d(a,c),d(a,f),je(f,l[0]),d(e,_),d(e,y),d(y,C),d(y,E),d(y,p),je(p,l[1]),d(e,g),d(e,m),d(m,k),d(m,A),d(m,ee);for(let X=0;X<B.length;X+=1)B[X]&&B[X].m(ee,null);d(e,Z),d(e,x),M(ne,x,null),se=!0,P||(J=[we(o,"click",l[5]),we(f,"input",l[6]),we(p,"input",l[7])],P=!0)},p(G,z){if(z&1&&f.value!==G[0]&&je(f,G[0]),z&2&&p.value!==G[1]&&je(p,G[1]),z&4){W=ye(G[2]);let K;for(K=0;K<W.length;K+=1){const me=_t(G,W,K);B[K]?(B[K].p(me,z),v(B[K],1)):(B[K]=dt(me),B[K].c(),v(B[K],1),B[K].m(ee,null))}for(le(),K=W.length;K<B.length;K+=1)oe(K);re()}const X={};z&8&&(X.title=G[3]?"Click to create supertag":"Enter a valid name to continue"),z&8&&(X.disabled=!G[3]),z&4096&&(X.$$scope={dirty:z,ctx:G}),ne.$set(X)},i(G){if(!se){for(let z=0;z<W.length;z+=1)v(B[z]);v(ne.$$.fragment,G),se=!0}},o(G){B=B.filter(Boolean);for(let z=0;z<B.length;z+=1)w(B[z]);w(ne.$$.fragment,G),se=!1},d(G){G&&$(e),Ue(B,G),L(ne),P=!1,lt(J)}}}function Vn(l){let e,n;return e=new Bt({props:{$$slots:{default:[An]},$$scope:{ctx:l}}}),e.$on("close",l[5]),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p(t,[s]){const o={};s&4111&&(o.$$scope={dirty:s,ctx:t}),e.$set(o)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function Rn(l,e,n){let t,{name:s=""}=e,{description:o=""}=e,{tags:r}=e;const a=Ve(),i=()=>a("close");function u(){s=this.value,n(0,s)}function c(){o=this.value,n(1,o)}const f=()=>{a("submit",{name:s,description:o,tags:r.map(({modifier:_,name:y})=>({modifier:_,name:y}))}),i()};return l.$$set=_=>{"name"in _&&n(0,s=_.name),"description"in _&&n(1,o=_.description),"tags"in _&&n(2,r=_.tags)},l.$$.update=()=>{l.$$.dirty&5&&n(3,t=typeof s=="string"&&s!==""&&r.length>1)},[s,o,r,t,a,i,u,c,f]}class Fn extends _e{constructor(e){super(),de(this,e,Rn,Vn,pe,{name:0,description:1,tags:2})}}function Mn(l){let e,n,t,s,o,r,a,i,u,c;return{c(){e=S("div"),n=S("div"),t=S("i"),s=N(),o=S("div"),r=S("h3"),a=ie(l[0]),i=N(),u=S("span"),c=ie(l[2]),this.h()},l(f){e=I(f,"DIV",{class:!0});var _=V(e);n=I(_,"DIV",{class:!0});var y=V(n);t=I(y,"I",{class:!0}),V(t).forEach($),y.forEach($),s=O(_),o=I(_,"DIV",{});var C=V(o);r=I(C,"H3",{class:!0});var b=V(r);a=ae(b,l[0]),b.forEach($),i=O(C),u=I(C,"SPAN",{});var E=V(u);c=ae(E,l[2]),E.forEach($),C.forEach($),_.forEach($),this.h()},h(){h(t,"class",Mt(l[1])+" svelte-1yohziu"),h(n,"class","icon svelte-1yohziu"),h(r,"class","svelte-1yohziu"),h(e,"class","error svelte-1yohziu")},m(f,_){T(f,e,_),d(e,n),d(n,t),d(e,s),d(e,o),d(o,r),d(r,a),d(o,i),d(o,u),d(u,c)},p:Q,i:Q,o:Q,d(f){f&&$(e)}}}function Ln(l,e,n){let{error:t}=e,s=t.message==="Failed to fetch"?"Connection Error":"Application Error",o=t.message==="Failed to fetch"?"codicon codicon-debug-disconnect":"codicon codicon-error",r=t.message==="Failed to fetch"?"Failed to connect to the server. Make sure you have a stable internet connection.":t.message;return l.$$set=a=>{"error"in a&&n(3,t=a.error)},[s,o,r,t]}class Bn extends _e{constructor(e){super(),de(this,e,Ln,Mn,pe,{error:3})}}function jn(l){let e,n,t,s,o="You have seen everything there is to see...";return{c(){e=S("img"),t=N(),s=S("p"),s.textContent=o,this.h()},l(r){e=I(r,"IMG",{src:!0,alt:!0,class:!0}),t=O(r),s=I(r,"P",{"data-svelte-h":!0}),ue(s)!=="svelte-1i75mtf"&&(s.textContent=o),this.h()},h(){ve(e.src,n=Gt+"/assets/shironeko-x.png")||h(e,"src",n),h(e,"alt","No more results to load"),h(e,"class","svelte-1pkma0d")},m(r,a){T(r,e,a),T(r,t,a),T(r,s,a)},p:Q,i:Q,o:Q,d(r){r&&($(e),$(t),$(s))}}}class Gn extends _e{constructor(e){super(),de(this,e,null,jn,pe,{})}}const Xe=l=>`post_${l}`;function zn(l){let e,n,t,s;const o=l[3].default,r=Jt(o,l,l[2],null);return{c(){e=S("div"),r&&r.c(),this.h()},l(a){e=I(a,"DIV",{role:!0,tabindex:!0,class:!0});var i=V(e);r&&r.l(i),i.forEach($),this.h()},h(){h(e,"role","none"),h(e,"tabindex","-1"),h(e,"class","svelte-6sy8qz")},m(a,i){T(a,e,i),r&&r.m(e,null),l[4](e),n=!0,t||(s=[we(e,"click",Xt(qn)),we(e,"keydown",l[1])],t=!0)},p(a,[i]){r&&r.p&&(!n||i&4)&&xt(r,o,a,a[2],n?tn(o,a[2],i,null):en(a[2]),null)},i(a){n||(v(r,a),n=!0)},o(a){w(r,a),n=!1},d(a){a&&$(e),r&&r.d(a),l[4](null),t=!1,lt(s)}}}const qn=()=>{};function Un(l,e,n){let{$$slots:t={},$$scope:s}=e;const o=Ve(),r=()=>o("close"),a=f=>{f.key==="Escape"&&r()},i=()=>{document.fullscreenElement||r()};let u;xe(async()=>{u.focus(),document.addEventListener("fullscreenchange",i);try{await u.requestFullscreen()}catch{}}),et(async()=>{document.removeEventListener("fullscreenchange",i);try{await document.exitFullscreen()}catch{}});function c(f){Se[f?"unshift":"push"](()=>{u=f,n(0,u)})}return l.$$set=f=>{"$$scope"in f&&n(2,s=f.$$scope)},[u,a,s,t,c]}class Hn extends _e{constructor(e){super(),de(this,e,Un,zn,pe,{})}}function Wn(l){let e;return{c(){e=S("div")},l(n){e=I(n,"DIV",{}),V(e).forEach($)},m(n,t){T(n,e,t),l[2](e)},p:Q,i:Q,o:Q,d(n){n&&$(e),l[2](null)}}}function Kn(l,e,n){let{rootMargin:t}=e;const s=Ve(),o=new IntersectionObserver(i=>{i[0].isIntersecting&&s("intersection")},{rootMargin:t});let r;function a(i){Se[i?"unshift":"push"](()=>{r=i,n(0,r)})}return l.$$set=i=>{"rootMargin"in i&&n(1,t=i.rootMargin)},l.$$.update=()=>{l.$$.dirty&1&&(o.disconnect(),r&&o.observe(r))},[r,t,a]}class Qt extends _e{constructor(e){super(),de(this,e,Kn,Wn,pe,{rootMargin:1})}}function mt(l,e,n){const t=l.slice();return t[3]=e[n],t}function gt(l,e,n){const t=l.slice();return t[6]=e[n][0],t[7]=e[n][1],t}function ht(l){let e,n="•",t,s,o;return s=new Ut({props:{source:l[0].source}}),{c(){e=S("span"),e.textContent=n,t=N(),R(s.$$.fragment)},l(r){e=I(r,"SPAN",{"data-svelte-h":!0}),ue(e)!=="svelte-7hh8jk"&&(e.textContent=n),t=O(r),F(s.$$.fragment,r)},m(r,a){T(r,e,a),T(r,t,a),M(s,r,a),o=!0},p(r,a){const i={};a&1&&(i.source=r[0].source),s.$set(i)},i(r){o||(v(s.$$.fragment,r),o=!0)},o(r){w(s.$$.fragment,r),o=!1},d(r){r&&($(e),$(t)),L(s,r)}}}function $t(l){let e,n=l[6]+"",t,s,o,r;return o=new mn({props:{tags:l[7]}}),{c(){e=S("h3"),t=ie(n),s=N(),R(o.$$.fragment),this.h()},l(a){e=I(a,"H3",{class:!0});var i=V(e);t=ae(i,n),i.forEach($),s=O(a),F(o.$$.fragment,a),this.h()},h(){h(e,"class","svelte-1kekodt")},m(a,i){T(a,e,i),d(e,t),T(a,s,i),M(o,a,i),r=!0},p(a,i){(!r||i&2)&&n!==(n=a[6]+"")&&Te(t,n);const u={};i&2&&(u.tags=a[7]),o.$set(u)},i(a){r||(v(o.$$.fragment,a),r=!0)},o(a){w(o.$$.fragment,a),r=!1},d(a){a&&($(e),$(s)),L(o,a)}}}function Qn(l){return{c:Q,l:Q,m:Q,p:Q,i:Q,o:Q,d:Q}}function Yn(l){let e,n,t,s;const o=[Jn,Zn],r=[];function a(i,u){return i[2].length>0?0:1}return e=a(l),n=r[e]=o[e](l),{c(){n.c(),t=be()},l(i){n.l(i),t=be()},m(i,u){r[e].m(i,u),T(i,t,u),s=!0},p(i,u){let c=e;e=a(i),e===c?r[e].p(i,u):(le(),w(r[c],1,1,()=>{r[c]=null}),re(),n=r[e],n?n.p(i,u):(n=r[e]=o[e](i),n.c()),v(n,1),n.m(t.parentNode,t))},i(i){s||(v(n),s=!0)},o(i){w(n),s=!1},d(i){i&&$(t),r[e].d(i)}}}function Zn(l){let e,n="Comments for this post are not available";return{c(){e=S("span"),e.textContent=n,this.h()},l(t){e=I(t,"SPAN",{class:!0,"data-svelte-h":!0}),ue(e)!=="svelte-4t2lxe"&&(e.textContent=n),this.h()},h(){h(e,"class","no-comments svelte-1kekodt")},m(t,s){T(t,e,s)},p:Q,i:Q,o:Q,d(t){t&&$(e)}}}function Jn(l){let e,n,t=ye(l[2]),s=[];for(let r=0;r<t.length;r+=1)s[r]=vt(mt(l,t,r));const o=r=>w(s[r],1,1,()=>{s[r]=null});return{c(){e=S("ul");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){e=I(r,"UL",{class:!0});var a=V(e);for(let i=0;i<s.length;i+=1)s[i].l(a);a.forEach($),this.h()},h(){h(e,"class","comments svelte-1kekodt")},m(r,a){T(r,e,a);for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(e,null);n=!0},p(r,a){if(a&1){t=ye(r[2]);let i;for(i=0;i<t.length;i+=1){const u=mt(r,t,i);s[i]?(s[i].p(u,a),v(s[i],1)):(s[i]=vt(u),s[i].c(),v(s[i],1),s[i].m(e,null))}for(le(),i=t.length;i<s.length;i+=1)o(i);re()}},i(r){if(!n){for(let a=0;a<t.length;a+=1)v(s[a]);n=!0}},o(r){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)w(s[a]);n=!1},d(r){r&&$(e),Ue(s,r)}}}function vt(l){let e,n;return e=new gn({props:{comment:l[3]}}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p(t,s){const o={};s&1&&(o.comment=t[3]),e.$set(o)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function Xn(l){let e,n;return e=new qt({}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p:Q,i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function xn(l){let e,n,t,s,o,r,a,i,u=l[0].id+"",c,f,_,y,C,b,E="•",p,g,m=l[0].type.toUpperCase()+"",k,D,A,ee="•",Z,x,ne,se,P="•",J,W,B,oe,G,z,X,K="•",me,ge,Ie,De,Pe,He,Ce,Ne,We="Comments",Ke,Re,U;y=new fn({props:{value:l[0].rating}}),x=new pn({props:{value:l[0].score}}),W=new _n({props:{value:l[0].change}}),G=new Ut({props:{source:"https://rule34.xxx/index.php?page=post&s=view&id="+l[0].id}}),ge=new dn({props:{url:l[0].file_url}});let q=l[0].source&&ht(l),he=ye(Object.entries(l[1])),Y=[];for(let H=0;H<he.length;H+=1)Y[H]=$t(gt(l,he,H));const Oe=H=>w(Y[H],1,1,()=>{Y[H]=null});let te={ctx:l,current:null,token:null,hasCatch:!1,pending:Xn,then:Yn,catch:Qn,value:2,blocks:[,,,]};return at(Re=ct(l[0].id),te),{c(){e=S("div"),n=S("img"),s=N(),o=S("h1"),r=ie("Post "),a=S("b"),i=ie("#"),c=ie(u),f=N(),_=S("div"),R(y.$$.fragment),C=N(),b=S("span"),b.textContent=E,p=N(),g=S("span"),k=ie(m),D=N(),A=S("span"),A.textContent=ee,Z=N(),R(x.$$.fragment),ne=N(),se=S("span"),se.textContent=P,J=N(),R(W.$$.fragment),B=N(),oe=S("div"),R(G.$$.fragment),z=N(),X=S("span"),X.textContent=K,me=N(),R(ge.$$.fragment),Ie=N(),q&&q.c(),De=N(),Pe=S("div");for(let H=0;H<Y.length;H+=1)Y[H].c();He=N(),Ce=S("div"),Ne=S("h3"),Ne.textContent=We,Ke=N(),te.block.c(),this.h()},l(H){e=I(H,"DIV",{class:!0});var j=V(e);n=I(j,"IMG",{class:!0,src:!0,alt:!0}),s=O(j),o=I(j,"H1",{class:!0});var ke=V(o);r=ae(ke,"Post "),a=I(ke,"B",{});var Le=V(a);i=ae(Le,"#"),c=ae(Le,u),Le.forEach($),ke.forEach($),f=O(j),_=I(j,"DIV",{class:!0});var fe=V(_);F(y.$$.fragment,fe),C=O(fe),b=I(fe,"SPAN",{"data-svelte-h":!0}),ue(b)!=="svelte-7hh8jk"&&(b.textContent=E),p=O(fe),g=I(fe,"SPAN",{});var Qe=V(g);k=ae(Qe,m),Qe.forEach($),D=O(fe),A=I(fe,"SPAN",{"data-svelte-h":!0}),ue(A)!=="svelte-7hh8jk"&&(A.textContent=ee),Z=O(fe),F(x.$$.fragment,fe),ne=O(fe),se=I(fe,"SPAN",{"data-svelte-h":!0}),ue(se)!=="svelte-7hh8jk"&&(se.textContent=P),J=O(fe),F(W.$$.fragment,fe),fe.forEach($),B=O(j),oe=I(j,"DIV",{class:!0});var Ee=V(oe);F(G.$$.fragment,Ee),z=O(Ee),X=I(Ee,"SPAN",{"data-svelte-h":!0}),ue(X)!=="svelte-7hh8jk"&&(X.textContent=K),me=O(Ee),F(ge.$$.fragment,Ee),Ie=O(Ee),q&&q.l(Ee),Ee.forEach($),De=O(j),Pe=I(j,"DIV",{});var ce=V(Pe);for(let rt=0;rt<Y.length;rt+=1)Y[rt].l(ce);ce.forEach($),He=O(j),Ce=I(j,"DIV",{});var Fe=V(Ce);Ne=I(Fe,"H3",{class:!0,"data-svelte-h":!0}),ue(Ne)!=="svelte-kc6sae"&&(Ne.textContent=We),Ke=O(Fe),te.block.l(Fe),Fe.forEach($),j.forEach($),this.h()},h(){h(n,"class","preview svelte-1kekodt"),ve(n.src,t=l[0].sample_url)||h(n,"src",t),h(n,"alt","preview"),h(o,"class","svelte-1kekodt"),h(_,"class","flex-row svelte-1kekodt"),h(oe,"class","flex-row svelte-1kekodt"),h(Ne,"class","svelte-1kekodt"),h(e,"class","details svelte-1kekodt")},m(H,j){T(H,e,j),d(e,n),d(e,s),d(e,o),d(o,r),d(o,a),d(a,i),d(a,c),d(e,f),d(e,_),M(y,_,null),d(_,C),d(_,b),d(_,p),d(_,g),d(g,k),d(_,D),d(_,A),d(_,Z),M(x,_,null),d(_,ne),d(_,se),d(_,J),M(W,_,null),d(e,B),d(e,oe),M(G,oe,null),d(oe,z),d(oe,X),d(oe,me),M(ge,oe,null),d(oe,Ie),q&&q.m(oe,null),d(e,De),d(e,Pe);for(let ke=0;ke<Y.length;ke+=1)Y[ke]&&Y[ke].m(Pe,null);d(e,He),d(e,Ce),d(Ce,Ne),d(Ce,Ke),te.block.m(Ce,te.anchor=null),te.mount=()=>Ce,te.anchor=null,U=!0},p(H,[j]){l=H,(!U||j&1&&!ve(n.src,t=l[0].sample_url))&&h(n,"src",t),(!U||j&1)&&u!==(u=l[0].id+"")&&Te(c,u);const ke={};j&1&&(ke.value=l[0].rating),y.$set(ke),(!U||j&1)&&m!==(m=l[0].type.toUpperCase()+"")&&Te(k,m);const Le={};j&1&&(Le.value=l[0].score),x.$set(Le);const fe={};j&1&&(fe.value=l[0].change),W.$set(fe);const Qe={};j&1&&(Qe.source="https://rule34.xxx/index.php?page=post&s=view&id="+l[0].id),G.$set(Qe);const Ee={};if(j&1&&(Ee.url=l[0].file_url),ge.$set(Ee),l[0].source?q?(q.p(l,j),j&1&&v(q,1)):(q=ht(l),q.c(),v(q,1),q.m(oe,null)):q&&(le(),w(q,1,1,()=>{q=null}),re()),j&2){he=ye(Object.entries(l[1]));let ce;for(ce=0;ce<he.length;ce+=1){const Fe=gt(l,he,ce);Y[ce]?(Y[ce].p(Fe,j),v(Y[ce],1)):(Y[ce]=$t(Fe),Y[ce].c(),v(Y[ce],1),Y[ce].m(Pe,null))}for(le(),ce=he.length;ce<Y.length;ce+=1)Oe(ce);re()}te.ctx=l,j&1&&Re!==(Re=ct(l[0].id))&&at(Re,te)||un(te,l,j)},i(H){if(!U){v(y.$$.fragment,H),v(x.$$.fragment,H),v(W.$$.fragment,H),v(G.$$.fragment,H),v(ge.$$.fragment,H),v(q);for(let j=0;j<he.length;j+=1)v(Y[j]);v(te.block),U=!0}},o(H){w(y.$$.fragment,H),w(x.$$.fragment,H),w(W.$$.fragment,H),w(G.$$.fragment,H),w(ge.$$.fragment,H),w(q),Y=Y.filter(Boolean);for(let j=0;j<Y.length;j+=1)w(Y[j]);for(let j=0;j<3;j+=1){const ke=te.blocks[j];w(ke)}U=!1},d(H){H&&$(e),L(y),L(x),L(W),L(G),L(ge),q&&q.d(),Ue(Y,H),te.block.d(),te.token=null,te=null}}}function es(l,e,n){let t,{post:s}=e;return l.$$set=o=>{"post"in o&&n(0,s=o.post)},l.$$.update=()=>{l.$$.dirty&1&&n(1,t=s.tags.reduce((o,r)=>(o[r.type]===void 0&&(o[r.type]=[]),o[r.type].push(r),o),{}))},[s,t]}class ts extends _e{constructor(e){super(),de(this,e,es,xn,pe,{post:0})}}const Be=new IntersectionObserver(l=>{for(const e of l)if(e.target){const n=e.target;e.isIntersecting&&n.autoplay&&n.paused&&n.play(),!e.isIntersecting&&!n.paused&&n.pause()}},{rootMargin:"-1px",threshold:.001});function ns(l){const e=l.slice(),n=hn(e[0].file_url,e[0].sample_url,e[0].preview_url);return e[4]=n,e}function ss(l){const e=l.slice(),n=Ht(e[0].file_url,e[0].sample_url,e[0].preview_url);return e[4]=n,e}function bt(l){let e,n,t,s;return{c(){e=S("img"),this.h()},l(o){e=I(o,"IMG",{src:!0,alt:!0,title:!0,class:!0}),this.h()},h(){ve(e.src,n=l[4].animated)||h(e,"src",n),h(e,"alt",t="[GIF] post #"+l[0].id),h(e,"title",s="[GIF] post #"+l[0].id),h(e,"class","svelte-1cjgn2p")},m(o,r){T(o,e,r)},p(o,r){r&1&&!ve(e.src,n=o[4].animated)&&h(e,"src",n),r&1&&t!==(t="[GIF] post #"+o[0].id)&&h(e,"alt",t),r&1&&s!==(s="[GIF] post #"+o[0].id)&&h(e,"title",s)},d(o){o&&$(e)}}}function kt(l){let e,n,t,s;return{c(){e=S("video"),this.h()},l(o){e=I(o,"VIDEO",{src:!0,poster:!0,title:!0,preload:!0,class:!0}),V(e).forEach($),this.h()},h(){ve(e.src,n=l[4].animated)||h(e,"src",n),h(e,"poster",t=l[4].static),e.loop=!0,h(e,"title",s="[VIDEO] post #"+l[0].id),e.controls=!0,h(e,"preload","metadata"),e.autoplay=!0,h(e,"class","svelte-1cjgn2p")},m(o,r){T(o,e,r),l[2](e)},p(o,r){r&1&&!ve(e.src,n=o[4].animated)&&h(e,"src",n),r&1&&t!==(t=o[4].static)&&h(e,"poster",t),r&1&&s!==(s="[VIDEO] post #"+o[0].id)&&h(e,"title",s)},d(o){o&&$(e),l[2](null)}}}function ls(l){let e,n,t,s;return{c(){e=S("img"),this.h()},l(o){e=I(o,"IMG",{src:!0,alt:!0,title:!0,class:!0}),this.h()},h(){ve(e.src,n=l[0].sample_url)||h(e,"src",n),h(e,"alt",t="[IMAGE] post #"+l[0].id),h(e,"title",s="[IMAGE] post #"+l[0].id),h(e,"class","svelte-1cjgn2p")},m(o,r){T(o,e,r)},p(o,r){r&1&&!ve(e.src,n=o[0].sample_url)&&h(e,"src",n),r&1&&t!==(t="[IMAGE] post #"+o[0].id)&&h(e,"alt",t),r&1&&s!==(s="[IMAGE] post #"+o[0].id)&&h(e,"title",s)},d(o){o&&$(e)}}}function rs(l){let e;function n(r,a){return r[0].type==="image"?ls:r[0].type==="video"?kt:bt}function t(r,a){return a===kt?ss(r):a===bt?ns(r):r}let s=n(l),o=s(t(l,s));return{c(){o.c(),e=be()},l(r){o.l(r),e=be()},m(r,a){o.m(r,a),T(r,e,a)},p(r,[a]){s===(s=n(r))&&o?o.p(t(r,s),a):(o.d(1),o=s(t(r,s)),o&&(o.c(),o.m(e.parentNode,e)))},i:Q,o:Q,d(r){r&&$(e),o.d(r)}}}function os(l,e,n){let{post:t}=e,s;const o=a=>{t.type==="video"&&s&&(a.key==="ArrowLeft"&&(a.preventDefault(),a.stopPropagation(),n(1,s.currentTime=Math.max(0,s.currentTime-5),s)),a.key==="ArrowRight"&&(a.preventDefault(),a.stopPropagation(),n(1,s.currentTime=Math.min(s.duration,s.currentTime+5),s)))};xe(()=>{s&&(Be==null||Be.observe(s)),document.addEventListener("keydown",o)}),et(()=>{s&&(Be==null||Be.unobserve(s)),document.removeEventListener("keydown",o)});function r(a){Se[a?"unshift":"push"](()=>{s=a,n(1,s)})}return l.$$set=a=>{"post"in a&&n(0,t=a.post)},[t,s,r]}class is extends _e{constructor(e){super(),de(this,e,os,rs,pe,{post:0})}}function as(l){let e,n,t;return{c(){e=S("img"),this.h()},l(s){e=I(s,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){ve(e.src,n=l[2])||h(e,"src",n),h(e,"alt",t="post #"+l[0].id),h(e,"class","svelte-itxz72"),Ae(e,"top",l[1])},m(s,o){T(s,e,o)},p(s,[o]){o&4&&!ve(e.src,n=s[2])&&h(e,"src",n),o&1&&t!==(t="post #"+s[0].id)&&h(e,"alt",t),o&2&&Ae(e,"top",s[1])},i:Q,o:Q,d(s){s&&$(e)}}}function cs(l,e,n){let t,{post:s}=e,{offset:o}=e;return l.$$set=r=>{"post"in r&&n(0,s=r.post),"offset"in r&&n(1,o=r.offset)},l.$$.update=()=>{l.$$.dirty&1&&n(2,t=$n(s.sample_url)?s.preview_url:s.sample_url)},[s,o,t]}class Yt extends _e{constructor(e){super(),de(this,e,cs,as,pe,{post:0,offset:1})}}function wt(l,e,n){const t=l.slice();return t[17]=e[n],t[19]=n,t}function yt(l){let e,n;return e=new Yt({props:{post:l[3],offset:l[6]}}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p(t,s){const o={};s&8&&(o.post=t[3]),s&64&&(o.offset=t[6]),e.$set(o)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function Ct(l){let e,n;return e=new Yt({props:{post:l[4],offset:l[7]}}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p(t,s){const o={};s&16&&(o.post=t[4]),s&128&&(o.offset=t[7]),e.$set(o)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function Et(l){let e,n=`${l[19]*100}vh`;return{c(){e=S("div"),this.h()},l(t){e=I(t,"DIV",{class:!0}),V(e).forEach($),this.h()},h(){h(e,"class","pseudo snap-item svelte-3khu3"),Ae(e,"top",n)},m(t,s){T(t,e,s)},p:Q,d(t){t&&$(e)}}}function us(l){let e,n,t,s,o,r,a,i,u,c,f,_,y,C=l[3]&&yt(l);s=new is({props:{post:l[2]}}),r=new ts({props:{post:l[2]}});let b=l[4]&&Ct(l),E=ye({length:l[8].posts.length}),p=[];for(let g=0;g<E.length;g+=1)p[g]=Et(wt(l,E,g));return c=new Qt({props:{rootMargin:window.innerHeight*2+"px"}}),c.$on("intersection",l[13]),{c(){e=S("div"),C&&C.c(),n=N(),t=S("div"),R(s.$$.fragment),o=N(),R(r.$$.fragment),a=N(),b&&b.c(),i=N();for(let g=0;g<p.length;g+=1)p[g].c();u=N(),R(c.$$.fragment),this.h()},l(g){e=I(g,"DIV",{class:!0});var m=V(e);C&&C.l(m),n=O(m),t=I(m,"DIV",{class:!0});var k=V(t);F(s.$$.fragment,k),o=O(k),F(r.$$.fragment,k),k.forEach($),a=O(m),b&&b.l(m),i=O(m);for(let D=0;D<p.length;D+=1)p[D].l(m);u=O(m),F(c.$$.fragment,m),m.forEach($),this.h()},h(){h(t,"class","screen snap-container horizontal current svelte-3khu3"),Ae(t,"top",l[5]),h(e,"class","root screen snap-container svelte-3khu3")},m(g,m){T(g,e,m),C&&C.m(e,null),d(e,n),d(e,t),M(s,t,null),d(t,o),M(r,t,null),l[12](t),d(e,a),b&&b.m(e,null),d(e,i);for(let k=0;k<p.length;k+=1)p[k]&&p[k].m(e,null);d(e,u),M(c,e,null),l[14](e),f=!0,_||(y=we(e,"scroll",l[10]),_=!0)},p(g,[m]){g[3]?C?(C.p(g,m),m&8&&v(C,1)):(C=yt(g),C.c(),v(C,1),C.m(e,n)):C&&(le(),w(C,1,1,()=>{C=null}),re());const k={};m&4&&(k.post=g[2]),s.$set(k);const D={};if(m&4&&(D.post=g[2]),r.$set(D),m&32&&Ae(t,"top",g[5]),g[4]?b?(b.p(g,m),m&16&&v(b,1)):(b=Ct(g),b.c(),v(b,1),b.m(e,i)):b&&(le(),w(b,1,1,()=>{b=null}),re()),m&256){E=ye({length:g[8].posts.length});let A;for(A=0;A<E.length;A+=1){const ee=wt(g,E,A);p[A]?p[A].p(ee,m):(p[A]=Et(ee),p[A].c(),p[A].m(e,u))}for(;A<p.length;A+=1)p[A].d(1);p.length=E.length}},i(g){f||(v(C),v(s.$$.fragment,g),v(r.$$.fragment,g),v(b),v(c.$$.fragment,g),f=!0)},o(g){w(C),w(s.$$.fragment,g),w(r.$$.fragment,g),w(b),w(c.$$.fragment,g),f=!1},d(g){g&&$(e),C&&C.d(),L(s),L(r),l[12](null),b&&b.d(),Ue(p,g),L(c),l[14](null),_=!1,y()}}}function fs(l,e,n){let t;$e(l,Ge,k=>n(8,t=k));let{index:s}=e,o,r,a=t.posts[s],i=s>0?t.posts[s-1]:void 0,u=s<t.posts.length-1?t.posts[s+1]:void 0,c=`${s*100}vh`,f=`${(s-1)*100}vh`,_=`${(s+1)*100}vh`;const y=Ve(),C=()=>{r&&(r.scrollIntoView(),n(1,r.scrollLeft=0,r))},b=k=>{const D=k.target,A=D.getBoundingClientRect().height,ee=D.scrollTop/A,Z=Math.round(ee);Z!=s&&requestAnimationFrame(()=>{n(11,s=Z),n(2,a=t.posts[s]),n(3,i=s>0?t.posts[s-1]:void 0),n(4,u=s<t.posts.length-1?t.posts[s+1]:void 0),n(5,c=`${s*100}vh`),n(6,f=`${(s-1)*100}vh`),n(7,_=`${(s+1)*100}vh`),r&&n(1,r.scrollLeft=0,r)})},E=k=>{k.key==="d"&&(k.preventDefault(),k.stopPropagation(),r.scrollLeft===0?r.scrollBy({left:o.clientWidth,top:0,behavior:"smooth"}):r.scrollBy({left:-o.clientWidth,top:0,behavior:"smooth"})),k.key==="ArrowUp"&&(k.preventDefault(),k.stopPropagation(),o.scrollTo({left:0,top:o.clientHeight*(s-1),behavior:"smooth"})),k.key==="ArrowDown"&&(k.preventDefault(),k.stopPropagation(),o.scrollTo({left:0,top:o.clientHeight*(s+1),behavior:"smooth"}))};xe(()=>{document.addEventListener("keydown",E),C()}),et(()=>{document.removeEventListener("keydown",E)});function p(k){Se[k?"unshift":"push"](()=>{r=k,n(1,r)})}const g=()=>y("endreached");function m(k){Se[k?"unshift":"push"](()=>{o=k,n(0,o)})}return l.$$set=k=>{"index"in k&&n(11,s=k.index)},[o,r,a,i,u,c,f,_,t,y,b,s,p,g,m]}class ps extends _e{constructor(e){super(),de(this,e,fs,us,pe,{index:11})}}function _s(l){let e;return{c(){e=S("i"),this.h()},l(n){e=I(n,"I",{class:!0}),V(e).forEach($),this.h()},h(){h(e,"class","codicon codicon-close")},m(n,t){T(n,e,t)},p:Q,d(n){n&&$(e)}}}function ds(l){let e,n,t,s,o;function r(i){l[2](i)}let a={};return l[0]!==void 0&&(a.index=l[0]),e=new ps({props:a}),Se.push(()=>Ze(e,"index",r)),e.$on("endreached",l[3]),s=new zt({props:{class:"button-close",$$slots:{default:[_s]},$$scope:{ctx:l}}}),s.$on("click",l[1]),{c(){R(e.$$.fragment),t=N(),R(s.$$.fragment)},l(i){F(e.$$.fragment,i),t=O(i),F(s.$$.fragment,i)},m(i,u){M(e,i,u),T(i,t,u),M(s,i,u),o=!0},p(i,u){const c={};!n&&u&1&&(n=!0,c.index=i[0],Ye(()=>n=!1)),e.$set(c);const f={};u&128&&(f.$$scope={dirty:u,ctx:i}),s.$set(f)},i(i){o||(v(e.$$.fragment,i),v(s.$$.fragment,i),o=!0)},o(i){w(e.$$.fragment,i),w(s.$$.fragment,i),o=!1},d(i){i&&$(t),L(e,i),L(s,i)}}}function ms(l){let e,n;return e=new Hn({props:{$$slots:{default:[ds]},$$scope:{ctx:l}}}),e.$on("close",l[1]),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p(t,[s]){const o={};s&129&&(o.$$scope={dirty:s,ctx:t}),e.$set(o)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function gs(l,e,n){let{index:t}=e;const s=Ve(),o=()=>{s("close",t)},r=c=>{c.key==="f"&&(c.preventDefault(),c.stopPropagation(),o())},a=()=>{var c,f;(((c=history.state)==null?void 0:c.fullscreen)===void 0||((f=history.state)==null?void 0:f.fullscreen)===!1)&&o()};xe(()=>{window.addEventListener("popstate",a),document.addEventListener("keydown",r)}),et(()=>{window.removeEventListener("popstate",a),document.removeEventListener("keydown",r)});function i(c){t=c,n(0,t)}function u(c){nt.call(this,l,c)}return l.$$set=c=>{"index"in c&&n(0,t=c.index)},[t,o,i,u]}class hs extends _e{constructor(e){super(),de(this,e,gs,ms,pe,{index:0})}}function St(l){let e,n=l[0].type==="video"?"▶":"GIF",t;return{c(){e=S("span"),t=ie(n),this.h()},l(s){e=I(s,"SPAN",{class:!0});var o=V(e);t=ae(o,n),o.forEach($),this.h()},h(){h(e,"class","type svelte-1213alg")},m(s,o){T(s,e,o),d(e,t)},p(s,o){o&1&&n!==(n=s[0].type==="video"?"▶":"GIF")&&Te(t,n)},d(s){s&&$(e)}}}function $s(l){let e,n,t,s,o,r=Je(l[0].score)+"",a,i,u,c,f,_=l[0].type!=="image"&&St(l);return{c(){e=S("div"),n=S("img"),s=N(),o=S("span"),a=ie(r),i=N(),_&&_.c(),this.h()},l(y){e=I(y,"DIV",{id:!0,class:!0,style:!0});var C=V(e);n=I(C,"IMG",{src:!0,alt:!0,class:!0,tabindex:!0,loading:!0}),s=O(C),o=I(C,"SPAN",{class:!0});var b=V(o);a=ae(b,r),b.forEach($),i=O(C),_&&_.l(C),C.forEach($),this.h()},h(){ve(n.src,t=l[1])||h(n,"src",t),h(n,"alt","post"),h(n,"class","post-media svelte-1213alg"),h(n,"tabindex","-1"),h(n,"loading","lazy"),h(o,"class","score svelte-1213alg"),h(e,"id",u=Xe(l[0].id)),h(e,"class","post svelte-1213alg"),Ae(e,"grid-row","span "+l[2]),st(e,"open",open)},m(y,C){T(y,e,C),d(e,n),d(e,s),d(e,o),d(o,a),d(e,i),_&&_.m(e,null),c||(f=[we(e,"click",l[3]),we(e,"keydown",l[4])],c=!0)},p(y,[C]){C&2&&!ve(n.src,t=y[1])&&h(n,"src",t),C&1&&r!==(r=Je(y[0].score)+"")&&Te(a,r),y[0].type!=="image"?_?_.p(y,C):(_=St(y),_.c(),_.m(e,null)):_&&(_.d(1),_=null),C&1&&u!==(u=Xe(y[0].id))&&h(e,"id",u),C&0&&st(e,"open",open)},i:Q,o:Q,d(y){y&&$(e),_&&_.d(),c=!1,lt(f)}}}let It=3;function vs(l,e,n){let t,{post:s}=e,o=Math.min(Math.round(s.height/s.width)*It,It*3);const r=u=>u.endsWith(".jpg")||u.endsWith(".jpeg")||u.endsWith(".png")||u.endsWith(".webp");function a(u){nt.call(this,l,u)}const i=u=>{var c;(Wt(u)||u.key==="f")&&((c=u.target)==null||c.click())};return l.$$set=u=>{"post"in u&&n(0,s=u.post)},l.$$.update=()=>{l.$$.dirty&1&&n(1,t=r(s.sample_url)?s.sample_url:s.preview_url)},[s,t,o,a,i]}class bs extends _e{constructor(e){super(),de(this,e,vs,$s,pe,{post:0})}}function ks(l){const e=l.slice(),n=Ht(e[1].file_url,e[1].sample_url,e[1].preview_url);return e[7]=n,e}function ws(l){let e,n;return e=new bn({props:{post:l[1]}}),e.$on("click",l[4]),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p(t,s){const o={};s&2&&(o.post=t[1]),e.$set(o)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function ys(l){let e,n;return e=new kn({props:{src:l[7].animated,poster:l[7].static,width:l[1].width,height:l[1].height,loop:l[2]||ut(l[1].tags)}}),e.$on("click",l[4]),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p(t,s){const o={};s&2&&(o.src=t[7].animated),s&2&&(o.poster=t[7].static),s&2&&(o.width=t[1].width),s&2&&(o.height=t[1].height),s&6&&(o.loop=t[2]||ut(t[1].tags)),e.$set(o)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function Cs(l){let e,n;return e=new wn({props:{post:l[1],open:l[0]}}),e.$on("click",l[4]),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p(t,s){const o={};s&2&&(o.post=t[1]),s&1&&(o.open=t[0]),e.$set(o)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function Es(l){let e;return{c(){e=S("i"),this.h()},l(n){e=I(n,"I",{class:!0}),V(e).forEach($),this.h()},h(){h(e,"class","codicon codicon-screen-full")},m(n,t){T(n,e,t)},p:Q,d(n){n&&$(e)}}}function Dt(l){let e,n;return e=new vn({props:{post:l[1]}}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p(t,s){const o={};s&2&&(o.post=t[1]),e.$set(o)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function Ss(l){let e,n,t,s,o,r,a,i,u,c;const f=[Cs,ys,ws],_=[];function y(E,p){return E[1].type==="image"?0:E[1].type==="video"?1:2}function C(E,p){return p===1?ks(E):E}n=y(l),t=_[n]=f[n](C(l,n)),o=new zt({props:{class:"button-fullscreen","aria-label":"Enter Fullscreen mode",$$slots:{default:[Es]},$$scope:{ctx:l}}}),o.$on("click",l[5]);let b=l[0]&&Dt(l);return{c(){e=S("div"),t.c(),s=N(),R(o.$$.fragment),r=N(),b&&b.c(),this.h()},l(E){e=I(E,"DIV",{id:!0,class:!0});var p=V(e);t.l(p),s=O(p),F(o.$$.fragment,p),r=O(p),b&&b.l(p),p.forEach($),this.h()},h(){h(e,"id",a=Xe(l[1].id)),h(e,"class","post svelte-pwgq1f"),st(e,"open",l[0])},m(E,p){T(E,e,p),_[n].m(e,null),d(e,s),M(o,e,null),d(e,r),b&&b.m(e,null),i=!0,u||(c=we(e,"keydown",l[6]),u=!0)},p(E,[p]){let g=n;n=y(E),n===g?_[n].p(C(E,n),p):(le(),w(_[g],1,1,()=>{_[g]=null}),re(),t=_[n],t?t.p(C(E,n),p):(t=_[n]=f[n](C(E,n)),t.c()),v(t,1),t.m(e,s));const m={};p&256&&(m.$$scope={dirty:p,ctx:E}),o.$set(m),E[0]?b?(b.p(E,p),p&1&&v(b,1)):(b=Dt(E),b.c(),v(b,1),b.m(e,null)):b&&(le(),w(b,1,1,()=>{b=null}),re()),(!i||p&2&&a!==(a=Xe(E[1].id)))&&h(e,"id",a),(!i||p&1)&&st(e,"open",E[0])},i(E){i||(v(t),v(o.$$.fragment,E),v(b),i=!0)},o(E){w(t),w(o.$$.fragment,E),w(b),i=!1},d(E){E&&$(e),_[n].d(),L(o),b&&b.d(),u=!1,c()}}}function Is(l,e,n){let t;$e(l,yn,c=>n(2,t=c));const s=Ve(),o=()=>n(0,a=!a);let{post:r}=e,{open:a=!1}=e;const i=()=>s("fullscreen"),u=c=>{c.key==="f"&&s("fullscreen")};return l.$$set=c=>{"post"in c&&n(1,r=c.post),"open"in c&&n(0,a=c.open)},[a,r,t,s,o,i,u]}class Ds extends _e{constructor(e){super(),de(this,e,Is,Ss,pe,{post:1,open:0})}}function Pt(l){let e,n;return e=new Bt({props:{$$slots:{default:[Os]},$$scope:{ctx:l}}}),e.$on("close",l[7]),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p(t,s){const o={};s&65543&&(o.$$scope={dirty:s,ctx:t}),e.$set(o)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function Ps(l){let e;return{c(){e=ie("Done")},l(n){e=ae(n,"Done")},m(n,t){T(n,e,t)},d(n){n&&$(e)}}}function Ns(l){let e;return{c(){e=ie("Reset")},l(n){e=ae(n,"Reset")},m(n,t){T(n,e,t)},d(n){n&&$(e)}}}function Os(l){let e,n,t="Sorting and Filtering",s,o,r,a="Sorting",i,u,c,f,_,y,C,b,E,p,g="Filtering by Score",m,k,D,A,ee,Z,x,ne,se,P="Filtering by Rating",J,W,B,oe,G,z,X,K,me,ge,Ie;function De(U){l[10](U)}let Pe={options:Vs};l[1].direction!==void 0&&(Pe.value=l[1].direction),c=new cn({props:Pe}),Se.push(()=>Ze(c,"value",De));function He(U){l[11](U)}let Ce={options:As};l[1].property!==void 0&&(Ce.value=l[1].property),y=new ft({props:Ce}),Se.push(()=>Ze(y,"value",He));function Ne(U){l[12](U)}let We={options:Rs};l[2].scoreComparator!==void 0&&(We.value=l[2].scoreComparator),D=new Cn({props:We}),Se.push(()=>Ze(D,"value",Ne));function Ke(U){l[14](U)}let Re={options:Zt};return l[2].rating!==void 0&&(Re.value=l[2].rating),B=new ft({props:Re}),Se.push(()=>Ze(B,"value",Ke)),z=new qe({props:{title:"Return to searching.",$$slots:{default:[Ps]},$$scope:{ctx:l}}}),z.$on("click",l[7]),K=new qe({props:{title:"Reset sort and filter.",type:"secondary",$$slots:{default:[Ns]},$$scope:{ctx:l}}}),K.$on("click",l[9]),{c(){e=S("div"),n=S("h3"),n.textContent=t,s=N(),o=S("div"),r=S("b"),r.textContent=a,i=N(),u=S("div"),R(c.$$.fragment),_=N(),R(y.$$.fragment),b=N(),E=S("div"),p=S("b"),p.textContent=g,m=N(),k=S("div"),R(D.$$.fragment),ee=N(),Z=S("input"),x=N(),ne=S("div"),se=S("b"),se.textContent=P,J=N(),W=S("div"),R(B.$$.fragment),G=N(),R(z.$$.fragment),X=N(),R(K.$$.fragment),this.h()},l(U){e=I(U,"DIV",{class:!0});var q=V(e);n=I(q,"H3",{"data-svelte-h":!0}),ue(n)!=="svelte-15zouq3"&&(n.textContent=t),s=O(q),o=I(q,"DIV",{});var he=V(o);r=I(he,"B",{class:!0,"data-svelte-h":!0}),ue(r)!=="svelte-ekzpgg"&&(r.textContent=a),i=O(he),u=I(he,"DIV",{class:!0});var Y=V(u);F(c.$$.fragment,Y),_=O(Y),F(y.$$.fragment,Y),Y.forEach($),he.forEach($),b=O(q),E=I(q,"DIV",{});var Oe=V(E);p=I(Oe,"B",{class:!0,"data-svelte-h":!0}),ue(p)!=="svelte-1flca3"&&(p.textContent=g),m=O(Oe),k=I(Oe,"DIV",{class:!0});var te=V(k);F(D.$$.fragment,te),ee=O(te),Z=I(te,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),te.forEach($),Oe.forEach($),x=O(q),ne=I(q,"DIV",{});var H=V(ne);se=I(H,"B",{class:!0,"data-svelte-h":!0}),ue(se)!=="svelte-1evbw58"&&(se.textContent=P),J=O(H),W=I(H,"DIV",{class:!0});var j=V(W);F(B.$$.fragment,j),j.forEach($),H.forEach($),G=O(q),F(z.$$.fragment,q),X=O(q),F(K.$$.fragment,q),q.forEach($),this.h()},h(){h(r,"class","svelte-4dh9db"),h(u,"class","row svelte-4dh9db"),h(p,"class","svelte-4dh9db"),h(Z,"type","number"),h(Z,"min",0),h(Z,"max",1e5),h(Z,"step",1),h(Z,"class","svelte-4dh9db"),h(k,"class","row svelte-4dh9db"),h(se,"class","svelte-4dh9db"),h(W,"class","row svelte-4dh9db"),h(e,"class","container svelte-4dh9db")},m(U,q){T(U,e,q),d(e,n),d(e,s),d(e,o),d(o,r),d(o,i),d(o,u),M(c,u,null),d(u,_),M(y,u,null),d(e,b),d(e,E),d(E,p),d(E,m),d(E,k),M(D,k,null),d(k,ee),d(k,Z),je(Z,l[0]),d(e,x),d(e,ne),d(ne,se),d(ne,J),d(ne,W),M(B,W,null),d(e,G),M(z,e,null),d(e,X),M(K,e,null),me=!0,ge||(Ie=[we(Z,"input",l[13]),we(Z,"keyup",l[8])],ge=!0)},p(U,q){const he={};!f&&q&2&&(f=!0,he.value=U[1].direction,Ye(()=>f=!1)),c.$set(he);const Y={};!C&&q&2&&(C=!0,Y.value=U[1].property,Ye(()=>C=!1)),y.$set(Y);const Oe={};!A&&q&4&&(A=!0,Oe.value=U[2].scoreComparator,Ye(()=>A=!1)),D.$set(Oe),q&1&&Lt(Z.value)!==U[0]&&je(Z,U[0]);const te={};!oe&&q&4&&(oe=!0,te.value=U[2].rating,Ye(()=>oe=!1)),B.$set(te);const H={};q&65536&&(H.$$scope={dirty:q,ctx:U}),z.$set(H);const j={};q&65536&&(j.$$scope={dirty:q,ctx:U}),K.$set(j)},i(U){me||(v(c.$$.fragment,U),v(y.$$.fragment,U),v(D.$$.fragment,U),v(B.$$.fragment,U),v(z.$$.fragment,U),v(K.$$.fragment,U),me=!0)},o(U){w(c.$$.fragment,U),w(y.$$.fragment,U),w(D.$$.fragment,U),w(B.$$.fragment,U),w(z.$$.fragment,U),w(K.$$.fragment,U),me=!1},d(U){U&&$(e),L(c),L(y),L(D),L(B),L(z),L(K),ge=!1,lt(Ie)}}}function Ts(l){let e,n,t,s,o,r,a,i,u,c,f,_,y,C,b,E=l[3]&&Pt(l);return{c(){e=S("button"),n=S("i"),t=N(),s=S("span"),o=ie(l[5]),r=N(),a=S("i"),i=N(),u=S("span"),c=ie(l[4]),f=N(),E&&E.c(),_=be(),this.h()},l(p){e=I(p,"BUTTON",{class:!0});var g=V(e);n=I(g,"I",{class:!0}),V(n).forEach($),t=O(g),s=I(g,"SPAN",{});var m=V(s);o=ae(m,l[5]),m.forEach($),r=O(g),a=I(g,"I",{class:!0}),V(a).forEach($),i=O(g),u=I(g,"SPAN",{});var k=V(u);c=ae(k,l[4]),k.forEach($),g.forEach($),f=O(p),E&&E.l(p),_=be(),this.h()},h(){h(n,"class","codicon codicon-filter svelte-4dh9db"),h(a,"class","codicon codicon-arrow-swap svelte-4dh9db"),h(e,"class","svelte-4dh9db")},m(p,g){T(p,e,g),d(e,n),d(e,t),d(e,s),d(s,o),d(e,r),d(e,a),d(e,i),d(e,u),d(u,c),T(p,f,g),E&&E.m(p,g),T(p,_,g),y=!0,C||(b=we(e,"click",l[6]),C=!0)},p(p,[g]){(!y||g&32)&&Te(o,p[5]),(!y||g&16)&&Te(c,p[4]),p[3]?E?(E.p(p,g),g&8&&v(E,1)):(E=Pt(p),E.c(),v(E,1),E.m(_.parentNode,_)):E&&(le(),w(E,1,1,()=>{E=null}),re())},i(p){y||(v(E),y=!0)},o(p){w(E),y=!1},d(p){p&&($(e),$(f),$(_)),E&&E.d(p),C=!1,b()}}}const As=Object.freeze({id:"Uploaded",score:"Score",updated:"Updated",random:"Random"}),Vs=Object.freeze({desc:"codicon codicon-arrow-down",asc:"codicon codicon-arrow-up"}),Rs=Object.freeze({">=":"≥","<=":"≤"}),Zt=Object.freeze({all:"All",safe:"Safe",questionable:"Questionable",explicit:"Explicit"}),Fs=Object.freeze({id:{asc:"Oldest",desc:"Newest"},score:{asc:"Worst",desc:"Best"},updated:{asc:"Inactive",desc:"Active"},random:{asc:"Random",desc:"Random"}}),Ms=(l,e,n)=>{let t=l==="all"?void 0:Zt[l],s=e===0&&n===">="?void 0:`Score${n}${Je(e)}`;return[t,s].filter(o=>o!==void 0).join(",")||"All"};function Ls(l,e,n){let t,s,o,r;$e(l,ze,m=>n(1,o=m)),$e(l,Me,m=>n(2,r=m));const a=Ve();let i=!1;const u=()=>n(3,i=!0),c=()=>{n(3,i=!1),a("sortfilterupdate")},f=m=>{var k;return Wt(m)&&((k=m.target)==null?void 0:k.blur())},_=()=>{ze.reset(),Me.reset(),n(0,y=r.scoreValue)};let y;function C(m){l.$$.not_equal(o.direction,m)&&(o.direction=m,ze.set(o))}function b(m){l.$$.not_equal(o.property,m)&&(o.property=m,ze.set(o))}function E(m){l.$$.not_equal(r.scoreComparator,m)&&(r.scoreComparator=m,Me.set(r))}function p(){y=Lt(this.value),n(0,y),n(2,r)}function g(m){l.$$.not_equal(r.rating,m)&&(r.rating=m,Me.set(r))}return l.$$.update=()=>{if(l.$$.dirty&5){y===void 0&&n(0,y=r.scoreValue);let m=Number(y);isNaN(m)||nn(Me,r.scoreValue=m,r)}l.$$.dirty&4&&n(5,t=Ms(r.rating,r.scoreValue,r.scoreComparator)),l.$$.dirty&2&&n(4,s=Fs[o.property][o.direction])},[y,o,r,i,s,t,u,c,f,_,C,b,E,p,g]}class Bs extends _e{constructor(e){super(),de(this,e,Ls,Ts,pe,{})}}function Nt(l,e,n){const t=l.slice();return t[8]=e[n],t[10]=n,t}function Ot(l,e,n){const t=l.slice();return t[8]=e[n],t[10]=n,t}function js(l){let e,n,t=ye(l[1].posts),s=[];for(let r=0;r<t.length;r+=1)s[r]=Tt(Nt(l,t,r));const o=r=>w(s[r],1,1,()=>{s[r]=null});return{c(){e=S("section");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){e=I(r,"SECTION",{class:!0,style:!0});var a=V(e);for(let i=0;i<s.length;i+=1)s[i].l(a);a.forEach($),this.h()},h(){h(e,"class","multi-column svelte-wypqh"),Ae(e,"grid-template-columns","repeat("+l[2]+", 1fr)")},m(r,a){T(r,e,a);for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(e,null);n=!0},p(r,a){if(a&3){t=ye(r[1].posts);let i;for(i=0;i<t.length;i+=1){const u=Nt(r,t,i);s[i]?(s[i].p(u,a),v(s[i],1)):(s[i]=Tt(u),s[i].c(),v(s[i],1),s[i].m(e,null))}for(le(),i=t.length;i<s.length;i+=1)o(i);re()}(!n||a&4)&&Ae(e,"grid-template-columns","repeat("+r[2]+", 1fr)")},i(r){if(!n){for(let a=0;a<t.length;a+=1)v(s[a]);n=!0}},o(r){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)w(s[a]);n=!1},d(r){r&&$(e),Ue(s,r)}}}function Gs(l){let e,n,t=ye(l[1].posts),s=[];for(let r=0;r<t.length;r+=1)s[r]=At(Ot(l,t,r));const o=r=>w(s[r],1,1,()=>{s[r]=null});return{c(){e=S("section");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){e=I(r,"SECTION",{class:!0});var a=V(e);for(let i=0;i<s.length;i+=1)s[i].l(a);a.forEach($),this.h()},h(){h(e,"class","single-column svelte-wypqh")},m(r,a){T(r,e,a);for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(e,null);n=!0},p(r,a){if(a&3){t=ye(r[1].posts);let i;for(i=0;i<t.length;i+=1){const u=Ot(r,t,i);s[i]?(s[i].p(u,a),v(s[i],1)):(s[i]=At(u),s[i].c(),v(s[i],1),s[i].m(e,null))}for(le(),i=t.length;i<s.length;i+=1)o(i);re()}},i(r){if(!n){for(let a=0;a<t.length;a+=1)v(s[a]);n=!0}},o(r){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)w(s[a]);n=!1},d(r){r&&$(e),Ue(s,r)}}}function Tt(l){let e,n;function t(){return l[6](l[10])}return e=new bs({props:{post:l[8]}}),e.$on("click",t),{c(){R(e.$$.fragment)},l(s){F(e.$$.fragment,s)},m(s,o){M(e,s,o),n=!0},p(s,o){l=s;const r={};o&2&&(r.post=l[8]),e.$set(r)},i(s){n||(v(e.$$.fragment,s),n=!0)},o(s){w(e.$$.fragment,s),n=!1},d(s){L(e,s)}}}function At(l){let e,n;function t(){return l[5](l[10])}return e=new Ds({props:{post:l[8]}}),e.$on("fullscreen",t),{c(){R(e.$$.fragment)},l(s){F(e.$$.fragment,s)},m(s,o){M(e,s,o),n=!0},p(s,o){l=s;const r={};o&2&&(r.post=l[8]),e.$set(r)},i(s){n||(v(e.$$.fragment,s),n=!0)},o(s){w(e.$$.fragment,s),n=!1},d(s){L(e,s)}}}function Vt(l){let e,n;return e=new hs({props:{index:l[0]}}),e.$on("close",l[3]),e.$on("endreached",l[7]),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p(t,s){const o={};s&1&&(o.index=t[0]),e.$set(o)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function zs(l){let e,n,t=Je(l[1].postCount)+"",s,o,r,a,i,u,c,f,_,y;a=new Bs({}),a.$on("sortfilterupdate",l[4]);const C=[Gs,js],b=[];function E(g,m){return g[2]==="1"?0:1}u=E(l),c=b[u]=C[u](l);let p=l[0]!==void 0&&Vt(l);return{c(){e=S("div"),n=S("span"),s=ie(t),o=ie(" posts"),r=N(),R(a.$$.fragment),i=N(),c.c(),f=N(),p&&p.c(),_=be(),this.h()},l(g){e=I(g,"DIV",{class:!0});var m=V(e);n=I(m,"SPAN",{});var k=V(n);s=ae(k,t),o=ae(k," posts"),k.forEach($),r=O(m),F(a.$$.fragment,m),m.forEach($),i=O(g),c.l(g),f=O(g),p&&p.l(g),_=be(),this.h()},h(){h(e,"class","svelte-wypqh")},m(g,m){T(g,e,m),d(e,n),d(n,s),d(n,o),d(e,r),M(a,e,null),T(g,i,m),b[u].m(g,m),T(g,f,m),p&&p.m(g,m),T(g,_,m),y=!0},p(g,[m]){(!y||m&2)&&t!==(t=Je(g[1].postCount)+"")&&Te(s,t);let k=u;u=E(g),u===k?b[u].p(g,m):(le(),w(b[k],1,1,()=>{b[k]=null}),re(),c=b[u],c?c.p(g,m):(c=b[u]=C[u](g),c.c()),v(c,1),c.m(f.parentNode,f)),g[0]!==void 0?p?(p.p(g,m),m&1&&v(p,1)):(p=Vt(g),p.c(),v(p,1),p.m(_.parentNode,_)):p&&(le(),w(p,1,1,()=>{p=null}),re())},i(g){y||(v(a.$$.fragment,g),v(c),v(p),y=!0)},o(g){w(a.$$.fragment,g),w(c),w(p),y=!1},d(g){g&&($(e),$(i),$(f),$(_)),L(a),b[u].d(g),p&&p.d(g)}}}function qs(l,e,n){let t,s;$e(l,Ge,f=>n(1,t=f)),$e(l,jt,f=>n(2,s=f));let o;const r=f=>{var C;const _=t.posts[f.detail],y=Xe(_.id);(C=document.getElementById(y))==null||C.scrollIntoView(),n(0,o=void 0)};function a(f){nt.call(this,l,f)}const i=f=>{n(0,o=f)},u=f=>{n(0,o=f)};function c(f){nt.call(this,l,f)}return l.$$.update=()=>{var f;l.$$.dirty&1&&(o!==void 0?history.pushState({...history.state,fullscreen:!0},""):(f=history.state)!=null&&f.fullscreen&&history.back())},[o,t,s,r,a,i,u,c]}class Us extends _e{constructor(e){super(),de(this,e,qs,zs,pe,{})}}function Hs(l){let e;return{c(){e=ie("Reset Filter")},l(n){e=ae(n,"Reset Filter")},m(n,t){T(n,e,t)},d(n){n&&$(e)}}}function Ws(l){let e,n,t,s,o="We couldn't find any posts matching your tags. Sorry...",r,a,i;return a=new qe({props:{title:"In case your filter caused all posts to vanish. Reset it.",$$slots:{default:[Hs]},$$scope:{ctx:l}}}),a.$on("click",l[1]),{c(){e=S("img"),t=N(),s=S("p"),s.textContent=o,r=N(),R(a.$$.fragment),this.h()},l(u){e=I(u,"IMG",{src:!0,alt:!0,class:!0}),t=O(u),s=I(u,"P",{"data-svelte-h":!0}),ue(s)!=="svelte-1utxj3w"&&(s.textContent=o),r=O(u),F(a.$$.fragment,u),this.h()},h(){ve(e.src,n=Gt+"/assets/shironeko-confused.png")||h(e,"src",n),h(e,"alt","Nothing here..."),h(e,"class","svelte-1bb5e7g")},m(u,c){T(u,e,c),T(u,t,c),T(u,s,c),T(u,r,c),M(a,u,c),i=!0},p(u,[c]){const f={};c&4&&(f.$$scope={dirty:c,ctx:u}),a.$set(f)},i(u){i||(v(a.$$.fragment,u),i=!0)},o(u){w(a.$$.fragment,u),i=!1},d(u){u&&($(e),$(t),$(s),$(r)),L(a,u)}}}function Ks(l){const e=Ve();return[e,()=>{ze.reset(),Me.reset(),e("sortfilterupdate")}]}class Qs extends _e{constructor(e){super(),de(this,e,Ks,Ws,pe,{})}}function Ys(l){const e=l-1;return e*e*e+1}function Zs(l,{delay:e=0,duration:n=400,easing:t=Ys,x:s=0,y:o=0,opacity:r=0}={}){const a=getComputedStyle(l),i=+a.opacity,u=a.transform==="none"?"":a.transform,c=i*(1-r),[f,_]=it(s),[y,C]=it(o);return{delay:e,duration:n,easing:t,css:(b,E)=>`
			transform: ${u} translate(${(1-b)*f}${_}, ${(1-b)*y}${C});
			opacity: ${i-c*E}`}}function Js(l){let e;return{c(){e=ie("Ok")},l(n){e=ae(n,"Ok")},m(n,t){T(n,e,t)},d(n){n&&$(e)}}}function Xs(l){let e,n,t="This site uses cookies",s,o,r,a;return o=new qe({props:{title:"Accept cookies",$$slots:{default:[Js]},$$scope:{ctx:l}}}),o.$on("click",l[0]),{c(){e=S("div"),n=S("span"),n.textContent=t,s=N(),R(o.$$.fragment),this.h()},l(i){e=I(i,"DIV",{class:!0});var u=V(e);n=I(u,"SPAN",{"data-svelte-h":!0}),ue(n)!=="svelte-17tpe0c"&&(n.textContent=t),s=O(u),F(o.$$.fragment,u),u.forEach($),this.h()},h(){h(e,"class","svelte-20j44m")},m(i,u){T(i,e,u),d(e,n),d(e,s),M(o,e,null),a=!0},p(i,[u]){const c={};u&2&&(c.$$scope={dirty:u,ctx:i}),o.$set(c)},i(i){a||(v(o.$$.fragment,i),r&&r.end(1),a=!0)},o(i){w(o.$$.fragment,i),i&&(r=sn(e,Zs,{y:200,duration:200})),a=!1},d(i){i&&$(e),L(o),i&&r&&r.end()}}}function xs(l){return[()=>Kt.set(!0)]}class el extends _e{constructor(e){super(),de(this,e,xs,Xs,pe,{})}}function tl(l){let e;return{c(){e=ie("Search")},l(n){e=ae(n,"Search")},m(n,t){T(n,e,t)},i:Q,o:Q,d(n){n&&$(e)}}}function nl(l){let e,n;return e=new qt({}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function sl(l){let e,n,t,s;const o=[nl,tl],r=[];function a(i,u){return i[0]?0:1}return e=a(l),n=r[e]=o[e](l),{c(){n.c(),t=be()},l(i){n.l(i),t=be()},m(i,u){r[e].m(i,u),T(i,t,u),s=!0},p(i,u){let c=e;e=a(i),e!==c&&(le(),w(r[c],1,1,()=>{r[c]=null}),re(),n=r[e],n||(n=r[e]=o[e](i),n.c()),v(n,1),n.m(t.parentNode,t))},i(i){s||(v(n),s=!0)},o(i){w(n),s=!1},d(i){i&&$(t),r[e].d(i)}}}function ll(l){let e,n,t,s,o,r;const a=[il,ol],i=[];function u(c,f){return c[3].postCount===0?0:1}return n=u(l),t=i[n]=a[n](l),o=new In({}),{c(){e=S("section"),t.c(),s=N(),R(o.$$.fragment),this.h()},l(c){e=I(c,"SECTION",{class:!0});var f=V(e);t.l(f),f.forEach($),s=O(c),F(o.$$.fragment,c),this.h()},h(){h(e,"class","svelte-1muglpt")},m(c,f){T(c,e,f),i[n].m(e,null),T(c,s,f),M(o,c,f),r=!0},p(c,f){let _=n;n=u(c),n===_?i[n].p(c,f):(le(),w(i[_],1,1,()=>{i[_]=null}),re(),t=i[n],t?t.p(c,f):(t=i[n]=a[n](c),t.c()),v(t,1),t.m(e,null))},i(c){r||(v(t),v(o.$$.fragment,c),r=!0)},o(c){w(t),w(o.$$.fragment,c),r=!1},d(c){c&&($(e),$(s)),i[n].d(),L(o,c)}}}function rl(l){let e,n;return e=new Bn({props:{error:l[1]}}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p(t,s){const o={};s&2&&(o.error=t[1]),e.$set(o)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function ol(l){let e,n,t,s,o,r;e=new Us({}),e.$on("sortfilterupdate",l[10]),e.$on("endreached",l[11]);const a=[cl,al],i=[];function u(c,f){return c[3].posts.length===c[3].postCount?0:1}return t=u(l),s=i[t]=a[t](l),{c(){R(e.$$.fragment),n=N(),s.c(),o=be()},l(c){F(e.$$.fragment,c),n=O(c),s.l(c),o=be()},m(c,f){M(e,c,f),T(c,n,f),i[t].m(c,f),T(c,o,f),r=!0},p(c,f){let _=t;t=u(c),t===_?i[t].p(c,f):(le(),w(i[_],1,1,()=>{i[_]=null}),re(),s=i[t],s?s.p(c,f):(s=i[t]=a[t](c),s.c()),v(s,1),s.m(o.parentNode,o))},i(c){r||(v(e.$$.fragment,c),v(s),r=!0)},o(c){w(e.$$.fragment,c),w(s),r=!1},d(c){c&&($(n),$(o)),L(e,c),i[t].d(c)}}}function il(l){let e,n;return e=new Qs({}),e.$on("sortfilterupdate",l[10]),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p:Q,i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function al(l){let e,n;return e=new Qt({props:{rootMargin:1e3/Number(l[7])+"px"}}),e.$on("intersection",l[11]),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p(t,s){const o={};s&128&&(o.rootMargin=1e3/Number(t[7])+"px"),e.$set(o)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function cl(l){let e,n;return e=new Gn({}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p:Q,i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function Rt(l){let e,n;return e=new Fn({props:{tags:l[5]}}),e.$on("close",l[16]),e.$on("submit",l[17]),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},p(t,s){const o={};s&32&&(o.tags=t[5]),e.$set(o)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function Ft(l){let e,n;return e=new el({}),{c(){R(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,s){M(e,t,s),n=!0},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){L(e,t)}}}function ul(l){let e,n,t,s,o,r,a,i,u,c,f,_,y,C,b;n=new rn({}),s=new En({props:{placeholder:"Search for tags",fetchSuggestions:l[9]}}),s.$on("pick",l[12]),r=new qe({props:{title:"Search with the tags above",$$slots:{default:[sl]},$$scope:{ctx:l}}}),r.$on("click",l[10]),i=new on({props:{tags:[...l[5],...l[4]]}}),i.$on("click",l[13]),i.$on("contextmenu",l[14]),i.$on("createSupertag",l[15]);const E=[rl,ll],p=[];function g(D,A){return D[1]?0:D[3].requested?1:-1}~(c=g(l))&&(f=p[c]=E[c](l));let m=l[2]&&Rt(l),k=!l[8]&&Ft();return{c(){e=S("section"),R(n.$$.fragment),t=N(),R(s.$$.fragment),o=N(),R(r.$$.fragment),a=N(),R(i.$$.fragment),u=N(),f&&f.c(),_=N(),m&&m.c(),y=N(),k&&k.c(),C=be(),this.h()},l(D){e=I(D,"SECTION",{id:!0,class:!0});var A=V(e);F(n.$$.fragment,A),t=O(A),F(s.$$.fragment,A),o=O(A),F(r.$$.fragment,A),a=O(A),F(i.$$.fragment,A),A.forEach($),u=O(D),f&&f.l(D),_=O(D),m&&m.l(D),y=O(D),k&&k.l(D),C=be(),this.h()},h(){h(e,"id","search"),h(e,"class","svelte-1muglpt")},m(D,A){T(D,e,A),M(n,e,null),d(e,t),M(s,e,null),d(e,o),M(r,e,null),d(e,a),M(i,e,null),T(D,u,A),~c&&p[c].m(D,A),T(D,_,A),m&&m.m(D,A),T(D,y,A),k&&k.m(D,A),T(D,C,A),b=!0},p(D,[A]){const ee={};A&33554433&&(ee.$$scope={dirty:A,ctx:D}),r.$set(ee);const Z={};A&48&&(Z.tags=[...D[5],...D[4]]),i.$set(Z);let x=c;c=g(D),c===x?~c&&p[c].p(D,A):(f&&(le(),w(p[x],1,1,()=>{p[x]=null}),re()),~c?(f=p[c],f?f.p(D,A):(f=p[c]=E[c](D),f.c()),v(f,1),f.m(_.parentNode,_)):f=null),D[2]?m?(m.p(D,A),A&4&&v(m,1)):(m=Rt(D),m.c(),v(m,1),m.m(y.parentNode,y)):m&&(le(),w(m,1,1,()=>{m=null}),re()),D[8]?k&&(le(),w(k,1,1,()=>{k=null}),re()):k?A&256&&v(k,1):(k=Ft(),k.c(),v(k,1),k.m(C.parentNode,C))},i(D){b||(v(n.$$.fragment,D),v(s.$$.fragment,D),v(r.$$.fragment,D),v(i.$$.fragment,D),v(f),v(m),v(k),b=!0)},o(D){w(n.$$.fragment,D),w(s.$$.fragment,D),w(r.$$.fragment,D),w(i.$$.fragment,D),w(f),w(m),w(k),b=!1},d(D){D&&($(e),$(u),$(_),$(y),$(C)),L(n),L(s),L(r),L(i),~c&&p[c].d(D),m&&m.d(D),k&&k.d(D)}}}function fl(l,e,n){let t,s,o,r,a,i,u,c,f;$e(l,Ge,P=>n(3,t=P)),$e(l,ot,P=>n(4,s=P)),$e(l,Me,P=>n(19,o=P)),$e(l,ze,P=>n(20,r=P)),$e(l,On,P=>n(21,a=P)),$e(l,tt,P=>n(5,i=P)),$e(l,pt,P=>n(6,u=P)),$e(l,jt,P=>n(7,c=P)),$e(l,Kt,P=>n(8,f=P));let _=!1,y,C=!1,b=0;const E=async P=>{const J=await Dn(P);return[...u.items.filter(({name:B})=>B.toLowerCase().includes(P.toLowerCase())).map(B=>({label:B.name,count:B.tags.length,type:"supertag"})),...J]},p=()=>new an().withPid(t.pageCount).withTags(i).withBlockedContent(a).withSortProperty(r.property).withSortDirection(r.direction).withScoreValue(o.scoreValue).withScoreComparator(o.scoreComparator).withRating(o.rating).withSupertags(s),g=async P=>{if(!_){n(1,y=void 0),n(0,_=!0);try{const J=t.pageCount;await P(),Nn(J).catch(()=>{})}catch(J){n(1,y=J),console.warn(J)}finally{n(0,_=!1)}}},m=async()=>{Ge.reset(),b=0,g(async()=>{const[P,J]=await p().getPageAndCount();Ge.addPage(P,J)})},k=async()=>{g(async()=>{const P=await p().getPage();Ge.addPage(P)})},D=P=>{var J,W;if((P.key==="/"||P.key==="s")&&(!document.activeElement||document.activeElement===document.body)&&((J=document.getElementById("searchbar"))==null||J.focus(),P.preventDefault(),P.stopPropagation()),P.ctrlKey&&P.key==="Enter"&&(P.preventDefault(),P.stopPropagation(),m()),P.ctrlKey&&P.key==="m"&&((W=document.getElementById("select-modifier"))==null||W.click()),P.ctrlKey&&P.key==="ArrowDown"){const B=document.getElementsByClassName("post-media");B[b].focus(),b=Math.min(b+1,Math.max(0,B.length-1))}P.ctrlKey&&P.key==="ArrowUp"&&(document.getElementsByClassName("post-media")[b].focus(),b=Math.max(b-1,0))};return xe(async()=>{document.addEventListener("keydown",D)}),et(()=>{document.removeEventListener("keydown",D)}),[_,y,C,t,s,i,u,c,f,E,m,k,async P=>{const J=P.detail;if(J.type==="supertag"){const W=u.items.find(B=>B.name===J.label);if(!W){console.warn("Supertag not present.");return}ot.addOrReplace(W)}else{const W=await Pn(P.detail.label);tt.addOrReplace({name:P.detail.label,modifier:P.detail.modifier,count:P.detail.count,type:(W==null?void 0:W.type)??"tag"})}},P=>"description"in P.detail?ot.removeByName(P.detail.name):tt.removeByName(P.detail.name),P=>{"description"in P.detail||(P.detail.modifier=Sn(P.detail.modifier),tt.addOrReplace(P.detail))},()=>n(2,C=!0),()=>n(2,C=!1),P=>pt.add(P.detail)]}class Fl extends _e{constructor(e){super(),de(this,e,fl,ul,pe,{})}}export{Fl as component};
